{
  "version": 3,
  "sources": ["src/core/auth-events.service.ts", "src/core/auth.service.ts"],
  "sourcesContent": ["/**\r\n * èªè­‰äº‹ä»¶æœå‹™\r\n * \r\n * ğŸ†• çµ±ä¸€èªè­‰äº‹ä»¶ç¸½ç·š\r\n * è§£æ±ºå¤šå€‹ AuthService ç‹€æ…‹ä¸åŒæ­¥çš„å•é¡Œ\r\n * \r\n * è¨­è¨ˆåŸå‰‡ï¼š\r\n * 1. å–®ä¸€äº‹ä»¶æº - æ‰€æœ‰èªè­‰äº‹ä»¶é€šéæ­¤æœå‹™å»£æ’­\r\n * 2. è§£è€¦ä¾è³´ - é¿å…æœå‹™é–“å¾ªç’°ä¾è³´\r\n * 3. äº‹ä»¶é©…å‹• - ä½¿ç”¨ RxJS Subject å»£æ’­äº‹ä»¶\r\n */\r\n\r\nimport { Injectable } from '@angular/core';\r\nimport { Subject, Observable } from 'rxjs';\r\n\r\n// èªè­‰äº‹ä»¶é¡å‹\r\nexport type AuthEventType = \r\n  | 'login'           // ç™»å…¥æˆåŠŸ\r\n  | 'logout'          // ç™»å‡º\r\n  | 'session_expired' // æœƒè©±éæœŸ\r\n  | 'token_refresh'   // Token åˆ·æ–°\r\n  | 'user_update';    // ç”¨æˆ¶ä¿¡æ¯æ›´æ–°\r\n\r\n// èªè­‰äº‹ä»¶æ•¸æ“š\r\nexport interface AuthEvent {\r\n  type: AuthEventType;\r\n  payload?: any;\r\n  timestamp: number;\r\n}\r\n\r\n// Token å­˜å„²éµ - é›†ä¸­ç®¡ç†\r\nexport const AUTH_STORAGE_KEYS = {\r\n  ACCESS_TOKEN: 'tgm_access_token',\r\n  REFRESH_TOKEN: 'tgm_refresh_token',\r\n  AUTH_TOKEN: 'tgm_auth_token',  // èˆŠç‰ˆå…¼å®¹\r\n  USER: 'tgm_user',\r\n  SESSION_ID: 'tgm_session_id',\r\n  REMEMBER_ME: 'tgm_remember_me'  // ğŸ†• è¨˜ä½ç™»å…¥ç‹€æ…‹\r\n} as const;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthEventsService {\r\n  // èªè­‰äº‹ä»¶ä¸»é¡Œ\r\n  private _authEvents = new Subject<AuthEvent>();\r\n  \r\n  // å…¬é–‹çš„äº‹ä»¶æµ\r\n  readonly authEvents$: Observable<AuthEvent> = this._authEvents.asObservable();\r\n  \r\n  /**\r\n   * å»£æ’­ç™»å…¥äº‹ä»¶\r\n   */\r\n  emitLogin(payload?: any): void {\r\n    this._authEvents.next({\r\n      type: 'login',\r\n      payload,\r\n      timestamp: Date.now()\r\n    });\r\n    console.log('[AuthEvents] Login event emitted');\r\n  }\r\n  \r\n  /**\r\n   * å»£æ’­ç™»å‡ºäº‹ä»¶\r\n   */\r\n  emitLogout(): void {\r\n    this._authEvents.next({\r\n      type: 'logout',\r\n      timestamp: Date.now()\r\n    });\r\n    console.log('[AuthEvents] Logout event emitted');\r\n  }\r\n  \r\n  /**\r\n   * å»£æ’­æœƒè©±éæœŸäº‹ä»¶\r\n   */\r\n  emitSessionExpired(): void {\r\n    this._authEvents.next({\r\n      type: 'session_expired',\r\n      timestamp: Date.now()\r\n    });\r\n    console.log('[AuthEvents] Session expired event emitted');\r\n  }\r\n  \r\n  /**\r\n   * å»£æ’­ Token åˆ·æ–°äº‹ä»¶\r\n   */\r\n  emitTokenRefresh(newToken: string): void {\r\n    this._authEvents.next({\r\n      type: 'token_refresh',\r\n      payload: { token: newToken },\r\n      timestamp: Date.now()\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * å»£æ’­ç”¨æˆ¶ä¿¡æ¯æ›´æ–°äº‹ä»¶\r\n   */\r\n  emitUserUpdate(user: any): void {\r\n    this._authEvents.next({\r\n      type: 'user_update',\r\n      payload: { user },\r\n      timestamp: Date.now()\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * æ¸…é™¤æ‰€æœ‰èªè­‰ç›¸é—œçš„ localStorage\r\n   * é›†ä¸­å¼ç®¡ç†ï¼Œç¢ºä¿å¾¹åº•æ¸…é™¤\r\n   */\r\n  clearAllAuthStorage(): void {\r\n    console.log('[AuthEvents] Clearing all auth storage');\r\n    Object.values(AUTH_STORAGE_KEYS).forEach(key => {\r\n      localStorage.removeItem(key);\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * ç²å–ç•¶å‰ Tokenï¼ˆå¾ localStorageï¼‰\r\n   */\r\n  getStoredToken(): string | null {\r\n    return localStorage.getItem(AUTH_STORAGE_KEYS.ACCESS_TOKEN) \r\n        || localStorage.getItem(AUTH_STORAGE_KEYS.AUTH_TOKEN);\r\n  }\r\n  \r\n  /**\r\n   * ç²å–å­˜å„²çš„ç”¨æˆ¶ä¿¡æ¯\r\n   */\r\n  getStoredUser(): any | null {\r\n    try {\r\n      const userJson = localStorage.getItem(AUTH_STORAGE_KEYS.USER);\r\n      return userJson ? JSON.parse(userJson) : null;\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n", "/**\n * TG-Matrix èªè­‰æœå‹™\n * \n * å„ªåŒ–è¨­è¨ˆï¼š\n * 1. çµ±ä¸€çš„èªè­‰ç‹€æ…‹ç®¡ç†\n * 2. Token è‡ªå‹•åˆ·æ–°\n * 3. è¨­å‚™ç®¡ç†\n * 4. é›¢ç·šæ”¯æŒ\n */\n\nimport { Injectable, inject, signal, computed, effect, OnDestroy } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { ApiService } from './api.service';\nimport { AuthEventsService, AUTH_STORAGE_KEYS } from './auth-events.service';\n\n// ç”¨æˆ¶æ¨¡å‹\nexport interface User {\n  id: string;\n  email: string;\n  username: string;\n  display_name: string;\n  displayName?: string;  // ğŸ†• å…¼å®¹åˆ¥å\n  avatar_url: string;\n  role: string;\n  subscription_tier: string;\n  max_accounts: number;\n  is_active: boolean;\n  is_verified: boolean;\n  two_factor_enabled: boolean;\n  created_at: string;\n  last_login_at: string;\n  // ğŸ†• Telegram ç›¸é—œå­—æ®µ\n  telegram_id?: string;\n  telegramId?: string;  // ğŸ†• å…¼å®¹åˆ¥å\n  telegram_username?: string;\n  // ğŸ†• é‚€è«‹ç›¸é—œå­—æ®µ\n  invite_code?: string;\n  inviteCode?: string;\n  invited_count?: number;\n  // ğŸ”§ P0 ä¿®å¾©ï¼šæœƒå“¡åˆ°æœŸæ™‚é–“\n  subscription_expires?: string;\n  membershipExpires?: string;  // å…¼å®¹åˆ¥å\n  // ğŸ”§ P0 ä¿®å¾©ï¼šæœƒå“¡ç­‰ç´š\n  membershipLevel?: string;\n}\n\n// èªè­‰ç‹€æ…‹\nexport interface AuthState {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  accessToken: string | null;\n  refreshToken: string | null;\n}\n\n// ç™»å…¥è«‹æ±‚\nexport interface LoginRequest {\n  email: string;\n  password: string;\n  remember?: boolean;\n  device_name?: string;\n}\n\n// è¨»å†Šè«‹æ±‚\nexport interface RegisterRequest {\n  email: string;\n  password: string;\n  username?: string;\n  display_name?: string;\n}\n\n// Token å­˜å„²éµï¼ˆä½¿ç”¨é›†ä¸­å®šç¾©ï¼‰\nconst TOKEN_KEYS = AUTH_STORAGE_KEYS;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService implements OnDestroy {\n  private api = inject(ApiService);\n  private router = inject(Router);\n  private authEvents = inject(AuthEventsService);\n  \n  // äº‹ä»¶è¨‚é–±\n  private eventSubscription: Subscription | null = null;\n  \n  // ç‹€æ…‹ä¿¡è™Ÿ\n  private _user = signal<User | null>(null);\n  private _isLoading = signal<boolean>(false);\n  private _accessToken = signal<string | null>(null);\n  private _refreshToken = signal<string | null>(null);\n  \n  // Token åˆ·æ–°å®šæ™‚å™¨\n  private refreshTimer: any = null;\n  \n  // å…¬é–‹çš„è¨ˆç®—å±¬æ€§\n  readonly user = computed(() => this._user());\n  // ğŸ”§ ä¿®å¾©ï¼šåªéœ€è¦ Token å­˜åœ¨å³å¯èªç‚ºå·²èªè­‰ï¼ˆuser å¯ä»¥å»¶é²åŠ è¼‰ï¼‰\n  readonly isAuthenticated = computed(() => !!this._accessToken());\n  readonly isLoading = computed(() => this._isLoading());\n  readonly accessToken = computed(() => this._accessToken());\n  \n  // è¨‚é–±ä¿¡æ¯\n  readonly subscriptionTier = computed(() => this._user()?.subscription_tier || 'free');\n  readonly maxAccounts = computed(() => this._user()?.max_accounts || 3);\n  readonly isPro = computed(() => ['pro', 'enterprise'].includes(this.subscriptionTier()));\n  \n  // æœƒå“¡ç­‰ç´šï¼ˆå…¼å®¹èˆŠæ¥å£ï¼‰\n  // ğŸ”§ P0 ä¿®å¾©ï¼šå®Œæ•´çš„ç­‰ç´šæ˜ å°„ï¼Œæ”¯æŒ subscription_tier å’Œç›´æ¥çš„ç­‰ç´šåç¨±\n  readonly membershipLevel = computed(() => {\n    const tier = this.subscriptionTier();\n    const tierMap: Record<string, string> = {\n      // å¾ subscription_tier è½‰æ›\n      'free': 'bronze',\n      'basic': 'silver',\n      'pro': 'gold',\n      'enterprise': 'diamond',\n      // ğŸ”§ ç›´æ¥æ˜ å°„ï¼ˆæ•¸æ“šåº«å¯èƒ½ç›´æ¥å­˜å„²ç­‰ç´šåç¨±ï¼‰\n      'bronze': 'bronze',\n      'silver': 'silver',\n      'gold': 'gold',\n      'diamond': 'diamond',\n      'star': 'star',\n      'king': 'king'\n    };\n    return tierMap[tier] || 'bronze';\n  });\n  \n  \n  // ğŸ”§ æ¨™è¨˜æ˜¯å¦å·²å®Œæˆåˆå§‹åŒ–ï¼Œé¿å… effect åœ¨åˆå§‹åŒ–æ™‚åˆªé™¤ localStorage\n  private _initialized = false;\n  \n  constructor() {\n    // åˆå§‹åŒ–æ™‚æ¢å¾©ç‹€æ…‹\n    this.restoreSession();\n    this._initialized = true;\n    \n    // ğŸ†• è¨‚é–±èªè­‰äº‹ä»¶ï¼ˆè™•ç†ä¾†è‡ªå…¶ä»–æœå‹™çš„ç™»å‡ºé€šçŸ¥å’Œç”¨æˆ¶æ›´æ–°ï¼‰\n    this.eventSubscription = this.authEvents.authEvents$.subscribe(event => {\n      if (event.type === 'logout') {\n        console.log('[CoreAuthService] Received logout event, clearing state');\n        this.clearAuthStateInternal();\n      } else if (event.type === 'user_update' && event.payload?.user) {\n        console.log('[CoreAuthService] Received user_update event, syncing user data');\n        this._user.set(event.payload.user);\n        // åŒæ­¥æ›´æ–° localStorage\n        localStorage.setItem(TOKEN_KEYS.USER, JSON.stringify(event.payload.user));\n      }\n    });\n    \n    // Token è®ŠåŒ–æ™‚è‡ªå‹•ä¿å­˜ - ğŸ”§ ä¿®å¾©ï¼šåªåœ¨åˆå§‹åŒ–å¾Œæ‰åŸ·è¡Œåˆªé™¤æ“ä½œ\n    effect(() => {\n      const token = this._accessToken();\n      if (token) {\n        localStorage.setItem(TOKEN_KEYS.ACCESS_TOKEN, token);\n      } else if (this._initialized) {\n        // ğŸ”§ åªæœ‰åœ¨åˆå§‹åŒ–å®Œæˆå¾Œï¼Œæ‰åˆªé™¤ localStorage\n        // é¿å…åœ¨æ§‹é€ å‡½æ•¸ä¸­å› ç‚ºåˆå§‹å€¼ null è€Œåˆªé™¤å·²ä¿å­˜çš„ Token\n        localStorage.removeItem(TOKEN_KEYS.ACCESS_TOKEN);\n      }\n    });\n    \n    effect(() => {\n      const token = this._refreshToken();\n      if (token) {\n        localStorage.setItem(TOKEN_KEYS.REFRESH_TOKEN, token);\n      } else if (this._initialized) {\n        localStorage.removeItem(TOKEN_KEYS.REFRESH_TOKEN);\n      }\n    });\n    \n    effect(() => {\n      const user = this._user();\n      if (user) {\n        localStorage.setItem(TOKEN_KEYS.USER, JSON.stringify(user));\n      } else if (this._initialized) {\n        localStorage.removeItem(TOKEN_KEYS.USER);\n      }\n    });\n  }\n  \n  ngOnDestroy(): void {\n    this.eventSubscription?.unsubscribe();\n  }\n  \n  // ==================== å…¬é–‹æ–¹æ³• ====================\n  \n  /**\n   * ç”¨æˆ¶è¨»å†Š\n   */\n  async register(request: RegisterRequest): Promise<{ success: boolean; error?: string }> {\n    this._isLoading.set(true);\n    \n    try {\n      const result = await this.api.command<any>('user-register', request);\n      \n      if (result.success && result.data) {\n        this.setAuthState(result.data);\n        return { success: true };\n      }\n      \n      return { success: false, error: result.error || 'è¨»å†Šå¤±æ•—' };\n    } catch (e: any) {\n      return { success: false, error: e.message || 'è¨»å†Šå¤±æ•—' };\n    } finally {\n      this._isLoading.set(false);\n    }\n  }\n  \n  /**\n   * ç”¨æˆ¶ç™»å…¥\n   */\n  async login(request: LoginRequest): Promise<{ success: boolean; error?: string }> {\n    this._isLoading.set(true);\n    \n    try {\n      // èª¿ç”¨ HTTP API\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          email: request.email,\n          password: request.password,\n          device_name: request.device_name || this.getDeviceName(),\n          remember: request.remember || false // ğŸ†• å‚³éè¨˜ä½ç™»å…¥é¸é …\n        })\n      });\n      \n      const result = await response.json();\n      \n      if (result.success && result.data) {\n        // ğŸ†• ä¿å­˜è¨˜ä½ç‹€æ…‹\n        if (request.remember) {\n          localStorage.setItem('tgm_remember_me', 'true');\n        } else {\n          localStorage.removeItem('tgm_remember_me');\n        }\n        \n        this.setAuthState(result.data);\n        this.scheduleTokenRefresh();\n        return { success: true };\n      }\n      \n      return { success: false, error: result.error || 'ç™»å…¥å¤±æ•—' };\n    } catch (e: any) {\n      return { success: false, error: e.message || 'ç™»å…¥å¤±æ•—' };\n    } finally {\n      this._isLoading.set(false);\n    }\n  }\n  \n  /**\n   * ç²å– Telegram OAuth é…ç½®\n   */\n  async getTelegramConfig(): Promise<{ enabled: boolean; bot_username?: string; bot_id?: string }> {\n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/oauth/telegram/config`);\n      const result = await response.json();\n      \n      if (result.success && result.data) {\n        return result.data;\n      }\n      \n      return { enabled: false };\n    } catch (e) {\n      console.error('Failed to get Telegram config:', e);\n      return { enabled: false };\n    }\n  }\n  \n  /**\n   * Telegram OAuth ç™»å…¥\n   */\n  async telegramLogin(authData: any): Promise<{ success: boolean; error?: string }> {\n    this._isLoading.set(true);\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/oauth/telegram`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(authData)\n      });\n      \n      const result = await response.json();\n      \n      if (result.success) {\n        // è¨­ç½®èªè­‰ç‹€æ…‹\n        this.setAuthState({\n          user: result.user,\n          access_token: result.access_token,\n          refresh_token: result.refresh_token\n        });\n        this.scheduleTokenRefresh();\n        return { success: true };\n      }\n      \n      return { success: false, error: result.error || 'Telegram ç™»å…¥å¤±æ•—' };\n    } catch (e: any) {\n      return { success: false, error: e.message || 'Telegram ç™»å…¥å¤±æ•—' };\n    } finally {\n      this._isLoading.set(false);\n    }\n  }\n  \n  /**\n   * ç™»å‡º\n   */\n  async logout(): Promise<void> {\n    try {\n      const token = this._accessToken();\n      if (token) {\n        await fetch(`${this.getApiBaseUrl()}/api/v1/auth/logout`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`\n          }\n        });\n      }\n    } catch (e) {\n      console.error('Logout error:', e);\n    } finally {\n      // ğŸ†• å»£æ’­ç™»å‡ºäº‹ä»¶ï¼Œé€šçŸ¥æ‰€æœ‰è¨‚é–±è€…\n      this.authEvents.emitLogout();\n      // æ¸…é™¤æœ¬æœå‹™ç‹€æ…‹\n      this.clearAuthStateInternal();\n      // ğŸ”§ ä¿®å¾©ï¼šä½¿ç”¨æ­£ç¢ºçš„ç™»å…¥é é¢è·¯å¾‘\n      this.router.navigate(['/auth/login']);\n    }\n  }\n  \n  /**\n   * è«‹æ±‚å¯†ç¢¼é‡ç½®\n   */\n  async forgotPassword(email: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/forgot-password`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email })\n      });\n      \n      const result = await response.json();\n      return { success: result.success, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * é‡ç½®å¯†ç¢¼\n   */\n  async resetPassword(token: string, password: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/reset-password`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token, password })\n      });\n      \n      const result = await response.json();\n      return { success: result.success, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * é©—è­‰éƒµç®±ï¼ˆé€šé Tokenï¼‰\n   */\n  async verifyEmail(token: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/verify-email`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token })\n      });\n      \n      const result = await response.json();\n      return { success: result.success, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * é©—è­‰éƒµç®±ï¼ˆé€šéé©—è­‰ç¢¼ï¼‰\n   */\n  async verifyEmailByCode(email: string, code: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/verify-email-code`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, code })\n      });\n      \n      const result = await response.json();\n      return { success: result.success, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * é‡æ–°ç™¼é€é©—è­‰éƒµä»¶\n   */\n  async resendVerificationEmail(): Promise<{ success: boolean; error?: string }> {\n    try {\n      const token = this._accessToken();\n      if (!token) {\n        return { success: false, error: 'æœªç™»å…¥' };\n      }\n      \n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/send-verification`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      \n      const result = await response.json();\n      return { success: result.success, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * åˆ·æ–° Token\n   */\n  async refreshAccessToken(): Promise<boolean> {\n    const refreshToken = this._refreshToken();\n    if (!refreshToken) {\n      return false;\n    }\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/refresh`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ refresh_token: refreshToken })\n      });\n      \n      const result = await response.json();\n      \n      if (result.success && result.data) {\n        this._accessToken.set(result.data.access_token);\n        this._refreshToken.set(result.data.refresh_token);\n        this.scheduleTokenRefresh();\n        return true;\n      }\n      \n      return false;\n    } catch (e) {\n      console.error('Token refresh error:', e);\n      return false;\n    }\n  }\n  \n  /**\n   * ç²å–ç•¶å‰ç”¨æˆ¶ä¿¡æ¯\n   * ğŸ”§ å„ªåŒ–ï¼šåŒæ™‚æª¢æŸ¥ Signal å’Œ localStorageï¼Œç¢ºä¿ Token ç¸½èƒ½è¢«è®€å–\n   */\n  async fetchCurrentUser(): Promise<User | null> {\n    // ğŸ”§ ä¿®å¾©ï¼šåŒæ™‚æª¢æŸ¥ Signal å’Œ localStorage\n    const token = this._accessToken() || localStorage.getItem(TOKEN_KEYS.ACCESS_TOKEN);\n    if (!token) {\n      console.log('[AuthService] fetchCurrentUser: No token available');\n      return null;\n    }\n    \n    // ç¢ºä¿ Signal åŒæ­¥ï¼ˆé˜²æ­¢ä¸ä¸€è‡´ï¼‰\n    if (!this._accessToken() && token) {\n      this._accessToken.set(token);\n    }\n    \n    try {\n      console.log('[AuthService] fetchCurrentUser: Fetching user info...');\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/me`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      // ğŸ”§ è™•ç†é 200 éŸ¿æ‡‰\n      if (!response.ok) {\n        console.warn(`[AuthService] fetchCurrentUser: HTTP ${response.status}`);\n        if (response.status === 401) {\n          // Token ç„¡æ•ˆï¼Œæ¸…é™¤èªè­‰ç‹€æ…‹\n          console.warn('[AuthService] Token invalid, clearing session');\n          // ä¸ç›´æ¥æ¸…é™¤ï¼Œè®“èª¿ç”¨è€…æ±ºå®šå¦‚ä½•è™•ç†\n        }\n        return null;\n      }\n      \n      const result = await response.json();\n      \n      if (result.success && result.data) {\n        console.log('[AuthService] fetchCurrentUser: Success', result.data.username);\n        this._user.set(result.data);\n        // ğŸ”§ åŒæ­¥æ›´æ–° localStorageï¼ˆç¢ºä¿ä¸€è‡´æ€§ï¼‰\n        localStorage.setItem(TOKEN_KEYS.USER, JSON.stringify(result.data));\n        return result.data;\n      }\n      \n      console.warn('[AuthService] fetchCurrentUser: API returned', result);\n      return null;\n    } catch (e) {\n      console.error('[AuthService] fetchCurrentUser error:', e);\n      return null;\n    }\n  }\n  \n  /**\n   * ğŸ”§ P0 ä¿®å¾©ï¼šå¼·åˆ¶åˆ·æ–°ç”¨æˆ¶æ•¸æ“š\n   * ä¾›çµ„ä»¶åœ¨é—œéµæ™‚æ©Ÿï¼ˆå¦‚é é¢å¯è¦‹ã€æœƒå“¡é é¢é€²å…¥ï¼‰èª¿ç”¨\n   */\n  async forceRefreshUser(): Promise<User | null> {\n    console.log('[AuthService] forceRefreshUser: å¼·åˆ¶åˆ·æ–°ç”¨æˆ¶æ•¸æ“š');\n    return this.fetchCurrentUser();\n  }\n  \n  /**\n   * æ›´æ–°ç”¨æˆ¶ä¿¡æ¯\n   */\n  async updateProfile(updates: Partial<User>): Promise<{ success: boolean; error?: string }> {\n    const token = this._accessToken();\n    if (!token) {\n      return { success: false, error: 'æœªç™»å…¥' };\n    }\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/me`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify(updates)\n      });\n      \n      const result = await response.json();\n      \n      if (result.success) {\n        // æ›´æ–°æœ¬åœ°ç”¨æˆ¶ä¿¡æ¯\n        const currentUser = this._user();\n        if (currentUser) {\n          this._user.set({ ...currentUser, ...updates });\n        }\n        return { success: true };\n      }\n      \n      return { success: false, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * ä¿®æ”¹å¯†ç¢¼\n   */\n  async changePassword(oldPassword: string, newPassword: string): Promise<{ success: boolean; error?: string }> {\n    const token = this._accessToken();\n    if (!token) {\n      return { success: false, error: 'æœªç™»å…¥' };\n    }\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/change-password`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ old_password: oldPassword, new_password: newPassword })\n      });\n      \n      const result = await response.json();\n      return { success: result.success, error: result.error };\n    } catch (e: any) {\n      return { success: false, error: e.message };\n    }\n  }\n  \n  /**\n   * ç²å–æœƒè©±åˆ—è¡¨\n   */\n  /**\n   * ğŸ†• Phase 4: ç²å–ç”¨æˆ¶æ‰€æœ‰è¨­å‚™\n   */\n  async getSessions(): Promise<any[]> {\n    const token = this._accessToken();\n    if (!token) return [];\n    \n    try {\n      // ä½¿ç”¨æ–°çš„è¨­å‚™ç®¡ç† API\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/devices`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      const result = await response.json();\n      return result.success ? (result.data?.devices || []) : [];\n    } catch (e) {\n      return [];\n    }\n  }\n  \n  /**\n   * æ’¤éŠ·æœƒè©±\n   */\n  /**\n   * ğŸ†• Phase 4: æ’¤éŠ·æŒ‡å®šè¨­å‚™æœƒè©±\n   */\n  async revokeSession(sessionId: string): Promise<boolean> {\n    const token = this._accessToken();\n    if (!token) return false;\n    \n    try {\n      // ä½¿ç”¨æ–°çš„è¨­å‚™ç®¡ç† API\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/devices/${sessionId}`, {\n        method: 'DELETE',\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      const result = await response.json();\n      return result.success;\n    } catch (e) {\n      return false;\n    }\n  }\n  \n  /**\n   * ğŸ†• Phase 4: ç™»å‡ºé™¤ç•¶å‰è¨­å‚™å¤–çš„æ‰€æœ‰è¨­å‚™\n   */\n  async revokeAllOtherSessions(): Promise<number> {\n    const token = this._accessToken();\n    if (!token) return 0;\n    \n    try {\n      // ç²å–ç•¶å‰æœƒè©± IDï¼ˆå¦‚æœæœ‰ä¿å­˜çš„è©±ï¼‰\n      const currentSessionId = localStorage.getItem('tgm_session_id') || '';\n      \n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/devices/revoke-all`, {\n        method: 'POST',\n        headers: { \n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ current_session_id: currentSessionId })\n      });\n      \n      const result = await response.json();\n      return result.success ? (result.revoked_count || 0) : 0;\n    } catch (e) {\n      return 0;\n    }\n  }\n  \n  /**\n   * æª¢æŸ¥åŠŸèƒ½æ¬Šé™\n   */\n  hasFeature(feature: string): boolean {\n    const tier = this.subscriptionTier();\n    const featureMap: Record<string, string[]> = {\n      'free': ['basic_monitoring', 'basic_ai'],\n      'basic': ['basic_monitoring', 'basic_ai', 'templates'],\n      'pro': ['basic_monitoring', 'basic_ai', 'templates', 'full_monitoring', 'advanced_ai', 'team', 'api_access'],\n      'enterprise': ['all']\n    };\n    \n    const allowedFeatures = featureMap[tier] || [];\n    return allowedFeatures.includes('all') || allowedFeatures.includes(feature);\n  }\n  \n  /**\n   * ç²å–èªè­‰ Header\n   * ğŸ”§ ä¿®å¾©ï¼šåŒæ™‚æª¢æŸ¥ Signal å’Œ localStorageï¼Œç¢ºä¿ Token ç¸½èƒ½è¢«è®€å–\n   */\n  getAuthHeaders(): Record<string, string> {\n    const token = this._accessToken() || localStorage.getItem('tgm_access_token');\n    if (token) {\n      return { 'Authorization': `Bearer ${token}` };\n    }\n    return {};\n  }\n  \n  // ==================== ğŸ†• è¨­å‚™ç®¡ç† ====================\n  \n  /**\n   * ç²å–æ‰€æœ‰ç¶å®šè¨­å‚™\n   */\n  async getDevices(): Promise<any[]> {\n    const token = this._accessToken();\n    if (!token) return [];\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/devices`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      const result = await response.json();\n      return result.success ? (result.data?.devices || result.devices || []) : [];\n    } catch (e) {\n      console.error('Failed to get devices:', e);\n      return [];\n    }\n  }\n  \n  /**\n   * ç¶å®šæ–°è¨­å‚™\n   */\n  async bindDevice(deviceCode: string, deviceName: string): Promise<{ success: boolean; message: string }> {\n    const token = this._accessToken();\n    if (!token) {\n      return { success: false, message: 'æœªç™»å…¥' };\n    }\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/devices`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ device_code: deviceCode, device_name: deviceName })\n      });\n      \n      const result = await response.json();\n      return { success: result.success, message: result.message || (result.success ? 'ç¶å®šæˆåŠŸ' : 'ç¶å®šå¤±æ•—') };\n    } catch (e: any) {\n      return { success: false, message: e.message || 'ç¶å®šå¤±æ•—' };\n    }\n  }\n  \n  /**\n   * è§£ç¶è¨­å‚™\n   */\n  async unbindDevice(deviceId: string | number): Promise<{ success: boolean; message: string }> {\n    const token = this._accessToken();\n    if (!token) {\n      return { success: false, message: 'æœªç™»å…¥' };\n    }\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/devices/${deviceId}`, {\n        method: 'DELETE',\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      const result = await response.json();\n      return { success: result.success, message: result.message || (result.success ? 'è§£ç¶æˆåŠŸ' : 'è§£ç¶å¤±æ•—') };\n    } catch (e: any) {\n      return { success: false, message: e.message || 'è§£ç¶å¤±æ•—' };\n    }\n  }\n  \n  // ==================== ğŸ†• æœƒå“¡ç®¡ç† ====================\n  \n  /**\n   * ç²å–ä½¿ç”¨çµ±è¨ˆ\n   */\n  async getUsageStats(): Promise<any> {\n    const token = this._accessToken();\n    if (!token) return null;\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/usage-stats`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      const result = await response.json();\n      return result.success ? result.data : null;\n    } catch (e) {\n      console.error('Failed to get usage stats:', e);\n      return null;\n    }\n  }\n  \n  /**\n   * æ¿€æ´»å¡å¯†ï¼ˆçºŒè²»/å‡ç´šæœƒå“¡ï¼‰\n   */\n  async activateLicense(licenseKey: string): Promise<{ success: boolean; message: string; data?: any }> {\n    const token = this._accessToken();\n    if (!token) {\n      return { success: false, message: 'æœªç™»å…¥' };\n    }\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/license/activate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ license_key: licenseKey })\n      });\n      \n      const result = await response.json();\n      \n      if (result.success) {\n        // æ›´æ–°ç”¨æˆ¶ä¿¡æ¯\n        await this.fetchCurrentUser();\n        // å»£æ’­ç”¨æˆ¶æ›´æ–°äº‹ä»¶\n        this.authEvents.emitUserUpdate(this._user());\n      }\n      \n      return { \n        success: result.success, \n        message: result.message || (result.success ? 'æ¿€æ´»æˆåŠŸ' : 'æ¿€æ´»å¤±æ•—'),\n        data: result.data \n      };\n    } catch (e: any) {\n      return { success: false, message: e.message || 'æ¿€æ´»å¤±æ•—' };\n    }\n  }\n  \n  /**\n   * ç²å–é‚€è«‹çå‹µä¿¡æ¯\n   */\n  async getInviteRewards(): Promise<{ inviteCode: string; invitedCount: number; rewardDays: number }> {\n    const token = this._accessToken();\n    const user = this._user();\n    \n    const defaultResult = {\n      inviteCode: user?.invite_code || user?.inviteCode || '',\n      invitedCount: 0,\n      rewardDays: 0\n    };\n    \n    if (!token) return defaultResult;\n    \n    try {\n      const response = await fetch(`${this.getApiBaseUrl()}/api/v1/auth/invite-rewards`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      \n      const result = await response.json();\n      return result.success ? {\n        inviteCode: result.data?.invite_code || defaultResult.inviteCode,\n        invitedCount: result.data?.invited_count || 0,\n        rewardDays: result.data?.reward_days || 0\n      } : defaultResult;\n    } catch (e) {\n      return defaultResult;\n    }\n  }\n  \n  // ==================== ç§æœ‰æ–¹æ³• ====================\n  \n  private setAuthState(data: any): void {\n    if (data.user) {\n      this._user.set(data.user);\n      // ğŸ”§ åŒæ­¥ä¿å­˜åˆ° localStorageï¼ˆé¿å… effect ç•°æ­¥å°è‡´é é¢åˆ·æ–°å‰æœªä¿å­˜ï¼‰\n      localStorage.setItem(TOKEN_KEYS.USER, JSON.stringify(data.user));\n    }\n    if (data.access_token) {\n      this._accessToken.set(data.access_token);\n      // ğŸ”§ åŒæ­¥ä¿å­˜åˆ° localStorage\n      localStorage.setItem(TOKEN_KEYS.ACCESS_TOKEN, data.access_token);\n    }\n    if (data.refresh_token) {\n      this._refreshToken.set(data.refresh_token);\n      // ğŸ”§ åŒæ­¥ä¿å­˜åˆ° localStorage\n      localStorage.setItem(TOKEN_KEYS.REFRESH_TOKEN, data.refresh_token);\n    }\n  }\n  \n  /**\n   * è¨­ç½®æœƒè©±ï¼ˆå…¬é–‹æ–¹æ³•ï¼‰\n   * ğŸ†• ç”¨æ–¼ç™»å…¥æˆåŠŸå¾Œç›´æ¥è¨­ç½®èªè­‰ç‹€æ…‹\n   */\n  setSession(data: { access_token?: string; refresh_token?: string; user?: any; session_id?: string }): void {\n    console.log('[AuthService] setSession called:', {\n      hasAccessToken: !!data.access_token,\n      hasRefreshToken: !!data.refresh_token,\n      hasUser: !!data.user\n    });\n    \n    // å…ˆç›´æ¥ä¿å­˜åˆ° localStorageï¼ˆç¢ºä¿æŒä¹…åŒ–ï¼‰\n    if (data.access_token) {\n      localStorage.setItem(TOKEN_KEYS.ACCESS_TOKEN, data.access_token);\n      this._accessToken.set(data.access_token);\n    }\n    if (data.refresh_token) {\n      localStorage.setItem(TOKEN_KEYS.REFRESH_TOKEN, data.refresh_token);\n      this._refreshToken.set(data.refresh_token);\n    }\n    if (data.user) {\n      localStorage.setItem(TOKEN_KEYS.USER, JSON.stringify(data.user));\n      this._user.set(data.user);\n    }\n    if (data.session_id) {\n      localStorage.setItem(TOKEN_KEYS.SESSION_ID, data.session_id);\n    }\n    \n    // ğŸ†• å»£æ’­ç™»å…¥äº‹ä»¶\n    this.authEvents.emitLogin(data);\n    \n    console.log('[AuthService] setSession complete, isAuthenticated:', this.isAuthenticated());\n  }\n  \n  /**\n   * æ¸…é™¤æœƒè©±ï¼ˆå…¬é–‹æ–¹æ³•ï¼‰\n   * ç”¨æ–¼èªè­‰å®ˆè¡›ç™¼ç¾ç„¡æ•ˆç‹€æ…‹æ™‚æ¸…ç†\n   * ğŸ†• åŒæ™‚å»£æ’­äº‹ä»¶é€šçŸ¥å…¶ä»–æœå‹™\n   */\n  clearSession(): void {\n    this.authEvents.emitLogout();\n    this.clearAuthStateInternal();\n  }\n  \n  /**\n   * å…§éƒ¨æ¸…é™¤ç‹€æ…‹ï¼ˆä¸ç™¼é€äº‹ä»¶ï¼Œé¿å…å¾ªç’°ï¼‰\n   */\n  private clearAuthStateInternal(): void {\n    this._user.set(null);\n    this._accessToken.set(null);\n    this._refreshToken.set(null);\n    \n    if (this.refreshTimer) {\n      clearTimeout(this.refreshTimer);\n      this.refreshTimer = null;\n    }\n    \n    // ğŸ†• ä½¿ç”¨é›†ä¸­å¼æ¸…é™¤æ–¹æ³•\n    this.authEvents.clearAllAuthStorage();\n  }\n  \n  /**\n   * @deprecated ä½¿ç”¨ clearAuthStateInternal ä»£æ›¿\n   */\n  private clearAuthState(): void {\n    this.clearAuthStateInternal();\n  }\n  \n  private restoreSession(): void {\n    try {\n      const accessToken = localStorage.getItem(TOKEN_KEYS.ACCESS_TOKEN);\n      const refreshToken = localStorage.getItem(TOKEN_KEYS.REFRESH_TOKEN);\n      const userJson = localStorage.getItem(TOKEN_KEYS.USER);\n      \n      console.log('[Auth] restoreSession - accessToken:', !!accessToken, 'refreshToken:', !!refreshToken, 'user:', !!userJson);\n      \n      // ğŸ†• P0: é©—è­‰ Token æ ¼å¼æœ‰æ•ˆæ€§\n      if (accessToken && !this.isValidTokenFormat(accessToken)) {\n        console.warn('[Auth] Invalid token format, clearing session');\n        this.clearAuthState();\n        return;\n      }\n      \n      if (accessToken) {\n        console.log('[Auth] Setting accessToken signal');\n        this._accessToken.set(accessToken);\n      }\n      if (refreshToken) {\n        this._refreshToken.set(refreshToken);\n      }\n      if (userJson) {\n        try {\n          this._user.set(JSON.parse(userJson));\n          console.log('[Auth] User restored from localStorage');\n        } catch {\n          console.warn('[Auth] Invalid user JSON, clearing');\n          this.clearAuthState();\n          return;\n        }\n      }\n      \n      // ğŸ”§ ä¿®å¾©ï¼šToken æœ‰æ•ˆæ€§æœƒåœ¨å¯¦éš› API è«‹æ±‚æ™‚ç”±å¾Œç«¯é©—è­‰\n      console.log('[Auth] Session restored successfully');\n      \n      // ğŸ”§ å„ªåŒ–ï¼šå¦‚æœæœ‰ Token ä½†æ²’æœ‰ç”¨æˆ¶ä¿¡æ¯ï¼Œç«‹å³ç²å–ï¼ˆä¸ç­‰å¾…ï¼‰\n      if (accessToken && !userJson) {\n        console.log('[Auth] Token exists but no user info, fetching immediately...');\n        // ä½¿ç”¨ queueMicrotask ç¢ºä¿åœ¨æ§‹é€ å‡½æ•¸å®Œæˆå¾ŒåŸ·è¡Œ\n        queueMicrotask(() => {\n          if (this._accessToken()) {\n            this.fetchCurrentUser().then(user => {\n              if (user) {\n                console.log('[Auth] User info fetched successfully:', user.username);\n              } else {\n                console.warn('[Auth] Failed to fetch user info');\n              }\n            }).catch(e => {\n              console.warn('[Auth] Error fetching user info:', e);\n            });\n          }\n        });\n      }\n    } catch (e) {\n      console.error('Restore session error:', e);\n      this.clearAuthState();\n    }\n  }\n  \n  /**\n   * é©—è­‰ Token æ ¼å¼æ˜¯å¦æœ‰æ•ˆï¼ˆJWT æ ¼å¼æª¢æŸ¥ï¼‰\n   */\n  private isValidTokenFormat(token: string): boolean {\n    if (!token || token.length < 20) return false;\n    \n    // JWT æ‡‰è©²æœ‰ 3 å€‹éƒ¨åˆ†ç”¨ . åˆ†éš”\n    const parts = token.split('.');\n    if (parts.length !== 3) return false;\n    \n    try {\n      // å˜—è©¦è§£æ payloadï¼ˆè™•ç† URL-safe Base64ï¼‰\n      const payload = JSON.parse(this.base64UrlDecode(parts[1]));\n      \n      // æª¢æŸ¥æ˜¯å¦éæœŸ\n      if (payload.exp && Date.now() >= payload.exp * 1000) {\n        console.warn('[Auth] Token expired');\n        return false;\n      }\n      \n      return true;\n    } catch {\n      return false;\n    }\n  }\n  \n  /**\n   * è§£ç¢¼ URL-safe Base64ï¼ˆè™•ç†å¾Œç«¯ JWT ç·¨ç¢¼ï¼‰\n   */\n  private base64UrlDecode(str: string): string {\n    // å°‡ URL-safe å­—ç¬¦æ›¿æ›å›æ¨™æº– Base64\n    let base64 = str.replace(/-/g, '+').replace(/_/g, '/');\n    // è£œé½Š padding\n    while (base64.length % 4) {\n      base64 += '=';\n    }\n    return atob(base64);\n  }\n  \n  private scheduleTokenRefresh(): void {\n    if (this.refreshTimer) {\n      clearTimeout(this.refreshTimer);\n    }\n    \n    // ğŸ†• æ ¹æ“š\"è¨˜ä½æˆ‘\"ç‹€æ…‹èª¿æ•´åˆ·æ–°é–“éš”\n    const rememberMe = localStorage.getItem('tgm_remember_me') === 'true';\n    // æ™®é€šï¼š55 åˆ†é˜åˆ·æ–°ï¼Œè¨˜ä½æˆ‘ï¼š23 å°æ™‚åˆ·æ–°ï¼ˆå‡è¨­å¾Œç«¯ Token æœ‰æ•ˆæœŸ 1 å°æ™‚/24 å°æ™‚ï¼‰\n    const refreshIn = rememberMe ? 23 * 60 * 60 * 1000 : 55 * 60 * 1000;\n    \n    console.log(`[AuthService] Scheduling token refresh in ${refreshIn / 60000} minutes (rememberMe: ${rememberMe})`);\n    \n    this.refreshTimer = setTimeout(() => {\n      this.refreshAccessToken();\n    }, refreshIn);\n  }\n  \n  private getApiBaseUrl(): string {\n    // é–‹ç™¼ç’°å¢ƒ\n    if (window.location.hostname === 'localhost' && window.location.port === '4200') {\n      return 'http://localhost:8000';\n    }\n    // ç”Ÿç”¢ç’°å¢ƒ\n    return '';\n  }\n  \n  private getDeviceName(): string {\n    const ua = navigator.userAgent;\n    if (ua.includes('Windows')) return 'Windows Browser';\n    if (ua.includes('Mac')) return 'Mac Browser';\n    if (ua.includes('Linux')) return 'Linux Browser';\n    if (ua.includes('iPhone') || ua.includes('iPad')) return 'iOS Browser';\n    if (ua.includes('Android')) return 'Android Browser';\n    return 'Web Browser';\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
