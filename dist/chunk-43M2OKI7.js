import{a as D,b as k}from"./chunk-7U27PO57.js";import{M as g,R as h,Vb as l,a as u,b as m,ga as p,ia as L}from"./chunk-YLSLTE5F.js";var V={success:"\u2705",error:"\u274C",warning:"\u26A0\uFE0F",info:"\u2139\uFE0F",progress:"\u23F3"},N=class o{constructor(){this.toasts=p([]);this.toastIdCounter=0}getToasts(){return this.toasts}success(e,t=3e3){return this.show("success",e,t)}error(e,t=5e3){return this.show("error",e,t)}warning(e,t=4e3){return this.show("warning",e,t)}warningWithAction(e,t,i,s=0){return this.withActions("warning",e,[{label:t,handler:i,variant:"primary"},{label:"\u7A0D\u5F8C",handler:()=>{},variant:"secondary"}],s)}info(e,t=3e3){return this.show("info",e,t)}successWithNextStep(e,t,i){let s=`toast-${++this.toastIdCounter}`,a={id:s,type:"success",message:e,icon:"\u{1F389}",duration:5e3,timestamp:new Date,nextStep:{label:t,action:i},dismissible:!0};return this.toasts.update(n=>[...n,a]),setTimeout(()=>this.dismiss(s),5e3),s}withActions(e,t,i,s=0){let a=`toast-${++this.toastIdCounter}`,n={id:a,type:e,message:t,icon:V[e],duration:s>0?s:void 0,timestamp:new Date,actions:i,dismissible:!0};return this.toasts.update(d=>[...d,n]),s>0&&setTimeout(()=>this.dismiss(a),s),a}showProgress(e,t=0){let i=`toast-${++this.toastIdCounter}`,s={id:i,type:"progress",message:e,icon:"\u23F3",progress:t,timestamp:new Date,dismissible:!1};return this.toasts.update(a=>[...a,s]),i}updateProgress(e,t,i){this.toasts.update(s=>s.map(a=>a.id===e?m(u({},a),{progress:t,message:i||a.message,icon:t>=100?"\u2705":"\u23F3"}):a)),t>=100&&setTimeout(()=>this.dismiss(e),2e3)}configReminder(e,t){return this.withActions("warning",`\u914D\u7F6E\u672A\u5B8C\u6210\uFF1A${e}`,[{label:"\u7ACB\u5373\u8A2D\u7F6E",handler:t,variant:"primary"},{label:"\u7A0D\u5F8C",handler:()=>{},variant:"secondary"}],0)}operationResult(e,t,i){return e?this.success(t):this.error(i)}accountConnected(e){return this.successWithNextStep(`\u{1F517} ${e} \u5DF2\u9023\u63A5`,"\u8A2D\u70BA\u76E3\u807D\u5E33\u865F",()=>{})}accountDisconnected(e){return this.warning(`\u{1F4F4} ${e} \u5DF2\u65B7\u958B\u9023\u63A5`)}accountRoleChanged(e,t){let i=t==="Listener"?"\u{1F441}\uFE0F":t==="Sender"?"\u{1F4E4}":"\u{1F464}";return this.success(`${i} ${e} \u5DF2\u8A2D\u70BA${t==="Listener"?"\u76E3\u807D":t==="Sender"?"\u767C\u9001":"\u666E\u901A"}\u5E33\u865F`)}groupAdded(e){return this.successWithNextStep(`\u{1F4AC} \u5DF2\u6DFB\u52A0\u7FA4\u7D44\u300C${e}\u300D`,"\u7D81\u5B9A\u95DC\u9375\u8A5E\u96C6",()=>{})}groupRemoved(e){return this.success(`\u{1F5D1}\uFE0F \u5DF2\u79FB\u9664\u300C${e}\u300D`)}groupKeywordBound(e,t){return this.success(`\u{1F517} \u5DF2\u5C07\u300C${t}\u300D\u7D81\u5B9A\u5230\u300C${e}\u300D`)}keywordSetCreated(e){return this.successWithNextStep(`\u{1F511} \u8A5E\u96C6\u300C${e}\u300D\u5DF2\u5275\u5EFA`,"\u7D81\u5B9A\u5230\u7FA4\u7D44",()=>{})}keywordSetDeleted(e){return this.success(`\u{1F5D1}\uFE0F \u8A5E\u96C6\u300C${e}\u300D\u5DF2\u522A\u9664`)}monitoringStarted(){return this.success("\u{1F680} \u76E3\u63A7\u5DF2\u555F\u52D5\uFF0C\u7CFB\u7D71\u6B63\u5728\u5DE5\u4F5C\u4E2D...")}monitoringStopped(){return this.info("\u23F8\uFE0F \u76E3\u63A7\u5DF2\u66AB\u505C")}keywordMatched(e,t){return this.info(`\u{1F3AF} \u5728\u300C${t}\u300D\u5339\u914D\u5230\u95DC\u9375\u8A5E\u300C${e}\u300D`)}extractMembersStarted(e){return this.showProgress(`\u6B63\u5728\u63D0\u53D6\u300C${e}\u300D\u7684\u6210\u54E1...`,0)}extractMembersCompleted(e,t){return this.success(`\u2705 \u5DF2\u5F9E\u300C${t}\u300D\u63D0\u53D6 ${e} \u500B\u6210\u54E1`)}show(e,t,i=3e3){let s=`toast-${++this.toastIdCounter}`,a={id:s,type:e,message:t,icon:V[e],duration:i>0?i:void 0,timestamp:new Date,dismissible:!0};return this.toasts.update(n=>[...n,a]),i>0&&setTimeout(()=>{this.dismiss(s)},i),s}dismiss(e){this.toasts.update(t=>t.filter(i=>i.id!==e))}dismissAll(){this.toasts.set([])}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})}};var r={bronze:{name:"\u9752\u9285\u6230\u58EB",icon:"\u2694\uFE0F",rank:1,monthlyPrice:0,yearlyPrice:0,quotas:{maxAccounts:2,dailyMessages:20,dailyAiCalls:10,maxGroups:3,maxKeywordSets:1,dataRetentionDays:7,platformApiQuota:0,platformApiMaxAccounts:0},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!1,hotLeads:!1,smartMode:!1,aiInsights:!1,dataExport:!1,batchOperations:!1,dataInsightsBasic:!1,strategyPlanning:!1,autoExecution:!1,dataInsightsAdvanced:!1,abTesting:!1,multiRole:!1,aiSalesFunnel:!1,advancedAnalytics:!1,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!1}},silver:{name:"\u767D\u9280\u7CBE\u82F1",icon:"\u{1F948}",rank:2,monthlyPrice:4.99,yearlyPrice:49.9,quotas:{maxAccounts:5,dailyMessages:100,dailyAiCalls:50,maxGroups:10,maxKeywordSets:5,dataRetentionDays:30,platformApiQuota:1,platformApiMaxAccounts:3},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!1,aiInsights:!1,dataExport:!1,batchOperations:!1,dataInsightsBasic:!1,strategyPlanning:!1,autoExecution:!1,dataInsightsAdvanced:!1,abTesting:!1,multiRole:!1,aiSalesFunnel:!1,advancedAnalytics:!1,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!1}},gold:{name:"\u9EC3\u91D1\u5927\u5E2B",icon:"\u{1F947}",rank:3,monthlyPrice:19.9,yearlyPrice:199,quotas:{maxAccounts:15,dailyMessages:500,dailyAiCalls:300,maxGroups:30,maxKeywordSets:20,dataRetentionDays:60,platformApiQuota:3,platformApiMaxAccounts:9},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!1,autoExecution:!1,dataInsightsAdvanced:!1,abTesting:!1,multiRole:!1,aiSalesFunnel:!1,advancedAnalytics:!1,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!1}},diamond:{name:"\u947D\u77F3\u738B\u724C",icon:"\u{1F48E}",rank:4,monthlyPrice:59.9,yearlyPrice:599,quotas:{maxAccounts:50,dailyMessages:2e3,dailyAiCalls:-1,maxGroups:100,maxKeywordSets:50,dataRetentionDays:90,platformApiQuota:10,platformApiMaxAccounts:30},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!0,autoExecution:!0,dataInsightsAdvanced:!0,abTesting:!0,multiRole:!0,aiSalesFunnel:!0,advancedAnalytics:!0,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!0}},star:{name:"\u661F\u8000\u50B3\u8AAA",icon:"\u{1F31F}",rank:5,monthlyPrice:199,yearlyPrice:1999,quotas:{maxAccounts:100,dailyMessages:1e4,dailyAiCalls:-1,maxGroups:300,maxKeywordSets:100,dataRetentionDays:180,platformApiQuota:30,platformApiMaxAccounts:90},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!0,autoExecution:!0,dataInsightsAdvanced:!0,abTesting:!0,multiRole:!0,aiSalesFunnel:!0,advancedAnalytics:!0,smartAntiBlock:!0,apiAccess:!0,teamManagement:!0,customBranding:!1,prioritySupport:!0}},king:{name:"\u69AE\u8000\u738B\u8005",icon:"\u{1F451}",rank:6,monthlyPrice:599,yearlyPrice:5999,quotas:{maxAccounts:-1,dailyMessages:-1,dailyAiCalls:-1,maxGroups:-1,maxKeywordSets:-1,dataRetentionDays:365,platformApiQuota:-1,platformApiMaxAccounts:-1},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!0,autoExecution:!0,dataInsightsAdvanced:!0,abTesting:!0,multiRole:!0,aiSalesFunnel:!0,advancedAnalytics:!0,smartAntiBlock:!0,apiAccess:!0,teamManagement:!0,customBranding:!0,prioritySupport:!0}}},C=class o{constructor(){this.SKIP_LOGIN=!!window.electronAPI||!!window.electron;this.DEFAULT_LEVEL="king";this._membership=p(null);this._isLoading=p(!0);this.membership=l(()=>this._membership());this.isLoading=l(()=>this._isLoading());this.level=l(()=>{let e=this.SKIP_LOGIN?this.DEFAULT_LEVEL:"bronze",t=this._membership()?.level||e;return t in r?t:{free:"bronze",vip:"silver",svip:"diamond",mvp:"king"}[t]||e});this.levelName=l(()=>r[this.level()]?.name||(this.SKIP_LOGIN?"\u69AE\u8000\u738B\u8005":"\u9752\u9285\u6230\u58EB"));this.levelIcon=l(()=>r[this.level()]?.icon||(this.SKIP_LOGIN?"\u{1F451}":"\u2694\uFE0F"));this.levelRank=l(()=>r[this.level()]?.rank||(this.SKIP_LOGIN?6:1));this.isActive=l(()=>{let e=this._membership();return e?e.level==="bronze"||!e.expiresAt?!0:new Date<e.expiresAt:!1});this.daysRemaining=l(()=>{let e=this._membership();if(!e||!e.expiresAt||e.level==="bronze")return-1;let t=e.expiresAt.getTime()-Date.now();return Math.max(0,Math.ceil(t/(1e3*60*60*24)))});this.quotas=l(()=>{let e=this.isActive()?this.level():"bronze";return r[e].quotas});this.features=l(()=>{let e=this.isActive()?this.level():"bronze";return r[e].features});this.usage=l(()=>this._membership()?.usage||this.getDefaultUsage());this.authEventsService=h(D);this.authService=h(k,{optional:!0});this.eventSubscription=null;this.loadMembership(),this.subscribeToAuthEvents(),this.SKIP_LOGIN||setTimeout(()=>this.syncFromAuthIfReady(),0)}static{this.STORAGE_KEY="tg-matrix-membership"}static{this.USAGE_KEY="tg-matrix-usage"}static{this.TRIAL_DAYS=7}syncFromAuthIfReady(){try{let t=this.authService?.user?.();if(t){let i=this.tierToLevel(t.membershipLevel||t.subscription_tier||"free"),s=t.membershipExpires||t.subscription_expires,a=!!t.isLifetime;this.syncFromAuthService(i,s,a)}}catch{}}subscribeToAuthEvents(){this.SKIP_LOGIN||(this.eventSubscription=this.authEventsService.authEvents$.subscribe(e=>{if(e.type==="login"||e.type==="user_update"){let t=e.payload?.user;if(t){let i=t.membershipLevel||t.subscription_tier||"free",s=this.tierToLevel(i),a=t.membershipExpires||t.membership_expires,n=!!t.isLifetime;console.log(`[MembershipService] \u{1F504} \u6536\u5230 ${e.type} \u4E8B\u4EF6\uFF0C\u540C\u6B65\u6703\u54E1: ${s}${n?" (\u7D42\u8EAB)":""}`),this.syncFromAuthService(s,a,n)}}else e.type==="logout"&&(console.log("[MembershipService] \u6536\u5230 logout \u4E8B\u4EF6\uFF0C\u91CD\u7F6E\u6703\u54E1\u72C0\u614B"),this.initializeFreeMembership())}))}tierToLevel(e){return{free:"bronze",basic:"silver",pro:"gold",enterprise:"diamond",bronze:"bronze",silver:"silver",gold:"gold",diamond:"diamond",star:"star",king:"king"}[e]||"bronze"}ngOnDestroy(){this.eventSubscription?.unsubscribe()}syncFromAuthService(e,t,i){if(this.SKIP_LOGIN){console.log("[MembershipService] Electron \u6A21\u5F0F\uFF0C\u8DF3\u904E AuthService \u540C\u6B65");return}let s=this._membership(),a=s?.level,n=r[e],d={level:e,levelName:n?.name||"\u672A\u77E5",levelIcon:n?.icon||"?",expiresAt:i?void 0:t?new Date(t):e!=="bronze"?new Date(Date.now()+365*100*24*60*60*1e3):void 0,activatedAt:s?.activatedAt||new Date,machineId:this.getMachineId(),usage:s?.usage||this.getDefaultUsage(),inviteCode:s?.inviteCode||this.generateInviteCode(),inviteCount:s?.inviteCount||0,inviteRewards:s?.inviteRewards||0};console.log(a!==e?`[MembershipService] \u{1F504} \u6703\u54E1\u7B49\u7D1A\u8B8A\u66F4: ${a} \u2192 ${e}`:`[MembershipService] \u2713 \u6703\u54E1\u540C\u6B65\u78BA\u8A8D: ${e} (expiresAt: ${d.expiresAt||"\u6C38\u4E45"})`),this._membership.set(d),this.saveMembership(d)}isSaaSMode(){return!this.SKIP_LOGIN}loadMembership(){try{let e=localStorage.getItem(o.STORAGE_KEY);if(e){let t=JSON.parse(e);t.expiresAt=t.expiresAt?new Date(t.expiresAt):void 0,t.activatedAt=t.activatedAt?new Date(t.activatedAt):void 0,this.SKIP_LOGIN&&t.level!==this.DEFAULT_LEVEL&&(console.log(`[MembershipService] \u514D\u767B\u9304\u6A21\u5F0F\uFF1A\u5F9E ${t.level} \u5347\u7D1A\u5230 ${this.DEFAULT_LEVEL}`),t.level=this.DEFAULT_LEVEL,t.levelName=r[this.DEFAULT_LEVEL].name,t.levelIcon=r[this.DEFAULT_LEVEL].icon,t.expiresAt=new Date(Date.now()+365*100*24*60*60*1e3),this.saveMembership(t)),this.checkAndResetDailyUsage(t),this._membership.set(t)}else this.initializeFreeMembership()}catch(e){console.error("Failed to load membership:",e),this.initializeFreeMembership()}finally{this._isLoading.set(!1)}}initializeFreeMembership(){let e=this.SKIP_LOGIN?this.DEFAULT_LEVEL:"bronze",t=r[e],i={level:e,levelName:t.name,levelIcon:t.icon,activatedAt:new Date,expiresAt:this.SKIP_LOGIN?new Date(Date.now()+365*100*24*60*60*1e3):void 0,machineId:this.getMachineId(),usage:this.getDefaultUsage(),inviteCode:this.generateInviteCode(),inviteCount:0,inviteRewards:0};console.log(`[MembershipService] \u521D\u59CB\u5316\u6703\u54E1: ${t.icon} ${t.name}`),this.saveMembership(i)}async activateMembership(e,t){let i=/^TGAI-([BGDSK][123YL]|EXT)-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/i,s=/^TGM-([BGDSK][123Y])-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/i,a=e.toUpperCase().match(i);if(a||(a=e.toUpperCase().match(s)),!a)return{success:!1,message:"\u2694\uFE0F \u5361\u5BC6\u683C\u5F0F\u4E0D\u6B63\u78BA\uFF0C\u8ACB\u6AA2\u67E5\u5F8C\u91CD\u8A66"};let n=a[1],d=n[0],v=n[1]||"2",y={B:"silver",G:"gold",D:"diamond",S:"star",K:"king",E:"gold"},w={1:7,2:30,3:90,Y:365,L:36500,X:30},S=y[d]||"silver",_=w[v]||30,A=this._membership(),b=new Date;A?.expiresAt&&A.expiresAt>new Date&&(b=new Date(A.expiresAt)),b.setDate(b.getDate()+_);let M=r[S],P=m(u({},A),{level:S,levelName:M.name,levelIcon:M.icon,expiresAt:b,activatedAt:new Date,licenseKey:e.toUpperCase(),email:t,machineId:this.getMachineId()});return this.saveMembership(P),{success:!0,message:`\u{1F389} ${M.icon} ${M.name} \u6FC0\u6D3B\u6210\u529F\uFF01\u6709\u6548\u671F\u81F3 ${b.toLocaleDateString()}`}}async applyInviteCode(e){if(!e||e.length!==8)return{success:!1,message:"\u9080\u8ACB\u78BC\u683C\u5F0F\u4E0D\u6B63\u78BA"};let t=this._membership();if(t?.invitedBy)return{success:!1,message:"\u60A8\u5DF2\u7D93\u4F7F\u7528\u904E\u9080\u8ACB\u78BC"};let i=new Date;i.setDate(i.getDate()+7);let s=m(u({},t),{level:"silver",levelName:r.silver.name,levelIcon:r.silver.icon,expiresAt:i,invitedBy:e});return this.saveMembership(s),{success:!0,message:"\u{1F381} \u9080\u8ACB\u78BC\u4F7F\u7528\u6210\u529F\uFF01\u7372\u5F97 7 \u5929\u767D\u9280\u7CBE\u82F1\u9AD4\u9A57"}}addInviteReward(e=3){let t=this._membership();if(!t)return;let i=t.expiresAt||new Date;i<new Date&&(i=new Date),i.setDate(i.getDate()+e);let s=m(u({},t),{expiresAt:i,inviteCount:(t.inviteCount||0)+1,inviteRewards:(t.inviteRewards||0)+e});s.level==="bronze"&&(s.level="silver",s.levelName=r.silver.name,s.levelIcon=r.silver.icon),this.saveMembership(s)}canAddAccount(e){let t=this.quotas().maxAccounts;return t===-1?{allowed:!0}:e>=t?{allowed:!1,message:`${this.levelIcon()} ${this.levelName()} \u6700\u591A\u652F\u6301 ${t} \u500B\u8CEC\u6236\uFF0C\u5347\u7D1A\u89E3\u9396\u66F4\u591A`}:{allowed:!0}}canSendMessage(){let e=this.quotas().dailyMessages;if(e===-1)return{allowed:!0,remaining:-1};let t=this.usage(),i=e-t.todayMessages;return i<=0?{allowed:!1,remaining:0,message:`\u4ECA\u65E5\u6D88\u606F\u914D\u984D\u5DF2\u7528\u5B8C (${e}\u689D)\uFF0C\u660E\u5929\u91CD\u7F6E\u6216\u5347\u7D1A\u6703\u54E1`}:{allowed:!0,remaining:i}}canUseAi(){let e=this.quotas().dailyAiCalls;if(e===-1)return{allowed:!0,remaining:-1};let t=this.usage(),i=e-t.todayAiCalls;return i<=0?{allowed:!1,remaining:0,message:`\u4ECA\u65E5AI\u914D\u984D\u5DF2\u7528\u5B8C (${e}\u6B21)\uFF0C\u660E\u5929\u91CD\u7F6E\u6216\u5347\u7D1A\u6703\u54E1`}:{allowed:!0,remaining:i}}hasFeature(e){return this.isActive()?this.features()[e]:r.bronze.features[e]}recordMessageSent(e=1){let t=this._membership();if(!t)return;let i=u({},t.usage);i.todayMessages+=e,i.totalMessages+=e,this.saveMembership(m(u({},t),{usage:i}))}recordAiCall(e=1){let t=this._membership();if(!t)return;let i=u({},t.usage);i.todayAiCalls+=e,i.totalAiCalls+=e,this.saveMembership(m(u({},t),{usage:i}))}recordLeadCaptured(e=1){let t=this._membership();if(!t)return;let i=u({},t.usage);i.totalLeads+=e,this.saveMembership(m(u({},t),{usage:i}))}getPricingPlans(){return[{level:"bronze",name:"\u2694\uFE0F \u9752\u9285\u6230\u58EB",icon:"\u2694\uFE0F",monthlyPrice:0,yearlyPrice:0,quotas:r.bronze.quotas,features:["2 \u500B\u8CEC\u6236","\u6BCF\u65E5 20 \u689D\u6D88\u606F","\u6BCF\u65E5 10 \u6B21 AI","3 \u500B\u7FA4\u7D44 / 1 \u500B\u95DC\u9375\u8A5E\u96C6","\u57FA\u790E\u76E3\u63A7\u529F\u80FD"]},{level:"silver",name:"\u{1F948} \u767D\u9280\u7CBE\u82F1",icon:"\u{1F948}",monthlyPrice:4.99,yearlyPrice:49.9,quotas:r.silver.quotas,features:["5 \u500B\u8CEC\u6236","\u6BCF\u65E5 100 \u689D\u6D88\u606F","\u6BCF\u65E5 50 \u6B21 AI","10 \u500B\u7FA4\u7D44 / 5 \u500B\u95DC\u9375\u8A5E\u96C6","\u5EE3\u544A\u767C\u9001\u529F\u80FD","\u71B1\u9580\u5BA2\u6236\u5206\u6790"]},{level:"gold",name:"\u{1F947} \u9EC3\u91D1\u5927\u5E2B",icon:"\u{1F947}",monthlyPrice:19.9,yearlyPrice:199,quotas:r.gold.quotas,recommended:!0,features:["15 \u500B\u8CEC\u6236","\u6BCF\u65E5 500 \u689D\u6D88\u606F / 300 \u6B21 AI","30 \u500B\u7FA4\u7D44 / 20 \u500B\u95DC\u9375\u8A5E\u96C6","\u{1F195} \u667A\u80FD\u6A21\u5F0F\u5100\u8868\u76E4","\u{1F195} AI \u667A\u80FD\u6D1E\u5BDF","\u6578\u64DA\u5C0E\u51FA + \u6279\u91CF\u64CD\u4F5C"]},{level:"diamond",name:"\u{1F48E} \u947D\u77F3\u738B\u724C",icon:"\u{1F48E}",monthlyPrice:59.9,yearlyPrice:599,quotas:r.diamond.quotas,features:["50 \u500B\u8CEC\u6236","\u6BCF\u65E5 2000 \u689D\u6D88\u606F / \u7121\u9650 AI","100 \u500B\u7FA4\u7D44 / 50 \u500B\u95DC\u9375\u8A5E\u96C6","\u{1F195} AI \u7B56\u7565\u898F\u5283","\u{1F195} AI \u81EA\u52D5\u57F7\u884C","\u591A\u89D2\u8272\u5354\u4F5C + A/B\u6E2C\u8A66"]},{level:"star",name:"\u{1F31F} \u661F\u8000\u50B3\u8AAA",icon:"\u{1F31F}",monthlyPrice:199,yearlyPrice:1999,quotas:r.star.quotas,features:["100 \u500B\u8CEC\u6236","\u6BCF\u65E5 10000 \u689D\u6D88\u606F / \u7121\u9650 AI","300 \u500B\u7FA4\u7D44 / 100 \u500B\u95DC\u9375\u8A5E\u96C6","API \u63A5\u53E3","\u5718\u968A\u7BA1\u7406","\u667A\u80FD\u9632\u5C01","\u512A\u5148\u652F\u6301"]},{level:"king",name:"\u{1F451} \u69AE\u8000\u738B\u8005",icon:"\u{1F451}",monthlyPrice:599,yearlyPrice:5999,quotas:r.king.quotas,features:["\u7121\u9650\u8CEC\u6236 / \u6D88\u606F / AI","\u7121\u9650\u7FA4\u7D44 / \u95DC\u9375\u8A5E\u96C6 / \u898F\u5247","\u6240\u6709\u529F\u80FD\u5168\u90E8\u89E3\u9396","\u81EA\u5B9A\u7FA9\u54C1\u724C","1\u5C0D1 \u5C08\u5C6C\u9867\u554F","\u65B0\u529F\u80FD\u5167\u6E2C\u9AD4\u9A57"]}]}getUpgradeSuggestion(){let e=this.level(),i={bronze:"silver",silver:"gold",gold:"diamond",diamond:"star",star:"king",king:null}[e];if(!i)return null;let s=r[e],a=r[i],n=[],d=s.quotas.maxAccounts===-1?"\u7121\u9650":s.quotas.maxAccounts,v=a.quotas.maxAccounts===-1?"\u7121\u9650":a.quotas.maxAccounts;v!==d&&n.push(`\u8CEC\u6236\u6578\u91CF ${d} \u2192 ${v}`);let y=s.quotas.dailyMessages===-1?"\u7121\u9650":s.quotas.dailyMessages,w=a.quotas.dailyMessages===-1?"\u7121\u9650":a.quotas.dailyMessages;return w!==y&&n.push(`\u6BCF\u65E5\u6D88\u606F ${y} \u2192 ${w}`),a.quotas.dailyAiCalls===-1&&s.quotas.dailyAiCalls!==-1&&n.push(`AI \u8ABF\u7528 ${s.quotas.dailyAiCalls} \u2192 \u7121\u9650`),a.features.adBroadcast&&!s.features.adBroadcast&&n.push("\u26A1 \u89E3\u9396\u5EE3\u544A\u767C\u9001"),a.features.multiRole&&!s.features.multiRole&&n.push("\u{1F3AD} \u89E3\u9396\u591A\u89D2\u8272\u5354\u4F5C"),a.features.aiSalesFunnel&&!s.features.aiSalesFunnel&&n.push("\u{1F3AF} \u89E3\u9396 AI \u92B7\u552E\u6F0F\u6597"),a.features.smartAntiBlock&&!s.features.smartAntiBlock&&n.push("\u{1F6E1}\uFE0F \u89E3\u9396\u667A\u80FD\u9632\u5C01"),a.features.apiAccess&&!s.features.apiAccess&&n.push("\u{1F50C} \u89E3\u9396 API \u63A5\u53E3"),{nextLevel:i,benefits:n,price:a.monthlyPrice}}saveMembership(e){this._membership.set(e),localStorage.setItem(o.STORAGE_KEY,JSON.stringify(e))}getMachineId(){let e=localStorage.getItem("tg-matrix-machine-id");return e||(e="mid-"+this.generateId(),localStorage.setItem("tg-matrix-machine-id",e)),e}generateId(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}generateInviteCode(){return this.generateId().substring(0,8).toUpperCase()}getDefaultUsage(){return{todayMessages:0,todayAiCalls:0,todayDate:new Date().toDateString(),totalMessages:0,totalAiCalls:0,totalLeads:0}}checkAndResetDailyUsage(e){let t=new Date().toDateString();e.usage.todayDate!==t&&(e.usage.todayMessages=0,e.usage.todayAiCalls=0,e.usage.todayDate=t)}getStatusText(){let e=this._membership();if(!e)return"\u672A\u77E5";if(e.level==="bronze")return`${e.levelIcon} ${e.levelName}`;if(!this.isActive())return`${e.levelIcon} ${e.levelName} (\u5DF2\u904E\u671F)`;let t=this.daysRemaining();return t<=7?`${e.levelIcon} ${e.levelName} (${t}\u5929\u5F8C\u5230\u671F)`:`${e.levelIcon} ${e.levelName}`}getRankDisplay(){let e=this.level(),t=r[e],i={bronze:"#CD7F32",silver:"#C0C0C0",gold:"#FFD700",diamond:"#B9F2FF",star:"#9B59B6",king:"#FF6B6B"};return{name:t.name,icon:t.icon,rank:t.rank,color:i[e]}}getUsagePercentage(){let e=this.quotas(),t=this.usage();return{messages:e.dailyMessages===-1?0:Math.min(100,t.todayMessages/e.dailyMessages*100),ai:e.dailyAiCalls===-1?0:Math.min(100,t.todayAiCalls/e.dailyAiCalls*100)}}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})}};var c=[{id:"dashboard",label:"\u5100\u8868\u677F",icon:"\u{1F4CA}",description:"\u7CFB\u7D71\u7E3D\u89BD\u548C\u5FEB\u901F\u64CD\u4F5C",color:"from-cyan-500 to-blue-500",defaultView:"dashboard",views:[{id:"dashboard",label:"\u7E3D\u89BD",icon:"\u{1F4CA}",shortcut:"D"}]},{id:"accounts",label:"\u5E33\u865F\u7BA1\u7406",icon:"\u{1F464}",description:"\u7BA1\u7406 Telegram \u5E33\u865F\u548C API \u8A2D\u7F6E",color:"from-purple-500 to-pink-500",defaultView:"accounts",views:[{id:"accounts",label:"\u5E33\u865F\u5217\u8868",icon:"\u{1F464}",description:"\u67E5\u770B\u548C\u7BA1\u7406\u6240\u6709\u5E33\u865F",shortcut:"A"},{id:"add-account",label:"\u6DFB\u52A0\u5E33\u865F",icon:"\u2795",description:"\u6DFB\u52A0\u65B0\u7684 Telegram \u5E33\u865F"},{id:"api-credentials",label:"API \u6191\u8B49",icon:"\u{1F511}",description:"\u7BA1\u7406 API ID \u548C Hash"}]},{id:"marketing-hub",label:"\u71DF\u92B7\u4EFB\u52D9\u4E2D\u5FC3",icon:"\u{1F680}",description:"\u4E00\u9375\u555F\u52D5\u71DF\u92B7\u4EFB\u52D9\uFF0CAI \u81EA\u52D5\u57F7\u884C",color:"from-purple-500 to-pink-500",defaultView:"marketing-hub",views:[{id:"marketing-hub",label:"\u5FEB\u901F\u555F\u52D5",icon:"\u{1F680}",description:"\u9078\u64C7\u76EE\u6A19\uFF0C\u4E00\u9375\u555F\u52D5",shortcut:"M"},{id:"marketing-tasks",label:"\u4EFB\u52D9\u5217\u8868",icon:"\u{1F4CB}",description:"\u7BA1\u7406\u6240\u6709\u71DF\u92B7\u4EFB\u52D9"},{id:"marketing-monitor",label:"\u6548\u679C\u76E3\u63A7",icon:"\u{1F4C8}",description:"\u5BE6\u6642\u67E5\u770B\u8F49\u5316\u6548\u679C"}]},{id:"role-library",label:"\u89D2\u8272\u8CC7\u6E90\u5EAB",icon:"\u{1F3AD}",description:"\u7BA1\u7406\u89D2\u8272\u5B9A\u7FA9\u548C\u5287\u672C\u6A21\u677F",color:"from-amber-500 to-orange-500",defaultView:"role-store",views:[{id:"role-store",label:"\u89D2\u8272\u5EAB",icon:"\u{1F3AD}",description:"50+ \u9810\u8A2D\u89D2\u8272"},{id:"my-roles",label:"\u6211\u7684\u89D2\u8272",icon:"\u{1F464}",description:"\u81EA\u5B9A\u7FA9\u89D2\u8272"},{id:"scene-templates",label:"\u5834\u666F\u6A21\u677F",icon:"\u{1F3AC}",description:"\u9810\u8A2D\u5834\u666F\u914D\u7F6E"},{id:"script-editor",label:"\u5287\u672C\u7DE8\u6392",icon:"\u{1F4DD}",description:"\u7DE8\u8F2F\u5C0D\u8A71\u5287\u672C"}]},{id:"knowledge-hub",label:"\u77E5\u8B58\u5927\u8166",icon:"\u{1F9E0}",description:"\u77E5\u8B58\u5EAB\u7BA1\u7406\u548C AI \u5B78\u7FD2",color:"from-pink-500 to-rose-500",defaultView:"ai-brain",views:[{id:"ai-brain",label:"\u77E5\u8B58\u7E3D\u89BD",icon:"\u{1F9E0}",description:"\u77E5\u8B58\u5EAB\u7D71\u8A08\u548C\u5065\u5EB7\u5EA6",shortcut:"K"},{id:"knowledge-manage",label:"\u77E5\u8B58\u7BA1\u7406",icon:"\u{1F4DD}",description:"\u67E5\u770B\u548C\u7DE8\u8F2F\u77E5\u8B58"},{id:"knowledge-import",label:"\u5C0E\u5165\u77E5\u8B58",icon:"\u{1F4E5}",description:"\u5C0D\u8A71/\u6587\u6A94/\u7DB2\u9801\u5C0E\u5165"},{id:"knowledge-gaps",label:"\u77E5\u8B58\u7F3A\u53E3",icon:"\u2753",description:"\u5F85\u88DC\u5145\u7684\u554F\u984C"},{id:"knowledge-settings",label:"\u77E5\u8B58\u8A2D\u7F6E",icon:"\u2699\uFE0F",description:"RAG \u914D\u7F6E"}]},{id:"ai-engine",label:"\u667A\u80FD\u5F15\u64CE",icon:"\u{1F916}",description:"AI \u6A21\u578B\u548C\u4EBA\u683C\u914D\u7F6E",color:"from-indigo-500 to-violet-500",defaultView:"ai-models",views:[{id:"ai-models",label:"\u6A21\u578B\u914D\u7F6E",icon:"\u{1F916}",description:"\u9078\u64C7\u548C\u914D\u7F6E AI \u6A21\u578B",shortcut:"I"},{id:"ai-persona",label:"\u4EBA\u683C\u8A2D\u7F6E",icon:"\u{1F4AC}",description:"AI \u8AAA\u8A71\u98A8\u683C\u548C\u4EBA\u683C"},{id:"ai-usage",label:"\u4F7F\u7528\u7D71\u8A08",icon:"\u{1F4CA}",description:"AI \u8ABF\u7528\u7D71\u8A08"}]},{id:"automation",label:"\u89F8\u767C\u76E3\u63A7",icon:"\u{1F4E1}",description:"\u8A2D\u7F6E\u89F8\u767C\u898F\u5247\u548C\u76E3\u63A7",color:"from-emerald-500 to-teal-500",defaultView:"monitoring-groups",views:[{id:"monitoring-groups",label:"\u76E3\u63A7\u7FA4\u7D44",icon:"\u{1F465}",description:"\u7BA1\u7406\u76E3\u63A7\u7684\u7FA4\u7D44"},{id:"keyword-sets",label:"\u95DC\u9375\u8A5E\u96C6",icon:"\u{1F50D}",description:"\u8A2D\u7F6E\u89F8\u767C\u95DC\u9375\u8A5E"},{id:"trigger-rules",label:"\u89F8\u767C\u898F\u5247",icon:"\u{1F3AF}",description:"\u914D\u7F6E\u89F8\u767C\u689D\u4EF6\u548C\u52D5\u4F5C"},{id:"chat-templates",label:"\u804A\u5929\u6A21\u677F",icon:"\u{1F4AC}",description:"\u9810\u8A2D\u56DE\u8986\u6A21\u677F"},{id:"collected-users",label:"\u6536\u96C6\u7528\u6236",icon:"\u{1F4E5}",description:"\u81EA\u52D5\u6536\u96C6\u7684\u7528\u6236"}]},{id:"contacts",label:"\u5BA2\u6236\u7BA1\u7406",icon:"\u{1F4CB}",description:"\u7BA1\u7406\u6F5B\u5728\u5BA2\u6236\u548C\u7528\u6236\u6578\u64DA",color:"from-sky-500 to-cyan-500",defaultView:"leads",views:[{id:"leads",label:"\u7DDA\u7D22\u7BA1\u7406",icon:"\u{1F4CB}",description:"\u7BA1\u7406\u6240\u6709\u6F5B\u5728\u5BA2\u6236",shortcut:"L"},{id:"lead-nurturing",label:"\u7DDA\u7D22\u57F9\u80B2",icon:"\u{1F331}",description:"AI \u9A45\u52D5\u7684\u5BA2\u6236\u57F9\u80B2"},{id:"member-database",label:"\u6210\u54E1\u6578\u64DA\u5EAB",icon:"\u{1F5C4}\uFE0F",description:"\u7FA4\u7D44\u6210\u54E1\u7BA1\u7406"},{id:"user-tracking",label:"\u7528\u6236\u8FFD\u8E64",icon:"\u{1F4CD}",description:"\u8FFD\u8E64\u9AD8\u50F9\u503C\u7528\u6236"}]},{id:"analytics",label:"\u6578\u64DA\u5206\u6790",icon:"\u{1F4C8}",description:"\u67E5\u770B\u7D71\u8A08\u548C\u5831\u544A",color:"from-rose-500 to-red-500",defaultView:"analytics",views:[{id:"analytics",label:"\u6578\u64DA\u7E3D\u89BD",icon:"\u{1F4C8}",description:"\u95DC\u9375\u6307\u6A19\u6982\u89BD"},{id:"marketing-report",label:"\u71DF\u92B7\u5831\u8868",icon:"\u{1F4CA}",description:"\u89D2\u8272\u7D44\u5408\u6548\u679C\u5206\u6790",shortcut:"R"},{id:"analytics-center",label:"\u5206\u6790\u4E2D\u5FC3",icon:"\u{1F4CA}",description:"\u6DF1\u5EA6\u6578\u64DA\u5206\u6790"},{id:"performance",label:"\u6027\u80FD\u76E3\u63A7",icon:"\u26A1",description:"\u7CFB\u7D71\u6027\u80FD\u6307\u6A19"},{id:"search-discovery",label:"\u8CC7\u6E90\u767C\u73FE",icon:"\u{1F52D}",description:"\u767C\u73FE\u65B0\u7FA4\u7D44\u548C\u7528\u6236"}]},{id:"system",label:"\u7CFB\u7D71\u8A2D\u7F6E",icon:"\u2699\uFE0F",description:"\u7CFB\u7D71\u914D\u7F6E\u548C\u65E5\u8A8C",color:"from-slate-500 to-gray-500",defaultView:"settings",views:[{id:"settings",label:"\u7CFB\u7D71\u8A2D\u7F6E",icon:"\u2699\uFE0F",description:"\u5168\u5C40\u8A2D\u7F6E",shortcut:"S"},{id:"profile",label:"\u500B\u4EBA\u8CC7\u6599",icon:"\u{1F464}",description:"\u7528\u6236\u8CC7\u6599"},{id:"membership-center",label:"\u6703\u54E1\u4E2D\u5FC3",icon:"\u{1F48E}",description:"\u8A02\u95B1\u7BA1\u7406"}]},{id:"marketing",label:"\u71DF\u92B7\u4E2D\u5FC3",icon:"\u{1F4E2}",description:"\uFF08\u5DF2\u6574\u5408\u5230\u71DF\u92B7\u4EFB\u52D9\u4E2D\u5FC3\uFF09",color:"from-rose-500 to-red-500",defaultView:"ads",views:[{id:"ads",label:"\u5EE3\u544A\u767C\u9001",icon:"\u{1F4E2}",description:"\u6279\u91CF\u767C\u9001\u5EE3\u544A",hidden:!0},{id:"campaigns",label:"\u71DF\u92B7\u6D3B\u52D5",icon:"\u{1F3AA}",description:"\u7BA1\u7406\u71DF\u92B7\u6D3B\u52D5",hidden:!0},{id:"multi-role",label:"\u591A\u89D2\u8272\u5354\u4F5C",icon:"\u{1F3AD}",description:"\u5DF2\u79FB\u81F3\u89D2\u8272\u8CC7\u6E90\u5EAB",hidden:!0}]},{id:"ai",label:"AI \u4E2D\u5FC3",icon:"\u{1F9E0}",description:"\uFF08\u5DF2\u6574\u5408\u5230\u667A\u80FD\u5F15\u64CE\uFF09",color:"from-indigo-500 to-violet-500",defaultView:"ai-center",views:[{id:"ai-center",label:"AI \u5C0D\u8A71",icon:"\u{1F9E0}",description:"\u5DF2\u79FB\u81F3\u667A\u80FD\u5F15\u64CE",hidden:!0},{id:"ai-assistant",label:"AI \u52A9\u624B",icon:"\u2728",description:"\u71DF\u92B7\u5167\u5BB9\u52A9\u624B",hidden:!0}]}],f=class o{constructor(){this._currentView=p("dashboard");this.currentView=this._currentView.asReadonly();this._history=[];this.MAX_HISTORY=20;this.modules=c;this.currentModule=l(()=>{let e=this._currentView();return c.find(t=>t.views.some(i=>i.id===e))||c[0]});this.currentNavItem=l(()=>{let e=this._currentView();for(let t of c){let i=t.views.find(s=>s.id===e);if(i)return i}return null});this.breadcrumbs=l(()=>{let e=this.currentModule(),t=this.currentNavItem();return!e||!t?[]:e.id==="dashboard"?[{label:"\u9996\u9801",icon:"\u{1F3E0}"}]:[{label:e.label,icon:e.icon,view:e.defaultView},{label:t.label,icon:t.icon}]})}navigateTo(e){let t=this._currentView();t!==e&&(this._history.push(t),this._history.length>this.MAX_HISTORY&&this._history.shift()),this._currentView.set(e)}goBack(){if(this._history.length===0)return!1;let e=this._history.pop();return e?(this._currentView.set(e),!0):!1}navigateToModule(e){let t=c.find(i=>i.id===e);t&&this.navigateTo(t.defaultView)}getModuleViews(e){let t=c.find(i=>i.id===e);return t?t.views.filter(i=>!i.hidden):[]}getViewModule(e){return c.find(t=>t.views.some(i=>i.id===e))||null}searchViews(e){if(!e)return[];let t=e.toLowerCase(),i=[];for(let s of c)for(let a of s.views)(a.label.toLowerCase().includes(t)||a.description?.toLowerCase().includes(t))&&i.push(a);return i}getShortcuts(){let e=new Map;for(let t of c)for(let i of t.views)i.shortcut&&e.set(i.shortcut.toLowerCase(),i.id);return e}setBadge(e,t){for(let i of c){let s=i.views.find(a=>a.id===e);if(s){s.badge=t;break}}}clearBadge(e){this.setBadge(e,0)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})}};var x=class o{constructor(){this.unifiedNav=h(f);this._currentView=p("dashboard");this.currentView=this._currentView.asReadonly();this._syncing=!1;L(()=>{let e=this.unifiedNav.currentView();!this._syncing&&this.isValidLegacyView(e)&&this._currentView.set(e)})}setView(e){this._syncing=!0;try{this._currentView.set(e),this.isValidViewId(e)&&this.unifiedNav.navigateTo(e)}finally{this._syncing=!1}}navigateTo(e){this.setView(e)}goBack(){return this.unifiedNav.goBack()}getCurrentModule(){return this.unifiedNav.currentModule()}getBreadcrumbs(){return this.unifiedNav.breadcrumbs()}getModules(){return c}navigateToModule(e){this.unifiedNav.navigateToModule(e);let t=c.find(i=>i.id===e);t&&this.isValidLegacyView(t.defaultView)&&this._currentView.set(t.defaultView)}isValidLegacyView(e){return["dashboard","accounts","add-account","api-credentials","resources","member-database","resource-center","search-discovery","ai-assistant","automation","automation-legacy","leads","lead-nurturing","nurturing-analytics","ads","user-tracking","campaigns","multi-role","ai-team","ai-center","settings","analytics","analytics-center","logs","performance","alerts","profile","membership-center","monitoring-accounts","monitoring-groups","keyword-sets","chat-templates","trigger-rules","collected-users"].includes(e)}isValidViewId(e){for(let t of c)if(t.views.some(i=>i.id===e))return!0;return!1}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})}},T=class o{constructor(){this.bridge=h(x);this.unifiedNav=h(f);this.shortcuts=this.unifiedNav.getShortcuts()}handleKeyboard(e){if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)return!1;if(e.ctrlKey||e.metaKey){let t=e.key.toLowerCase(),i=this.shortcuts.get(t);if(i)return e.preventDefault(),this.bridge.navigateTo(i),!0}return e.key==="Backspace"?(e.preventDefault(),this.bridge.goBack()):!1}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})}};export{N as a,C as b,f as c,x as d,T as e};
