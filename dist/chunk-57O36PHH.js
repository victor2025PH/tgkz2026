import{a as Q,b as U}from"./chunk-OO4LYYQ2.js";import{a as J}from"./chunk-AHVHPKZ5.js";import{a as H,b as K,d as z}from"./chunk-43M2OKI7.js";import{a as B}from"./chunk-3V3KVMT4.js";import{b as q}from"./chunk-CXXWQ5XE.js";import{t as G}from"./chunk-36YFMG3E.js";import{$a as g,Aa as s,Ab as y,Na as A,Ob as $,Pb as P,R as x,Vb as C,W as b,X as _,Xb as M,Y as D,Yb as O,Z as T,_a as p,a as R,b as L,cb as N,db as j,eb as k,fb as e,ga as E,gb as t,hb as S,lb as f,nb as d,oc as W,pb as c,qc as I,vb as F,xb as n,yb as v,zb as w}from"./chunk-YLSLTE5F.js";var ne=(a,r)=>r.id;function oe(a,r){if(a&1&&(e(0,"span",60),n(1,"\u25CF \u76E3\u63A7\u904B\u884C\u4E2D"),t(),n(2)),a&2){let o=c();s(2),w(" \xB7 \u5DF2\u904B\u884C ",o.runningTime()," ")}}function re(a,r){a&1&&(e(0,"span",61),n(1,"\u25CF \u76E3\u63A7\u5DF2\u505C\u6B62"),t(),n(2," \xB7 \u5B8C\u6210\u914D\u7F6E\u5F8C\u5373\u53EF\u958B\u59CB "))}function ae(a,r){a&1&&(e(0,"span"),n(1,"\u23F9\uFE0F"),t(),n(2," \u505C\u6B62\u76E3\u63A7 "))}function se(a,r){a&1&&(e(0,"span"),n(1,"\u25B6\uFE0F"),t(),n(2," \u958B\u59CB\u76E3\u63A7 "))}function le(a,r){if(a&1){let o=f();e(0,"button",71),d("click",function(){b(o);let l=c(2);return _(l.navigateTo("chat-templates"))}),e(1,"span"),n(2,"\u{1F4DD}"),t(),n(3," \u5275\u5EFA\u6D88\u606F\u6A21\u677F "),t()}}function ue(a,r){if(a&1){let o=f();e(0,"button",71),d("click",function(){b(o);let l=c(2);return _(l.navigateTo("automation-rules"))}),e(1,"span"),n(2,"\u26A1"),t(),n(3," \u914D\u7F6E\u89F8\u767C\u898F\u5247 "),t()}}function de(a,r){if(a&1){let o=f();e(0,"div",9)(1,"div",62)(2,"span",13),n(3,"\u26A0\uFE0F"),t(),e(4,"div",63)(5,"p",64),n(6),t(),e(7,"p",65),n(8),t(),e(9,"div",66),p(10,le,4,0,"button",67),p(11,ue,4,0,"button",67),t()(),e(12,"button",68),d("click",function(){b(o);let l=c();return _(l.dismissWarning())}),D(),e(13,"svg",69),S(14,"path",70),t()()()()}if(a&2){let o=c();s(6),v(o.monitoringWarningMessage()),s(2),v(o.monitoringWarningDetail()),s(2),g(o.stateService.chatTemplates().length===0?10:-1),s(),g(o.hasActiveRules()?-1:11)}}function me(a,r){a&1&&S(0,"span",29)}function ce(a,r){if(a&1){let o=f();e(0,"button",72),d("click",function(){b(o);let l=c();return _(l.clearActivities())}),n(1," \u6E05\u7A7A "),t()}}function pe(a,r){if(a&1&&(e(0,"p",76),n(1),t()),a&2){let o=c().$implicit;s(),v(o.detail)}}function ge(a,r){if(a&1&&(e(0,"div",73)(1,"span",42),n(2),t(),e(3,"div",74)(4,"p",75),n(5),t(),p(6,pe,2,1,"p",76),t(),e(7,"span",77),n(8),t()()),a&2){let o=r.$implicit,i=c(2);s(2),v(o.icon),s(3),v(o.message),s(),g(o.detail?6:-1),s(2),v(i.formatTime(o.timestamp))}}function ve(a,r){if(a&1&&N(0,ge,9,4,"div",73,ne),a&2){let o=c();j(o.activities())}}function xe(a,r){if(a&1){let o=f();e(0,"button",88),d("click",function(){b(o);let l=c(2);return _(l.startMonitoringClick.emit())}),e(1,"span"),n(2,"\u25B6\uFE0F"),t(),n(3," \u958B\u59CB\u76E3\u63A7 "),t()}}function he(a,r){if(a&1){let o=f();e(0,"div",34)(1,"div",78),n(2,"\u{1F4E1}"),t(),e(3,"p",79),n(4,"\u66AB\u7121\u4E8B\u4EF6\u8A18\u9304"),t(),e(5,"p",80),n(6," \u958B\u59CB\u76E3\u63A7\u5F8C\uFF0C\u4EE5\u4E0B\u4E8B\u4EF6\u5C07\u986F\u793A\u5728\u9019\u88E1\uFF1A "),t(),e(7,"div",81)(8,"span",82),n(9,"\u{1F511} \u95DC\u9375\u8A5E\u5339\u914D"),t(),e(10,"span",83),n(11,"\u{1F4E8} \u81EA\u52D5\u56DE\u8986"),t(),e(12,"span",84),n(13,"\u2728 \u65B0 Lead \u6355\u7372"),t()(),e(14,"div",85),p(15,xe,4,0,"button",86),e(16,"button",87),d("click",function(){b(o);let l=c();return _(l.navigateTo("automation-rules"))}),e(17,"span"),n(18,"\u2699\uFE0F"),t(),n(19," \u914D\u7F6E\u89F8\u767C\u898F\u5247 "),t()()()}if(a&2){let o=c();s(15),g(o.isMonitoring()?-1:15)}}function be(a,r){if(a&1){let o=f();e(0,"app-config-progress",89),d("action",function(l){b(o);let m=c();return _(m.handleConfigAction(l))}),t()}}function _e(a,r){a&1&&(e(0,"span",54),n(1,"\u5F85\u8A2D\u7F6E"),t())}function fe(a,r){if(a&1){let o=f();e(0,"div",59)(1,"div",3)(2,"div",90)(3,"span",13),n(4,"\u{1F4A1}"),t()(),e(5,"div",63)(6,"h4",44),n(7),t(),e(8,"p",16),n(9),t()(),e(10,"button",91),d("click",function(){b(o);let l=c();return _(l.handleConfigAction(l.nextStepSuggestion().action))}),n(11),t()()()}if(a&2){let o=c();s(7),v(o.nextStepSuggestion().title),s(2),v(o.nextStepSuggestion().description),s(2),w(" ",o.nextStepSuggestion().buttonText," \u2192 ")}}var V=class a{constructor(){this.stateService=x(Q);this.ipcService=x(B);this.isMonitoring=O(!1);this.todayStats=O({matchCount:0,matchTrend:0,newLeads:0,leadsTrend:0,messagesSent:0,replySuccessRate:100,timeSaved:0,conversions:0});this.realtimeMatches=O([]);this.startMonitoringClick=M();this.stopMonitoringClick=M();this.navigateToPage=M();this.configActionEvent=M();this.activities=E([]);this.runningTime=E("0:00");this.warningDismissed=E(!1);this.startTime=null;this.Math=Math;this.hasActiveRules=C(()=>this.stateService.hasActiveTriggerRules());this.showMonitoringWarning=C(()=>{if(this.warningDismissed())return!1;let r=this.stateService.chatTemplates().length===0,o=!this.hasActiveRules();return r||o});this.monitoringWarningMessage=C(()=>{let r=this.stateService.chatTemplates().length===0,o=!this.hasActiveRules();return r&&o?"\u76E3\u63A7\u4E2D\uFF0C\u4F46\u5C1A\u672A\u914D\u7F6E\u81EA\u52D5\u56DE\u8986\u529F\u80FD":r?"\u76E3\u63A7\u4E2D\uFF0C\u4F46\u7F3A\u5C11\u6D88\u606F\u6A21\u677F":o?"\u76E3\u63A7\u4E2D\uFF0C\u4F46\u7F3A\u5C11\u89F8\u767C\u898F\u5247":""});this.monitoringWarningDetail=C(()=>{let r=this.stateService.chatTemplates().length===0,o=!this.hasActiveRules();return r&&o?"\u5339\u914D\u5230\u7684\u6D88\u606F\u4E0D\u6703\u81EA\u52D5\u56DE\u8986\u3002\u8ACB\u5275\u5EFA\u6D88\u606F\u6A21\u677F\u548C\u89F8\u767C\u898F\u5247\u3002":r?"\u7121\u6CD5\u767C\u9001\u81EA\u52D5\u56DE\u8986\uFF0C\u56E0\u70BA\u6C92\u6709\u53EF\u7528\u7684\u6D88\u606F\u6A21\u677F\u3002":o?"\u5339\u914D\u5230\u7684\u6D88\u606F\u4E0D\u6703\u89F8\u767C\u4EFB\u4F55\u52D5\u4F5C\uFF0C\u8ACB\u524D\u5F80\u300C\u89F8\u767C\u898F\u5247\u300D\u914D\u7F6E\u3002":""});this.canStartMonitoring=C(()=>this.stateService.configStatus().completedCount>=4);this.nextStepSuggestion=C(()=>{let r=this.stateService.configStatus();if(r.isReady)return null;let o=r.nextStep;return o&&{"add-listener":{title:"\u6DFB\u52A0\u76E3\u63A7\u5E33\u865F",description:"\u9700\u8981\u6DFB\u52A0\u4E00\u500B\u7528\u65BC\u76E3\u63A7\u7FA4\u7D44\u6D88\u606F\u7684 Telegram \u5E33\u865F",buttonText:"\u53BB\u6DFB\u52A0",action:"monitoring-accounts"},"add-group":{title:"\u6DFB\u52A0\u76E3\u63A7\u7FA4\u7D44",description:"\u6DFB\u52A0\u9700\u8981\u76E3\u63A7\u7684 Telegram \u7FA4\u7D44",buttonText:"\u53BB\u6DFB\u52A0",action:"monitoring-groups"},"add-keywords":{title:"\u5275\u5EFA\u95DC\u9375\u8A5E\u96C6",description:"\u8A2D\u7F6E\u7528\u65BC\u5339\u914D\u6D88\u606F\u7684\u95DC\u9375\u8A5E",buttonText:"\u53BB\u5275\u5EFA",action:"keyword-sets"},"bind-keywords":{title:"\u7D81\u5B9A\u95DC\u9375\u8A5E\u96C6",description:"\u5C07\u95DC\u9375\u8A5E\u96C6\u7D81\u5B9A\u5230\u76E3\u63A7\u7FA4\u7D44",buttonText:"\u53BB\u7D81\u5B9A",action:"monitoring-groups"},"add-template":{title:"\u8A2D\u7F6E\u804A\u5929\u6A21\u677F",description:"\u914D\u7F6E\u81EA\u52D5\u56DE\u8986\u4F7F\u7528\u7684\u6D88\u606F\u6A21\u677F",buttonText:"\u53BB\u8A2D\u7F6E",action:"chat-templates"},"add-sender":{title:"\u914D\u7F6E\u767C\u9001\u5E33\u865F",description:"\u8A2D\u7F6E\u7528\u65BC\u767C\u9001\u81EA\u52D5\u56DE\u8986\u7684\u5E33\u865F",buttonText:"\u53BB\u914D\u7F6E",action:"monitoring-accounts"}}[o.action||""]||null});this.listeners=[]}ngOnInit(){this.stateService.loadAll(),this.setupActivityListeners()}ngOnDestroy(){this.runningInterval&&clearInterval(this.runningInterval),this.listeners.forEach(r=>r())}setupActivityListeners(){let r=this.ipcService.on("keyword-matched",u=>{this.addActivity({type:"match",message:`\u5728\u300C${u.groupName}\u300D\u5339\u914D\u5230\u95DC\u9375\u8A5E\u300C${u.keyword}\u300D`,detail:u.messagePreview,icon:"\u{1F3AF}"})});this.listeners.push(r);let o=this.ipcService.on("message-sent",u=>{this.addActivity({type:"reply",message:`\u81EA\u52D5\u56DE\u8986\u4E86 ${u.username||"\u7528\u6236"}`,icon:"\u{1F4E8}"})});this.listeners.push(o);let i=this.ipcService.on("lead-added",u=>{this.addActivity({type:"lead",message:`\u65B0\u589E Lead: ${u.username||u.name}`,icon:"\u2728"})});this.listeners.push(i);let l=this.ipcService.on("new-lead-captured",u=>{this.addActivity({type:"lead",message:`\u6355\u7372\u65B0 Lead: @${u.username||u.user_id}`,detail:`\u4F86\u81EA\u7FA4\u7D44: ${u.sourceGroup||u.source_group}`,icon:"\u2728"})});this.listeners.push(l);let m=this.ipcService.on("log-entry",u=>{if(u.message.includes("\u5339\u914D")||u.message.includes("\u76E3\u63A7")||u.message.includes("Lead")||u.message.includes("\u56DE\u8986")){let ee=u.level==="success"?"\u2705":u.level==="warning"?"\u26A0\uFE0F":u.level==="error"?"\u274C":"\u2139\uFE0F";this.addActivity({type:"system",message:u.message,icon:ee})}});this.listeners.push(m);let h=this.ipcService.on("monitoring-started",u=>{this.addActivity({type:"system",message:u?.message||"\u76E3\u63A7\u5DF2\u555F\u52D5",icon:"\u{1F680}"})});this.listeners.push(h);let Y=this.ipcService.on("monitoring-stopped",()=>{this.addActivity({type:"system",message:"\u76E3\u63A7\u5DF2\u505C\u6B62",icon:"\u23F9\uFE0F"})});this.listeners.push(Y);let Z=this.ipcService.on("private-message-received",u=>{this.addActivity({type:"message",message:`\u6536\u5230\u79C1\u4FE1: @${u.from_username||u.user_id}`,detail:u.text?.substring(0,50)+(u.text?.length>50?"...":""),icon:"\u{1F4AC}"})});this.listeners.push(Z)}addActivity(r){let o=L(R({},r),{id:`activity-${Date.now()}`,timestamp:new Date});this.activities.update(i=>[o,...i].slice(0,50))}clearActivities(){this.activities.set([])}toggleMonitoring(){this.isMonitoring()?(this.stopMonitoringClick.emit(),this.stopRunningTimer()):(this.startMonitoringClick.emit(),this.startRunningTimer())}startRunningTimer(){this.startTime=new Date,this.runningInterval=setInterval(()=>{if(this.startTime){let r=Date.now()-this.startTime.getTime(),o=Math.floor(r/36e5),i=Math.floor(r%36e5/6e4);this.runningTime.set(`${o}:${i.toString().padStart(2,"0")}`)}},1e3)}stopRunningTimer(){this.runningInterval&&(clearInterval(this.runningInterval),this.runningInterval=null),this.runningTime.set("0:00"),this.startTime=null}navigateTo(r){this.navigateToPage.emit(r)}handleConfigAction(r){this.configActionEvent.emit(r)}formatTime(r){let i=new Date().getTime()-r.getTime();return i<6e4?"\u525B\u525B":i<36e5?`${Math.floor(i/6e4)} \u5206\u9418\u524D`:i<864e5?`${Math.floor(i/36e5)} \u5C0F\u6642\u524D`:r.toLocaleDateString()}dismissWarning(){this.warningDismissed.set(!0)}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=A({type:a,selectors:[["app-dashboard-overview"]],inputs:{isMonitoring:[1,"isMonitoring"],todayStats:[1,"todayStats"],realtimeMatches:[1,"realtimeMatches"]},outputs:{startMonitoringClick:"startMonitoringClick",stopMonitoringClick:"stopMonitoringClick",navigateToPage:"navigateToPage",configActionEvent:"configActionEvent"},decls:164,vars:61,consts:[[1,"h-full","overflow-y-auto"],[1,"p-6","space-y-6"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],[1,"w-14","h-14","rounded-2xl","flex","items-center","justify-center"],[1,"text-3xl"],[1,"text-2xl","font-bold","text-white"],[1,"text-slate-400"],[1,"px-6","py-3","rounded-xl","font-medium","transition-all","flex","items-center","gap-2",3,"click","disabled"],[1,"mt-4","p-4","bg-gradient-to-r","from-amber-500/10","to-orange-500/10","rounded-xl","border","border-amber-500/30"],[1,"grid","grid-cols-2","lg:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-orange-500/20","to-amber-500/10","rounded-xl","border","border-orange-500/20","p-5"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-2xl"],[1,"text-xs","px-2","py-1","bg-orange-500/20","text-orange-400","rounded-full"],[1,"text-3xl","font-bold","text-white","mb-1"],[1,"text-sm","text-slate-400"],[1,"bg-gradient-to-br","from-emerald-500/20","to-teal-500/10","rounded-xl","border","border-emerald-500/20","p-5"],[1,"text-xs","px-2","py-1","bg-emerald-500/20","text-emerald-400","rounded-full"],[1,"bg-gradient-to-br","from-blue-500/20","to-cyan-500/10","rounded-xl","border","border-blue-500/20","p-5"],[1,"text-xs","px-2","py-1","bg-blue-500/20","text-blue-400","rounded-full"],[1,"bg-gradient-to-br","from-purple-500/20","to-pink-500/10","rounded-xl","border","border-purple-500/20","p-5"],[1,"text-xs","px-2","py-1","bg-purple-500/20","text-purple-400","rounded-full"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-6"],[1,"bg-slate-800/50","rounded-xl","border","border-slate-700/50","overflow-hidden"],[1,"p-4","border-b","border-slate-700/50","flex","items-center","justify-between"],[1,"flex","items-center","gap-2"],[1,"font-semibold","text-white","flex","items-center","gap-2"],[1,"w-2","h-2","bg-emerald-500","rounded-full","animate-pulse"],["title","\u986F\u793A\u95DC\u9375\u8A5E\u5339\u914D\u3001\u81EA\u52D5\u56DE\u8986\u7B49\u4E8B\u4EF6\u8A18\u9304",1,"text-xs","text-slate-500"],[1,"text-xs","px-2","py-1","bg-cyan-500/20","hover:bg-cyan-500/30","text-cyan-400","rounded","transition-colors",3,"click"],[1,"text-xs","text-slate-500","hover:text-slate-400"],[1,"p-4","space-y-3","max-h-80","overflow-y-auto"],[1,"text-center","py-8"],["mode","detailed"],[1,"space-y-6"],[1,"p-4","border-b","border-slate-700/50"],[1,"p-4","space-y-3"],[1,"w-full","flex","items-center","justify-between","p-4","bg-slate-700/30","hover:bg-slate-700/50","rounded-xl","transition-colors","group",3,"click"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-lg","bg-cyan-500/20","flex","items-center","justify-center"],[1,"text-xl"],[1,"text-left"],[1,"font-medium","text-white"],[1,"text-xs","text-slate-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-slate-500","group-hover:text-cyan-400","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"w-10","h-10","rounded-lg","bg-emerald-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-slate-500","group-hover:text-emerald-400","transition-colors"],[1,"w-10","h-10","rounded-lg","bg-purple-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-slate-500","group-hover:text-purple-400","transition-colors"],[1,"w-10","h-10","rounded-lg","bg-pink-500/20","flex","items-center","justify-center"],[1,"font-medium","text-white","flex","items-center","gap-2"],[1,"text-xs","bg-amber-500/20","text-amber-400","px-1.5","py-0.5","rounded"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-slate-500","group-hover:text-pink-400","transition-colors"],[1,"p-4","grid","grid-cols-2","gap-3"],[1,"flex","flex-col","items-center","gap-2","p-4","bg-slate-700/30","hover:bg-slate-700/50","rounded-xl","transition-colors",3,"click"],[1,"text-sm","text-slate-300"],[1,"bg-gradient-to-r","from-cyan-500/10","to-blue-500/10","rounded-xl","border","border-cyan-500/20","p-5"],[1,"text-emerald-400"],[1,"text-slate-500"],[1,"flex","items-start","gap-3"],[1,"flex-1"],[1,"text-amber-400","font-medium","mb-1"],[1,"text-slate-400","text-sm","mb-3"],[1,"flex","flex-wrap","gap-2"],[1,"px-3","py-1.5","bg-amber-500/20","hover:bg-amber-500/30","text-amber-400","text-sm","rounded-lg","transition-colors","flex","items-center","gap-1"],[1,"text-slate-500","hover:text-slate-400",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"px-3","py-1.5","bg-amber-500/20","hover:bg-amber-500/30","text-amber-400","text-sm","rounded-lg","transition-colors","flex","items-center","gap-1",3,"click"],[1,"text-xs","text-slate-500","hover:text-slate-400",3,"click"],[1,"flex","items-start","gap-3","p-3","bg-slate-700/30","rounded-lg","hover:bg-slate-700/50","transition-colors"],[1,"flex-1","min-w-0"],[1,"text-sm","text-white"],[1,"text-xs","text-slate-500","truncate"],[1,"text-xs","text-slate-500","whitespace-nowrap"],[1,"text-4xl","mb-3"],[1,"text-slate-400","font-medium","mb-2"],[1,"text-xs","text-slate-500","mb-4"],[1,"flex","flex-wrap","justify-center","gap-2","mb-4"],[1,"text-xs","px-2","py-1","bg-yellow-500/10","text-yellow-400","rounded"],[1,"text-xs","px-2","py-1","bg-blue-500/10","text-blue-400","rounded"],[1,"text-xs","px-2","py-1","bg-emerald-500/10","text-emerald-400","rounded"],[1,"flex","justify-center","gap-3"],[1,"text-sm","px-4","py-2","bg-gradient-to-r","from-emerald-500","to-cyan-500","text-white","rounded-lg","hover:opacity-90","transition-opacity","flex","items-center","gap-2"],[1,"text-sm","px-4","py-2","bg-slate-700","hover:bg-slate-600","text-slate-300","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"text-sm","px-4","py-2","bg-gradient-to-r","from-emerald-500","to-cyan-500","text-white","rounded-lg","hover:opacity-90","transition-opacity","flex","items-center","gap-2",3,"click"],["mode","detailed",3,"action"],[1,"w-12","h-12","bg-cyan-500/20","rounded-xl","flex","items-center","justify-center"],[1,"px-4","py-2","bg-cyan-500/20","hover:bg-cyan-500/30","text-cyan-400","rounded-lg","transition-colors",3,"click"]],template:function(o,i){o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),n(6),t()(),e(7,"div")(8,"h1",6),n(9,"\u81EA\u52D5\u5316\u76E3\u63A7\u4E2D\u5FC3"),t(),e(10,"p",7),p(11,oe,3,1)(12,re,3,0),t()()(),e(13,"button",8),d("click",function(){return i.toggleMonitoring()}),p(14,ae,3,0)(15,se,3,0),t()(),p(16,de,15,4,"div",9),e(17,"div",10)(18,"div",11)(19,"div",12)(20,"span",13),n(21,"\u{1F525}"),t(),e(22,"span",14),n(23),t()(),e(24,"div",15),n(25),t(),e(26,"div",16),n(27,"\u4ECA\u65E5\u5339\u914D"),t()(),e(28,"div",17)(29,"div",12)(30,"span",13),n(31,"\u2728"),t(),e(32,"span",18),n(33),t()(),e(34,"div",15),n(35),t(),e(36,"div",16),n(37,"\u65B0\u589E Leads"),t()(),e(38,"div",19)(39,"div",12)(40,"span",13),n(41,"\u{1F4E8}"),t(),e(42,"span",20),n(43),t()(),e(44,"div",15),n(45),t(),e(46,"div",16),n(47,"\u81EA\u52D5\u56DE\u8986"),t()(),e(48,"div",21)(49,"div",12)(50,"span",13),n(51,"\u23F0"),t(),e(52,"span",22),n(53," vs \u624B\u52D5 "),t()(),e(54,"div",15),n(55),t(),e(56,"div",16),n(57,"\u7BC0\u7701\u6642\u9593"),t()()(),e(58,"div",23)(59,"div",24)(60,"div",25)(61,"div",26)(62,"div",27)(63,"h3",28)(64,"span"),n(65,"\u{1F4E1}"),t(),n(66," \u76E3\u63A7\u4E8B\u4EF6\u6D41 "),p(67,me,1,0,"span",29),t(),e(68,"span",30),n(69," \u24D8 "),t()(),e(70,"div",27)(71,"button",31),d("click",function(){return i.navigateTo("automation-rules")}),n(72," \u2699\uFE0F \u914D\u7F6E\u898F\u5247 "),t(),p(73,ce,2,0,"button",32),t()(),e(74,"div",33),p(75,ve,2,0)(76,he,20,1,"div",34),t()(),p(77,be,1,0,"app-config-progress",35),t(),e(78,"div",36)(79,"div",25)(80,"div",37)(81,"h3",28)(82,"span"),n(83,"\u2699\uFE0F"),t(),n(84," \u5FEB\u901F\u914D\u7F6E "),t()(),e(85,"div",38)(86,"button",39),d("click",function(){return i.navigateTo("monitoring-accounts")}),e(87,"div",40)(88,"div",41)(89,"span",42),n(90,"\u{1F4F1}"),t()(),e(91,"div",43)(92,"div",44),n(93,"\u76E3\u63A7\u5E33\u865F"),t(),e(94,"div",45),n(95),t()()(),D(),e(96,"svg",46),S(97,"path",47),t()(),T(),e(98,"button",39),d("click",function(){return i.navigateTo("monitoring-groups")}),e(99,"div",40)(100,"div",48)(101,"span",42),n(102,"\u{1F4AC}"),t()(),e(103,"div",43)(104,"div",44),n(105,"\u76E3\u63A7\u7FA4\u7D44"),t(),e(106,"div",45),n(107),$(108,"number"),t()()(),D(),e(109,"svg",49),S(110,"path",47),t()(),T(),e(111,"button",39),d("click",function(){return i.navigateTo("keyword-sets")}),e(112,"div",40)(113,"div",50)(114,"span",42),n(115,"\u{1F511}"),t()(),e(116,"div",43)(117,"div",44),n(118,"\u95DC\u9375\u8A5E\u96C6"),t(),e(119,"div",45),n(120),t()()(),D(),e(121,"svg",51),S(122,"path",47),t()(),T(),e(123,"button",39),d("click",function(){return i.navigateTo("chat-templates")}),e(124,"div",40)(125,"div",52)(126,"span",42),n(127,"\u{1F4DD}"),t()(),e(128,"div",43)(129,"div",53),n(130," \u804A\u5929\u6A21\u677F "),p(131,_e,2,0,"span",54),t(),e(132,"div",45),n(133),t()()(),D(),e(134,"svg",55),S(135,"path",47),t()()()(),T(),e(136,"div",25)(137,"div",37)(138,"h3",28)(139,"span"),n(140,"\u{1F4E6}"),t(),n(141," \u66F4\u591A\u529F\u80FD "),t()(),e(142,"div",56)(143,"button",57),d("click",function(){return i.navigateTo("resources")}),e(144,"span",13),n(145,"\u{1F4DA}"),t(),e(146,"span",58),n(147,"\u8CC7\u6599\u5EAB"),t()(),e(148,"button",57),d("click",function(){return i.navigateTo("rules")}),e(149,"span",13),n(150,"\u26A1"),t(),e(151,"span",58),n(152,"\u81EA\u52D5\u898F\u5247"),t()(),e(153,"button",57),d("click",function(){return i.navigateTo("send-settings")}),e(154,"span",13),n(155,"\u{1F4E4}"),t(),e(156,"span",58),n(157,"\u767C\u9001\u8A2D\u7F6E"),t()(),e(158,"button",57),d("click",function(){return i.navigateTo("analytics")}),e(159,"span",13),n(160,"\u{1F4CA}"),t(),e(161,"span",58),n(162,"\u6578\u64DA\u5206\u6790"),t()()()()()(),p(163,fe,12,3,"div",59),t()()),o&2&&(s(4),F("bg-gradient-to-br",i.isMonitoring())("from-emerald-500",i.isMonitoring())("to-cyan-500",i.isMonitoring())("bg-slate-700",!i.isMonitoring()),s(2),v(i.isMonitoring()?"\u{1F680}":"\u23F8\uFE0F"),s(5),g(i.isMonitoring()?11:12),s(2),F("bg-gradient-to-r",!i.isMonitoring())("from-emerald-500",!i.isMonitoring())("to-cyan-500",!i.isMonitoring())("text-white",!i.isMonitoring())("hover:shadow-lg",!i.isMonitoring())("hover:shadow-emerald-500/25",!i.isMonitoring())("bg-red-500/20",i.isMonitoring())("text-red-400",i.isMonitoring())("hover:bg-red-500/30",i.isMonitoring()),k("disabled",!i.canStartMonitoring()&&!i.isMonitoring()),s(),g(i.isMonitoring()?14:15),s(2),g(i.isMonitoring()&&i.showMonitoringWarning()?16:-1),s(7),y(" ",i.todayStats().matchTrend>=0?"\u2191":"\u2193"," ",i.Math.abs(i.todayStats().matchTrend),"% "),s(2),v(i.todayStats().matchCount),s(8),y(" ",i.todayStats().leadsTrend>=0?"\u2191":"\u2193"," ",i.Math.abs(i.todayStats().leadsTrend),"% "),s(2),v(i.todayStats().newLeads),s(8),w(" \u6210\u529F\u7387 ",i.todayStats().replySuccessRate,"% "),s(2),v(i.todayStats().messagesSent),s(10),w("",i.todayStats().timeSaved,"h"),s(12),g(i.isMonitoring()?67:-1),s(6),g(i.activities().length>0?73:-1),s(2),g(i.activities().length>0?75:76),s(2),g(i.stateService.configStatus().isReady?-1:77),s(18),y("",i.stateService.listenerAccounts().length," \u76E3\u807D \xB7 ",i.stateService.senderAccounts().length," \u767C\u9001"),s(12),y("",i.stateService.groups().length," \u500B\u7FA4\u7D44 \xB7 ",P(108,59,i.stateService.totalMembers())," \u6210\u54E1"),s(13),y("",i.stateService.keywordSets().length," \u8A5E\u96C6 \xB7 ",i.stateService.totalKeywords()," \u95DC\u9375\u8A5E"),s(3),F("border-2",i.stateService.chatTemplates().length===0)("border-dashed",i.stateService.chatTemplates().length===0)("border-amber-500/50",i.stateService.chatTemplates().length===0),s(8),g(i.stateService.chatTemplates().length===0?131:-1),s(2),w("",i.stateService.chatTemplates().length," \u500B\u6A21\u677F"),s(30),g(i.nextStepSuggestion()?163:-1))},dependencies:[I,U,W],encapsulation:2})}};var X=class a{constructor(){this.i18n=x(q);this.nav=x(z);this.ipc=x(B);this.toast=x(H);this.membershipService=x(K);this.monitoringMgmt=x(J);this.isMonitoring=C(()=>this.monitoringMgmt.monitoringActive());this.monitoringStats=E({groups:0,keywords:0,messages:0,triggered:0});this.ipcCleanup=[]}ngOnInit(){this.loadStatus(),this.setupIpcListeners()}ngOnDestroy(){this.ipcCleanup.forEach(r=>r())}loadStatus(){this.ipc.send("get-monitoring-status"),this.ipc.send("get-monitoring-stats")}setupIpcListeners(){let r=this.ipc.on("monitoring-stats",m=>{this.monitoringStats.set(m)}),o=this.ipc.on("monitoring-started",m=>{let h=typeof m=="object"&&m?.message?m.message:"\u76E3\u63A7\u5DF2\u555F\u52D5";this.toast.success(h)}),i=this.ipc.on("monitoring-stopped",()=>{this.toast.info("\u76E3\u63A7\u5DF2\u505C\u6B62")}),l=this.ipc.on("monitoring-start-failed",m=>{console.log("[AutomationView] \u76E3\u63A7\u555F\u52D5\u5931\u6557:",m);let h=m.message||"\u76E3\u63A7\u555F\u52D5\u5931\u6557";m.reason==="config_check_failed"&&m.issues?.length?h=`\u914D\u7F6E\u932F\u8AA4: ${m.issues[0]?.message||h}`:m.reason==="no_accessible_groups"?h="\u7121\u6CD5\u8A2A\u554F\u76E3\u63A7\u7FA4\u7D44\uFF0C\u8ACB\u78BA\u4FDD\u5E33\u865F\u5DF2\u52A0\u5165\u7FA4\u7D44":m.reason==="all_accounts_failed"&&(h="\u6240\u6709\u76E3\u63A7\u5E33\u865F\u90FD\u7121\u6CD5\u555F\u52D5"),this.toast.error(h,5e3)});this.ipcCleanup.push(r,o,i,l)}t(r,o){return this.i18n.t(r,o)}navigateTo(r){this.nav.navigateTo(r)}startMonitoring(){this.ipc.send("start-monitoring")}stopMonitoring(){this.ipc.send("stop-monitoring")}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=A({type:a,selectors:[["app-automation-view"]],decls:1,vars:1,consts:[[3,"startMonitoringClick","stopMonitoringClick","navigateToPage","isMonitoring"]],template:function(o,i){o&1&&(e(0,"app-dashboard-overview",0),d("startMonitoringClick",function(){return i.startMonitoring()})("stopMonitoringClick",function(){return i.stopMonitoring()})("navigateToPage",function(m){return i.navigateTo(m)}),t()),o&2&&k("isMonitoring",i.isMonitoring())},dependencies:[I,G,V],encapsulation:2,changeDetection:0})}};export{X as a};
