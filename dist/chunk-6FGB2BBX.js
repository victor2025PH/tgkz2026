import{a as U}from"./chunk-QQWXSIIS.js";import{a as j}from"./chunk-3V3KVMT4.js";import{b as G}from"./chunk-7U27PO57.js";import"./chunk-B6NL44GT.js";import{g as B,j as H}from"./chunk-N7GMY4UM.js";import{Aa as r,Ab as V,Mb as _,Na as q,Ob as A,Qb as Q,R as O,Sa as u,Vb as C,W as P,X as D,Y as w,Ya as k,Z as T,a as F,eb as d,fb as o,ga as h,gb as i,hb as v,lb as S,lc as z,mc as R,nb as f,nc as $,pb as l,qc as N,ub as E,vb as b,xb as s,yb as g,zb as x}from"./chunk-YLSLTE5F.js";var M=()=>[],Y=()=>[0,1,2,3,4];function K(a,t){if(a&1&&(o(0,"div",36)(1,"div",37),s(2,"\u23F0"),i(),o(3,"div",38)(4,"span",39),s(5,"\u6BCF\u65E5\u914D\u984D\u91CD\u7F6E"),i(),o(6,"span",40),s(7),i()()()),a&2){let e=l();r(7),g(e.nextResetTime())}}function W(a,t){if(a&1&&(o(0,"div",54)(1,"span",55),s(2),i(),o(3,"span",56),s(4,"/"),i(),o(5,"span",57),s(6),i()()),a&2){let e=l().$implicit,n=l();r(2),g(n.formatNumber(e.used)),r(4),g(n.formatNumber(e.limit))}}function J(a,t){if(a&1&&(o(0,"div",58)(1,"span",59),s(2,"\u221E"),i(),o(3,"span",60),s(4),i()()),a&2){let e=l().$implicit,n=l();r(4),x("\u5DF2\u4F7F\u7528 ",n.formatNumber(e.used))}}function X(a,t){if(a&1&&(o(0,"div",61)(1,"div",62),v(2,"div",63),i(),o(3,"span",64),s(4),i()()),a&2){let e=l().$implicit,n=l();r(2),E("width",e.percentage,"%")("background",n.getProgressGradient(e.status)),r(2),x("",e.percentage.toFixed(1),"%")}}function Z(a,t){if(a&1&&(o(0,"span",65),s(1),i()),a&2){let e=l().$implicit,n=l();r(),x(" \u5269\u9918: ",n.formatNumber(e.remaining)," ")}}function ee(a,t){if(a&1&&(o(0,"span",66),s(1),i()),a&2){let e=l().$implicit,n=l();r(),x(" ",n.formatResetTime(e.resetAt)," \u91CD\u7F6E ")}}function te(a,t){if(a&1&&(o(0,"div",67),w(),o(1,"svg",68),v(2,"polyline",69),i()()),a&2){let e=t.ngIf;r(2),k("points",e)}}function ne(a,t){if(a&1&&(o(0,"div",41)(1,"div",42)(2,"div",43),s(3),i(),o(4,"div",44)(5,"h3"),s(6),i(),o(7,"span",45),s(8),i()()(),o(9,"div",46),u(10,W,7,2,"div",47)(11,J,5,1,"div",48)(12,X,5,5,"div",49),o(13,"div",50),u(14,Z,2,1,"span",51)(15,ee,2,1,"span",52),i()(),u(16,te,3,1,"div",53),i()),a&2){let e=t.$implicit,n=l();b("warning",e.status==="warning"||e.status==="critical")("exceeded",e.status==="exceeded")("unlimited",e.unlimited),r(3),g(n.getQuotaIcon(e.type)),r(3),g(n.quotaService.getQuotaDisplayName(e.type)),r(),E("color",n.getStatusColor(e.status)),r(),x(" ",n.getStatusText(e.status)," "),r(2),d("ngIf",!e.unlimited),r(),d("ngIf",e.unlimited),r(),d("ngIf",!e.unlimited),r(2),d("ngIf",!e.unlimited),r(),d("ngIf",e.resetAt),r(),d("ngIf",n.getTrendData(e.type))}}function ie(a,t){if(a&1){let e=S();o(0,"button",70),f("click",function(){let c=P(e).$implicit,p=l();return D(p.selectedPeriod.set(c.value))}),s(1),i()}if(a&2){let e=t.$implicit,n=l();b("active",n.selectedPeriod()===e.value),r(),x(" ",e.label," ")}}function ae(a,t){if(a&1&&(o(0,"div",71),v(1,"span",72),o(2,"span",73),s(3),i()()),a&2){let e=t.$implicit;r(),E("background",e.color),r(2),g(e.name)}}function oe(a,t){if(a&1&&(w(),v(0,"line",74)),a&2){let e=t.$implicit;k("y1",e*37.5)("y2",e*37.5)}}function re(a,t){if(a&1&&(w(),v(0,"circle",77)),a&2){let e=t.$implicit,n=t.index,c=l().$implicit,p=l();k("cx",n/(c.data.length-1||1)*400)("cy",150-e/p.maxTrendValue()*150)("fill",c.color)}}function se(a,t){if(a&1&&(w(),o(0,"g"),v(1,"polyline",75),u(2,re,1,3,"circle",76),i()),a&2){let e=t.$implicit,n=l();r(),k("points",n.generateChartPoints(e.data))("stroke",e.color),r(),d("ngForOf",e.data)}}function ce(a,t){if(a&1&&(o(0,"span"),s(1),i()),a&2){let e=t.$implicit;r(),g(e)}}function le(a,t){if(a&1&&(o(0,"div",78)(1,"span",79),s(2),i(),o(3,"span",80)(4,"span",81),s(5),i(),s(6),i(),o(7,"span",55),s(8),i(),o(9,"span",57),s(10),i(),o(11,"span",64),s(12),i()()),a&2){let e=t.$implicit,n=l();r(2),g(e.date),r(3),g(n.getQuotaIcon(e.quota_type)),r(),x(" ",n.quotaService.getQuotaDisplayName(e.quota_type)," "),r(2),g(n.formatNumber(e.used)),r(2),g(n.formatNumber(e.limit)),r(),b("warning",n.getHistoryPercentage(e)>80),r(),x(" ",n.getHistoryPercentage(e).toFixed(1),"% ")}}function de(a,t){a&1&&(o(0,"div",82),s(1," \u66AB\u7121\u6B77\u53F2\u8A18\u9304 "),i())}function pe(a,t){if(a&1&&(o(0,"span",95),s(1),i()),a&2){let e=l().$implicit;r(),V(" \u7DE9\u5B58: ",e.cached_usage," / \u5BE6\u969B: ",e.actual_count," ")}}function ue(a,t){if(a&1&&(o(0,"div",91)(1,"span",92),s(2),i(),o(3,"span",93),s(4),i(),u(5,pe,2,2,"span",94),i()),a&2){let e=t.$implicit;r(2),g(e.quota_type),r(),b("ok",e.status==="ok")("err",e.status!=="ok"),r(),x(" ",e.status==="ok"?"\u2713 \u4E00\u81F4":"\u26A1 \u5DF2\u4FEE\u5FA9"," "),r(),d("ngIf",e.cached_usage!==void 0)}}function ge(a,t){if(a&1&&(o(0,"div",89),u(1,ue,6,7,"div",90),i()),a&2){let e,n=l(2);r(),d("ngForOf",((e=n.consistencyResult())==null?null:e.checks)||_(1,M))}}function me(a,t){if(a&1&&(o(0,"div",83)(1,"div",84)(2,"span",85),s(3),i(),o(4,"span",86),s(5),i()(),u(6,ge,2,2,"div",87),o(7,"div",88),s(8),A(9,"date"),i()()),a&2){let e,n,c,p,m,I,y=l();r(),b("ok",(e=y.consistencyResult())==null?null:e.consistent)("mismatch",!((n=y.consistencyResult())!=null&&n.consistent)),r(2),g((c=y.consistencyResult())!=null&&c.consistent?"\u2705":"\u26A0\uFE0F"),r(2),g((p=y.consistencyResult())!=null&&p.consistent?"\u6240\u6709\u914D\u984D\u6578\u64DA\u4E00\u81F4":"\u767C\u73FE\u4E0D\u4E00\u81F4\uFF0C\u5DF2\u81EA\u52D5\u4FEE\u5FA9"),r(),d("ngIf",(m=y.consistencyResult())==null?null:m.checks),r(2),x("\u6821\u9A57\u6642\u9593: ",Q(9,8,(I=y.consistencyResult())==null?null:I.checked_at,"short"))}}function xe(a,t){if(a&1){let e=S();o(0,"button",106),f("click",function(){P(e);let c=l().$implicit,p=l(2);return D(p.acknowledgeAlert(c.id))}),s(1," \u78BA\u8A8D "),i()}}function fe(a,t){if(a&1&&(o(0,"div",100)(1,"div",101),s(2,"\u26A0\uFE0F"),i(),o(3,"div",102)(4,"span",103),s(5),i(),o(6,"span",104),s(7),i()(),u(8,xe,2,0,"button",105),i()),a&2){let e=t.$implicit,n=l(2);b("acknowledged",e.acknowledged),r(5),g(n.quotaService.getQuotaDisplayName(e.quota_type)),r(2),g(e.message),r(),d("ngIf",!e.acknowledged)}}function _e(a,t){if(a&1){let e=S();o(0,"section",96)(1,"div",12)(2,"h2"),s(3,"\u914D\u984D\u544A\u8B66"),i(),o(4,"button",97),f("click",function(){P(e);let c=l();return D(c.clearAlerts())}),s(5,"\u5168\u90E8\u78BA\u8A8D"),i()(),o(6,"div",98),u(7,fe,9,5,"div",99),i()()}if(a&2){let e=l();r(7),d("ngForOf",e.quotaService.alerts())}}function he(a,t){if(a&1&&(o(0,"span",115),s(1),i()),a&2){let e=t.$implicit;r(),x(" \u2713 ",e," ")}}function ve(a,t){if(a&1){let e=S();o(0,"section",107)(1,"div",108)(2,"div",109),s(3,"\u{1F680}"),i(),o(4,"div",110)(5,"h3"),s(6,"\u89E3\u9396\u66F4\u591A\u914D\u984D"),i(),o(7,"p"),s(8,"\u5347\u7D1A\u5230\u66F4\u9AD8\u7B49\u7D1A\uFF0C\u7372\u5F97\u66F4\u591A\u8CC7\u6E90\u914D\u984D\u548C\u9AD8\u7D1A\u529F\u80FD"),i()(),o(9,"div",111),u(10,he,2,1,"span",112),i()(),o(11,"button",113),f("click",function(){P(e);let c=l();return D(c.goToUpgrade())}),s(12," \u67E5\u770B\u5347\u7D1A\u65B9\u6848 "),o(13,"span",114),s(14,"\u2192"),i()()()}if(a&2){let e=l();r(10),d("ngForOf",e.upgradeFeatures)}}var L=class a{constructor(){this.quotaService=O(U);this.authService=O(G);this.router=O(B);this.ipc=O(j);this.selectedPeriod=h("7d");this.showAllHistory=!1;this.isCheckingConsistency=h(!1);this.consistencyResult=h(null);this._trendData=h(null);this.trendData=this._trendData.asReadonly();this._history=h([]);this._nextResetTime=h(null);this.nextResetTime=this._nextResetTime.asReadonly();this.periods=[{value:"7d",label:"7\u5929"},{value:"30d",label:"30\u5929"},{value:"90d",label:"90\u5929"}];this.upgradeFeatures=["\u66F4\u591A TG \u5E33\u865F","\u66F4\u9AD8\u6D88\u606F\u914D\u984D","\u7121\u9650 AI \u8ABF\u7528","\u9AD8\u7D1A\u529F\u80FD"];this.quotaIcons={daily_messages:"\u{1F4AC}",ai_calls:"\u{1F916}",tg_accounts:"\u{1F4F1}",groups:"\u{1F465}",devices:"\u{1F4BB}",keyword_sets:"\u{1F511}",auto_reply_rules:"\u{1F504}",scheduled_tasks:"\u23F0"};this.tierConfig={bronze:{icon:"\u{1F949}",gradient:"linear-gradient(135deg, #CD7F32, #8B4513)",name:"\u9752\u9285\u6230\u58EB"},silver:{icon:"\u{1F948}",gradient:"linear-gradient(135deg, #C0C0C0, #808080)",name:"\u767D\u9280\u885B\u58EB"},gold:{icon:"\u{1F947}",gradient:"linear-gradient(135deg, #FFD700, #FFA500)",name:"\u9EC3\u91D1\u7375\u624B"},diamond:{icon:"\u{1F48E}",gradient:"linear-gradient(135deg, #00CED1, #4169E1)",name:"\u947D\u77F3\u738B\u8005"},star:{icon:"\u2B50",gradient:"linear-gradient(135deg, #9B59B6, #8E44AD)",name:"\u661F\u8000\u50B3\u5947"},king:{icon:"\u{1F451}",gradient:"linear-gradient(135deg, #FF6B6B, #EE5A24)",name:"\u738B\u8005\u81F3\u5C0A"}};this.tierIcon=C(()=>{let t=this.authService.subscriptionTier()||"bronze";return this.tierConfig[t]?.icon||"\u{1F949}"});this.tierGradient=C(()=>{let t=this.authService.subscriptionTier()||"bronze";return this.tierConfig[t]?.gradient||this.tierConfig.bronze.gradient});this.tierName=C(()=>{let t=this.authService.subscriptionTier()||"bronze";return this.tierConfig[t]?.name||"\u9752\u9285\u6230\u58EB"});this.displayQuotas=C(()=>{let t=this.quotaService.quotaSummary();return t?.quotas?Object.entries(t.quotas).map(([e,n])=>F({type:e},n)):[]});this.displayHistory=C(()=>{let t=this._history();return this.showAllHistory?t:t.slice(0,5)});this.maxTrendValue=C(()=>{let t=this._trendData();if(!t)return 100;let e=0;return t.datasets.forEach(n=>{n.data.forEach(c=>{c>e&&(e=c)})}),e||100})}ngOnInit(){this.loadData(),this.startRefreshInterval(),this.startCountdown()}ngOnDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval),this.countdownInterval&&clearInterval(this.countdownInterval)}async loadData(){await Promise.all([this.quotaService.loadQuotaSummary(),this.quotaService.loadAlerts(),this.quotaService.loadMembershipLevels(),this.loadTrendData(),this.loadHistory()])}startRefreshInterval(){this.refreshInterval=setInterval(()=>{this.quotaService.loadQuotaSummary()},6e4)}startCountdown(){this.updateCountdown(),this.countdownInterval=setInterval(()=>{this.updateCountdown()},1e3)}updateCountdown(){let t=new Date,e=new Date(t);e.setDate(e.getDate()+1),e.setHours(0,0,0,0);let n=e.getTime()-t.getTime(),c=Math.floor(n/(1e3*60*60)),p=Math.floor(n%(1e3*60*60)/(1e3*60)),m=Math.floor(n%(1e3*60)/1e3);this._nextResetTime.set(`${c.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`)}async loadTrendData(){let t=this.selectedPeriod()==="7d"?7:this.selectedPeriod()==="30d"?30:90,e=[],n=[],c=[];for(let p=t-1;p>=0;p--){let m=new Date;m.setDate(m.getDate()-p),e.push(`${m.getMonth()+1}/${m.getDate()}`),n.push(Math.floor(Math.random()*100)+20),c.push(Math.floor(Math.random()*50)+5)}this._trendData.set({labels:e,datasets:[{name:"\u6BCF\u65E5\u6D88\u606F",data:n,color:"#3b82f6"},{name:"AI \u8ABF\u7528",data:c,color:"#8b5cf6"}]})}async loadHistory(){let t=[];for(let e=0;e<10;e++){let n=new Date;n.setDate(n.getDate()-e),t.push({date:`${n.getMonth()+1}/${n.getDate()}`,quota_type:e%2===0?"daily_messages":"ai_calls",used:Math.floor(Math.random()*80)+20,limit:100})}this._history.set(t)}getQuotaIcon(t){return this.quotaIcons[t]||"\u{1F4CA}"}getStatusColor(t){return{ok:"#22c55e",warning:"#f59e0b",critical:"#ef4444",exceeded:"#dc2626",unlimited:"#8b5cf6"}[t]||"#888"}getStatusText(t){return{ok:"\u6B63\u5E38",warning:"\u5373\u5C07\u9054\u9650",critical:"\u63A5\u8FD1\u4E0A\u9650",exceeded:"\u5DF2\u8D85\u9650",unlimited:"\u7121\u9650\u5236"}[t]||""}getProgressGradient(t){return t==="exceeded"?"#ef4444":t==="critical"||t==="warning"?"linear-gradient(90deg, #f59e0b, #ef4444)":"linear-gradient(90deg, #3b82f6, #8b5cf6)"}formatNumber(t){return t===-1?"\u221E":t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()}formatResetTime(t){try{return new Date(t).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"})}catch{return""}}getTrendData(t){let e=[];for(let n=0;n<7;n++){let c=n/6*100,p=30-Math.random()*25;e.push(`${c},${p}`)}return e.join(" ")}generateChartPoints(t){if(!t||t.length===0)return"";let e=this.maxTrendValue(),n=[];return t.forEach((c,p)=>{let m=p/(t.length-1||1)*400,I=150-c/e*150;n.push(`${m},${I}`)}),n.join(" ")}getHistoryPercentage(t){return t.limit===0?0:t.used/t.limit*100}showUpgradeHint(){let t=this.authService.subscriptionTier();return t!=="king"&&t!=="star"&&t!=="diamond"}async acknowledgeAlert(t){await this.quotaService.acknowledgeAlert(t)}async clearAlerts(){let t=this.quotaService.alerts();for(let e of t)e.acknowledged||await this.quotaService.acknowledgeAlert(e.id)}goToUpgrade(){this.router.navigate(["/upgrade"])}async runConsistencyCheck(){this.isCheckingConsistency.set(!0),this.consistencyResult.set(null);try{let t=localStorage.getItem("tgm_access_token"),e=window.location.hostname==="localhost"&&window.location.port==="4200"?"http://localhost:8000":"",c=await(await fetch(`${e}/api/v1/quota/consistency`,{headers:t?{Authorization:`Bearer ${t}`}:{}})).json();c.success?this.consistencyResult.set(c.data):this.consistencyResult.set({consistent:!1,error:c.error})}catch(t){this.consistencyResult.set({consistent:!1,error:t.message||"\u6821\u9A57\u5931\u6557"})}finally{this.isCheckingConsistency.set(!1)}}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=q({type:a,selectors:[["app-quota-dashboard-view"]],decls:64,vars:25,consts:[[1,"quota-dashboard"],[1,"page-header"],[1,"header-left"],[1,"header-right"],[1,"tier-badge"],[1,"tier-icon"],[1,"tier-name"],[1,"upgrade-btn",3,"click"],["class","reset-countdown",4,"ngIf"],[1,"quota-grid"],["class","quota-card",3,"warning","exceeded","unlimited",4,"ngFor","ngForOf"],[1,"trend-section"],[1,"section-header"],[1,"period-selector"],[3,"active","click",4,"ngFor","ngForOf"],[1,"chart-container"],[1,"chart-legend"],["class","legend-item",4,"ngFor","ngForOf"],[1,"chart-area"],["viewBox","0 0 400 150","preserveAspectRatio","none",1,"trend-chart"],[1,"grid"],["x1","0","x2","400",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"chart-labels"],[1,"history-section"],[1,"view-all-btn",3,"click"],[1,"history-table"],[1,"table-header"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],["class","empty-history",4,"ngIf"],[1,"consistency-section"],[1,"check-btn",3,"click","disabled"],["class","consistency-result",4,"ngIf"],["class","alerts-section",4,"ngIf"],["class","upgrade-section",4,"ngIf"],[1,"reset-countdown"],[1,"countdown-icon"],[1,"countdown-info"],[1,"countdown-label"],[1,"countdown-time"],[1,"quota-card"],[1,"card-header"],[1,"quota-icon"],[1,"quota-info"],[1,"quota-status"],[1,"card-body"],["class","quota-value",4,"ngIf"],["class","quota-value unlimited",4,"ngIf"],["class","progress-container",4,"ngIf"],[1,"quota-details"],["class","remaining",4,"ngIf"],["class","reset-hint",4,"ngIf"],["class","mini-trend",4,"ngIf"],[1,"quota-value"],[1,"used"],[1,"separator"],[1,"limit"],[1,"quota-value","unlimited"],[1,"infinity"],[1,"used-text"],[1,"progress-container"],[1,"progress-bar"],[1,"progress-fill"],[1,"percentage"],[1,"remaining"],[1,"reset-hint"],[1,"mini-trend"],["viewBox","0 0 100 30","preserveAspectRatio","none"],["fill","none","stroke","currentColor","stroke-width","2","stroke-linejoin","round"],[3,"click"],[1,"legend-item"],[1,"legend-color"],[1,"legend-label"],["x1","0","x2","400"],["fill","none","stroke-width","2","stroke-linejoin","round"],["r","4","class","data-point",4,"ngFor","ngForOf"],["r","4",1,"data-point"],[1,"table-row"],[1,"date"],[1,"type"],[1,"type-icon"],[1,"empty-history"],[1,"consistency-result"],[1,"consistency-status"],[1,"status-icon"],[1,"status-text"],["class","check-details",4,"ngIf"],[1,"check-time"],[1,"check-details"],["class","check-item",4,"ngFor","ngForOf"],[1,"check-item"],[1,"check-type"],[1,"check-status"],["class","check-detail",4,"ngIf"],[1,"check-detail"],[1,"alerts-section"],[1,"clear-btn",3,"click"],[1,"alerts-list"],["class","alert-item",3,"acknowledged",4,"ngFor","ngForOf"],[1,"alert-item"],[1,"alert-icon"],[1,"alert-content"],[1,"alert-type"],[1,"alert-message"],["class","ack-btn",3,"click",4,"ngIf"],[1,"ack-btn",3,"click"],[1,"upgrade-section"],[1,"upgrade-content"],[1,"upgrade-icon"],[1,"upgrade-text"],[1,"upgrade-features"],["class","feature",4,"ngFor","ngForOf"],[1,"upgrade-cta",3,"click"],[1,"arrow"],[1,"feature"]],template:function(e,n){if(e&1&&(o(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1"),s(4,"\u914D\u984D\u7BA1\u7406"),i(),o(5,"p"),s(6,"\u67E5\u770B\u548C\u7BA1\u7406\u60A8\u7684\u8CC7\u6E90\u914D\u984D"),i()(),o(7,"div",3)(8,"div",4)(9,"span",5),s(10),i(),o(11,"span",6),s(12),i()(),o(13,"button",7),f("click",function(){return n.goToUpgrade()}),s(14," \u5347\u7D1A\u65B9\u6848 "),i()()(),u(15,K,8,1,"div",8),o(16,"div",9),u(17,ne,17,17,"div",10),i(),o(18,"section",11)(19,"div",12)(20,"h2"),s(21,"\u4F7F\u7528\u8DA8\u52E2"),i(),o(22,"div",13),u(23,ie,2,3,"button",14),i()(),o(24,"div",15)(25,"div",16),u(26,ae,4,3,"div",17),i(),o(27,"div",18),w(),o(28,"svg",19)(29,"g",20),u(30,oe,1,2,"line",21),i(),u(31,se,3,3,"g",22),i(),T(),o(32,"div",23),u(33,ce,2,1,"span",22),i()()()(),o(34,"section",24)(35,"div",12)(36,"h2"),s(37,"\u4F7F\u7528\u6B77\u53F2"),i(),o(38,"button",25),f("click",function(){return n.showAllHistory=!n.showAllHistory}),s(39),i()(),o(40,"div",26)(41,"div",27)(42,"span"),s(43,"\u65E5\u671F"),i(),o(44,"span"),s(45,"\u985E\u578B"),i(),o(46,"span"),s(47,"\u4F7F\u7528\u91CF"),i(),o(48,"span"),s(49,"\u914D\u984D"),i(),o(50,"span"),s(51,"\u4F7F\u7528\u7387"),i()(),o(52,"div",28),u(53,le,13,8,"div",29)(54,de,2,0,"div",30),i()()(),o(55,"section",31)(56,"div",12)(57,"h2"),s(58,"\u6578\u64DA\u6821\u9A57"),i(),o(59,"button",32),f("click",function(){return n.runConsistencyCheck()}),s(60),i()(),u(61,me,10,11,"div",33),i(),u(62,_e,8,1,"section",34)(63,ve,15,1,"section",35),i()),e&2){let c,p,m;r(8),E("background",n.tierGradient()),r(2),g(n.tierIcon()),r(2),g(n.tierName()),r(3),d("ngIf",n.nextResetTime()),r(2),d("ngForOf",n.displayQuotas()),r(6),d("ngForOf",n.periods),r(3),d("ngForOf",((c=n.trendData())==null?null:c.datasets)||_(19,M)),r(4),d("ngForOf",_(20,Y)),r(),d("ngForOf",((p=n.trendData())==null?null:p.datasets)||_(21,M)),r(2),d("ngForOf",((m=n.trendData())==null?null:m.labels)||_(22,M)),r(6),x(" ",n.showAllHistory?"\u6536\u8D77":"\u67E5\u770B\u5168\u90E8"," "),r(14),d("ngForOf",n.displayHistory()),r(),d("ngIf",(n.displayHistory()||_(23,M)).length===0),r(5),d("disabled",n.isCheckingConsistency()),r(),x(" ",n.isCheckingConsistency()?"\u6821\u9A57\u4E2D...":"\u6821\u9A57\u914D\u984D\u4E00\u81F4\u6027"," "),r(),d("ngIf",n.consistencyResult()),r(),d("ngIf",(n.quotaService.alerts()||_(24,M)).length>0),r(),d("ngIf",n.showUpgradeHint())}},dependencies:[N,z,R,H,$],styles:[".quota-dashboard[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin:0 0 4px}.header-left[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary, #888);font-size:14px}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.tier-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:20px;color:#fff;font-weight:600}.tier-icon[_ngcontent-%COMP%]{font-size:18px}.upgrade-btn[_ngcontent-%COMP%]{padding:10px 20px;background:linear-gradient(135deg,#8b5cf6,#6366f1);border:none;border-radius:8px;color:#fff;font-weight:600;cursor:pointer;transition:all .2s}.upgrade-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #8b5cf64d}.reset-countdown[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 20px;background:#3b82f61a;border:1px solid rgba(59,130,246,.2);border-radius:12px;margin-bottom:24px}.countdown-icon[_ngcontent-%COMP%]{font-size:24px}.countdown-label[_ngcontent-%COMP%]{display:block;font-size:12px;color:var(--text-secondary, #888)}.countdown-time[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--primary, #3b82f6)}.quota-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px;margin-bottom:32px}.quota-card[_ngcontent-%COMP%]{background:var(--bg-secondary, #1a1a1a);border:1px solid var(--border-color, #333);border-radius:16px;padding:20px;transition:all .3s;position:relative;overflow:hidden}.quota-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #0003}.quota-card.warning[_ngcontent-%COMP%]{border-color:#f59e0b80}.quota-card.exceeded[_ngcontent-%COMP%]{border-color:#ef444480;background:#ef44440d}.quota-card.unlimited[_ngcontent-%COMP%]{border-color:#8b5cf64d}.card-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px}.quota-icon[_ngcontent-%COMP%]{font-size:32px}.quota-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600}.quota-status[_ngcontent-%COMP%]{font-size:12px}.card-body[_ngcontent-%COMP%]   .quota-value[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:4px;margin-bottom:12px}.quota-value[_ngcontent-%COMP%]   .used[_ngcontent-%COMP%]{font-size:32px;font-weight:700}.quota-value[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%], .quota-value[_ngcontent-%COMP%]   .limit[_ngcontent-%COMP%]{font-size:18px;color:var(--text-secondary, #888)}.quota-value.unlimited[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.infinity[_ngcontent-%COMP%]{font-size:36px;color:#8b5cf6}.used-text[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary, #888)}.progress-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px}.progress-bar[_ngcontent-%COMP%]{flex:1;height:8px;background:#ffffff1a;border-radius:4px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;border-radius:4px;transition:width .3s}.percentage[_ngcontent-%COMP%]{font-size:14px;font-weight:600;min-width:50px;text-align:right}.quota-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:12px;color:var(--text-secondary, #888)}.mini-trend[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:40px;opacity:.3;color:var(--primary, #3b82f6)}.mini-trend[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}.trend-section[_ngcontent-%COMP%], .history-section[_ngcontent-%COMP%], .alerts-section[_ngcontent-%COMP%], .consistency-section[_ngcontent-%COMP%]{background:var(--bg-secondary, #1a1a1a);border-radius:16px;padding:24px;margin-bottom:24px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0}.period-selector[_ngcontent-%COMP%]{display:flex;background:#ffffff0d;border-radius:8px;padding:4px}.period-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 12px;background:transparent;border:none;border-radius:6px;color:var(--text-secondary, #888);font-size:13px;cursor:pointer;transition:all .2s}.period-selector[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--primary, #3b82f6);color:#fff}.chart-container[_ngcontent-%COMP%]{position:relative}.chart-legend[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:16px}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:13px}.legend-color[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:3px}.chart-area[_ngcontent-%COMP%]{position:relative}.trend-chart[_ngcontent-%COMP%]{width:100%;height:150px}.trend-chart[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   line[_ngcontent-%COMP%]{stroke:#ffffff1a;stroke-width:1}.data-point[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s}.trend-chart[_ngcontent-%COMP%]:hover   .data-point[_ngcontent-%COMP%]{opacity:1}.chart-labels[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:8px;font-size:11px;color:var(--text-muted, #666)}.view-all-btn[_ngcontent-%COMP%], .clear-btn[_ngcontent-%COMP%]{padding:6px 12px;background:#ffffff1a;border:none;border-radius:6px;color:var(--text-secondary, #888);font-size:13px;cursor:pointer}.history-table[_ngcontent-%COMP%]{border:1px solid var(--border-color, #333);border-radius:12px;overflow:hidden}.table-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:100px 1fr 80px 80px 80px;padding:12px 16px;background:#ffffff0d;font-size:12px;font-weight:600;color:var(--text-secondary, #888)}.table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:100px 1fr 80px 80px 80px;padding:12px 16px;border-top:1px solid var(--border-color, #333);font-size:13px;transition:background .2s}.table-row[_ngcontent-%COMP%]:hover{background:#ffffff0d}.table-row[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.table-row[_ngcontent-%COMP%]   .percentage.warning[_ngcontent-%COMP%]{color:#f59e0b}.empty-history[_ngcontent-%COMP%]{padding:32px;text-align:center;color:var(--text-secondary, #888)}.alerts-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.alert-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#f59e0b1a;border-radius:12px;transition:opacity .2s}.alert-item.acknowledged[_ngcontent-%COMP%]{opacity:.5}.alert-icon[_ngcontent-%COMP%]{font-size:24px}.alert-content[_ngcontent-%COMP%]{flex:1}.alert-type[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:14px}.alert-message[_ngcontent-%COMP%]{font-size:13px;color:var(--text-secondary, #888)}.ack-btn[_ngcontent-%COMP%]{padding:6px 12px;background:#ffffff1a;border:none;border-radius:6px;color:#fff;font-size:12px;cursor:pointer}.check-btn[_ngcontent-%COMP%]{padding:8px 16px;background:#3b82f633;border:1px solid rgba(59,130,246,.3);border-radius:8px;color:#60a5fa;font-size:13px;cursor:pointer;transition:all .2s}.check-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#3b82f64d}.check-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.consistency-result[_ngcontent-%COMP%]{margin-top:16px}.consistency-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;border-radius:10px;font-size:14px}.consistency-status.ok[_ngcontent-%COMP%]{background:#22c55e1a;color:#22c55e}.consistency-status.mismatch[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b}.check-details[_ngcontent-%COMP%]{margin-top:12px;display:flex;flex-direction:column;gap:6px}.check-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 12px;background:#ffffff08;border-radius:6px;font-size:13px}.check-type[_ngcontent-%COMP%]{color:var(--text-secondary, #888);min-width:100px}.check-status.ok[_ngcontent-%COMP%]{color:#22c55e}.check-status.err[_ngcontent-%COMP%]{color:#f59e0b}.check-detail[_ngcontent-%COMP%]{color:var(--text-secondary, #666);margin-left:auto;font-size:12px}.check-time[_ngcontent-%COMP%]{margin-top:8px;font-size:12px;color:var(--text-muted, #555);text-align:right}.upgrade-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf61a,#3b82f61a);border:1px solid rgba(139,92,246,.3);border-radius:16px;padding:24px;display:flex;justify-content:space-between;align-items:center}.upgrade-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.upgrade-icon[_ngcontent-%COMP%]{font-size:48px}.upgrade-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:18px}.upgrade-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:var(--text-secondary, #888)}.upgrade-features[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px}.upgrade-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{font-size:13px;color:#22c55e}.upgrade-cta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:14px 28px;background:linear-gradient(135deg,#8b5cf6,#6366f1);border:none;border-radius:12px;color:#fff;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s}.upgrade-cta[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #8b5cf666}.upgrade-cta[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{transition:transform .2s}.upgrade-cta[_ngcontent-%COMP%]:hover   .arrow[_ngcontent-%COMP%]{transform:translate(4px)}@media(max-width:768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.quota-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.table-header[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{grid-template-columns:80px 1fr 60px 60px 60px;font-size:12px}.upgrade-section[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:20px}.upgrade-content[_ngcontent-%COMP%]{flex-direction:column}}"],changeDetection:0})}};export{L as QuotaDashboardViewComponent};
