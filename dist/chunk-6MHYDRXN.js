import{J as y,Wb as l,a as o,b as c,da as g}from"./chunk-MB4RORS3.js";var M={success:"\u2705",error:"\u274C",warning:"\u26A0\uFE0F",info:"\u2139\uFE0F",progress:"\u23F3"},x=class u{constructor(){this.toasts=g([]);this.toastIdCounter=0}getToasts(){return this.toasts}success(e,t=3e3){return this.show("success",e,t)}error(e,t=5e3){return this.show("error",e,t)}warning(e,t=4e3){return this.show("warning",e,t)}warningWithAction(e,t,s,a=0){return this.withActions("warning",e,[{label:t,handler:s,variant:"primary"},{label:"\u7A0D\u5F8C",handler:()=>{},variant:"secondary"}],a)}info(e,t=3e3){return this.show("info",e,t)}successWithNextStep(e,t,s){let a=`toast-${++this.toastIdCounter}`,i={id:a,type:"success",message:e,icon:"\u{1F389}",duration:5e3,timestamp:new Date,nextStep:{label:t,action:s},dismissible:!0};return this.toasts.update(n=>[...n,i]),setTimeout(()=>this.dismiss(a),5e3),a}withActions(e,t,s,a=0){let i=`toast-${++this.toastIdCounter}`,n={id:i,type:e,message:t,icon:M[e],duration:a>0?a:void 0,timestamp:new Date,actions:s,dismissible:!0};return this.toasts.update(d=>[...d,n]),a>0&&setTimeout(()=>this.dismiss(i),a),i}showProgress(e,t=0){let s=`toast-${++this.toastIdCounter}`,a={id:s,type:"progress",message:e,icon:"\u23F3",progress:t,timestamp:new Date,dismissible:!1};return this.toasts.update(i=>[...i,a]),s}updateProgress(e,t,s){this.toasts.update(a=>a.map(i=>i.id===e?c(o({},i),{progress:t,message:s||i.message,icon:t>=100?"\u2705":"\u23F3"}):i)),t>=100&&setTimeout(()=>this.dismiss(e),2e3)}configReminder(e,t){return this.withActions("warning",`\u914D\u7F6E\u672A\u5B8C\u6210\uFF1A${e}`,[{label:"\u7ACB\u5373\u8A2D\u7F6E",handler:t,variant:"primary"},{label:"\u7A0D\u5F8C",handler:()=>{},variant:"secondary"}],0)}operationResult(e,t,s){return e?this.success(t):this.error(s)}accountConnected(e){return this.successWithNextStep(`\u{1F517} ${e} \u5DF2\u9023\u63A5`,"\u8A2D\u70BA\u76E3\u807D\u5E33\u865F",()=>{})}accountDisconnected(e){return this.warning(`\u{1F4F4} ${e} \u5DF2\u65B7\u958B\u9023\u63A5`)}accountRoleChanged(e,t){let s=t==="Listener"?"\u{1F441}\uFE0F":t==="Sender"?"\u{1F4E4}":"\u{1F464}";return this.success(`${s} ${e} \u5DF2\u8A2D\u70BA${t==="Listener"?"\u76E3\u807D":t==="Sender"?"\u767C\u9001":"\u666E\u901A"}\u5E33\u865F`)}groupAdded(e){return this.successWithNextStep(`\u{1F4AC} \u5DF2\u6DFB\u52A0\u7FA4\u7D44\u300C${e}\u300D`,"\u7D81\u5B9A\u95DC\u9375\u8A5E\u96C6",()=>{})}groupRemoved(e){return this.success(`\u{1F5D1}\uFE0F \u5DF2\u79FB\u9664\u300C${e}\u300D`)}groupKeywordBound(e,t){return this.success(`\u{1F517} \u5DF2\u5C07\u300C${t}\u300D\u7D81\u5B9A\u5230\u300C${e}\u300D`)}keywordSetCreated(e){return this.successWithNextStep(`\u{1F511} \u8A5E\u96C6\u300C${e}\u300D\u5DF2\u5275\u5EFA`,"\u7D81\u5B9A\u5230\u7FA4\u7D44",()=>{})}keywordSetDeleted(e){return this.success(`\u{1F5D1}\uFE0F \u8A5E\u96C6\u300C${e}\u300D\u5DF2\u522A\u9664`)}monitoringStarted(){return this.success("\u{1F680} \u76E3\u63A7\u5DF2\u555F\u52D5\uFF0C\u7CFB\u7D71\u6B63\u5728\u5DE5\u4F5C\u4E2D...")}monitoringStopped(){return this.info("\u23F8\uFE0F \u76E3\u63A7\u5DF2\u66AB\u505C")}keywordMatched(e,t){return this.info(`\u{1F3AF} \u5728\u300C${t}\u300D\u5339\u914D\u5230\u95DC\u9375\u8A5E\u300C${e}\u300D`)}extractMembersStarted(e){return this.showProgress(`\u6B63\u5728\u63D0\u53D6\u300C${e}\u300D\u7684\u6210\u54E1...`,0)}extractMembersCompleted(e,t){return this.success(`\u2705 \u5DF2\u5F9E\u300C${t}\u300D\u63D0\u53D6 ${e} \u500B\u6210\u54E1`)}show(e,t,s=3e3){let a=`toast-${++this.toastIdCounter}`,i={id:a,type:e,message:t,icon:M[e],duration:s>0?s:void 0,timestamp:new Date,dismissible:!0};return this.toasts.update(n=>[...n,i]),s>0&&setTimeout(()=>{this.dismiss(a)},s),a}dismiss(e){this.toasts.update(t=>t.filter(s=>s.id!==e))}dismissAll(){this.toasts.set([])}static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275prov=y({token:u,factory:u.\u0275fac,providedIn:"root"})}};var r={bronze:{name:"\u9752\u9285\u6230\u58EB",icon:"\u2694\uFE0F",rank:1,monthlyPrice:0,yearlyPrice:0,quotas:{maxAccounts:2,dailyMessages:20,dailyAiCalls:10,maxGroups:3,maxKeywordSets:1,dataRetentionDays:7,platformApiQuota:0,platformApiMaxAccounts:0},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!1,hotLeads:!1,smartMode:!1,aiInsights:!1,dataExport:!1,batchOperations:!1,dataInsightsBasic:!1,strategyPlanning:!1,autoExecution:!1,dataInsightsAdvanced:!1,abTesting:!1,multiRole:!1,aiSalesFunnel:!1,advancedAnalytics:!1,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!1}},silver:{name:"\u767D\u9280\u7CBE\u82F1",icon:"\u{1F948}",rank:2,monthlyPrice:4.99,yearlyPrice:49.9,quotas:{maxAccounts:5,dailyMessages:100,dailyAiCalls:50,maxGroups:10,maxKeywordSets:5,dataRetentionDays:30,platformApiQuota:1,platformApiMaxAccounts:3},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!1,aiInsights:!1,dataExport:!1,batchOperations:!1,dataInsightsBasic:!1,strategyPlanning:!1,autoExecution:!1,dataInsightsAdvanced:!1,abTesting:!1,multiRole:!1,aiSalesFunnel:!1,advancedAnalytics:!1,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!1}},gold:{name:"\u9EC3\u91D1\u5927\u5E2B",icon:"\u{1F947}",rank:3,monthlyPrice:19.9,yearlyPrice:199,quotas:{maxAccounts:15,dailyMessages:500,dailyAiCalls:300,maxGroups:30,maxKeywordSets:20,dataRetentionDays:60,platformApiQuota:3,platformApiMaxAccounts:9},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!1,autoExecution:!1,dataInsightsAdvanced:!1,abTesting:!1,multiRole:!1,aiSalesFunnel:!1,advancedAnalytics:!1,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!1}},diamond:{name:"\u947D\u77F3\u738B\u724C",icon:"\u{1F48E}",rank:4,monthlyPrice:59.9,yearlyPrice:599,quotas:{maxAccounts:50,dailyMessages:2e3,dailyAiCalls:-1,maxGroups:100,maxKeywordSets:50,dataRetentionDays:90,platformApiQuota:10,platformApiMaxAccounts:30},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!0,autoExecution:!0,dataInsightsAdvanced:!0,abTesting:!0,multiRole:!0,aiSalesFunnel:!0,advancedAnalytics:!0,smartAntiBlock:!1,apiAccess:!1,teamManagement:!1,customBranding:!1,prioritySupport:!0}},star:{name:"\u661F\u8000\u50B3\u8AAA",icon:"\u{1F31F}",rank:5,monthlyPrice:199,yearlyPrice:1999,quotas:{maxAccounts:100,dailyMessages:1e4,dailyAiCalls:-1,maxGroups:300,maxKeywordSets:100,dataRetentionDays:180,platformApiQuota:30,platformApiMaxAccounts:90},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!0,autoExecution:!0,dataInsightsAdvanced:!0,abTesting:!0,multiRole:!0,aiSalesFunnel:!0,advancedAnalytics:!0,smartAntiBlock:!0,apiAccess:!0,teamManagement:!0,customBranding:!1,prioritySupport:!0}},king:{name:"\u69AE\u8000\u738B\u8005",icon:"\u{1F451}",rank:6,monthlyPrice:599,yearlyPrice:5999,quotas:{maxAccounts:-1,dailyMessages:-1,dailyAiCalls:-1,maxGroups:-1,maxKeywordSets:-1,dataRetentionDays:365,platformApiQuota:-1,platformApiMaxAccounts:-1},features:{accountManagement:!0,keywordMonitoring:!0,leadCapture:!0,aiAutoReply:!0,adBroadcast:!0,hotLeads:!0,smartMode:!0,aiInsights:!0,dataExport:!0,batchOperations:!0,dataInsightsBasic:!0,strategyPlanning:!0,autoExecution:!0,dataInsightsAdvanced:!0,abTesting:!0,multiRole:!0,aiSalesFunnel:!0,advancedAnalytics:!0,smartAntiBlock:!0,apiAccess:!0,teamManagement:!0,customBranding:!0,prioritySupport:!0}}},I=class u{constructor(){this.SKIP_LOGIN=!!window.electronAPI||!!window.electron;this.DEFAULT_LEVEL="king";this._membership=g(null);this._isLoading=g(!0);this.membership=l(()=>this._membership());this.isLoading=l(()=>this._isLoading());this.level=l(()=>{let e=this.SKIP_LOGIN?this.DEFAULT_LEVEL:"bronze",t=this._membership()?.level||e;return t in r?t:{free:"bronze",vip:"silver",svip:"diamond",mvp:"king"}[t]||e});this.levelName=l(()=>r[this.level()]?.name||(this.SKIP_LOGIN?"\u69AE\u8000\u738B\u8005":"\u9752\u9285\u6230\u58EB"));this.levelIcon=l(()=>r[this.level()]?.icon||(this.SKIP_LOGIN?"\u{1F451}":"\u2694\uFE0F"));this.levelRank=l(()=>r[this.level()]?.rank||(this.SKIP_LOGIN?6:1));this.isActive=l(()=>{let e=this._membership();return e?e.level==="bronze"||!e.expiresAt?!0:new Date<e.expiresAt:!1});this.daysRemaining=l(()=>{let e=this._membership();if(!e||!e.expiresAt||e.level==="bronze")return-1;let t=e.expiresAt.getTime()-Date.now();return Math.max(0,Math.ceil(t/(1e3*60*60*24)))});this.quotas=l(()=>{let e=this.isActive()?this.level():"bronze";return r[e].quotas});this.features=l(()=>{let e=this.isActive()?this.level():"bronze";return r[e].features});this.usage=l(()=>this._membership()?.usage||this.getDefaultUsage());this.loadMembership()}static{this.STORAGE_KEY="tg-matrix-membership"}static{this.USAGE_KEY="tg-matrix-usage"}static{this.TRIAL_DAYS=7}loadMembership(){try{let e=localStorage.getItem(u.STORAGE_KEY);if(e){let t=JSON.parse(e);t.expiresAt=t.expiresAt?new Date(t.expiresAt):void 0,t.activatedAt=t.activatedAt?new Date(t.activatedAt):void 0,this.SKIP_LOGIN&&t.level!==this.DEFAULT_LEVEL&&(console.log(`[MembershipService] \u514D\u767B\u9304\u6A21\u5F0F\uFF1A\u5F9E ${t.level} \u5347\u7D1A\u5230 ${this.DEFAULT_LEVEL}`),t.level=this.DEFAULT_LEVEL,t.levelName=r[this.DEFAULT_LEVEL].name,t.levelIcon=r[this.DEFAULT_LEVEL].icon,t.expiresAt=new Date(Date.now()+365*100*24*60*60*1e3),this.saveMembership(t)),this.checkAndResetDailyUsage(t),this._membership.set(t)}else this.initializeFreeMembership()}catch(e){console.error("Failed to load membership:",e),this.initializeFreeMembership()}finally{this._isLoading.set(!1)}}initializeFreeMembership(){let e=this.SKIP_LOGIN?this.DEFAULT_LEVEL:"bronze",t=r[e],s={level:e,levelName:t.name,levelIcon:t.icon,activatedAt:new Date,expiresAt:this.SKIP_LOGIN?new Date(Date.now()+365*100*24*60*60*1e3):void 0,machineId:this.getMachineId(),usage:this.getDefaultUsage(),inviteCode:this.generateInviteCode(),inviteCount:0,inviteRewards:0};console.log(`[MembershipService] \u521D\u59CB\u5316\u6703\u54E1: ${t.icon} ${t.name}`),this.saveMembership(s)}async activateMembership(e,t){let s=/^TGAI-([BGDSK][123YL]|EXT)-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/i,a=/^TGM-([BGDSK][123Y])-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/i,i=e.toUpperCase().match(s);if(i||(i=e.toUpperCase().match(a)),!i)return{success:!1,message:"\u2694\uFE0F \u5361\u5BC6\u683C\u5F0F\u4E0D\u6B63\u78BA\uFF0C\u8ACB\u6AA2\u67E5\u5F8C\u91CD\u8A66"};let n=i[1],d=n[0],p=n[1]||"2",h={B:"silver",G:"gold",D:"diamond",S:"star",K:"king",E:"gold"},v={1:7,2:30,3:90,Y:365,L:36500,X:30},A=h[d]||"silver",w=v[p]||30,f=this._membership(),m=new Date;f?.expiresAt&&f.expiresAt>new Date&&(m=new Date(f.expiresAt)),m.setDate(m.getDate()+w);let b=r[A],D=c(o({},f),{level:A,levelName:b.name,levelIcon:b.icon,expiresAt:m,activatedAt:new Date,licenseKey:e.toUpperCase(),email:t,machineId:this.getMachineId()});return this.saveMembership(D),{success:!0,message:`\u{1F389} ${b.icon} ${b.name} \u6FC0\u6D3B\u6210\u529F\uFF01\u6709\u6548\u671F\u81F3 ${m.toLocaleDateString()}`}}async applyInviteCode(e){if(!e||e.length!==8)return{success:!1,message:"\u9080\u8ACB\u78BC\u683C\u5F0F\u4E0D\u6B63\u78BA"};let t=this._membership();if(t?.invitedBy)return{success:!1,message:"\u60A8\u5DF2\u7D93\u4F7F\u7528\u904E\u9080\u8ACB\u78BC"};let s=new Date;s.setDate(s.getDate()+7);let a=c(o({},t),{level:"silver",levelName:r.silver.name,levelIcon:r.silver.icon,expiresAt:s,invitedBy:e});return this.saveMembership(a),{success:!0,message:"\u{1F381} \u9080\u8ACB\u78BC\u4F7F\u7528\u6210\u529F\uFF01\u7372\u5F97 7 \u5929\u767D\u9280\u7CBE\u82F1\u9AD4\u9A57"}}addInviteReward(e=3){let t=this._membership();if(!t)return;let s=t.expiresAt||new Date;s<new Date&&(s=new Date),s.setDate(s.getDate()+e);let a=c(o({},t),{expiresAt:s,inviteCount:(t.inviteCount||0)+1,inviteRewards:(t.inviteRewards||0)+e});a.level==="bronze"&&(a.level="silver",a.levelName=r.silver.name,a.levelIcon=r.silver.icon),this.saveMembership(a)}canAddAccount(e){let t=this.quotas().maxAccounts;return t===-1?{allowed:!0}:e>=t?{allowed:!1,message:`${this.levelIcon()} ${this.levelName()} \u6700\u591A\u652F\u6301 ${t} \u500B\u8CEC\u6236\uFF0C\u5347\u7D1A\u89E3\u9396\u66F4\u591A`}:{allowed:!0}}canSendMessage(){let e=this.quotas().dailyMessages;if(e===-1)return{allowed:!0,remaining:-1};let t=this.usage(),s=e-t.todayMessages;return s<=0?{allowed:!1,remaining:0,message:`\u4ECA\u65E5\u6D88\u606F\u914D\u984D\u5DF2\u7528\u5B8C (${e}\u689D)\uFF0C\u660E\u5929\u91CD\u7F6E\u6216\u5347\u7D1A\u6703\u54E1`}:{allowed:!0,remaining:s}}canUseAi(){let e=this.quotas().dailyAiCalls;if(e===-1)return{allowed:!0,remaining:-1};let t=this.usage(),s=e-t.todayAiCalls;return s<=0?{allowed:!1,remaining:0,message:`\u4ECA\u65E5AI\u914D\u984D\u5DF2\u7528\u5B8C (${e}\u6B21)\uFF0C\u660E\u5929\u91CD\u7F6E\u6216\u5347\u7D1A\u6703\u54E1`}:{allowed:!0,remaining:s}}hasFeature(e){return this.isActive()?this.features()[e]:r.bronze.features[e]}recordMessageSent(e=1){let t=this._membership();if(!t)return;let s=o({},t.usage);s.todayMessages+=e,s.totalMessages+=e,this.saveMembership(c(o({},t),{usage:s}))}recordAiCall(e=1){let t=this._membership();if(!t)return;let s=o({},t.usage);s.todayAiCalls+=e,s.totalAiCalls+=e,this.saveMembership(c(o({},t),{usage:s}))}recordLeadCaptured(e=1){let t=this._membership();if(!t)return;let s=o({},t.usage);s.totalLeads+=e,this.saveMembership(c(o({},t),{usage:s}))}getPricingPlans(){return[{level:"bronze",name:"\u2694\uFE0F \u9752\u9285\u6230\u58EB",icon:"\u2694\uFE0F",monthlyPrice:0,yearlyPrice:0,quotas:r.bronze.quotas,features:["2 \u500B\u8CEC\u6236","\u6BCF\u65E5 20 \u689D\u6D88\u606F","\u6BCF\u65E5 10 \u6B21 AI","3 \u500B\u7FA4\u7D44 / 1 \u500B\u95DC\u9375\u8A5E\u96C6","\u57FA\u790E\u76E3\u63A7\u529F\u80FD"]},{level:"silver",name:"\u{1F948} \u767D\u9280\u7CBE\u82F1",icon:"\u{1F948}",monthlyPrice:4.99,yearlyPrice:49.9,quotas:r.silver.quotas,features:["5 \u500B\u8CEC\u6236","\u6BCF\u65E5 100 \u689D\u6D88\u606F","\u6BCF\u65E5 50 \u6B21 AI","10 \u500B\u7FA4\u7D44 / 5 \u500B\u95DC\u9375\u8A5E\u96C6","\u5EE3\u544A\u767C\u9001\u529F\u80FD","\u71B1\u9580\u5BA2\u6236\u5206\u6790"]},{level:"gold",name:"\u{1F947} \u9EC3\u91D1\u5927\u5E2B",icon:"\u{1F947}",monthlyPrice:19.9,yearlyPrice:199,quotas:r.gold.quotas,recommended:!0,features:["15 \u500B\u8CEC\u6236","\u6BCF\u65E5 500 \u689D\u6D88\u606F / 300 \u6B21 AI","30 \u500B\u7FA4\u7D44 / 20 \u500B\u95DC\u9375\u8A5E\u96C6","\u{1F195} \u667A\u80FD\u6A21\u5F0F\u5100\u8868\u76E4","\u{1F195} AI \u667A\u80FD\u6D1E\u5BDF","\u6578\u64DA\u5C0E\u51FA + \u6279\u91CF\u64CD\u4F5C"]},{level:"diamond",name:"\u{1F48E} \u947D\u77F3\u738B\u724C",icon:"\u{1F48E}",monthlyPrice:59.9,yearlyPrice:599,quotas:r.diamond.quotas,features:["50 \u500B\u8CEC\u6236","\u6BCF\u65E5 2000 \u689D\u6D88\u606F / \u7121\u9650 AI","100 \u500B\u7FA4\u7D44 / 50 \u500B\u95DC\u9375\u8A5E\u96C6","\u{1F195} AI \u7B56\u7565\u898F\u5283","\u{1F195} AI \u81EA\u52D5\u57F7\u884C","\u591A\u89D2\u8272\u5354\u4F5C + A/B\u6E2C\u8A66"]},{level:"star",name:"\u{1F31F} \u661F\u8000\u50B3\u8AAA",icon:"\u{1F31F}",monthlyPrice:199,yearlyPrice:1999,quotas:r.star.quotas,features:["100 \u500B\u8CEC\u6236","\u6BCF\u65E5 10000 \u689D\u6D88\u606F / \u7121\u9650 AI","300 \u500B\u7FA4\u7D44 / 100 \u500B\u95DC\u9375\u8A5E\u96C6","API \u63A5\u53E3","\u5718\u968A\u7BA1\u7406","\u667A\u80FD\u9632\u5C01","\u512A\u5148\u652F\u6301"]},{level:"king",name:"\u{1F451} \u69AE\u8000\u738B\u8005",icon:"\u{1F451}",monthlyPrice:599,yearlyPrice:5999,quotas:r.king.quotas,features:["\u7121\u9650\u8CEC\u6236 / \u6D88\u606F / AI","\u7121\u9650\u7FA4\u7D44 / \u95DC\u9375\u8A5E\u96C6 / \u898F\u5247","\u6240\u6709\u529F\u80FD\u5168\u90E8\u89E3\u9396","\u81EA\u5B9A\u7FA9\u54C1\u724C","1\u5C0D1 \u5C08\u5C6C\u9867\u554F","\u65B0\u529F\u80FD\u5167\u6E2C\u9AD4\u9A57"]}]}getUpgradeSuggestion(){let e=this.level(),s={bronze:"silver",silver:"gold",gold:"diamond",diamond:"star",star:"king",king:null}[e];if(!s)return null;let a=r[e],i=r[s],n=[],d=a.quotas.maxAccounts===-1?"\u7121\u9650":a.quotas.maxAccounts,p=i.quotas.maxAccounts===-1?"\u7121\u9650":i.quotas.maxAccounts;p!==d&&n.push(`\u8CEC\u6236\u6578\u91CF ${d} \u2192 ${p}`);let h=a.quotas.dailyMessages===-1?"\u7121\u9650":a.quotas.dailyMessages,v=i.quotas.dailyMessages===-1?"\u7121\u9650":i.quotas.dailyMessages;return v!==h&&n.push(`\u6BCF\u65E5\u6D88\u606F ${h} \u2192 ${v}`),i.quotas.dailyAiCalls===-1&&a.quotas.dailyAiCalls!==-1&&n.push(`AI \u8ABF\u7528 ${a.quotas.dailyAiCalls} \u2192 \u7121\u9650`),i.features.adBroadcast&&!a.features.adBroadcast&&n.push("\u26A1 \u89E3\u9396\u5EE3\u544A\u767C\u9001"),i.features.multiRole&&!a.features.multiRole&&n.push("\u{1F3AD} \u89E3\u9396\u591A\u89D2\u8272\u5354\u4F5C"),i.features.aiSalesFunnel&&!a.features.aiSalesFunnel&&n.push("\u{1F3AF} \u89E3\u9396 AI \u92B7\u552E\u6F0F\u6597"),i.features.smartAntiBlock&&!a.features.smartAntiBlock&&n.push("\u{1F6E1}\uFE0F \u89E3\u9396\u667A\u80FD\u9632\u5C01"),i.features.apiAccess&&!a.features.apiAccess&&n.push("\u{1F50C} \u89E3\u9396 API \u63A5\u53E3"),{nextLevel:s,benefits:n,price:i.monthlyPrice}}saveMembership(e){this._membership.set(e),localStorage.setItem(u.STORAGE_KEY,JSON.stringify(e))}getMachineId(){let e=localStorage.getItem("tg-matrix-machine-id");return e||(e="mid-"+this.generateId(),localStorage.setItem("tg-matrix-machine-id",e)),e}generateId(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}generateInviteCode(){return this.generateId().substring(0,8).toUpperCase()}getDefaultUsage(){return{todayMessages:0,todayAiCalls:0,todayDate:new Date().toDateString(),totalMessages:0,totalAiCalls:0,totalLeads:0}}checkAndResetDailyUsage(e){let t=new Date().toDateString();e.usage.todayDate!==t&&(e.usage.todayMessages=0,e.usage.todayAiCalls=0,e.usage.todayDate=t)}getStatusText(){let e=this._membership();if(!e)return"\u672A\u77E5";if(e.level==="bronze")return`${e.levelIcon} ${e.levelName}`;if(!this.isActive())return`${e.levelIcon} ${e.levelName} (\u5DF2\u904E\u671F)`;let t=this.daysRemaining();return t<=7?`${e.levelIcon} ${e.levelName} (${t}\u5929\u5F8C\u5230\u671F)`:`${e.levelIcon} ${e.levelName}`}getRankDisplay(){let e=this.level(),t=r[e],s={bronze:"#CD7F32",silver:"#C0C0C0",gold:"#FFD700",diamond:"#B9F2FF",star:"#9B59B6",king:"#FF6B6B"};return{name:t.name,icon:t.icon,rank:t.rank,color:s[e]}}getUsagePercentage(){let e=this.quotas(),t=this.usage();return{messages:e.dailyMessages===-1?0:Math.min(100,t.todayMessages/e.dailyMessages*100),ai:e.dailyAiCalls===-1?0:Math.min(100,t.todayAiCalls/e.dailyAiCalls*100)}}static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275prov=y({token:u,factory:u.\u0275fac,providedIn:"root"})}};export{x as a,I as b};
