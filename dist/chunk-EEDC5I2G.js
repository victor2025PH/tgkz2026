import{s as Ee,y as Te}from"./chunk-BDXALK3H.js";import"./chunk-E5JAB72H.js";import"./chunk-A22KDSKM.js";import"./chunk-LAYKK35A.js";import{a as ee}from"./chunk-M2VKGXCG.js";import{b as te}from"./chunk-5UHDXNYI.js";import{a as De,b as Z}from"./chunk-7LTHB4NI.js";import"./chunk-SIDS6FGB.js";import{a as U}from"./chunk-5HHK7KPZ.js";import{b as ve,c as Ce,f as fe,k as be,l as ye,m as Se,t as Y}from"./chunk-FZJM4IRN.js";import{b as we}from"./chunk-CIOQN4KY.js";import"./chunk-B2KG2WNU.js";import"./chunk-TMNXXRHZ.js";import{f as he}from"./chunk-K5SU4RX2.js";import{$b as J,Aa as l,Ab as E,Bb as s,Cb as D,Db as v,Eb as ae,Ib as le,Jb as ce,Kb as ue,M as de,Na as G,Qb as pe,R as M,Sb as K,Tb as z,Ub as _e,W as p,X as _,Zb as k,a as P,ac as $,b as N,cb as x,db as g,fb as L,ga as f,gb as V,hb as B,ia as me,ib as w,jb as r,kb as n,lb as H,pb as S,rb as m,rc as xe,sc as ge,tb as c,uc as X,wa as q,zb as se}from"./chunk-PDD6YQ47.js";var Fe="tg-operation-history",ie=200,ne=class i{constructor(){this.ipc=M(U);this._records=f([]);this.records=this._records.asReadonly();this.recentRecords=k(()=>this._records().slice(0,20));this.successCount=k(()=>this._records().filter(t=>t.status==="success").length);this.failedCount=k(()=>this._records().filter(t=>t.status==="failed").length);this.todayRecords=k(()=>{let t=new Date;t.setHours(0,0,0,0);let e=t.getTime();return this._records().filter(o=>o.timestamp>=e)});this.statsByType=k(()=>{let t={join:{total:0,success:0,failed:0},monitor:{total:0,success:0,failed:0},extract:{total:0,success:0,failed:0},search:{total:0,success:0,failed:0},remove:{total:0,success:0,failed:0}};for(let e of this._records()){let o=t[e.type];o&&(o.total++,e.status==="success"&&o.success++,e.status==="failed"&&o.failed++)}return t});this.pendingOps=new Map;this.cleanupFns=[];this.loadFromStorage(),this.setupEventListeners()}startOperation(t,e){let o=`op-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,a=N(P({id:o,type:t,status:"pending"},e),{timestamp:Date.now()});return this.pendingOps.set(o,{record:a,startTime:Date.now()}),this._records.update(u=>[a,...u].slice(0,ie)),o}completeOperation(t,e){let o=this.pendingOps.get(t),a=o?Date.now()-o.startTime:void 0;this._records.update(u=>u.map(h=>h.id===t?N(P({},h),{status:e.success?"success":"failed",details:e.details,errorCode:e.errorCode,errorMessage:e.errorMessage,memberCount:e.memberCount,duration:a}):h)),this.pendingOps.delete(t),this.saveToStorage()}addRecord(t,e){let o={id:`op-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,type:t,status:e.success?"success":"failed",resourceId:e.resourceId,resourceTitle:e.resourceTitle,resourceUsername:e.resourceUsername,phone:e.phone,details:e.details,errorCode:e.errorCode,errorMessage:e.errorMessage,memberCount:e.memberCount,timestamp:Date.now()};this._records.update(a=>[o,...a].slice(0,ie)),this.saveToStorage()}getByResource(t){return this._records().filter(e=>String(e.resourceId)===String(t))}clear(){this._records.set([]),this.saveToStorage()}getTypeLabel(t){return{join:"\u52A0\u5165\u7FA4\u7D44",monitor:"\u52A0\u5165\u76E3\u63A7",extract:"\u63D0\u53D6\u6210\u54E1",search:"\u641C\u7D22\u767C\u73FE",remove:"\u79FB\u9664\u7FA4\u7D44"}[t]||t}getStatusIcon(t){return{pending:"\u23F3",success:"\u2705",failed:"\u274C"}[t]||"\u2753"}setupEventListeners(){this.cleanupFns.push(this.ipc.on("join-and-monitor-complete",t=>{this.addRecord(t.monitored?"monitor":"join",{resourceId:t.resourceId,resourceTitle:t.title,success:t.success===!0,errorMessage:t.error,details:t.success?`${t.monitored?"\u76E3\u63A7":"\u52A0\u5165"}\u6210\u529F (${t.memberCount||0} \u6210\u54E1)`:void 0})})),this.cleanupFns.push(this.ipc.on("resource-status-updated",t=>{t.newStatus==="monitoring"&&this.addRecord("monitor",{resourceId:t.resourceId,resourceUsername:t.username,success:!0,details:"\u5DF2\u6DFB\u52A0\u5230\u76E3\u63A7\u5217\u8868"})})),this.cleanupFns.push(this.ipc.on("members-extracted",t=>{this.addRecord("extract",{resourceId:t.resourceId,success:t.success===!0,memberCount:t.extracted||0,errorCode:t.error_code,errorMessage:t.error,details:t.success?`\u63D0\u53D6 ${t.extracted||0} \u6210\u54E1 (\u7E3D\u8A08 ${t.total||0})`:void 0})})),this.cleanupFns.push(this.ipc.on("monitored-group-added",t=>{this.addRecord("monitor",{resourceTitle:t.name,resourceUsername:t.username,success:t.success===!0,errorMessage:t.error,details:t.success?`\u5DF2\u6DFB\u52A0\u300C${t.name||t.username||""}\u300D\u5230\u76E3\u63A7\u5217\u8868`:`\u6DFB\u52A0\u5931\u6557: ${t.error||"\u672A\u77E5\u932F\u8AA4"}`})})),this.cleanupFns.push(this.ipc.on("group-removed",t=>{this.addRecord("remove",{success:t.success!==!1,details:t.success!==!1?"\u5DF2\u79FB\u9664\u7FA4\u7D44":`\u79FB\u9664\u5931\u6557: ${t.error}`,errorMessage:t.error})}))}loadFromStorage(){try{let t=localStorage.getItem(Fe);if(t){let e=JSON.parse(t);this._records.set(e.slice(0,ie))}}catch(t){console.warn("[OperationHistory] Failed to load from storage:",t)}}saveToStorage(){try{let t=this._records();localStorage.setItem(Fe,JSON.stringify(t.slice(0,ie)))}catch(t){console.warn("[OperationHistory] Failed to save to storage:",t)}}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=de({token:i,factory:i.\u0275fac,providedIn:"root"})}};var Ae=()=>[1,2,3,4,5],re=(i,t)=>t.id;function Ve(i,t){return this.getResourceTrackId(t,i)}function Be(i,t){if(i&1){let e=S();r(0,"button",42),m("click",function(){let a=p(e).$implicit,u=c(3);return _(u.selectAccount(a))}),H(1,"span",36),r(2,"span",43),s(3),n()()}if(i&2){let e=t.$implicit;l(),se("bg-green-400",e.status==="Online")("bg-slate-400",e.status!=="Online"),l(2),D(e.phone)}}function je(i,t){if(i&1&&(r(0,"div",39)(1,"div",40),V(2,Be,4,5,"button",41,re),n()()),i&2){let e=c(2);l(2),B(e.mergedAccounts())}}function Pe(i,t){if(i&1){let e=S();r(0,"div",11)(1,"button",35),m("click",function(){p(e);let a=c();return _(a.showAccountSelector.set(!a.showAccountSelector()))}),H(2,"span",36),r(3,"span",37),s(4),n(),r(5,"span",38),s(6,"\u25BC"),n()(),x(7,je,4,0,"div",39),n()}if(i&2){let e=t,o=c();l(2),se("bg-green-400",e.status==="Online")("bg-slate-400",e.status!=="Online"),l(2),D(e.phone),l(3),g(o.showAccountSelector()?7:-1)}}function Ne(i,t){i&1&&(r(0,"span",12),s(1,"\u26A0\uFE0F \u7121\u53EF\u7528\u5E33\u865F"),n())}function $e(i,t){i&1&&(r(0,"span",13),s(1," \u{1F504} \u641C\u7D22\u4E2D... "),n())}function Oe(i,t){i&1&&(r(0,"span",14),s(1," \u2705 \u5C31\u7DD2 "),n())}function He(i,t){if(i&1&&(r(0,"span",56),s(1),n()),i&2){let e=c().$implicit;l(),v("",e.memberCount,"\u4EBA")}}function Je(i,t){if(i&1&&(r(0,"span",57),s(1),n()),i&2){let e=c().$implicit;w("title",e.errorMessage),l(),D(e.errorMessage)}}function Le(i,t){if(i&1&&(r(0,"div",52)(1,"span"),s(2),n(),r(3,"span",54),s(4),n(),r(5,"span",55),s(6),n(),x(7,He,2,1,"span",56),x(8,Je,2,2,"span",57),r(9,"span",58),s(10),n()()),i&2){let e=t.$implicit,o=c(2);l(2),D(o.opHistory.getStatusIcon(e.status)),l(2),D(o.opHistory.getTypeLabel(e.type)),l(2),D(e.resourceTitle||e.resourceUsername||"\u672A\u77E5"),l(),g(e.memberCount?7:-1),l(),g(e.errorMessage?8:-1),l(2),D(o.formatTime(e.timestamp))}}function Ke(i,t){i&1&&(r(0,"div",53),s(1,"\u4ECA\u5929\u9084\u6C92\u6709\u64CD\u4F5C\u8A18\u9304"),n())}function ze(i,t){if(i&1){let e=S();r(0,"div",15)(1,"div",44)(2,"div",45)(3,"div",46)(4,"span",47),s(5,"\u{1F4CB} \u4ECA\u65E5\u64CD\u4F5C\u8A18\u9304"),n(),r(6,"span",48),s(7),n(),r(8,"span",49),s(9),n()(),r(10,"button",50),m("click",function(){p(e);let a=c();return _(a.showOperationHistory.set(!1))}),s(11,"\u2715"),n()(),r(12,"div",51),V(13,Le,11,6,"div",52,re),x(15,Ke,2,0,"div",53),n()()()}if(i&2){let e=c();l(7),v(" \u2705 ",e.opHistory.statsByType().join.success+e.opHistory.statsByType().monitor.success+e.opHistory.statsByType().extract.success," "),l(2),v(" \u274C ",e.opHistory.statsByType().join.failed+e.opHistory.statsByType().monitor.failed+e.opHistory.statsByType().extract.failed," "),l(4),B(e.opHistory.todayRecords().slice(0,10)),l(2),g(e.opHistory.todayRecords().length===0?15:-1)}}function Ue(i,t){if(i&1){let e=S();r(0,"button",65),m("mousedown",function(){let a=p(e).$implicit,u=c(3);return _(u.quickSearch(a))}),s(1),n()}if(i&2){let e=t.$implicit;l(),v(" ",e," ")}}function Qe(i,t){if(i&1&&(r(0,"div",59)(1,"div",61),s(2,"\u{1F550} \u6700\u8FD1\u641C\u7D22"),n(),r(3,"div",62),V(4,Ue,2,1,"button",64,L),n()()),i&2){let e=c(2);l(4),B(e.mergedHistoryKeywords().slice(0,5))}}function qe(i,t){if(i&1){let e=S();r(0,"button",66),m("mousedown",function(){let a=p(e).$implicit,u=c(2);return _(u.quickSearch(a))}),s(1),n()}if(i&2){let e=t.$implicit;l(),v(" ",e," ")}}function We(i,t){if(i&1&&(r(0,"div",21),x(1,Qe,6,0,"div",59),r(2,"div",60)(3,"div",61),s(4,"\u{1F525} \u71B1\u9580\u641C\u7D22"),n(),r(5,"div",62),V(6,qe,2,1,"button",63,L),n()()()),i&2){let e=c();l(),g(e.mergedHistoryKeywords().length>0?1:-1),l(5),B(e.hotKeywords)}}function Ge(i,t){if(i&1&&(r(0,"span",71),s(1),n()),i&2){let e=c().$implicit;E(e.tagClass),l(),D(e.tag)}}function Xe(i,t){if(i&1){let e=S();r(0,"label",67)(1,"input",68),m("change",function(){let a=p(e).$implicit,u=c();return _(u.toggleSource(a.id))}),n(),r(2,"span"),s(3),n(),r(4,"span",69),s(5),n(),x(6,Ge,2,3,"span",70),n()}if(i&2){let e=t.$implicit,o=c();E(e.disabled?"bg-slate-800/50 border border-slate-700/30 cursor-not-allowed opacity-50":o.selectedSources().includes(e.id)?"bg-cyan-500/20 border border-cyan-500/50 cursor-pointer":"bg-slate-700/30 border border-slate-700 hover:bg-slate-700/50 cursor-pointer"),w("title",e.disabled?"\u8A72\u529F\u80FD\u6B63\u5728\u958B\u767C\u4E2D\uFF0C\u656C\u8ACB\u671F\u5F85":""),l(),w("checked",o.selectedSources().includes(e.id))("disabled",e.disabled),l(2),D(e.icon),l(2),D(e.name),l(),g(e.tag?6:-1)}}function Ye(i,t){if(i&1&&(r(0,"div",26)(1,"span",86),s(2,"\u7576\u524D\u641C\u7D22\uFF1A"),n(),r(3,"span",87),s(4),n()()),i&2){let e=c(2);l(4),v(" \u{1F50D} ",e.currentKeyword()," ")}}function Ze(i,t){if(i&1&&(r(0,"span",88),s(1),n(),r(2,"span",89),s(3),n()),i&2){let e=c(2);l(),v("\u{1F195} ",e.newDiscoveredCount()," \u500B\u65B0\u767C\u73FE"),l(2),v("\u{1F504} ",e.existingCount()," \u500B\u5DF2\u77E5")}}function et(i,t){if(i&1&&(r(0,"span",74)(1,"span",90),s(2,"\u23F3"),n(),s(3),n()),i&2){let e=c(2);l(3),v(" ",e.searchProgress()," ")}}function tt(i,t){i&1&&(r(0,"span",75)(1,"span",91),s(2,"\u{1F4CA}"),n(),s(3," \u6B63\u5728\u7372\u53D6\u6210\u54E1\u6578\u7B49\u8A73\u60C5... "),n())}function it(i,t){if(i&1&&(r(0,"span",81),s(1),n()),i&2){let e=c(2);l(),v(" ",e.activeFilterCount()," ")}}function nt(i,t){if(i&1){let e=S();r(0,"div",84)(1,"div")(2,"label",92),s(3,"\u6210\u54E1\u6578\u7BC4\u570D"),n(),r(4,"div",26)(5,"input",93),m("change",function(a){p(e);let u=c(2);return _(u.filterMemberMin.set(a.target.value?+a.target.value:null))}),n(),r(6,"span",94),s(7,"-"),n(),r(8,"input",95),m("change",function(a){p(e);let u=c(2);return _(u.filterMemberMax.set(a.target.value?+a.target.value:null))}),n()()(),r(9,"div")(10,"label",92),s(11,"\u4F86\u6E90\u6E20\u9053"),n(),r(12,"select",96),m("change",function(a){p(e);let u=c(2);return _(u.filterSource.set(a.target.value))}),r(13,"option",77),s(14,"\u5168\u90E8\u4F86\u6E90"),n(),r(15,"option",97),s(16,"TG \u5B98\u65B9"),n(),r(17,"option",98),s(18,"\u4E2D\u6587\u641C\u7D22"),n(),r(19,"option",99),s(20,"\u672C\u5730\u7D22\u5F15"),n()()(),r(21,"div")(22,"label",92),s(23,"\u52A0\u5165\u72C0\u614B"),n(),r(24,"select",96),m("change",function(a){p(e);let u=c(2);return _(u.filterJoinStatus.set(a.target.value))}),r(25,"option",77),s(26,"\u5168\u90E8\u72C0\u614B"),n(),r(27,"option",100),s(28,"\u76E3\u63A7\u4E2D"),n(),r(29,"option",101),s(30,"\u5DF2\u52A0\u5165"),n(),r(31,"option",102),s(32,"\u672A\u52A0\u5165"),n()()(),r(33,"div")(34,"label",92),s(35,"\u5176\u4ED6\u9078\u9805"),n(),r(36,"div",3)(37,"label",103)(38,"input",104),m("change",function(a){p(e);let u=c(2);return _(u.filterHasId.set(a.target.checked))}),n(),r(39,"span",105),s(40,"\u53EA\u986F\u793A\u6709 ID"),n()(),r(41,"button",106),m("click",function(){p(e);let a=c(2);return _(a.resetFilters())}),s(42," \u91CD\u7F6E\u7BE9\u9078 "),n()()()()}if(i&2){let e=c(2);l(5),w("value",e.filterMemberMin()||""),l(3),w("value",e.filterMemberMax()||""),l(4),w("value",e.filterSource()),l(12),w("value",e.filterJoinStatus()),l(14),w("checked",e.filterHasId())}}function ot(i,t){if(i&1){let e=S();r(0,"div",109)(1,"span",110),s(2),n(),H(3,"div",111),r(4,"button",112),m("click",function(){p(e);let a=c(3);return _(a.batchSaveSelected())}),s(5," \u2B50 \u6536\u85CF\u9078\u4E2D "),n(),r(6,"button",113),m("click",function(){p(e);let a=c(3);return _(a.copySelectedIds())}),s(7," \u{1F4CB} \u8907\u88FDID "),n(),r(8,"button",114),m("click",function(){p(e);let a=c(3);return _(a.batchExtractSelected())}),s(9," \u{1F465} \u6279\u91CF\u63D0\u53D6\u6210\u54E1 "),n(),r(10,"button",115),m("click",function(){p(e);let a=c(3);return _(a.batchAddToMonitoring())}),s(11," \u{1F4E1} \u6279\u91CF\u76E3\u63A7 "),n()()}if(i&2){let e=c(3);l(2),v(" \u2713 \u5DF2\u9078 ",e.selectedCount()," \u9805 ")}}function rt(i,t){if(i&1){let e=S();r(0,"div",85)(1,"div",107)(2,"span",86),s(3,"\u6279\u91CF\u64CD\u4F5C:"),n(),r(4,"button",108),m("click",function(){p(e);let a=c(2);return _(a.selectAllVisible())}),s(5," \u2611\uFE0F \u5168\u9078\u672C\u9801 "),n(),r(6,"button",108),m("click",function(){p(e);let a=c(2);return _(a.clearSelection())}),s(7," \u2610 \u53D6\u6D88\u5168\u9078 "),n(),r(8,"button",108),m("click",function(){p(e);let a=c(2);return _(a.invertSelection())}),s(9," \u21C6 \u53CD\u9078 "),n()(),x(10,ot,12,1,"div",109),n()}if(i&2){let e=c(2);l(10),g(e.selectedCount()>0?10:-1)}}function st(i,t){if(i&1){let e=S();r(0,"div",29)(1,"div",2)(2,"div",3),x(3,Ye,5,1,"div",26),r(4,"span",72),s(5," \u5171 "),r(6,"span",73),s(7),n(),s(8," \u500B\u7D50\u679C "),x(9,Ze,4,2),n(),x(10,et,4,1,"span",74),x(11,tt,4,0,"span",75),n(),r(12,"div",26)(13,"select",76),ue("ngModelChange",function(a){p(e);let u=c();return ce(u.filterType,a)||(u.filterType=a),_(a)}),r(14,"option",77),s(15,"\u5168\u90E8\u985E\u578B"),n(),r(16,"option",78),s(17,"\u7FA4\u7D44"),n(),r(18,"option",79),s(19,"\u983B\u9053"),n()(),r(20,"button",80),m("click",function(){p(e);let a=c();return _(a.showAdvancedFilter.set(!a.showAdvancedFilter()))}),s(21," \u{1F39B}\uFE0F \u9AD8\u7D1A\u7BE9\u9078 "),x(22,it,2,1,"span",81),n(),r(23,"button",82),m("click",function(){p(e);let a=c();return _(a.batchSave())}),s(24," \u2B50 \u6279\u91CF\u6536\u85CF "),n(),r(25,"button",83),m("click",function(){p(e);let a=c();return _(a.exportResults())}),s(26),n()()(),x(27,nt,43,5,"div",84),x(28,rt,11,1,"div",85),n()}if(i&2){let e=c();l(3),g(e.currentKeyword()?3:-1),l(4),D(e.mergedResources().length),l(2),g(e.newDiscoveredCount()>0||e.existingCount()>0?9:-1),l(),g(e.searchProgress()?10:-1),l(),g(e.isFetchingDetails()?11:-1),l(2),le("ngModel",e.filterType),l(7),E(e.showAdvancedFilter()||e.activeFilterCount()>0?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/50":"bg-slate-700/50 text-slate-300 border border-slate-700 hover:border-slate-600"),l(2),g(e.activeFilterCount()>0?22:-1),l(3),E(e.filteredResources().length>0?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-slate-600/30 text-slate-500 cursor-not-allowed"),w("disabled",e.filteredResources().length===0),l(),v(" \u{1F4E4} \u5C0E\u51FA\u5168\u90E8 (",e.filteredResources().length,") "),l(),g(e.showAdvancedFilter()?27:-1),l(),g(e.filteredResources().length>0?28:-1)}}function at(i,t){i&1&&(r(0,"div",116)(1,"div",117),H(2,"div",118),r(3,"div",119),H(4,"div",120)(5,"div",121)(6,"div",122),n()()())}function lt(i,t){i&1&&(r(0,"div",31),V(1,at,7,0,"div",116,L),n()),i&2&&(l(),B(pe(0,Ae)))}function ct(i,t){if(i&1){let e=S();r(0,"div",123)(1,"div",124),s(2,"\u26A0\uFE0F"),n(),r(3,"p",125),s(4,"\u641C\u7D22\u5931\u6557"),n(),r(5,"p",126),s(6),n(),r(7,"button",127),m("click",function(){p(e);let a=c(2);return _(a.doSearch())}),s(8," \u{1F504} \u91CD\u8A66 "),n()()}if(i&2){let e=c(2);l(6),D(e.mergedSearchError().message)}}function ut(i,t){if(i&1){let e=S();r(0,"button",133),m("click",function(){let a=p(e).$implicit,u=c(3);return _(u.quickSearch(a))}),s(1),n()}if(i&2){let e=t.$implicit;l(),v(" ",e," ")}}function dt(i,t){if(i&1&&(r(0,"div",124),s(1,"\u{1F50D}"),n(),r(2,"p",128),s(3,"\u958B\u59CB\u641C\u7D22\u767C\u73FE\u7FA4\u7D44"),n(),r(4,"p",129),s(5,"\u8F38\u5165\u95DC\u9375\u8A5E\u641C\u7D22 Telegram \u7FA4\u7D44\u548C\u983B\u9053"),n(),r(6,"div",130)(7,"span",131),s(8,"\u8A66\u8A66\uFF1A"),n(),V(9,ut,2,1,"button",132,L),n()),i&2){let e=c(2);l(9),B(e.hotKeywords.slice(0,5))}}function mt(i,t){if(i&1&&(r(0,"div",32),x(1,ct,9,1,"div",123)(2,dt,11,0),n()),i&2){let e=c();l(),g(e.mergedSearchError().hasError?1:2)}}function pt(i,t){if(i&1&&(r(0,"option",138),s(1),n()),i&2){let e=t.$implicit;w("value",e),l(),D(e)}}function _t(i,t){i&1&&(r(0,"span",148),s(1,"\u2713"),n())}function xt(i,t){i&1&&(r(0,"span",153),s(1," \u25CF \u76E3\u63A7\u4E2D "),n())}function gt(i,t){i&1&&(r(0,"span",154),s(1," \u25CF \u5DF2\u52A0\u5165 "),n())}function ht(i,t){i&1&&(r(0,"span",155),s(1," \u25CF \u5DF2\u66AB\u505C "),n())}function vt(i,t){i&1&&(r(0,"span",156),s(1," \u{1F195} \u65B0\u767C\u73FE "),n())}function Ct(i,t){i&1&&(r(0,"span",157),s(1," \u{1F504} \u5DF2\u77E5 "),n())}function ft(i,t){if(i&1){let e=S();r(0,"a",176),m("click",function(a){return p(e),_(a.stopPropagation())}),s(1),n()}if(i&2){let e=c().$implicit;w("href","https://t.me/"+e.username,q),l(),v(" @",e.username," ")}}function bt(i,t){if(i&1){let e=S();r(0,"code",177),s(1),n(),r(2,"button",178),m("click",function(a){p(e);let u=c().$implicit,h=c(2);return _(h.copyId(u,a))}),s(3),n()}if(i&2){let e=c().$implicit,o=c(2);l(),D(e.telegram_id),l(),E(o.copiedId()===e.telegram_id?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400 hover:bg-cyan-500/20 hover:text-cyan-400"),l(),v(" ",o.copiedId()===e.telegram_id?"\u2713 \u5DF2\u8907\u88FD":"\u{1F4CB} \u8907\u88FD"," ")}}function yt(i,t){if(i&1&&(r(0,"code",179),s(1),n(),r(2,"span",180),s(3," \u26A0\uFE0F \u9700\u52A0\u5165\u7372\u53D6 "),n()),i&2){let e=c().$implicit;l(),v("@",e.username)}}function St(i,t){i&1&&(r(0,"span",131),s(1,"\u9700\u901A\u904E\u9080\u8ACB\u93C8\u63A5\u52A0\u5165"),n())}function Dt(i,t){if(i&1){let e=S();r(0,"span",181),s(1,"|"),n(),r(2,"button",182),m("click",function(a){p(e);let u=c().$implicit,h=c(2);return _(h.copyLink(u,a))}),s(3),n()}if(i&2){let e=c().$implicit,o=c(2);l(2),E(o.copiedLink()===e.username?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400 hover:bg-cyan-500/20 hover:text-cyan-400"),l(),v(" ",o.copiedLink()===e.username?"\u2713 \u5DF2\u8907\u88FD":"\u{1F517} \u8907\u88FD\u9023\u7D50"," ")}}function wt(i,t){if(i&1&&(r(0,"p",161),s(1),n()),i&2){let e=c().$implicit;l(),D(e.description)}}function Et(i,t){if(i&1&&(r(0,"span",166),s(1),K(2,"number"),n()),i&2){let e=c().$implicit;l(),v(" \u{1F4C8} +",z(2,1,e.member_change)," ")}}function Tt(i,t){if(i&1&&(r(0,"span",167),s(1),K(2,"number"),n()),i&2){let e=c().$implicit;l(),v(" \u{1F4C9} ",z(2,1,e.member_change)," ")}}function Ft(i,t){i&1&&(r(0,"span",183),s(1,"\u2B50\u2B50\u2B50"),n(),r(2,"span",184),s(3,"\u9AD8\u5EA6\u76F8\u95DC"),n())}function kt(i,t){i&1&&(r(0,"span",183),s(1,"\u2B50\u2B50"),n(),r(2,"span",10),s(3,"\u4E2D\u5EA6\u76F8\u95DC"),n())}function It(i,t){i&1&&(r(0,"span",183),s(1,"\u2B50"),n(),r(2,"span",94),s(3,"\u4E00\u822C\u76F8\u95DC"),n())}function Rt(i,t){if(i&1&&(r(0,"span",170),s(1),n()),i&2){let e=c().$implicit,o=c(2);l(),v(" ",o.getSourceLabel(e.discovery_source)," ")}}function Mt(i,t){i&1&&(r(0,"span",48),s(1,"\u25CF \u76E3\u63A7\u4E2D"),n())}function At(i,t){i&1&&(r(0,"span",171),s(1,"\u2713 \u5DF2\u52A0\u5165"),n())}function Vt(i,t){if(i&1&&(r(0,"span",187),s(1),n()),i&2){let e=c(2).$implicit;l(),v("",e.joined_phone.slice(0,7),"***")}}function Bt(i,t){if(i&1&&(r(0,"div",173)(1,"span",185),s(2," \u2705 \u5DF2\u52A0\u5165 "),n(),r(3,"span",186),s(4," \u{1F4E1} \u76E3\u63A7\u4E2D "),n(),x(5,Vt,2,1,"span",187),n()),i&2){let e=c().$implicit;l(5),g(e.joined_phone?5:-1)}}function jt(i,t){if(i&1&&(r(0,"span",187),s(1),n()),i&2){let e=c(2).$implicit;l(),v("",e.joined_phone.slice(0,7),"***")}}function Pt(i,t){i&1&&(r(0,"button",188)(1,"span",90),s(2,"\u23F3"),n(),s(3," \u6DFB\u52A0\u4E2D... "),n())}function Nt(i,t){if(i&1){let e=S();r(0,"button",190),m("click",function(){p(e);let a=c(2).$implicit,u=c(2);return _(u.addToMonitoring(a))}),s(1," \u{1F4E1} \u52A0\u5165\u76E3\u63A7 "),n()}}function $t(i,t){if(i&1&&(r(0,"div",173)(1,"span",185),s(2," \u2705 \u5DF2\u52A0\u5165 "),n(),x(3,jt,2,1,"span",187),n(),x(4,Pt,4,0,"button",188)(5,Nt,2,0,"button",189)),i&2){let e=c().$implicit,o=c(2);l(3),g(e.joined_phone?3:-1),l(),g(o.isAddingMonitor(e)?4:5)}}function Ot(i,t){i&1&&(r(0,"button",174)(1,"span",90),s(2,"\u23F3"),n(),s(3," \u52A0\u5165\u4E2D... "),n())}function Ht(i,t){i&1&&(r(0,"button",192)(1,"span",90),s(2,"\u23F3"),n(),s(3," \u76E3\u63A7\u4E2D... "),n())}function Jt(i,t){if(i&1){let e=S();r(0,"button",194),m("click",function(){p(e);let a=c(2).$implicit,u=c(2);return _(u.addToMonitoring(a))}),s(1," \u{1F4E1} \u76E3\u63A7 "),n()}}function Lt(i,t){if(i&1){let e=S();r(0,"button",191),m("click",function(){p(e);let a=c().$implicit,u=c(2);return _(u.openJoinDialog(a))}),s(1," \u{1F680} \u52A0\u5165 "),n(),x(2,Ht,4,0,"button",192)(3,Jt,2,0,"button",193)}if(i&2){let e=c().$implicit,o=c(2);l(2),g(o.isAddingMonitor(e)?2:3)}}function Kt(i,t){if(i&1){let e=S();r(0,"button",197),m("click",function(){p(e);let a=c(2).$implicit,u=c(2);return _(u.extractMembers(a))}),s(1," \u{1F465} \u63D0\u53D6\u6210\u54E1 "),n()}}function zt(i,t){i&1&&(r(0,"button",196),s(1," \u{1F465} \u6210\u54E1 "),n())}function Ut(i,t){if(i&1&&x(0,Kt,2,0,"button",195)(1,zt,2,0,"button",196),i&2){let e=c().$implicit;g(e.status==="joined"||e.status==="monitoring"?0:1)}}function Qt(i,t){i&1&&(r(0,"button",175),s(1," \u{1F465} \u6210\u54E1 \u{1F512} "),n())}function qt(i,t){if(i&1){let e=S();r(0,"div",142),m("click",function(){let a=p(e).$implicit,u=c(2);return _(u.openDetail(a))}),r(1,"div",143)(2,"div",144)(3,"label",145),m("click",function(a){return p(e),_(a.stopPropagation())}),r(4,"input",146),m("change",function(a){let u=p(e).$implicit,h=c(2);return _(h.toggleBatchSelect(u,a))}),n(),r(5,"div",147),x(6,_t,2,0,"span",148),n()(),r(7,"button",149),m("click",function(a){let u=p(e).$implicit;return c(2).toggleSave(u),_(a.stopPropagation())}),s(8),n()(),r(9,"div",150)(10,"div",151)(11,"span",152),s(12),n(),x(13,xt,2,0,"span",153)(14,gt,2,0,"span",154)(15,ht,2,0,"span",155),x(16,vt,2,0,"span",156)(17,Ct,2,0,"span",157),r(18,"h4",158),s(19),n(),x(20,ft,2,2,"a",159),n(),r(21,"div",160)(22,"span",86),s(23,"ID:"),n(),x(24,bt,4,4)(25,yt,4,1)(26,St,2,0,"span",131),x(27,Dt,4,3),n(),x(28,wt,2,1,"p",161),r(29,"div",162)(30,"span",163)(31,"span",164),s(32,"\u{1F465}"),n(),r(33,"span",165),s(34),K(35,"number"),n(),s(36," \u6210\u54E1 "),x(37,Et,3,3,"span",166)(38,Tt,3,3,"span",167),n(),r(39,"span",168),x(40,Ft,4,0)(41,kt,4,0)(42,It,4,0),r(43,"span",169),s(44),n()(),x(45,Rt,2,1,"span",170),x(46,Mt,2,0,"span",48)(47,At,2,0,"span",171),n()(),r(48,"div",172),m("click",function(a){return p(e),_(a.stopPropagation())}),x(49,Bt,6,1,"div",173)(50,$t,6,2)(51,Ot,4,0,"button",174)(52,Lt,4,1),x(53,Ut,2,1)(54,Qt,2,0,"button",175),n()()()}if(i&2){let e=t.$implicit,o=c(2);E(o.isSelectedForBatch(e)?"border-cyan-500/70 shadow-lg shadow-cyan-500/10":"border-slate-700/50 hover:border-cyan-500/50 hover:shadow-lg hover:shadow-cyan-500/10"),l(4),w("checked",o.isSelectedForBatch(e)),l(),E(o.isSelectedForBatch(e)?"bg-cyan-500 border-cyan-500":"border-slate-500 hover:border-cyan-400"),l(),g(o.isSelectedForBatch(e)?6:-1),l(),E(e.is_saved?"bg-yellow-500/20 text-yellow-400":"bg-slate-700/50 text-slate-400 hover:bg-yellow-500/20 hover:text-yellow-400"),w("title",e.is_saved?"\u53D6\u6D88\u6536\u85CF":"\u6536\u85CF"),l(),v(" ",e.is_saved?"\u2B50":"\u2606"," "),l(3),E(e.resource_type==="channel"?"bg-purple-500/30 text-purple-300":"bg-blue-500/30 text-blue-300"),l(),v(" ",e.resource_type==="channel"?"\u{1F4E2} \u983B\u9053":"\u{1F465} \u7FA4\u7D44"," "),l(),g(e.status==="monitoring"?13:e.status==="joined"?14:e.status==="paused"?15:-1),l(3),g(e.is_new?16:e.is_new===!1?17:-1),l(3),D(e.title),l(),g(e.username?20:-1),l(4),g(e.telegram_id?24:e.username?25:26),l(3),g(e.username?27:-1),l(),g(e.description?28:-1),l(6),D(z(35,28,e.member_count)),l(3),g(e.member_change&&e.member_change>0?37:e.member_change&&e.member_change<0?38:-1),l(3),g((e.overall_score||0)>=.7?40:(e.overall_score||0)>=.5?41:42),l(4),v(" (",o.formatScore(e.overall_score),") "),l(),g(e.discovery_source?45:-1),l(),g(e.status==="monitoring"?46:e.status==="joined"||e.status==="paused"?47:-1),l(3),g(e.status==="monitoring"?49:e.status==="joined"?50:o.isJoining(e)?51:52),l(4),g(e.resource_type!=="channel"?53:54)}}function Wt(i,t){if(i&1){let e=S();r(0,"button",201),m("click",function(){let a=p(e).$implicit,u=c(3);return _(u.goToPage(a))}),s(1),n()}if(i&2){let e=t.$implicit,o=c(3);E(e===o.currentPage()?"bg-cyan-500 text-white":"bg-slate-700/50 text-slate-300 hover:bg-slate-600"),l(),v(" ",e," ")}}function Gt(i,t){if(i&1){let e=S();r(0,"div",141)(1,"button",198),m("click",function(){p(e);let a=c(2);return _(a.firstPage())}),s(2," \u23EE\uFE0F \u9996\u9801 "),n(),r(3,"button",198),m("click",function(){p(e);let a=c(2);return _(a.prevPage())}),s(4," \u25C0\uFE0F \u4E0A\u4E00\u9801 "),n(),V(5,Wt,2,3,"button",199,L),r(7,"button",198),m("click",function(){p(e);let a=c(2);return _(a.nextPage())}),s(8," \u4E0B\u4E00\u9801 \u25B6\uFE0F "),n(),r(9,"button",198),m("click",function(){p(e);let a=c(2);return _(a.lastPage())}),s(10," \u5C3E\u9801 \u23ED\uFE0F "),n(),r(11,"span",200),s(12),n()()}if(i&2){let e=c(2);l(),E(e.currentPage()===1?"bg-slate-700/30 text-slate-500 cursor-not-allowed":"bg-slate-700/50 text-slate-300 hover:bg-slate-600"),w("disabled",e.currentPage()===1),l(2),E(e.currentPage()===1?"bg-slate-700/30 text-slate-500 cursor-not-allowed":"bg-slate-700/50 text-slate-300 hover:bg-slate-600"),w("disabled",e.currentPage()===1),l(2),B(e.pageNumbers()),l(2),E(e.currentPage()===e.totalPages()?"bg-slate-700/30 text-slate-500 cursor-not-allowed":"bg-slate-700/50 text-slate-300 hover:bg-slate-600"),w("disabled",e.currentPage()===e.totalPages()),l(2),E(e.currentPage()===e.totalPages()?"bg-slate-700/30 text-slate-500 cursor-not-allowed":"bg-slate-700/50 text-slate-300 hover:bg-slate-600"),w("disabled",e.currentPage()===e.totalPages()),l(3),ae(" \u7B2C ",e.currentPage()," / ",e.totalPages()," \u9801 ")}}function Xt(i,t){if(i&1){let e=S();r(0,"div",134)(1,"div",23),s(2," \u5171 "),r(3,"span",135),s(4),n(),s(5," \u500B\u7D50\u679C\uFF0C \u986F\u793A\u7B2C "),r(6,"span",136),s(7),n(),s(8," - "),r(9,"span",136),s(10),n(),s(11," \u500B "),n(),r(12,"div",26)(13,"span",23),s(14,"\u6BCF\u9801"),n(),r(15,"select",137),m("ngModelChange",function(a){p(e);let u=c();return _(u.changePageSize(a))}),V(16,pt,2,2,"option",138,L),n()()(),r(18,"div",139),V(19,qt,55,30,"div",140,Ve,!0),n(),x(21,Gt,13,14,"div",141)}if(i&2){let e=c();l(4),D(e.filteredResources().length),l(3),D((e.currentPage()-1)*e.pageSize()+1),l(3),D(e.Math.min(e.currentPage()*e.pageSize(),e.filteredResources().length)),l(5),w("ngModel",e.pageSize()),l(),B(e.pageSizeOptions),l(3),B(e.pagedResources()),l(2),g(e.filteredResources().length>e.pageSize()?21:-1)}}function Yt(i,t){if(i&1&&(r(0,"a",215),s(1),n()),i&2){let e=c();w("href","https://t.me/"+e.username,q),l(),v(" @",e.username," ")}}function Zt(i,t){if(i&1){let e=S();r(0,"code",236),s(1),n(),r(2,"button",237),m("click",function(a){p(e);let u=c(),h=c();return _(h.copyId(u,a))}),s(3),n()}if(i&2){let e=c(),o=c();l(),D(e.telegram_id),l(),E(o.copiedId()===e.telegram_id?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400 hover:bg-cyan-500/20 hover:text-cyan-400"),l(),v(" ",o.copiedId()===e.telegram_id?"\u2713":"\u{1F4CB}"," ")}}function ei(i,t){i&1&&(r(0,"span",239),s(1,"\u26A0\uFE0F \u9700\u52A0\u5165\u7372\u53D6ID"),n())}function ti(i,t){i&1&&(r(0,"span",240),s(1,"\u{1F504} \u540C\u6B65\u4E2D"),n())}function ii(i,t){if(i&1&&(r(0,"code",238),s(1),n(),x(2,ei,2,0,"span",239)(3,ti,2,0,"span",240)),i&2){let e=c();l(),v("@",e.username),l(),g(e.status!=="joined"&&e.status!=="monitoring"?2:3)}}function ni(i,t){i&1&&(r(0,"span",94),s(1,"\u9700\u52A0\u5165\u7372\u53D6"),n())}function oi(i,t){i&1&&(r(0,"span",241),s(1,"\u{1F504} \u540C\u6B65\u4E2D"),n())}function ri(i,t){if(i&1&&x(0,ni,2,0,"span",94)(1,oi,2,0,"span",241),i&2){let e=c();g(e.status!=="joined"&&e.status!=="monitoring"?0:1)}}function si(i,t){if(i&1){let e=S();r(0,"span",221),s(1),n(),r(2,"button",242),m("click",function(a){p(e);let u=c(),h=c();return _(h.copyLink(u,a))}),s(3," \u{1F517} "),n()}if(i&2){let e=c();l(),v("@",e.username)}}function ai(i,t){i&1&&(r(0,"span",94),s(1,"\u7121"),n())}function li(i,t){if(i&1&&(r(0,"a",222),s(1),n()),i&2){let e=c();w("href","https://t.me/"+e.username,q),l(),v(" t.me/",e.username," ")}}function ci(i,t){i&1&&(r(0,"span",94),s(1,"\u7121\u516C\u958B\u9023\u7D50"),n())}function ui(i,t){i&1&&s(0," \u2B50\u2B50\u2B50 ")}function di(i,t){i&1&&s(0," \u2B50\u2B50 ")}function mi(i,t){i&1&&s(0," \u2B50 ")}function pi(i,t){i&1&&s(0," \u76E3\u63A7\u4E2D ")}function _i(i,t){i&1&&s(0," \u5DF2\u66AB\u505C ")}function xi(i,t){i&1&&s(0," \u5DF2\u52A0\u5165 ")}function gi(i,t){i&1&&s(0," \u52A0\u5165\u4E2D... ")}function hi(i,t){i&1&&s(0," \u672A\u52A0\u5165 ")}function vi(i,t){if(i&1&&(r(0,"div",217)(1,"h4",218)(2,"span"),s(3,"\u{1F4DD}"),n(),s(4," \u7FA4\u7D44\u63CF\u8FF0 "),n(),r(5,"p",243),s(6),n()()),i&2){let e=c();l(6),D(e.description)}}function Ci(i,t){if(i&1&&(r(0,"span",230),s(1),n()),i&2){let e=c(),o=c();l(),v(" \u4F86\u6E90\uFF1A",o.getSourceLabel(e.discovery_source)," ")}}function fi(i,t){if(i&1&&(r(0,"span",231),s(1),n()),i&2){let e=c();l(),v(" \u95DC\u9375\u8A5E\uFF1A",e.discovery_keyword," ")}}function bi(i,t){if(i&1&&(r(0,"span",230),s(1),K(2,"date"),n()),i&2){let e=c();l(),v(" \u767C\u73FE\u6642\u9593\uFF1A",_e(2,1,e.created_at,"yyyy-MM-dd HH:mm")," ")}}function yi(i,t){if(i&1&&(r(0,"a",234),s(1," \u{1F517} \u6253\u958B Telegram "),n()),i&2){let e=c();w("href","https://t.me/"+e.username,q)}}function Si(i,t){if(i&1){let e=S();r(0,"button",244),m("click",function(){p(e);let a=c(),u=c();return u.addToMonitoring(a),_(u.closeDetail())}),s(1," \u{1F4E1} \u76E3\u63A7 "),n(),r(2,"button",245),m("click",function(){p(e);let a=c(),u=c();return u.openJoinDialog(a),_(u.closeDetail())}),s(3," \u{1F680} \u52A0\u5165\u7FA4\u7D44 "),n()}}function Di(i,t){if(i&1){let e=S();r(0,"button",248),m("click",function(){p(e);let a=c(2),u=c();return u.extractMembers(a),_(u.closeDetail())}),s(1," \u{1F465} \u63D0\u53D6\u6210\u54E1 "),n()}}function wi(i,t){if(i&1){let e=S();r(0,"button",246),m("click",function(){p(e);let a=c(),u=c();return u.addToMonitoring(a),_(u.closeDetail())}),s(1," \u{1F4E1} \u52A0\u5165\u76E3\u63A7 "),n(),x(2,Di,2,0,"button",247)}if(i&2){let e=c();l(2),g(e.resource_type!=="channel"?2:-1)}}function Ei(i,t){if(i&1){let e=S();r(0,"button",248),m("click",function(){p(e);let a=c(2),u=c();return u.extractMembers(a),_(u.closeDetail())}),s(1," \u{1F465} \u63D0\u53D6\u6210\u54E1 "),n()}}function Ti(i,t){if(i&1&&(r(0,"span",249),s(1," \u{1F4E1} \u76E3\u63A7\u4E2D "),n(),x(2,Ei,2,0,"button",247)),i&2){let e=c();l(2),g(e.resource_type!=="channel"?2:-1)}}function Fi(i,t){if(i&1){let e=S();r(0,"div",202),m("click",function(){p(e);let a=c();return _(a.closeDetail())}),r(1,"div",203),m("click",function(a){return p(e),_(a.stopPropagation())}),r(2,"div",204)(3,"div",107)(4,"span",205),s(5),n(),r(6,"h2",206),s(7,"\u7FA4\u7D44\u8A73\u60C5"),n(),r(8,"span",23),s(9),n()(),r(10,"div",26)(11,"button",207),m("click",function(){p(e);let a=c();return _(a.navigatePrev())}),s(12," \u2190 "),n(),r(13,"button",208),m("click",function(){p(e);let a=c();return _(a.navigateNext())}),s(14," \u2192 "),n(),H(15,"div",209),r(16,"button",210),m("click",function(){p(e);let a=c();return _(a.closeDetail())}),s(17," \u2715 "),n()()(),r(18,"div",211)(19,"div",212)(20,"div",213),s(21),n(),r(22,"div",150)(23,"h3",214),s(24),n(),x(25,Yt,2,2,"a",215),n(),r(26,"button",216),m("click",function(){let a=p(e),u=c();return _(u.toggleSave(a))}),s(27),n()(),r(28,"div",217)(29,"h4",218)(30,"span"),s(31,"\u{1F4CA}"),n(),s(32," \u57FA\u672C\u4FE1\u606F "),n(),r(33,"div",219)(34,"div")(35,"div",220),s(36,"\u985E\u578B"),n(),r(37,"div",221),s(38),n()(),r(39,"div")(40,"div",220),s(41,"Telegram ID"),n(),r(42,"div",26),x(43,Zt,4,4)(44,ii,4,2)(45,ri,2,1),n()(),r(46,"div")(47,"div",220),s(48,"Username"),n(),r(49,"div",26),x(50,si,4,1)(51,ai,2,0,"span",94),n()(),r(52,"div")(53,"div",220),s(54,"\u9023\u7D50"),n(),x(55,li,2,2,"a",222)(56,ci,2,0,"span",94),n()()(),r(57,"div",217)(58,"h4",218)(59,"span"),s(60,"\u{1F465}"),n(),s(61," \u6210\u54E1\u6578\u64DA "),n(),r(62,"div",223)(63,"div",224)(64,"div",225),s(65),K(66,"number"),n(),r(67,"div",131),s(68,"\u7E3D\u6210\u54E1"),n()(),r(69,"div",224)(70,"div",226),x(71,ui,1,0)(72,di,1,0)(73,mi,1,0),n(),r(74,"div",227),s(75),n(),r(76,"div",89),s(77,"\u76F8\u95DC\u5EA6"),n()(),r(78,"div",224)(79,"div",228),s(80),n(),r(81,"div",131),x(82,pi,1,0)(83,_i,1,0)(84,xi,1,0)(85,gi,1,0)(86,hi,1,0),n()()()(),x(87,vi,7,1,"div",217),r(88,"div",229)(89,"h4",218)(90,"span"),s(91,"\u{1F3F7}\uFE0F"),n(),s(92," \u4F86\u6E90\u4FE1\u606F "),n(),r(93,"div",62),x(94,Ci,2,1,"span",230),x(95,fi,2,1,"span",231),x(96,bi,3,4,"span",230),n()()(),r(97,"div",232)(98,"div",26)(99,"button",233),m("click",function(){let a=p(e),u=c();return _(u.toggleSave(a))}),s(100),n(),x(101,yi,2,1,"a",234),n(),r(102,"div",26)(103,"button",235),m("click",function(){p(e);let a=c();return _(a.closeDetail())}),s(104," \u95DC\u9589 "),n(),x(105,Si,4,0)(106,wi,3,1)(107,Ti,3,1),n()()()()}if(i&2){let e=t,o=c();l(4),E(e.resource_type==="channel"?"bg-purple-500/30 text-purple-300":"bg-blue-500/30 text-blue-300"),l(),v(" ",e.resource_type==="channel"?"\u{1F4E2} \u983B\u9053":"\u{1F465} \u7FA4\u7D44"," "),l(4),ae(" ",o.selectedResourceIndex()+1," / ",o.filteredResources().length," "),l(2),E(o.canNavigatePrev()?"text-slate-400 hover:text-white hover:bg-slate-700":"text-slate-600 cursor-not-allowed"),w("disabled",!o.canNavigatePrev()),l(2),E(o.canNavigateNext()?"text-slate-400 hover:text-white hover:bg-slate-700":"text-slate-600 cursor-not-allowed"),w("disabled",!o.canNavigateNext()),l(8),v(" ",e.title[0]||"?"," "),l(3),D(e.title),l(),g(e.username?25:-1),l(),E(e.is_saved?"bg-yellow-500/20 text-yellow-400":"bg-slate-700 text-slate-400 hover:bg-yellow-500/20 hover:text-yellow-400"),l(),v(" ",e.is_saved?"\u2B50":"\u2606"," "),l(11),D(e.resource_type==="channel"?"\u983B\u9053":"\u7FA4\u7D44"),l(5),g(e.telegram_id?43:e.username?44:45),l(7),g(e.username?50:51),l(5),g(e.username?55:56),l(10),D(z(66,37,e.member_count)),l(6),g((e.overall_score||0)>=.7?71:(e.overall_score||0)>=.5?72:73),l(4),D(o.formatScore(e.overall_score)),l(4),E(e.status==="monitoring"?"text-green-400":e.status==="joined"?"text-blue-400":e.status==="paused"?"text-yellow-400":"text-slate-400"),l(),v(" ",e.status==="joined"||e.status==="monitoring"||e.status==="paused"?"\u2713":"\u2014"," "),l(2),g(e.status==="monitoring"?82:e.status==="paused"?83:e.status==="joined"?84:e.status==="joining"?85:86),l(5),g(e.description?87:-1),l(7),g(e.discovery_source?94:-1),l(),g(e.discovery_keyword?95:-1),l(),g(e.created_at?96:-1),l(3),E(e.is_saved?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30":"bg-slate-700 text-slate-300 hover:bg-slate-600"),l(),v(" ",e.is_saved?"\u2B50 \u5DF2\u6536\u85CF":"\u2606 \u6536\u85CF"," "),l(),g(e.username?101:-1),l(4),g(e.status!=="joined"&&e.status!=="monitoring"?105:e.status==="joined"?106:107)}}function ki(i,t){i&1&&(r(0,"p",254),s(1),n()),i&2&&(l(),D(t.title))}function Ii(i,t){if(i&1&&(r(0,"div",264),s(1),n()),i&2){let e=c();l(),v("@",e.username)}}function Ri(i,t){if(i&1&&(r(0,"div",255)(1,"div",107)(2,"div",262),s(3),n(),r(4,"div",150)(5,"div",263),s(6),n(),x(7,Ii,2,1,"div",264),r(8,"div",265)(9,"span"),s(10),K(11,"number"),n()()()()()),i&2){let e=t;l(3),v(" ",(e.title==null?null:e.title.charAt(0))||"G"," "),l(3),D(e.title),l(),g(e.username?7:-1),l(3),v("\u{1F465} ",z(11,4,e.member_count)," \u6210\u54E1")}}function Mi(i,t){if(i&1&&(r(0,"div",271),s(1),n()),i&2){let e=c(2).$implicit;l(),D(e.display_name)}}function Ai(i,t){if(i&1){let e=S();r(0,"label",267)(1,"input",268),m("change",function(){p(e);let a=c().$implicit,u=c(2);return _(u.joinDialogSelectedPhone.set(a.phone))}),n(),r(2,"div",269)(3,"div",270),s(4),n(),x(5,Mi,2,1,"div",271),n(),H(6,"span",272),n()}if(i&2){let e=c().$implicit,o=c(2);E(o.joinDialogSelectedPhone()===e.phone?"bg-cyan-500/20 border-2 border-cyan-500":"bg-slate-700/30 border-2 border-transparent hover:bg-slate-700/50"),l(),w("value",e.phone)("checked",o.joinDialogSelectedPhone()===e.phone),l(3),D(e.phone),l(),g(e.display_name?5:-1)}}function Vi(i,t){if(i&1&&x(0,Ai,7,6,"label",266),i&2){let e=t.$implicit;g(e.status==="Online"?0:-1)}}function Bi(i,t){if(i&1){let e=S();r(0,"div",250),m("click",function(){p(e);let a=c();return _(a.cancelJoinDialog())}),r(1,"div",251),m("click",function(a){return p(e),_(a.stopPropagation())}),r(2,"div",252)(3,"h3",253),s(4," \u{1F680} \u9078\u64C7\u52A0\u5165\u5E33\u865F "),n(),x(5,ki,2,1,"p",254),n(),x(6,Ri,12,6,"div",255),r(7,"div",256)(8,"div",257),s(9,"\u9078\u64C7\u8981\u4F7F\u7528\u7684\u5E33\u865F\uFF1A"),n(),r(10,"div",258),V(11,Vi,1,1,null,null,re),n()(),r(13,"div",259)(14,"button",260),m("click",function(){p(e);let a=c();return _(a.cancelJoinDialog())}),s(15," \u53D6\u6D88 "),n(),r(16,"button",261),m("click",function(){p(e);let a=c();return _(a.confirmJoinFromDialog())}),s(17," \u78BA\u8A8D\u52A0\u5165 "),n()()()()}if(i&2){let e,o,a=c();l(5),g((e=a.joinDialogResource())?5:-1,e),l(),g((o=a.joinDialogResource())?6:-1,o),l(5),B(a.mergedAccounts()),l(5),w("disabled",!a.joinDialogSelectedPhone())}}var oe=class i{constructor(){this.toast=M(Z);this.ipc=M(U);this.accountService=M(ee);this.dialogService=M(Te);this.opHistory=M(ne);this.navBridge=M(te);this.showOperationHistory=f(!1);this.groupService=null;this.Math=Math;this._internalAccounts=f([]);this._internalResources=f([]);this._internalSearching=f(!1);this._internalSelectedAccount=f(null);this._internalSearchError=f({hasError:!1,message:""});this._historyKeywords=f([]);this.ipcCleanup=[];this.searchProgress=f("");this.isFetchingDetails=f(!1);this.newDiscoveredCount=f(0);this.existingCount=f(0);this.currentPage=f(1);this.pageSize=f(50);this.pageSizeOptions=[20,50,100,200];this.searchTimeoutId=null;this.SEARCH_BASE_TIMEOUT_MS=6e4;this.HEARTBEAT_TIMEOUT_MS=15e3;this.lastProgressTime=0;this.initialView=$("search-discovery");this.resources=$([]);this.isSearching=$(!1);this.selectedAccount=$(null);this.availableAccounts=$([]);this.historyKeywords=$([]);this.currentKeyword=$("");this.searchError=$({hasError:!1,message:""});this.savedResourceIds=$(new Set);this.mergedAccounts=k(()=>{let t=this._internalAccounts(),e=this.availableAccounts();return t.length>0?t:e});this.mergedResources=k(()=>{let t=this._internalResources(),e=this.resources();return t.length>0?t:e});this.pagedResources=k(()=>{let t=this.filteredResources(),e=this.currentPage(),o=this.pageSize(),a=(e-1)*o,u=a+o;return t.slice(a,u)});this.totalPages=k(()=>{let t=this.filteredResources().length,e=this.pageSize();return Math.ceil(t/e)||1});this.pageNumbers=k(()=>{let t=this.totalPages(),e=this.currentPage(),o=[],a=Math.max(1,e-2),u=Math.min(t,e+2);for(let h=a;h<=u;h++)o.push(h);return o});this.mergedSearching=k(()=>this._internalSearching()||this.isSearching());this.mergedSelectedAccount=k(()=>this._internalSelectedAccount()||this.selectedAccount());this.mergedSearchError=k(()=>{let t=this._internalSearchError();return t.hasError?t:this.searchError()});this.mergedHistoryKeywords=k(()=>{let t=this._historyKeywords(),e=this.historyKeywords();return t.length>0?t:e});this.searchEvent=J();this.selectAccountEvent=J();this.saveResourceEvent=J();this.unsaveResourceEvent=J();this.joinResourceEvent=J();this.extractMembersEvent=J();this.clearResultsEvent=J();this.searchQuery="";this.filterType="all";this.showAccountSelector=f(!1);this.showSuggestions=f(!1);this.copiedId=f("");this.copiedLink=f("");this.selectedSources=f(["telegram","jiso"]);this.showJoinAccountDialog=f(!1);this.joinDialogResource=f(null);this.joinDialogSelectedPhone=f("");this.joiningResourceIds=f(new Set);this.monitoringResourceIds=f(new Set);this.showAdvancedFilter=f(!1);this.filterMemberMin=f(null);this.filterMemberMax=f(null);this.filterSource=f("all");this.filterJoinStatus=f("all");this.filterHasId=f(!1);this.filterSavedOnly=f(!1);this.showDetailDialog=f(!1);this.selectedResource=f(null);this.selectedResourceIndex=f(-1);this.selectedForBatch=f(new Set);this.searchSources=[{id:"telegram",name:"\u5B98\u65B9\u641C\u7D22",icon:"\u{1F4F1}",tag:"\u7A69\u5B9A",tagClass:"bg-green-500/20 text-green-400",disabled:!1},{id:"jiso",name:"\u4E2D\u6587\u641C\u7D22",icon:"\u{1F50D}",tag:"\u63A8\u85A6",tagClass:"bg-yellow-500/20 text-yellow-400",disabled:!1},{id:"tgstat",name:"TGStat",icon:"\u{1F4CA}",tag:"\u958B\u767C\u4E2D",tagClass:"bg-slate-600 text-slate-400",disabled:!0},{id:"local",name:"\u672C\u5730\u7D22\u5F15",icon:"\u{1F4BE}",tag:null,tagClass:"",disabled:!1}];this.hotKeywords=["\u652F\u4ED8","USDT","\u4EA4\u6613","\u62DB\u8058","\u4EE3\u8CFC","\u52A0\u5BC6\u8CA8\u5E63","\u96FB\u5F71","\u8CC7\u6E90\u5206\u4EAB"];this.filteredResources=k(()=>{let t=this.mergedResources();this.filterType!=="all"&&(t=t.filter(h=>this.filterType==="channel"?h.resource_type==="channel":h.resource_type!=="channel"));let e=this.filterMemberMin(),o=this.filterMemberMax();e!==null&&e>0&&(t=t.filter(h=>h.member_count>=e)),o!==null&&o>0&&(t=t.filter(h=>h.member_count<=o));let a=this.filterSource();a!=="all"&&(t=t.filter(h=>h.discovery_source===a));let u=this.filterJoinStatus();return u==="monitoring"?t=t.filter(h=>h.status==="monitoring"):u==="joined"?t=t.filter(h=>h.status==="joined"||h.status==="monitoring"||h.status==="paused"):u==="not_joined"&&(t=t.filter(h=>h.status!=="joined"&&h.status!=="monitoring"&&h.status!=="paused")),this.filterHasId()&&(t=t.filter(h=>h.telegram_id&&h.telegram_id.trim()!=="")),this.filterSavedOnly()&&(t=t.filter(h=>h.is_saved)),t});this.savedCount=k(()=>this.mergedResources().filter(t=>t.is_saved).length);this.canNavigatePrev=k(()=>this.selectedResourceIndex()>0);this.canNavigateNext=k(()=>{let t=this.filteredResources();return this.selectedResourceIndex()<t.length-1});this.pendingJoinResource=null;this.selectedCount=k(()=>this.selectedForBatch().size);this.activeFilterCount=k(()=>{let t=0;return this.filterType!=="all"&&t++,this.filterMemberMin()!==null&&this.filterMemberMin()>0&&t++,this.filterMemberMax()!==null&&this.filterMemberMax()>0&&t++,this.filterSource()!=="all"&&t++,this.filterJoinStatus()!=="all"&&t++,this.filterHasId()&&t++,t});me(()=>{this.filterSavedOnly.set(this.initialView()==="resource-center")})}getResourceTrackId(t,e){let o=[`idx-${e}`];return t.id&&t.id!==0&&o.push(`id-${t.id}`),t.telegram_id&&t.telegram_id.toString().trim()!==""&&o.push(`tg-${t.telegram_id}`),t.username&&t.username.trim()!==""&&o.push(`u-${t.username}`),t.source&&o.push(`src-${t.source}`),o.join("_")}ngOnInit(){document.addEventListener("click",this.handleOutsideClick.bind(this)),document.addEventListener("keydown",this.handleKeydown.bind(this)),this.initialView()==="resource-center"&&this.filterSavedOnly.set(!0),this.loadAccounts(),this.setupIpcListeners(),this.loadSearchHistory(),this.restoreSearchResults(),this.syncResourceStatusWithMonitoredGroups()}saveSearchResults(){try{let t=this._internalResources(),e=this.searchQuery;if(t.length>0){let o={query:e,resources:t,timestamp:Date.now(),newCount:this.newDiscoveredCount(),existingCount:this.existingCount()};sessionStorage.setItem("search-discovery-results",JSON.stringify(o)),console.log(`[SearchDiscovery] \u5DF2\u4FDD\u5B58 ${t.length} \u500B\u641C\u7D22\u7D50\u679C\u5230 sessionStorage`)}}catch(t){console.error("[SearchDiscovery] \u4FDD\u5B58\u641C\u7D22\u7D50\u679C\u5931\u6557:",t)}}restoreSearchResults(){try{let t=sessionStorage.getItem("search-discovery-results");if(t){let e=JSON.parse(t);Date.now()-(e.timestamp||0)<1800*1e3?(this._internalResources.set(e.resources||[]),this.searchQuery=e.query||"",this.newDiscoveredCount.set(e.newCount||0),this.existingCount.set(e.existingCount||0),console.log(`[SearchDiscovery] \u5DF2\u6062\u5FA9 ${e.resources?.length||0} \u500B\u641C\u7D22\u7D50\u679C`)):sessionStorage.removeItem("search-discovery-results")}}catch(t){console.error("[SearchDiscovery] \u6062\u5FA9\u641C\u7D22\u7D50\u679C\u5931\u6557:",t)}}syncResourceStatusWithMonitoredGroups(){let t=this.ipc.on("get-groups-result",e=>{let o=e.groups||[];if(!o.length&&!this._internalResources().length)return;let a=new Set,u=new Set,h=new Set;for(let R of o)R.url&&a.add(R.url),R.username&&u.add(R.username.toLowerCase().replace("@","")),R.telegramId&&h.add(String(R.telegramId));let O=0,Q=this._internalResources().map(R=>{let W=R.username&&u.has(R.username.toLowerCase().replace("@",""))||R.telegram_id&&h.has(String(R.telegram_id));return R.status==="monitoring"&&!W?(O++,N(P({},R),{status:"joined"})):R.status!=="monitoring"&&W?(O++,N(P({},R),{status:"monitoring"})):R});O>0&&(console.log(`[SearchDiscovery] Phase4: \u6821\u6B63\u4E86 ${O} \u500B\u8CC7\u6E90\u7684\u76E3\u63A7\u72C0\u614B`),this._internalResources.set(Q),this.saveSearchResults())});this.ipcCleanup.push(t),this._internalResources().length>0&&this.ipc.send("get-monitored-groups",{})}ngOnDestroy(){document.removeEventListener("click",this.handleOutsideClick.bind(this)),document.removeEventListener("keydown",this.handleKeydown.bind(this)),this.ipcCleanup.forEach(t=>t()),this.clearSearchTimeout()}loadAccounts(){let e=this.accountService.accounts().filter(o=>o.status==="Online");this._internalAccounts.set(e.map(o=>({id:o.id,phone:o.phone,status:o.status}))),!this._internalSelectedAccount()&&e.length>0&&this._internalSelectedAccount.set({id:e[0].id,phone:e[0].phone,status:e[0].status}),console.log("[SearchDiscovery] \u8F09\u5165\u5E33\u865F:",e.length,"\u500B\u5728\u7DDA")}setupIpcListeners(){let t=this.ipc.on("accounts-updated",d=>{let b=d.filter(y=>y.status==="Online");this._internalAccounts.set(b.map(y=>({id:y.id,phone:y.phone,status:y.status})));let C=this._internalSelectedAccount();C?!b.find(I=>I.id===C.id)&&b.length>0&&this._internalSelectedAccount.set({id:b[0].id,phone:b[0].phone,status:b[0].status}):b.length>0&&this._internalSelectedAccount.set({id:b[0].id,phone:b[0].phone,status:b[0].status}),console.log("[SearchDiscovery] \u5E33\u865F\u66F4\u65B0:",b.length,"\u500B\u5728\u7DDA")}),e=this.ipc.on("search-batch",d=>{if(this.resetHeartbeat(),d.success&&d.groups){let b=d.groups.map((C,y)=>({id:y+1,telegram_id:C.telegram_id||null,title:C.title,username:C.username,description:C.description,member_count:C.member_count||C.members_count||0,resource_type:C.type||"group",status:"discovered",overall_score:C.score,discovery_source:"search",discovery_keyword:this.searchQuery,source:C.source,link:C.link}));this._internalResources.set(b),d.message&&this.searchProgress.set(d.message),console.log(`[SearchDiscovery] \u6536\u5230\u6279\u6B21\u7D50\u679C: ${b.length} \u500B (\u4F86\u6E90: ${d.source})`)}}),o=this.ipc.on("search-results",d=>{if(this.clearSearchTimeout(),this._internalSearching.set(!1),this.searchProgress.set(""),this.isFetchingDetails.set(!1),d.success&&d.groups){let b=d.groups.map((T,j)=>({id:j+1,telegram_id:T.telegram_id||null,title:T.title,username:T.username,description:T.description,member_count:T.member_count||T.members_count||0,resource_type:T.type||"group",status:T.status||"discovered",joined_phone:T.joined_phone||T.joined_by_phone||null,overall_score:T.score,discovery_source:"search",discovery_keyword:this.searchQuery,source:T.source,link:T.link,is_new:T.is_new,member_change:T.member_change}));this._internalResources.set(b),this._internalSearchError.set({hasError:!1,message:""}),this.saveSearchResults();let C=d.new_count||0,y=d.existing_count||0;this.newDiscoveredCount.set(C),this.existingCount.set(y);let I=`\u641C\u7D22\u5B8C\u6210\uFF01\u5171\u627E\u5230 ${b.length} \u500B\u7D50\u679C`;C>0&&(I+=`\uFF0C\u5176\u4E2D ${C} \u500B\u70BA\u65B0\u767C\u73FE`),this.toast.success(I)}else this._internalSearchError.set({hasError:!0,message:d.error||"\u641C\u7D22\u5931\u6557"})}),a=this.ipc.on("search-error",d=>{this.clearSearchTimeout(),this._internalSearching.set(!1),this.searchProgress.set(""),this.isFetchingDetails.set(!1),this._internalSearchError.set({hasError:!0,message:d.message||"\u641C\u7D22\u8ACB\u6C42\u5931\u6557"}),this.toast.error("\u641C\u7D22\u5931\u6557: "+(d.message||"\u672A\u77E5\u932F\u8AA4"))}),u=this.ipc.on("jiso-search-progress",d=>{if(this.resetHeartbeat(),this.searchProgress.set(d.message),d.status==="basic_results"&&d.data?.results){let b=d.data.results.map((C,y)=>({id:y+1,telegram_id:C.telegram_id||null,title:C.title,username:C.username,description:C.description,member_count:C.member_count||0,resource_type:C.chat_type||C.type||"group",link:C.link,status:"discovered",overall_score:C.score,discovery_source:"search",discovery_keyword:this.searchQuery}));this._internalResources.set(b),this.isFetchingDetails.set(!0),this.toast.info(`\u5DF2\u8F09\u5165 ${b.length} \u500B\u57FA\u790E\u7D50\u679C\uFF0C\u6B63\u5728\u7372\u53D6\u8A73\u60C5...`)}else d.status==="fetching_details"?this.isFetchingDetails.set(!0):d.status==="completed"&&(this.isFetchingDetails.set(!1),this.searchProgress.set(""))}),h=this.ipc.on("join-and-monitor-complete",d=>{if(d.resourceId&&this.joiningResourceIds.update(b=>{let C=new Set(b);return C.delete(d.resourceId),C}),d.success){let C=this._internalResources().map(y=>d.resourceId&&y.id===d.resourceId||d.username&&y.username===d.username||d.telegramId&&y.telegram_id===d.telegramId?(this.joiningResourceIds.update(T=>{let j=new Set(T);return j.delete(y.id),j}),N(P({},y),{status:"joined",member_count:d.memberCount||y.member_count,joined_phone:d.phone||y.joined_phone})):y);this._internalResources.set(C),this.saveSearchResults(),console.log(`[SearchDiscovery] \u8CC7\u6E90\u72C0\u614B\u5DF2\u66F4\u65B0: ${d.username||d.telegramId} \u2192 joined (${d.phone})`)}else(d.username||d.telegramId)&&this._internalResources().forEach(C=>{(d.username&&C.username===d.username||d.telegramId&&C.telegram_id===d.telegramId)&&this.joiningResourceIds.update(y=>{let I=new Set(y);return I.delete(C.id),I})})}),O=this.ipc.on("resource-status-updated",d=>{let C=this._internalResources().map(y=>(d.resourceId&&y.id===d.resourceId||d.username&&y.username===d.username||d.telegramId&&y.telegram_id===d.telegramId)&&d.newStatus?(d.newStatus==="monitoring"&&this.monitoringResourceIds.update(T=>{let j=new Set(T);return j.delete(y.id),j}),N(P({},y),{status:d.newStatus})):y);this._internalResources.set(C),this.saveSearchResults()}),F=this.ipc.on("group-added",d=>{d&&d.success===!1&&d.error&&(this.toast.error(`\u6DFB\u52A0\u76E3\u63A7\u5931\u6557: ${d.error}`),this.monitoringResourceIds.set(new Set))}),Q=this.ipc.on("monitored-group-added",d=>{if(d.success){let b=!1,y=this._internalResources().map(I=>d.telegramId&&I.telegram_id===d.telegramId||d.username&&I.username===d.username?(I.status==="monitoring"&&(b=!0),this.monitoringResourceIds.update(j=>{let A=new Set(j);return A.delete(I.id),A}),N(P({},I),{status:"monitoring"})):I);this._internalResources.set(y),this.saveSearchResults(),b||this.toast.successWithNextStep(`\u{1F4E1} \u5DF2\u6210\u529F\u6DFB\u52A0\u5230\u76E3\u63A7\u5217\u8868: ${d.name||""}`,"\u524D\u5F80\u76E3\u63A7\u9801 \u2192",()=>this.navBridge.navigateTo("monitoring-groups"))}else this.monitoringResourceIds().size>0&&(this.monitoringResourceIds.set(new Set),this.toast.error(`\u274C \u6DFB\u52A0\u76E3\u63A7\u5931\u6557: ${d.error||"\u672A\u77E5\u932F\u8AA4"}`))}),R=this.ipc.on("batch-add-monitored-result",d=>{if(this.monitoringResourceIds.set(new Set),d.success){let b=`\u6279\u91CF\u6DFB\u52A0\u5B8C\u6210: ${d.added} \u500B\u6210\u529F`;d.skipped&&(b+=`, ${d.skipped} \u5DF2\u5B58\u5728`),d.failed&&(b+=`, ${d.failed} \u5931\u6557`),this.toast.success(b)}else this.toast.error(`\u6279\u91CF\u6DFB\u52A0\u5931\u6557: ${d.error||"\u672A\u77E5\u932F\u8AA4"}`)}),W=this.ipc.on("get-groups-result",d=>{let b=d.groups;if(!b||!Array.isArray(b)||b.length===0)return;let C=this._internalResources();if(C.length===0)return;let y=new Set,I=new Set;for(let A of b)A.url&&y.add(A.url.toLowerCase()),A.username&&I.add(A.username.toLowerCase().replace("@",""));let T=0,j=C.map(A=>A.status==="monitoring"?A:A.username&&I.has(A.username.toLowerCase().replace("@",""))||A.telegram_id&&b.some(Re=>String(Re.telegramId)===String(A.telegram_id))?(T++,N(P({},A),{status:"monitoring"})):A);T>0&&(console.log(`[SearchDiscovery] Phase4: \u4FEE\u6B63 ${T} \u500B\u8CC7\u6E90\u72C0\u614B\uFF08discovered \u2192 monitoring\uFF09`),this._internalResources.set(j),this.saveSearchResults())});this.ipcCleanup.push(t,e,o,a,u,h,O,F,Q,R,W)}loadSearchHistory(){try{let t=localStorage.getItem("search-history");t&&this._historyKeywords.set(JSON.parse(t))}catch(t){console.warn("[SearchDiscovery] \u52A0\u8F09\u641C\u7D22\u6B77\u53F2\u5931\u6557:",t)}}saveSearchHistory(t){let e=this._historyKeywords(),o=[t,...e.filter(a=>a!==t)].slice(0,10);this._historyKeywords.set(o);try{localStorage.setItem("search-history",JSON.stringify(o))}catch(a){console.warn("[SearchDiscovery] \u4FDD\u5B58\u641C\u7D22\u6B77\u53F2\u5931\u6557:",a)}}formatTime(t){let e=new Date(t);return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`}handleKeydown(t){if(this.showDetailDialog())switch(t.key){case"Escape":this.closeDetail();break;case"ArrowLeft":this.canNavigatePrev()&&this.navigatePrev();break;case"ArrowRight":this.canNavigateNext()&&this.navigateNext();break}}handleOutsideClick(t){t.target.closest(".relative")||this.showAccountSelector.set(!1)}doSearch(){if(!this.searchQuery.trim()){this.toast.warning("\u8ACB\u8F38\u5165\u641C\u7D22\u95DC\u9375\u8A5E");return}if(this.selectedSources().length===0){this.toast.warning("\u8ACB\u81F3\u5C11\u9078\u64C7\u4E00\u500B\u641C\u7D22\u6E20\u9053");return}let t=this.mergedSelectedAccount();if(!t){this.toast.warning("\u8ACB\u5148\u9078\u64C7\u4E00\u500B\u5728\u7DDA\u5E33\u865F"),this.loadAccounts();return}let e=this.searchQuery.trim(),o=this.selectedSources();console.log("[SearchDiscovery] \u958B\u59CB\u641C\u7D22:",{query:e,sources:o,account:t.phone}),this.clearSearchTimeout(),this.resetPagination(),this._internalSearching.set(!0),this._internalSearchError.set({hasError:!1,message:""}),this.saveSearchHistory(e),this.lastProgressTime=Date.now(),this.startHeartbeatCheck(),this.ipc.send("search-groups",{keyword:e,sources:o,account_id:t.id,account_phone:t.phone,limit:500}),this.searchEvent.emit({query:e,sources:o})}clearSearchTimeout(){this.searchTimeoutId&&(clearTimeout(this.searchTimeoutId),this.searchTimeoutId=null)}startHeartbeatCheck(){this.clearSearchTimeout(),this.searchTimeoutId=setTimeout(()=>{if(!this._internalSearching())return;let t=Date.now(),e=t-this.lastProgressTime,o=t-(this.lastProgressTime-e);e>this.HEARTBEAT_TIMEOUT_MS?(console.warn("[SearchDiscovery] \u641C\u7D22\u8D85\u6642 - \u7121\u9032\u5EA6\u66F4\u65B0",{timeSinceLastProgress:e,totalElapsed:o}),this.handleSearchTimeout()):this.startHeartbeatCheck()},5e3)}handleSearchTimeout(){this.clearSearchTimeout(),this._internalSearching.set(!1),this.searchProgress.set(""),this.isFetchingDetails.set(!1),this._internalSearchError.set({hasError:!0,message:"\u641C\u7D22\u8D85\u6642\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66"}),this.toast.warning("\u641C\u7D22\u8D85\u6642\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}resetHeartbeat(){this.lastProgressTime=Date.now()}quickSearch(t){this.searchQuery=t,this.showSuggestions.set(!1),this.doSearch()}goToPage(t){let e=this.totalPages();t>=1&&t<=e&&this.currentPage.set(t)}nextPage(){this.goToPage(this.currentPage()+1)}prevPage(){this.goToPage(this.currentPage()-1)}firstPage(){this.goToPage(1)}lastPage(){this.goToPage(this.totalPages())}changePageSize(t){this.pageSize.set(t),this.currentPage.set(1)}resetPagination(){this.currentPage.set(1)}toggleSource(t){if(this.searchSources.find(a=>a.id===t)?.disabled){console.log("\u26A0\uFE0F \u8A72\u641C\u7D22\u6E20\u9053\u6B63\u5728\u958B\u767C\u4E2D:",t);return}let o=this.selectedSources();o.includes(t)?this.selectedSources.set(o.filter(a=>a!==t)):this.selectedSources.set([...o,t])}hideSuggestions(){setTimeout(()=>this.showSuggestions.set(!1),200)}clearResults(){this.clearResultsEvent.emit()}selectAccount(t){if(this._internalSelectedAccount.set(t),this.selectAccountEvent.emit(t),this.showAccountSelector.set(!1),this.pendingJoinResource){let e=this.pendingJoinResource;if(t.status!=="Online"){this.toast.warning(`\u5E33\u865F ${t.phone} \u672A\u9023\u63A5\uFF0C\u7121\u6CD5\u52A0\u5165\u7FA4\u7D44`);return}setTimeout(()=>{this.executeJoin(e,t.phone)},100)}}openDetail(t){let o=this.filteredResources().findIndex(a=>a.telegram_id&&a.telegram_id===t.telegram_id||a.id&&a.id===t.id);this.selectedResource.set(t),this.selectedResourceIndex.set(o),this.showDetailDialog.set(!0)}closeDetail(){this.showDetailDialog.set(!1),this.selectedResource.set(null),this.selectedResourceIndex.set(-1)}navigatePrev(){let t=this.filteredResources(),e=this.selectedResourceIndex();if(e>0){let o=t[e-1];this.selectedResource.set(o),this.selectedResourceIndex.set(e-1)}}navigateNext(){let t=this.filteredResources(),e=this.selectedResourceIndex();if(e<t.length-1){let o=t[e+1];this.selectedResource.set(o),this.selectedResourceIndex.set(e+1)}}toggleSave(t){t.is_saved?this.unsaveResourceEvent.emit(t):this.saveResourceEvent.emit(t)}openJoinDialog(t){if(console.log("[SearchDiscovery] \u6253\u958B\u52A0\u5165\u5C0D\u8A71\u6846:",t.title),!t.username&&!t.telegram_id){this.toast.warning("\u7121\u6CD5\u52A0\u5165\uFF1A\u7F3A\u5C11\u7FA4\u7D44\u6A19\u8B58");return}if(this.joiningResourceIds().has(t.id)){this.toast.warning("\u6B63\u5728\u52A0\u5165\u4E2D\uFF0C\u8ACB\u7A0D\u5019...");return}let e=this.mergedAccounts().filter(o=>o.status==="Online");if(e.length===0){this.toast.warning("\u6C92\u6709\u5728\u7DDA\u5E33\u865F\uFF0C\u8ACB\u5148\u767B\u9304\u5E33\u865F");return}if(e.length===1){this.executeJoin(t,e[0].phone);return}this.joinDialogResource.set(t),this.joinDialogSelectedPhone.set(""),this.showJoinAccountDialog.set(!0)}confirmJoinFromDialog(){let t=this.joinDialogResource(),e=this.joinDialogSelectedPhone();if(!t){this.toast.warning("\u8ACB\u9078\u64C7\u8981\u52A0\u5165\u7684\u7FA4\u7D44");return}if(!e){this.toast.warning("\u8ACB\u9078\u64C7\u8981\u4F7F\u7528\u7684\u5E33\u865F");return}this.showJoinAccountDialog.set(!1),this.executeJoin(t,e)}cancelJoinDialog(){this.showJoinAccountDialog.set(!1),this.joinDialogResource.set(null),this.joinDialogSelectedPhone.set("")}joinResource(t){if(console.log("[SearchDiscovery] \u52A0\u5165\u7FA4\u7D44:",t.title,t.username),!t.username&&!t.telegram_id){this.toast.warning("\u7121\u6CD5\u52A0\u5165\uFF1A\u7F3A\u5C11\u7FA4\u7D44\u6A19\u8B58");return}if(this.joiningResourceIds().has(t.id)){this.toast.warning("\u6B63\u5728\u52A0\u5165\u4E2D\uFF0C\u8ACB\u7A0D\u5019...");return}let e=this.mergedSelectedAccount();if(!e){this.pendingJoinResource=t,this.showAccountSelector.set(!0),this.toast.warning("\u8ACB\u9078\u64C7\u4E00\u500B\u5E33\u865F\u4F86\u52A0\u5165\u7FA4\u7D44");return}if(e.status!=="Online"){this.toast.warning(`\u5E33\u865F ${e.phone} \u672A\u9023\u63A5\uFF0C\u8ACB\u9078\u64C7\u5DF2\u9023\u63A5\u7684\u5E33\u865F`),this.pendingJoinResource=t,this.showAccountSelector.set(!0);return}this.executeJoin(t,e.phone)}executeJoin(t,e){this.joiningResourceIds.update(o=>{let a=new Set(o);return a.add(t.id),a}),this.toast.info(`\u6B63\u5728\u4F7F\u7528 ${e.slice(0,4)}**** \u52A0\u5165\u7FA4\u7D44: ${t.title||t.username}...`),this.ipc.send("join-resource",{resourceId:t.id||0,username:t.username,telegramId:t.telegram_id,title:t.title,phone:e}),this.pendingJoinResource=null,this.joinResourceEvent.emit(t)}isJoining(t){return this.joiningResourceIds().has(t.id)}isAddingMonitor(t){return this.monitoringResourceIds().has(t.id)}addToMonitoring(t){if(console.log("[SearchDiscovery] \u6DFB\u52A0\u5230\u76E3\u63A7:",t.title),t.status==="monitoring"){this.toast.info("\u6B64\u7FA4\u7D44\u5DF2\u5728\u76E3\u63A7\u5217\u8868\u4E2D");return}if(this.monitoringResourceIds().has(t.id)){this.toast.info("\u6B63\u5728\u6DFB\u52A0\u4E2D\uFF0C\u8ACB\u7A0D\u5019...");return}if(!t.username&&!t.telegram_id){this.toast.warning("\u7121\u6CD5\u76E3\u63A7\uFF1A\u7F3A\u5C11\u7FA4\u7D44\u6A19\u8B58");return}this.monitoringResourceIds.update(o=>{let a=new Set(o);return a.add(t.id),a});let e=t.username?`https://t.me/${t.username}`:t.invite_link||`tg://resolve?id=${t.telegram_id}`;this.ipc.send("add-monitored-group",{url:e,name:t.title||t.username||"",telegramId:t.telegram_id,username:t.username,resourceId:t.id,phone:t.joined_phone||this.mergedSelectedAccount()?.phone,keywordSetIds:[]}),this.toast.info(`\u{1F4E1} \u6B63\u5728\u5C07\u300C${t.title||t.username}\u300D\u6DFB\u52A0\u5230\u76E3\u63A7\u5217\u8868...`),setTimeout(()=>{this.monitoringResourceIds().has(t.id)&&(this.monitoringResourceIds.update(o=>{let a=new Set(o);return a.delete(t.id),a}),console.warn("[SearchDiscovery] \u76E3\u63A7\u6DFB\u52A0\u8D85\u6642\uFF0C\u5DF2\u6E05\u9664 loading \u72C0\u614B:",t.title))},3e4)}extractMembers(t){if(console.log("[SearchDiscovery] \u6253\u958B\u63D0\u53D6\u6210\u54E1\u5C0D\u8A71\u6846:",t.title),!t.telegram_id&&!t.username){this.toast.warning("\u7121\u6CD5\u63D0\u53D6\uFF1A\u7F3A\u5C11\u7FA4\u7D44\u6A19\u8B58");return}let e=t.joined_phone||this.mergedSelectedAccount()?.phone;if(t.status!=="joined"&&t.status!=="monitoring"){if(!e){this.toast.warning("\u26A0\uFE0F \u6C92\u6709\u53EF\u7528\u5E33\u865F\uFF0C\u8ACB\u5148\u767B\u9304\u4E00\u500B Telegram \u5E33\u865F\u3002",5e3);return}this.toast.info("\u{1F680} \u672A\u52A0\u5165\u7FA4\u7D44\uFF0C\u6B63\u5728\u81EA\u52D5\u52A0\u5165\u4E26\u63D0\u53D6\u6210\u54E1..."),this.ipc.send("join-and-extract",{resourceId:t.id,telegramId:t.telegram_id,username:t.username,groupName:t.title,phone:e,limit:200});return}let o={id:String(t.id||t.telegram_id||""),name:t.title||"\u672A\u77E5\u7FA4\u7D44",url:t.username?`https://t.me/${t.username}`:"",telegramId:t.telegram_id||"",memberCount:t.member_count||0,accountPhone:e,resourceType:t.resource_type||"group"};console.log("[SearchDiscovery] \u6253\u958B\u63D0\u53D6\u6210\u54E1\u5C0D\u8A71\u6846\uFF0C\u7FA4\u7D44\u4FE1\u606F:",o),this.dialogService.openMemberExtraction(o),this.extractMembersEvent.emit(t)}toggleBatchSelect(t,e){e.stopPropagation();let o=t.telegram_id||String(t.id),a=new Set(this.selectedForBatch());a.has(o)?a.delete(o):a.add(o),this.selectedForBatch.set(a)}isSelectedForBatch(t){let e=t.telegram_id||String(t.id);return this.selectedForBatch().has(e)}selectAllVisible(){let t=this.filteredResources().map(e=>e.telegram_id||String(e.id));this.selectedForBatch.set(new Set(t))}clearSelection(){this.selectedForBatch.set(new Set)}invertSelection(){let t=this.selectedForBatch(),e=this.filteredResources().map(a=>a.telegram_id||String(a.id)),o=new Set(e.filter(a=>!t.has(a)));this.selectedForBatch.set(o)}batchSaveSelected(){let t=this.filteredResources().filter(e=>this.selectedForBatch().has(e.telegram_id||String(e.id))&&!e.is_saved);if(t.length===0){this.toast.info("\u672A\u9078\u4E2D\u53EF\u6536\u85CF\u7684\u8CC7\u6E90");return}t.forEach(e=>this.saveResourceEvent.emit(e)),this.toast.success(`\u5DF2\u6536\u85CF ${t.length} \u500B\u8CC7\u6E90`),this.clearSelection()}copySelectedIds(){let t=this.filteredResources().filter(e=>this.selectedForBatch().has(e.telegram_id||String(e.id))).map(e=>e.telegram_id).filter(e=>e);if(t.length===0){this.toast.warning("\u9078\u4E2D\u7684\u8CC7\u6E90\u4E2D\u6C92\u6709\u53EF\u8907\u88FD\u7684 ID");return}navigator.clipboard.writeText(t.join(`
`)).then(()=>{this.toast.success(`\u5DF2\u8907\u88FD ${t.length} \u500B ID`)}).catch(()=>{this.toast.error("\u8907\u88FD\u5931\u6557")})}batchAddToMonitoring(){let e=this.filteredResources().filter(a=>this.selectedForBatch().has(a.telegram_id||String(a.id))).filter(a=>a.status!=="monitoring");if(e.length===0){this.toast.info("\u9078\u4E2D\u7684\u8CC7\u6E90\u5DF2\u5168\u90E8\u5728\u76E3\u63A7\u5217\u8868\u4E2D");return}let o=e.map(a=>({url:a.username?`https://t.me/${a.username}`:a.invite_link||`tg://resolve?id=${a.telegram_id}`,name:a.title||a.username||"",telegramId:a.telegram_id,username:a.username,resourceId:a.id,phone:a.joined_phone||this.mergedSelectedAccount()?.phone}));this.monitoringResourceIds.update(a=>{let u=new Set(a);return e.forEach(h=>u.add(h.id)),u}),this.ipc.send("batch-add-monitored-groups",{groups:o}),this.toast.info(`\u{1F4E1} \u6B63\u5728\u6279\u91CF\u6DFB\u52A0 ${e.length} \u500B\u7FA4\u7D44\u5230\u76E3\u63A7\u5217\u8868...`),setTimeout(()=>{this.monitoringResourceIds.update(a=>{let u=new Set(a);return e.forEach(h=>u.delete(h.id)),u})},6e4),this.clearSelection()}batchExtractSelected(){let t=this.filteredResources().filter(o=>this.selectedForBatch().has(o.telegram_id||String(o.id)));if(t.length===0){this.toast.warning("\u8ACB\u5148\u9078\u64C7\u7FA4\u7D44");return}let e=t.map(o=>o.id).filter(o=>o);if(e.length===0){this.toast.warning("\u9078\u4E2D\u7684\u7FA4\u7D44\u7F3A\u5C11\u6709\u6548 ID");return}this.toast.info(`\u{1F680} \u958B\u59CB\u6279\u91CF\u63D0\u53D6 ${e.length} \u500B\u7FA4\u7D44\u7684\u6210\u54E1...`),this.ipc.send("batch-extract-members",{resourceIds:e,limit:100,safeMode:!0}),this.clearSelection()}batchSave(){let t=this.filteredResources().filter(e=>!e.is_saved);if(t.length===0){this.toast.info("\u6240\u6709\u7D50\u679C\u90FD\u5DF2\u6536\u85CF");return}t.forEach(e=>this.saveResourceEvent.emit(e)),this.toast.success(`\u5DF2\u6536\u85CF ${t.length} \u500B\u8CC7\u6E90`)}exportResults(){let t=this.filteredResources();if(t.length===0){this.toast.warning("\u6C92\u6709\u53EF\u5C0E\u51FA\u7684\u7D50\u679C");return}let e=t.map((F,Q)=>({\u5E8F\u865F:Q+1,ID:F.telegram_id||"",\u540D\u7A31:F.title||"",Username:F.username||"",\u985E\u578B:F.resource_type==="channel"?"\u983B\u9053":"\u7FA4\u7D44",\u6210\u54E1\u6578:F.member_count||0,\u63CF\u8FF0:(F.description||"").replace(/"/g,'""').substring(0,200),\u9023\u7D50:F.username?`https://t.me/${F.username}`:"",\u4F86\u6E90:F.source||"search"})),a=[["\u5E8F\u865F","ID","\u540D\u7A31","Username","\u985E\u578B","\u6210\u54E1\u6578","\u63CF\u8FF0","\u9023\u7D50","\u4F86\u6E90"].join(","),...e.map(F=>[F.\u5E8F\u865F,`"${F.ID}"`,`"${F.\u540D\u7A31}"`,F.Username,F.\u985E\u578B,F.\u6210\u54E1\u6578,`"${F.\u63CF\u8FF0}"`,F.\u9023\u7D50,F.\u4F86\u6E90].join(","))].join(`
`),u=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a");h.href=URL.createObjectURL(u);let O=this.searchQuery||"all";h.download=`telegram-search-${O}-${t.length}\u689D-${new Date().toISOString().split("T")[0]}.csv`,h.click(),this.toast.success(`\u5DF2\u5C0E\u51FA ${t.length} \u689D\u641C\u7D22\u7D50\u679C`)}copyId(t,e){e.stopPropagation();let o=t.telegram_id||"";if(!o){this.toast.warning("\u7121\u53EF\u8907\u88FD\u7684 ID");return}navigator.clipboard.writeText(o).then(()=>{this.copiedId.set(o),console.log("\u2705 ID \u5DF2\u8907\u88FD:",o),setTimeout(()=>this.copiedId.set(""),2e3)}).catch(()=>{this.toast.error("\u8907\u88FD\u5931\u6557")})}copyLink(t,e){if(e.stopPropagation(),!t.username){this.toast.warning("\u8A72\u8CC7\u6E90\u6C92\u6709\u516C\u958B\u9023\u7D50");return}let o=`https://t.me/${t.username}`;navigator.clipboard.writeText(o).then(()=>{this.copiedLink.set(t.username),console.log("\u2705 \u9023\u7D50\u5DF2\u8907\u88FD:",o),setTimeout(()=>this.copiedLink.set(""),2e3)}).catch(()=>{this.toast.error("\u8907\u88FD\u5931\u6557")})}getSourceLabel(t){return{telegram:"TG\u5B98\u65B9",jiso:"\u4E2D\u6587\u641C\u7D22",tgstat:"TGStat",local:"\u672C\u5730"}[t]||t}formatScore(t){return t==null?"0.0/1.0":`${t.toFixed(1)}/1.0`}resetFilters(){this.filterType="all",this.filterMemberMin.set(null),this.filterMemberMax.set(null),this.filterSource.set("all"),this.filterJoinStatus.set("all"),this.filterHasId.set(!1)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=G({type:i,selectors:[["app-search-discovery"]],inputs:{initialView:[1,"initialView"],resources:[1,"resources"],isSearching:[1,"isSearching"],selectedAccount:[1,"selectedAccount"],availableAccounts:[1,"availableAccounts"],historyKeywords:[1,"historyKeywords"],currentKeyword:[1,"currentKeyword"],searchError:[1,"searchError"],savedResourceIds:[1,"savedResourceIds"]},outputs:{searchEvent:"searchEvent",selectAccountEvent:"selectAccountEvent",saveResourceEvent:"saveResourceEvent",unsaveResourceEvent:"unsaveResourceEvent",joinResourceEvent:"joinResourceEvent",extractMembersEvent:"extractMembersEvent",clearResultsEvent:"clearResultsEvent"},decls:52,vars:18,consts:[[1,"h-full","flex","flex-col","bg-slate-900","text-white","overflow-hidden"],[1,"flex-shrink-0","px-6","py-4","border-b","border-slate-700/50","bg-slate-900/95","backdrop-blur-sm"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],[1,"text-2xl","font-bold","text-white","flex","items-center","gap-3"],[1,"text-2xl"],[1,"flex","items-center","gap-2","text-sm"],[1,"px-3","py-1","bg-cyan-500/20","text-cyan-400","rounded-lg"],[1,"px-3","py-1","bg-yellow-500/20","text-yellow-400","rounded-lg"],[1,"px-3","py-1","rounded-lg","text-sm","transition-all",3,"click"],[1,"text-slate-400"],[1,"relative"],[1,"text-red-400","text-sm","px-3","py-1.5","bg-red-500/10","rounded-lg"],[1,"px-3","py-1.5","rounded-lg","text-sm","bg-blue-500/20","text-blue-400","animate-pulse"],[1,"px-3","py-1.5","rounded-lg","text-sm","bg-green-500/20","text-green-400"],[1,"flex-shrink-0","border-b","border-purple-500/20","bg-purple-900/10","animate-slideDown"],[1,"flex-shrink-0","px-6","py-4","border-b","border-slate-700/30","bg-slate-800/30"],[1,"flex","gap-3","mb-4"],[1,"flex-1","relative"],["type","text","placeholder","\u8F38\u5165\u95DC\u9375\u8A5E\u641C\u7D22\u7FA4\u7D44\u548C\u983B\u9053...",1,"w-full","bg-slate-700/50","border","border-slate-600","rounded-xl","py-3","px-4","pl-12","text-white","text-lg","focus:ring-2","focus:ring-cyan-500/50","focus:border-cyan-500","transition-all",3,"ngModelChange","keyup.enter","focus","blur","ngModel"],[1,"absolute","left-4","top-1/2","-translate-y-1/2","text-slate-400","text-xl"],[1,"absolute","top-full","left-0","right-0","mt-2","bg-slate-800","border","border-slate-700","rounded-xl","shadow-xl","z-50","overflow-hidden"],[1,"px-8","py-3","bg-gradient-to-r","from-cyan-500","to-blue-500","hover:from-cyan-400","hover:to-blue-400","text-white","rounded-xl","font-medium","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","shadow-lg","shadow-cyan-500/25",3,"click","disabled"],[1,"text-sm","text-slate-400"],[1,"flex","gap-2"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-lg","transition-all",3,"class","title"],[1,"flex","items-center","gap-2"],[1,"text-xs","px-2","py-1","bg-cyan-500/20","hover:bg-cyan-500/30","text-cyan-400","rounded","transition-all",3,"click"],[1,"text-xs","px-2","py-1","bg-slate-600/50","hover:bg-slate-600","text-slate-400","rounded","transition-all",3,"click"],[1,"flex-shrink-0","px-6","py-3","border-b","border-slate-700/30","bg-slate-800/20"],[1,"flex-1","overflow-y-auto","px-6","py-4"],[1,"space-y-4"],[1,"flex","flex-col","items-center","justify-center","h-full","text-center"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm","flex","items-center","justify-center","z-50","p-4"],[1,"fixed","inset-0","bg-black/60","backdrop-blur-sm","flex","items-center","justify-center","z-[100]"],[1,"flex","items-center","gap-2","px-3","py-1.5","bg-slate-700/50","hover:bg-slate-600/50","rounded-lg","border","border-slate-600/50",3,"click"],[1,"w-2","h-2","rounded-full"],[1,"font-mono","text-sm"],[1,"text-slate-400","text-xs"],[1,"absolute","top-full","right-0","mt-1","w-56","bg-slate-800","border","border-slate-700","rounded-lg","shadow-xl","z-50"],[1,"max-h-48","overflow-y-auto","p-1"],[1,"w-full","flex","items-center","gap-2","px-3","py-2","hover:bg-slate-700/50","rounded-lg","text-left"],[1,"w-full","flex","items-center","gap-2","px-3","py-2","hover:bg-slate-700/50","rounded-lg","text-left",3,"click"],[1,"font-mono","text-sm","flex-1"],[1,"px-6","py-3"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center","gap-3","text-sm"],[1,"text-purple-400","font-medium"],[1,"px-2","py-0.5","bg-green-500/20","text-green-400","rounded","text-xs"],[1,"px-2","py-0.5","bg-red-500/20","text-red-400","rounded","text-xs"],[1,"text-slate-400","hover:text-white","text-sm","px-2",3,"click"],[1,"max-h-32","overflow-y-auto","space-y-1"],[1,"flex","items-center","gap-2","text-xs","py-1","px-2","rounded","bg-slate-800/30"],[1,"text-center","text-slate-500","py-2","text-xs"],[1,"text-slate-400","w-14","flex-shrink-0"],[1,"text-slate-300","truncate","flex-1"],[1,"text-cyan-400","flex-shrink-0"],[1,"text-red-400","truncate","max-w-[200px]",3,"title"],[1,"text-slate-500","flex-shrink-0"],[1,"p-3","border-b","border-slate-700"],[1,"p-3"],[1,"text-xs","text-slate-500","mb-2"],[1,"flex","flex-wrap","gap-2"],[1,"px-3","py-1.5","bg-orange-500/10","hover:bg-orange-500/20","text-orange-300","hover:text-orange-200","rounded-lg","text-sm","transition-all"],[1,"px-3","py-1.5","bg-slate-700/50","hover:bg-cyan-500/20","text-slate-300","hover:text-cyan-400","rounded-lg","text-sm","transition-all"],[1,"px-3","py-1.5","bg-slate-700/50","hover:bg-cyan-500/20","text-slate-300","hover:text-cyan-400","rounded-lg","text-sm","transition-all",3,"mousedown"],[1,"px-3","py-1.5","bg-orange-500/10","hover:bg-orange-500/20","text-orange-300","hover:text-orange-200","rounded-lg","text-sm","transition-all",3,"mousedown"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-lg","transition-all",3,"title"],["type","checkbox",1,"hidden",3,"change","checked","disabled"],[1,"text-sm"],[1,"text-[10px]","px-1.5","py-0.5","rounded",3,"class"],[1,"text-[10px]","px-1.5","py-0.5","rounded"],[1,"text-slate-400","text-sm","flex","items-center","gap-3"],[1,"font-bold","text-white"],[1,"text-cyan-400","text-sm","flex","items-center","gap-1"],[1,"text-amber-400","text-sm","flex","items-center","gap-1"],[1,"bg-slate-700/50","border","border-slate-600","rounded-lg","py-1.5","px-3","text-white","text-sm",3,"ngModelChange","ngModel"],["value","all"],["value","group"],["value","channel"],[1,"px-3","py-1.5","rounded-lg","text-sm","flex","items-center","gap-1","transition-all",3,"click"],[1,"ml-1","px-1.5","py-0.5","bg-cyan-500","text-white","text-xs","rounded-full"],[1,"px-3","py-1.5","bg-yellow-500/20","text-yellow-400","rounded-lg","hover:bg-yellow-500/30","text-sm","flex","items-center","gap-1",3,"click"],[1,"px-3","py-1.5","rounded-lg","text-sm","flex","items-center","gap-1","transition-all",3,"click","disabled"],[1,"mt-3","pt-3","border-t","border-slate-700/30","grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"mt-3","pt-3","border-t","border-slate-700/30","flex","items-center","justify-between"],[1,"text-slate-400","text-sm"],[1,"px-3","py-1","bg-cyan-500/20","text-cyan-400","rounded-full","text-sm","font-medium"],[1,"text-green-400","text-xs"],[1,"text-slate-500","text-xs"],[1,"animate-spin"],[1,"animate-pulse"],[1,"text-xs","text-slate-400","mb-1","block"],["type","number","placeholder","\u6700\u5C11",1,"w-full","bg-slate-700/50","border","border-slate-600","rounded","py-1.5","px-2","text-white","text-sm",3,"change","value"],[1,"text-slate-500"],["type","number","placeholder","\u6700\u591A",1,"w-full","bg-slate-700/50","border","border-slate-600","rounded","py-1.5","px-2","text-white","text-sm",3,"change","value"],[1,"w-full","bg-slate-700/50","border","border-slate-600","rounded","py-1.5","px-2","text-white","text-sm",3,"change","value"],["value","telegram"],["value","jiso"],["value","local"],["value","monitoring"],["value","joined"],["value","not_joined"],[1,"flex","items-center","gap-2","cursor-pointer"],["type","checkbox",1,"rounded","border-slate-500","bg-slate-700","text-cyan-500",3,"change","checked"],[1,"text-sm","text-slate-300"],[1,"text-xs","text-slate-400","hover:text-white","underline",3,"click"],[1,"flex","items-center","gap-3"],[1,"px-2","py-1","text-xs","bg-slate-700/50","hover:bg-slate-700","text-slate-300","rounded","transition-all",3,"click"],[1,"flex","items-center","gap-3","px-3","py-1.5","bg-cyan-500/10","rounded-lg","border","border-cyan-500/30"],[1,"text-cyan-400","text-sm","font-medium"],[1,"w-px","h-4","bg-slate-600"],[1,"px-2","py-1","text-xs","bg-yellow-500/20","hover:bg-yellow-500/30","text-yellow-400","rounded","transition-all",3,"click"],[1,"px-2","py-1","text-xs","bg-cyan-500/20","hover:bg-cyan-500/30","text-cyan-400","rounded","transition-all",3,"click"],[1,"px-2","py-1","text-xs","bg-green-500/20","hover:bg-green-500/30","text-green-400","rounded","transition-all",3,"click"],[1,"px-2","py-1","text-xs","bg-purple-500/20","hover:bg-purple-500/30","text-purple-400","rounded","transition-all",3,"click"],[1,"animate-pulse","bg-slate-800/50","rounded-xl","p-4","border","border-slate-700/50"],[1,"flex","items-start","gap-4"],[1,"w-12","h-12","bg-slate-700","rounded-lg"],[1,"flex-1","space-y-2"],[1,"h-5","bg-slate-700","rounded","w-1/3"],[1,"h-4","bg-slate-700","rounded","w-1/4"],[1,"h-3","bg-slate-700","rounded","w-2/3"],[1,"max-w-md"],[1,"text-6xl","mb-4"],[1,"text-red-400","text-xl","mb-2"],[1,"text-slate-400","mb-4"],[1,"px-4","py-2","bg-cyan-500","hover:bg-cyan-600","text-white","rounded-lg",3,"click"],[1,"text-slate-300","text-xl","mb-2"],[1,"text-slate-500","mb-6"],[1,"flex","flex-wrap","justify-center","gap-2","max-w-lg"],[1,"text-slate-500","text-sm"],[1,"px-3","py-1.5","bg-slate-700/50","hover:bg-cyan-500/20","text-slate-400","hover:text-cyan-400","rounded-full","text-sm","transition-all"],[1,"px-3","py-1.5","bg-slate-700/50","hover:bg-cyan-500/20","text-slate-400","hover:text-cyan-400","rounded-full","text-sm","transition-all",3,"click"],[1,"flex","items-center","justify-between","mb-3","px-1"],[1,"text-white","font-bold"],[1,"text-cyan-400"],[1,"bg-slate-700/50","border","border-slate-600","rounded","px-2","py-1","text-sm","text-white",3,"ngModelChange","ngModel"],[3,"value"],[1,"space-y-3"],[1,"group","bg-gradient-to-r","from-slate-800/80","to-slate-800/40","rounded-xl","border","transition-all","duration-300","overflow-hidden","cursor-pointer",3,"class"],[1,"flex","items-center","justify-center","gap-2","mt-4","py-3","border-t","border-slate-700/50"],[1,"group","bg-gradient-to-r","from-slate-800/80","to-slate-800/40","rounded-xl","border","transition-all","duration-300","overflow-hidden","cursor-pointer",3,"click"],[1,"p-4","flex","items-start","gap-4"],[1,"flex-shrink-0","flex","flex-col","gap-2"],[1,"relative","cursor-pointer",3,"click"],["type","checkbox",1,"sr-only",3,"change","checked"],[1,"w-5","h-5","rounded","border-2","flex","items-center","justify-center","transition-all"],[1,"text-white","text-xs"],[1,"p-2","rounded-lg","transition-all",3,"click","title"],[1,"flex-1","min-w-0"],[1,"flex","items-center","gap-2","mb-2","flex-wrap"],[1,"px-2.5","py-1","text-xs","rounded-full","font-medium","flex-shrink-0"],[1,"px-2","py-0.5","text-xs","rounded-full","font-medium","bg-green-500/30","text-green-300","flex-shrink-0"],[1,"px-2","py-0.5","text-xs","rounded-full","font-medium","bg-blue-500/30","text-blue-300","flex-shrink-0"],[1,"px-2","py-0.5","text-xs","rounded-full","font-medium","bg-yellow-500/30","text-yellow-300","flex-shrink-0"],[1,"px-2","py-0.5","text-xs","rounded-full","font-medium","bg-cyan-500/30","text-cyan-300","flex-shrink-0","animate-pulse"],[1,"px-2","py-0.5","text-xs","rounded-full","font-medium","bg-slate-600/30","text-slate-400","flex-shrink-0"],[1,"font-semibold","text-white","truncate"],["target","_blank",1,"text-cyan-400","text-sm","hover:underline","flex-shrink-0",3,"href"],[1,"flex","items-center","gap-3","mb-2","bg-slate-900/50","rounded-lg","px-3","py-2"],[1,"text-slate-400","text-sm","mb-2","line-clamp-2"],[1,"flex","items-center","gap-4","text-sm","flex-wrap"],[1,"flex","items-center","gap-1","text-slate-400"],[1,"text-lg"],[1,"font-medium","text-white"],["title","\u76F8\u6BD4\u4E0A\u6B21\u589E\u52A0",1,"text-green-400","text-xs","ml-1"],["title","\u76F8\u6BD4\u4E0A\u6B21\u6E1B\u5C11",1,"text-red-400","text-xs","ml-1"],[1,"flex","items-center","gap-1.5"],[1,"text-xs","text-slate-500","font-mono"],[1,"px-2","py-0.5","bg-slate-700/50","text-slate-400","rounded","text-xs"],[1,"px-2","py-0.5","bg-blue-500/20","text-blue-400","rounded","text-xs"],[1,"flex-shrink-0","flex","flex-col","gap-2",3,"click"],[1,"flex","flex-col","items-center"],["disabled","",1,"px-4","py-2","bg-slate-600","text-slate-300","rounded-lg","text-sm","font-medium","cursor-wait","flex","items-center","gap-1"],["disabled","","title","\u983B\u9053\u7121\u6CD5\u63D0\u53D6\u6210\u54E1",1,"px-4","py-2","bg-slate-500/20","text-slate-500","rounded-lg","text-sm","cursor-not-allowed"],["target","_blank",1,"text-cyan-400","text-sm","hover:underline","flex-shrink-0",3,"click","href"],[1,"font-mono","text-cyan-300","text-sm","select-all"],["title","\u8907\u88FD ID",1,"px-2","py-1","text-xs","rounded","transition-all",3,"click"],[1,"font-mono","text-slate-400","text-sm"],["title","\u52A0\u5165\u7FA4\u7D44\u5F8C\u53EF\u7372\u53D6\u5B8C\u6574\u6578\u5B57 ID",1,"text-xs","text-amber-400/80","bg-amber-500/10","px-2","py-0.5","rounded"],[1,"text-slate-600"],["title","\u8907\u88FD\u9023\u7D50",1,"px-2","py-1","text-xs","rounded","transition-all",3,"click"],[1,"text-yellow-400"],[1,"text-yellow-400","font-medium"],[1,"px-4","py-2","bg-green-500/20","text-green-400","rounded-lg","text-sm","text-center"],[1,"px-4","py-1.5","bg-emerald-500/15","text-emerald-400","rounded-lg","text-xs","text-center","mt-1"],[1,"text-xs","text-slate-500","mt-1"],["disabled","",1,"px-4","py-2","bg-emerald-500/10","text-emerald-400/60","rounded-lg","text-sm","cursor-wait","flex","items-center","gap-1"],[1,"px-4","py-2","bg-emerald-500/20","hover:bg-emerald-500/30","text-emerald-400","rounded-lg","text-sm","transition-all"],[1,"px-4","py-2","bg-emerald-500/20","hover:bg-emerald-500/30","text-emerald-400","rounded-lg","text-sm","transition-all",3,"click"],[1,"px-4","py-2","bg-cyan-500","hover:bg-cyan-400","text-white","rounded-lg","text-sm","font-medium","transition-all","shadow-lg","shadow-cyan-500/20",3,"click"],["disabled","","title","\u6B63\u5728\u6DFB\u52A0\u5230\u76E3\u63A7\u5217\u8868...",1,"px-4","py-2","bg-emerald-500/10","text-emerald-400/60","rounded-lg","text-sm","cursor-wait","flex","items-center","gap-1"],["title","\u76F4\u63A5\u6DFB\u52A0\u5230\u76E3\u63A7\u7FA4\u7D44\u5217\u8868",1,"px-4","py-2","bg-emerald-500/20","hover:bg-emerald-500/30","text-emerald-400","rounded-lg","text-sm","transition-all"],["title","\u76F4\u63A5\u6DFB\u52A0\u5230\u76E3\u63A7\u7FA4\u7D44\u5217\u8868",1,"px-4","py-2","bg-emerald-500/20","hover:bg-emerald-500/30","text-emerald-400","rounded-lg","text-sm","transition-all",3,"click"],[1,"px-4","py-2","bg-purple-500/20","hover:bg-purple-500/30","text-purple-400","rounded-lg","text-sm","transition-all"],["disabled","","title","\u9700\u8981\u5148\u52A0\u5165\u7FA4\u7D44\u624D\u80FD\u63D0\u53D6\u6210\u54E1",1,"px-4","py-2","bg-slate-500/20","text-slate-500","rounded-lg","text-sm","cursor-not-allowed"],[1,"px-4","py-2","bg-purple-500/20","hover:bg-purple-500/30","text-purple-400","rounded-lg","text-sm","transition-all",3,"click"],[1,"px-3","py-1.5","rounded-lg","text-sm","transition-all",3,"click","disabled"],[1,"w-8","h-8","rounded-lg","text-sm","font-medium","transition-all",3,"class"],[1,"ml-2","text-sm","text-slate-400"],[1,"w-8","h-8","rounded-lg","text-sm","font-medium","transition-all",3,"click"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-slate-800","rounded-2xl","w-full","max-w-2xl","max-h-[90vh]","overflow-hidden","shadow-2xl","border","border-slate-700",3,"click"],[1,"px-6","py-4","border-b","border-slate-700","flex","items-center","justify-between","bg-slate-800/95"],[1,"px-3","py-1","text-sm","rounded-full","font-medium"],[1,"text-xl","font-bold","text-white"],["title","\u4E0A\u4E00\u500B (\u2190 \u9375)",1,"p-2","rounded-lg","transition-all",3,"click","disabled"],["title","\u4E0B\u4E00\u500B (\u2192 \u9375)",1,"p-2","rounded-lg","transition-all",3,"click","disabled"],[1,"w-px","h-6","bg-slate-700","mx-1"],["title","\u95DC\u9589 (Esc \u9375)",1,"p-2","text-slate-400","hover:text-white","hover:bg-slate-700","rounded-lg","transition-all",3,"click"],[1,"p-6","overflow-y-auto","max-h-[calc(90vh-140px)]"],[1,"flex","items-start","gap-4","mb-6"],[1,"w-16","h-16","rounded-xl","bg-gradient-to-br","from-cyan-500","to-blue-600","flex","items-center","justify-center","text-3xl","flex-shrink-0"],[1,"text-2xl","font-bold","text-white","mb-1"],["target","_blank",1,"text-cyan-400","hover:underline",3,"href"],[1,"p-3","rounded-xl","transition-all",3,"click"],[1,"bg-slate-900/50","rounded-xl","p-4","mb-4"],[1,"text-slate-300","font-medium","mb-3","flex","items-center","gap-2"],[1,"grid","grid-cols-2","gap-4"],[1,"text-slate-500","text-sm","mb-1"],[1,"text-white"],["target","_blank",1,"text-cyan-400","hover:underline","text-sm",3,"href"],[1,"grid","grid-cols-3","gap-4"],[1,"text-center","p-3","bg-slate-800/50","rounded-lg"],[1,"text-2xl","font-bold","text-cyan-400"],[1,"text-xl","font-bold","text-yellow-400","mb-1"],[1,"text-cyan-400","font-mono","text-lg"],[1,"text-2xl","font-bold"],[1,"bg-slate-900/50","rounded-xl","p-4"],[1,"px-3","py-1","bg-slate-700","text-slate-300","rounded-full","text-sm"],[1,"px-3","py-1","bg-cyan-500/20","text-cyan-400","rounded-full","text-sm"],[1,"px-6","py-4","border-t","border-slate-700","bg-slate-800/95","flex","items-center","justify-between"],[1,"px-4","py-2","rounded-lg","transition-all","flex","items-center","gap-2",3,"click"],["target","_blank",1,"px-4","py-2","bg-slate-700","text-slate-300","hover:bg-slate-600","rounded-lg","flex","items-center","gap-2",3,"href"],[1,"px-4","py-2","bg-slate-700","text-slate-300","hover:bg-slate-600","rounded-lg",3,"click"],[1,"font-mono","text-cyan-300"],[1,"px-2","py-1","text-xs","rounded","transition-all",3,"click"],[1,"font-mono","text-slate-400"],["title","\u52A0\u5165\u7FA4\u7D44\u5F8C\u53EF\u7372\u53D6\u5B8C\u6574\u6578\u5B57 ID",1,"text-xs","text-amber-400/80"],["title","\u6B63\u5728\u540C\u6B65ID...",1,"text-xs","text-blue-400/80"],[1,"text-blue-400"],[1,"px-2","py-1","text-xs","bg-slate-700","text-slate-400","hover:bg-cyan-500/20","hover:text-cyan-400","rounded","transition-all",3,"click"],[1,"text-slate-400","whitespace-pre-wrap"],[1,"px-5","py-2","bg-emerald-500/20","hover:bg-emerald-500/30","text-emerald-400","rounded-lg","font-medium","transition-all",3,"click"],[1,"px-6","py-2","bg-cyan-500","hover:bg-cyan-400","text-white","rounded-lg","font-medium","transition-all","shadow-lg","shadow-cyan-500/20",3,"click"],[1,"px-5","py-2","bg-emerald-500","hover:bg-emerald-600","text-white","rounded-lg","font-medium","transition-all",3,"click"],[1,"px-6","py-2","bg-purple-500","hover:bg-purple-400","text-white","rounded-lg","font-medium","transition-all"],[1,"px-6","py-2","bg-purple-500","hover:bg-purple-400","text-white","rounded-lg","font-medium","transition-all",3,"click"],[1,"px-4","py-2","bg-emerald-500/15","text-emerald-400","rounded-lg","text-sm","font-medium"],[1,"fixed","inset-0","bg-black/60","backdrop-blur-sm","flex","items-center","justify-center","z-[100]",3,"click"],[1,"bg-slate-800","rounded-2xl","border","border-slate-700","shadow-2xl","w-[420px]","max-h-[80vh]","overflow-hidden",3,"click"],[1,"p-5","border-b","border-slate-700","bg-gradient-to-r","from-cyan-500/10","to-blue-500/10"],[1,"text-lg","font-bold","text-white","flex","items-center","gap-2"],[1,"text-sm","text-slate-400","mt-1","truncate"],[1,"p-4","border-b","border-slate-700/50","bg-slate-800/50"],[1,"p-4","max-h-[300px]","overflow-y-auto"],[1,"text-sm","text-slate-400","mb-3"],[1,"space-y-2"],[1,"p-4","border-t","border-slate-700","flex","justify-end","gap-3"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-slate-300","rounded-lg","transition-colors",3,"click"],[1,"px-6","py-2","bg-cyan-500","hover:bg-cyan-400","disabled:bg-slate-600","disabled:text-slate-400","disabled:cursor-not-allowed","text-white","rounded-lg","font-medium","transition-all",3,"click","disabled"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-cyan-500","to-blue-600","flex","items-center","justify-center","text-2xl","font-bold","text-white"],[1,"font-medium","text-white","truncate"],[1,"text-sm","text-cyan-400"],[1,"text-xs","text-slate-500","flex","items-center","gap-2","mt-0.5"],[1,"flex","items-center","gap-3","p-3","rounded-xl","cursor-pointer","transition-all",3,"class"],[1,"flex","items-center","gap-3","p-3","rounded-xl","cursor-pointer","transition-all"],["type","radio",1,"w-4","h-4","text-cyan-500","bg-slate-700","border-slate-600","focus:ring-cyan-500",3,"change","value","checked"],[1,"flex-1"],[1,"font-mono","text-white"],[1,"text-xs","text-slate-400"],[1,"w-2","h-2","rounded-full","bg-green-400"]],template:function(e,o){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4)(5,"span",5),s(6),n(),s(7),n(),r(8,"div",6)(9,"span",7),s(10),n(),r(11,"span",8),s(12),n(),r(13,"button",9),m("click",function(){return o.showOperationHistory.set(!o.showOperationHistory())}),s(14),n()()(),r(15,"div",3)(16,"div",6)(17,"span",10),s(18,"\u4F7F\u7528\u5E33\u865F:"),n(),x(19,Pe,8,6,"div",11)(20,Ne,2,0,"span",12),n(),x(21,$e,2,0,"span",13)(22,Oe,2,0,"span",14),n()()(),x(23,ze,16,3,"div",15),r(24,"div",16)(25,"div",17)(26,"div",18)(27,"input",19),ue("ngModelChange",function(u){return ce(o.searchQuery,u)||(o.searchQuery=u),u}),m("keyup.enter",function(){return o.doSearch()})("focus",function(){return o.showSuggestions.set(!0)})("blur",function(){return o.hideSuggestions()}),n(),r(28,"span",20),s(29,"\u{1F50D}"),n(),x(30,We,8,1,"div",21),n(),r(31,"button",22),m("click",function(){return o.doSearch()}),s(32),n()(),r(33,"div",2)(34,"div",3)(35,"span",23),s(36,"\u641C\u7D22\u6E20\u9053:"),n(),r(37,"div",24),V(38,Xe,7,8,"label",25,re),n()(),r(40,"div",26)(41,"button",27),m("click",function(){return o.selectedSources.set(["telegram","jiso"])}),s(42," \u63A8\u85A6\u7D44\u5408 "),n(),r(43,"button",28),m("click",function(){return o.clearResults()}),s(44," \u6E05\u7A7A\u7D50\u679C "),n()()()(),x(45,st,29,15,"div",29),r(46,"div",30),x(47,lt,3,1,"div",31)(48,mt,3,1,"div",32)(49,Xt,22,5),n(),x(50,Fi,108,39,"div",33),x(51,Bi,18,3,"div",34),n()),e&2){let a,u;l(6),D(o.initialView()==="resource-center"?"\u{1F4E6}":"\u{1F50D}"),l(),v(" ",o.initialView()==="resource-center"?"\u8CC7\u6E90\u4E2D\u5FC3":"\u641C\u7D22\u767C\u73FE"," "),l(3),v(" ",o.mergedResources().length," \u7D50\u679C "),l(2),v(" ",o.savedCount()," \u5DF2\u6536\u85CF "),l(),E(o.showOperationHistory()?"bg-purple-500/30 text-purple-300 ring-1 ring-purple-500/50":"bg-slate-700/30 text-slate-400 hover:bg-slate-600/30"),l(),v(" \u{1F4CB} ",o.opHistory.todayRecords().length," \u64CD\u4F5C "),l(5),g((a=o.mergedSelectedAccount())?19:20,a),l(2),g(o.mergedSearching()?21:22),l(2),g(o.showOperationHistory()?23:-1),l(4),le("ngModel",o.searchQuery),l(3),g(o.showSuggestions()&&!o.mergedSearching()?30:-1),l(),w("disabled",o.mergedSearching()||!o.searchQuery.trim()),l(),v(" ",o.mergedSearching()?"\u641C\u7D22\u4E2D...":"\u641C\u7D22"," "),l(6),B(o.searchSources),l(7),g(o.mergedResources().length>0||o.currentKeyword()?45:-1),l(2),g(o.mergedSearching()?47:o.filteredResources().length===0?48:49),l(3),g((u=o.showDetailDialog()&&o.selectedResource())?50:-1,u),l(),g(o.showJoinAccountDialog()?51:-1)}},dependencies:[X,Y,ye,Se,ve,be,Ce,fe,ge,xe],styles:["[_nghost-%COMP%]{display:block;height:100%}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#64748b4d;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#64748b80}.animate-slideDown[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .2s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{max-height:0;opacity:0;overflow:hidden}to{max-height:200px;opacity:1}}"]})}};var Ie=class i{constructor(){this.i18n=M(we);this.nav=M(te);this.route=M(he);this.ipc=M(U);this.toast=M(Z);this.membershipService=M(De);this.accountService=M(ee);this.resourceService=M(Ee);this.routeDataSub=null;this.initialView=f("search-discovery")}setModeFromRoute(){let t=this.route.snapshot.data.discoveryMode;if(t==="resource-center"||t==="search-discovery")this.initialView.set(t);else{let e=this.nav.currentView();e==="resource-center"||e==="resources"?this.initialView.set("resource-center"):this.initialView.set("search-discovery")}}ngOnInit(){this.setModeFromRoute(),this.routeDataSub=this.route.data.subscribe(()=>this.setModeFromRoute())}ngOnDestroy(){this.routeDataSub?.unsubscribe()}navigateTo(t){this.nav.navigateTo(t)}selectResource(t){this.resourceService.toggleSelection(t.id)}batchJoin(t){let e=t.map(o=>o.id).join(",");this.resourceService.batchJoin(e)}t(t,e){return this.i18n.t(t,e)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=G({type:i,selectors:[["app-resource-discovery-view"]],decls:1,vars:1,consts:[[3,"resourceSelected","batchJoin","navigateTo","initialView"]],template:function(e,o){e&1&&(r(0,"app-search-discovery",0),m("resourceSelected",function(u){return o.selectResource(u)})("batchJoin",function(u){return o.batchJoin(u)})("navigateTo",function(u){return o.navigateTo(u)}),n()),e&2&&w("initialView",o.initialView())},dependencies:[X,Y,oe],encapsulation:2,changeDetection:0})}};export{Ie as ResourceDiscoveryViewComponent};
