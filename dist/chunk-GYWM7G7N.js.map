{
  "version": 3,
  "sources": ["src/services/security.service.ts", "src/auth/login.component.ts"],
  "sourcesContent": ["/**\r\n * å‰ç«¯å®‰å…¨æœå‹™\r\n * \r\n * P1.5: å®‰å…¨å¢å¼·\r\n * 1. CSRF Token ç®¡ç†\r\n * 2. ç™»å…¥å˜—è©¦é™åˆ¶\r\n * 3. å®‰å…¨é ­è™•ç†\r\n * 4. XSS é˜²è­·\r\n */\r\n\r\nimport { Injectable, signal, computed } from '@angular/core';\r\n\r\n// CSRF é…ç½®\r\nconst CSRF_CONFIG = {\r\n  COOKIE_NAME: 'csrf_token',\r\n  HEADER_NAME: 'X-CSRF-Token',\r\n  STORAGE_KEY: 'tgm_csrf_token'\r\n};\r\n\r\n// ç™»å…¥é™åˆ¶é…ç½®\r\nconst LOGIN_LIMIT_CONFIG = {\r\n  MAX_ATTEMPTS: 5,           // æœ€å¤§å˜—è©¦æ¬¡æ•¸\r\n  LOCKOUT_DURATION: 300,     // é–å®šæ™‚é•·ï¼ˆç§’ï¼‰\r\n  ATTEMPT_WINDOW: 900,       // å˜—è©¦çª—å£ï¼ˆç§’ï¼‰\r\n  STORAGE_KEY: 'tgm_login_attempts'\r\n};\r\n\r\ninterface LoginAttempt {\r\n  timestamp: number;\r\n  success: boolean;\r\n  email?: string;\r\n}\r\n\r\ninterface LoginLockout {\r\n  lockedUntil: number;\r\n  attempts: LoginAttempt[];\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FrontendSecurityService {\r\n  \r\n  // ==================== CSRF Token ç®¡ç† ====================\r\n  \r\n  private _csrfToken = signal<string>('');\r\n  readonly csrfToken = computed(() => this._csrfToken());\r\n  \r\n  constructor() {\r\n    // åˆå§‹åŒ–æ™‚å˜—è©¦å¾ Cookie ç²å– CSRF Token\r\n    this.refreshCsrfToken();\r\n  }\r\n  \r\n  /**\r\n   * å¾ Cookie åˆ·æ–° CSRF Token\r\n   */\r\n  refreshCsrfToken(): void {\r\n    const token = this.getCookie(CSRF_CONFIG.COOKIE_NAME);\r\n    if (token) {\r\n      this._csrfToken.set(token);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ç²å– CSRF Tokenï¼ˆç”¨æ–¼è«‹æ±‚é ­ï¼‰\r\n   */\r\n  getCsrfToken(): string {\r\n    return this._csrfToken();\r\n  }\r\n  \r\n  /**\r\n   * ç²å–åŒ…å« CSRF Token çš„è«‹æ±‚é ­\r\n   */\r\n  getCsrfHeaders(): Record<string, string> {\r\n    const token = this.getCsrfToken();\r\n    if (token) {\r\n      return { [CSRF_CONFIG.HEADER_NAME]: token };\r\n    }\r\n    return {};\r\n  }\r\n  \r\n  /**\r\n   * å¢å¼·çš„ fetchï¼Œè‡ªå‹•æ·»åŠ  CSRF Token\r\n   */\r\n  async secureFetch(url: string, options: RequestInit = {}): Promise<Response> {\r\n    const headers = new Headers(options.headers);\r\n    \r\n    // æ·»åŠ  CSRF Token\r\n    const csrfToken = this.getCsrfToken();\r\n    if (csrfToken) {\r\n      headers.set(CSRF_CONFIG.HEADER_NAME, csrfToken);\r\n    }\r\n    \r\n    // æ·»åŠ å®‰å…¨é ­\r\n    if (!headers.has('Content-Type')) {\r\n      headers.set('Content-Type', 'application/json');\r\n    }\r\n    \r\n    const response = await fetch(url, {\r\n      ...options,\r\n      headers,\r\n      credentials: 'include'  // åŒ…å« Cookie\r\n    });\r\n    \r\n    // å¾éŸ¿æ‡‰æ›´æ–° CSRF Token\r\n    this.refreshCsrfToken();\r\n    \r\n    return response;\r\n  }\r\n  \r\n  // ==================== ç™»å…¥å˜—è©¦é™åˆ¶ ====================\r\n  \r\n  private _isLocked = signal<boolean>(false);\r\n  private _lockoutRemaining = signal<number>(0);\r\n  private _attemptCount = signal<number>(0);\r\n  \r\n  readonly isLocked = computed(() => this._isLocked());\r\n  readonly lockoutRemaining = computed(() => this._lockoutRemaining());\r\n  readonly attemptCount = computed(() => this._attemptCount());\r\n  readonly attemptsLeft = computed(() => Math.max(0, LOGIN_LIMIT_CONFIG.MAX_ATTEMPTS - this._attemptCount()));\r\n  \r\n  /**\r\n   * æª¢æŸ¥æ˜¯å¦å¯ä»¥å˜—è©¦ç™»å…¥\r\n   */\r\n  canAttemptLogin(): { allowed: boolean; message?: string; waitSeconds?: number } {\r\n    const lockout = this.getLockoutData();\r\n    const now = Date.now();\r\n    \r\n    // æª¢æŸ¥æ˜¯å¦è¢«é–å®š\r\n    if (lockout.lockedUntil > now) {\r\n      const waitSeconds = Math.ceil((lockout.lockedUntil - now) / 1000);\r\n      this._isLocked.set(true);\r\n      this._lockoutRemaining.set(waitSeconds);\r\n      return {\r\n        allowed: false,\r\n        message: `ç™»å…¥å˜—è©¦æ¬¡æ•¸éå¤šï¼Œè«‹ ${this.formatDuration(waitSeconds)} å¾Œå†è©¦`,\r\n        waitSeconds\r\n      };\r\n    }\r\n    \r\n    this._isLocked.set(false);\r\n    this._lockoutRemaining.set(0);\r\n    \r\n    // è¨ˆç®—æœ€è¿‘çš„å˜—è©¦æ¬¡æ•¸\r\n    const recentAttempts = this.getRecentAttempts(lockout.attempts);\r\n    this._attemptCount.set(recentAttempts.length);\r\n    \r\n    if (recentAttempts.length >= LOGIN_LIMIT_CONFIG.MAX_ATTEMPTS) {\r\n      // è¨­ç½®é–å®š\r\n      const lockedUntil = now + LOGIN_LIMIT_CONFIG.LOCKOUT_DURATION * 1000;\r\n      this.setLockout(lockedUntil, lockout.attempts);\r\n      \r\n      const waitSeconds = LOGIN_LIMIT_CONFIG.LOCKOUT_DURATION;\r\n      this._isLocked.set(true);\r\n      this._lockoutRemaining.set(waitSeconds);\r\n      \r\n      return {\r\n        allowed: false,\r\n        message: `ç™»å…¥å˜—è©¦æ¬¡æ•¸éå¤šï¼Œè«‹ ${this.formatDuration(waitSeconds)} å¾Œå†è©¦`,\r\n        waitSeconds\r\n      };\r\n    }\r\n    \r\n    return { allowed: true };\r\n  }\r\n  \r\n  /**\r\n   * è¨˜éŒ„ç™»å…¥å˜—è©¦\r\n   */\r\n  recordLoginAttempt(success: boolean, email?: string): void {\r\n    const lockout = this.getLockoutData();\r\n    \r\n    // æ·»åŠ æ–°å˜—è©¦\r\n    lockout.attempts.push({\r\n      timestamp: Date.now(),\r\n      success,\r\n      email\r\n    });\r\n    \r\n    // åªä¿ç•™æœ€è¿‘çš„å˜—è©¦\r\n    lockout.attempts = this.getRecentAttempts(lockout.attempts);\r\n    \r\n    // å¦‚æœæˆåŠŸï¼Œæ¸…é™¤é–å®šå’Œå˜—è©¦è¨˜éŒ„\r\n    if (success) {\r\n      lockout.lockedUntil = 0;\r\n      lockout.attempts = [];\r\n    }\r\n    \r\n    this.saveLockoutData(lockout);\r\n    this._attemptCount.set(lockout.attempts.filter(a => !a.success).length);\r\n  }\r\n  \r\n  /**\r\n   * æ¸…é™¤ç™»å…¥é™åˆ¶\r\n   */\r\n  clearLoginLimit(): void {\r\n    localStorage.removeItem(LOGIN_LIMIT_CONFIG.STORAGE_KEY);\r\n    this._isLocked.set(false);\r\n    this._lockoutRemaining.set(0);\r\n    this._attemptCount.set(0);\r\n  }\r\n  \r\n  /**\r\n   * ç²å–æœ€è¿‘çš„å¤±æ•—å˜—è©¦\r\n   */\r\n  private getRecentAttempts(attempts: LoginAttempt[]): LoginAttempt[] {\r\n    const windowStart = Date.now() - LOGIN_LIMIT_CONFIG.ATTEMPT_WINDOW * 1000;\r\n    return attempts.filter(a => a.timestamp > windowStart && !a.success);\r\n  }\r\n  \r\n  /**\r\n   * ç²å–é–å®šæ•¸æ“š\r\n   */\r\n  private getLockoutData(): LoginLockout {\r\n    try {\r\n      const data = localStorage.getItem(LOGIN_LIMIT_CONFIG.STORAGE_KEY);\r\n      if (data) {\r\n        return JSON.parse(data);\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to parse lockout data:', e);\r\n    }\r\n    return { lockedUntil: 0, attempts: [] };\r\n  }\r\n  \r\n  /**\r\n   * ä¿å­˜é–å®šæ•¸æ“š\r\n   */\r\n  private saveLockoutData(data: LoginLockout): void {\r\n    localStorage.setItem(LOGIN_LIMIT_CONFIG.STORAGE_KEY, JSON.stringify(data));\r\n  }\r\n  \r\n  /**\r\n   * è¨­ç½®é–å®š\r\n   */\r\n  private setLockout(lockedUntil: number, attempts: LoginAttempt[]): void {\r\n    this.saveLockoutData({ lockedUntil, attempts });\r\n  }\r\n  \r\n  // ==================== XSS é˜²è­· ====================\r\n  \r\n  /**\r\n   * æ¸…ç† HTMLï¼ˆé˜²æ­¢ XSSï¼‰\r\n   */\r\n  sanitizeHtml(html: string): string {\r\n    // å‰µå»ºè‡¨æ™‚å…ƒç´ \r\n    const temp = document.createElement('div');\r\n    temp.textContent = html;\r\n    return temp.innerHTML;\r\n  }\r\n  \r\n  /**\r\n   * é©—è­‰ URL å®‰å…¨æ€§\r\n   */\r\n  isUrlSafe(url: string): boolean {\r\n    if (!url) return false;\r\n    \r\n    // ç¦æ­¢ javascript: å”è­°\r\n    if (url.toLowerCase().startsWith('javascript:')) return false;\r\n    \r\n    // ç¦æ­¢ data: å”è­°ï¼ˆé™¤äº†åœ–ç‰‡ï¼‰\r\n    if (url.toLowerCase().startsWith('data:') && !url.toLowerCase().startsWith('data:image/')) {\r\n      return false;\r\n    }\r\n    \r\n    // åªå…è¨± http/https å’Œç›¸å°è·¯å¾‘\r\n    if (url.startsWith('/') || url.startsWith('http://') || url.startsWith('https://')) {\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n  \r\n  /**\r\n   * è½‰ç¾© HTML ç‰¹æ®Šå­—ç¬¦\r\n   */\r\n  escapeHtml(text: string): string {\r\n    const map: Record<string, string> = {\r\n      '&': '&amp;',\r\n      '<': '&lt;',\r\n      '>': '&gt;',\r\n      '\"': '&quot;',\r\n      \"'\": '&#039;'\r\n    };\r\n    return text.replace(/[&<>\"']/g, m => map[m]);\r\n  }\r\n  \r\n  // ==================== è¼”åŠ©æ–¹æ³• ====================\r\n  \r\n  /**\r\n   * ç²å– Cookie å€¼\r\n   */\r\n  private getCookie(name: string): string | null {\r\n    const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));\r\n    return match ? decodeURIComponent(match[2]) : null;\r\n  }\r\n  \r\n  /**\r\n   * æ ¼å¼åŒ–æŒçºŒæ™‚é–“\r\n   */\r\n  private formatDuration(seconds: number): string {\r\n    if (seconds < 60) {\r\n      return `${seconds} ç§’`;\r\n    }\r\n    const minutes = Math.ceil(seconds / 60);\r\n    return `${minutes} åˆ†é˜`;\r\n  }\r\n  \r\n  /**\r\n   * å•Ÿå‹•é–å®šå€’è¨ˆæ™‚\r\n   */\r\n  startLockoutCountdown(callback?: (remaining: number) => void): () => void {\r\n    const interval = setInterval(() => {\r\n      const remaining = this._lockoutRemaining();\r\n      if (remaining <= 0) {\r\n        clearInterval(interval);\r\n        this._isLocked.set(false);\r\n        callback?.(0);\r\n        return;\r\n      }\r\n      \r\n      this._lockoutRemaining.update(r => r - 1);\r\n      callback?.(remaining - 1);\r\n    }, 1000);\r\n    \r\n    return () => clearInterval(interval);\r\n  }\r\n}\r\n", "/**\r\n * ç™»å…¥é é¢çµ„ä»¶\r\n * \r\n * å„ªåŒ–è¨­è¨ˆï¼š\r\n * 1. è¡¨å–®é©—è­‰å’ŒéŒ¯èª¤æç¤º\r\n * 2. å¯†ç¢¼å¯è¦‹åˆ‡æ›\r\n * 3. è¨˜ä½æˆ‘åŠŸèƒ½\r\n * 4. ç¬¬ä¸‰æ–¹ç™»å…¥å…¥å£\r\n * 5. åŠ è¼‰ç‹€æ…‹\r\n */\r\n\r\nimport { Component, inject, signal, computed, ChangeDetectionStrategy, OnInit, OnDestroy } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Router, RouterModule, ActivatedRoute } from '@angular/router';\r\nimport { AuthService } from '../core/auth.service';\r\nimport { I18nService } from '../i18n.service';\r\nimport { FrontendSecurityService } from '../services/security.service';\r\nimport { ElectronIpcService } from '../electron-ipc.service';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, RouterModule],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  template: `\r\n    <div class=\"login-page\">\r\n      <!-- ğŸ†• Phase 3: ç™»å…¥æˆåŠŸå‹•ç•«é®ç½© -->\r\n      @if (loginSuccess()) {\r\n        <div class=\"success-overlay\">\r\n          <div class=\"success-content\">\r\n            <div class=\"success-icon\">\r\n              <svg viewBox=\"0 0 52 52\" class=\"checkmark\">\r\n                <circle class=\"checkmark-circle\" cx=\"26\" cy=\"26\" r=\"25\" fill=\"none\"/>\r\n                <path class=\"checkmark-check\" fill=\"none\" d=\"M14.1 27.2l7.1 7.2 16.7-16.8\"/>\r\n              </svg>\r\n            </div>\r\n            <h3 class=\"success-title\">{{ t('auth.loginSuccess') }}</h3>\r\n            <p class=\"success-user\">{{ t('auth.welcomeBackUser') }}ï¼Œ{{ successUserName() }}</p>\r\n            <p class=\"success-hint\">{{ t('auth.redirecting') }}</p>\r\n          </div>\r\n        </div>\r\n      }\r\n      \r\n      <h2 class=\"page-title\">{{ t('auth.welcomeBack') }}</h2>\r\n      <p class=\"page-subtitle\">{{ t('auth.loginSubtitle') }}</p>\r\n      \r\n      <!-- é–å®šæç¤º -->\r\n      @if (isLocked()) {\r\n        <div class=\"lockout-alert\">\r\n          <span class=\"lockout-icon\">ğŸ”’</span>\r\n          <div class=\"lockout-content\">\r\n            <span class=\"lockout-title\">{{ t('auth.accountLocked') }}</span>\r\n            <span class=\"lockout-time\">{{ t('auth.waitSeconds', {seconds: lockoutRemaining()}) }}</span>\r\n          </div>\r\n        </div>\r\n      }\r\n      \r\n      <!-- éŒ¯èª¤æç¤º -->\r\n      @if (error() && !isLocked()) {\r\n        <div class=\"error-alert\">\r\n          <span class=\"error-icon\">âš ï¸</span>\r\n          <span>{{ error() }}</span>\r\n        </div>\r\n      }\r\n      \r\n      <form class=\"login-form\" (ngSubmit)=\"onSubmit()\">\r\n        <!-- éƒµç®± -->\r\n        <div class=\"form-group\">\r\n          <label for=\"email\">{{ t('auth.email') }}</label>\r\n          <div class=\"input-wrapper\">\r\n            <span class=\"input-icon\">ğŸ“§</span>\r\n            <input\r\n              type=\"email\"\r\n              id=\"email\"\r\n              [(ngModel)]=\"email\"\r\n              name=\"email\"\r\n              [placeholder]=\"t('auth.emailPlaceholder')\"\r\n              required\r\n              autocomplete=\"email\"\r\n              [disabled]=\"isLoading()\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- å¯†ç¢¼ -->\r\n        <div class=\"form-group\">\r\n          <label for=\"password\">{{ t('auth.password') }}</label>\r\n          <div class=\"input-wrapper\">\r\n            <span class=\"input-icon\">ğŸ”’</span>\r\n            <input\r\n              [type]=\"showPassword() ? 'text' : 'password'\"\r\n              id=\"password\"\r\n              [(ngModel)]=\"password\"\r\n              name=\"password\"\r\n              [placeholder]=\"t('auth.passwordPlaceholder')\"\r\n              required\r\n              autocomplete=\"current-password\"\r\n              [disabled]=\"isLoading()\"\r\n            />\r\n            <button \r\n              type=\"button\" \r\n              class=\"toggle-password\"\r\n              (click)=\"showPassword.set(!showPassword())\"\r\n            >\r\n              {{ showPassword() ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- è¨˜ä½æˆ‘ & å¿˜è¨˜å¯†ç¢¼ -->\r\n        <div class=\"form-options\">\r\n          <label class=\"checkbox-label\">\r\n            <input \r\n              type=\"checkbox\" \r\n              [(ngModel)]=\"rememberMe\" \r\n              name=\"rememberMe\"\r\n            />\r\n            <span>{{ t('auth.rememberMe') }}</span>\r\n          </label>\r\n          <a routerLink=\"/auth/forgot-password\" class=\"forgot-link\">\r\n            {{ t('auth.forgotPassword') }}\r\n          </a>\r\n        </div>\r\n        \r\n        <!-- ç™»å…¥æŒ‰éˆ• -->\r\n        <button \r\n          type=\"submit\" \r\n          class=\"submit-btn\"\r\n          [disabled]=\"isLoading() || !email || !password || isLocked()\"\r\n        >\r\n          @if (isLoading()) {\r\n            <span class=\"loading-spinner\"></span>\r\n            <span>{{ t('auth.loggingIn') }}</span>\r\n          } @else {\r\n            <span>{{ t('auth.login') }}</span>\r\n          }\r\n        </button>\r\n      </form>\r\n      \r\n      <!-- åˆ†éš”ç·š -->\r\n      <div class=\"divider\">\r\n        <span>{{ t('auth.or') }}</span>\r\n      </div>\r\n      \r\n      <!-- ğŸ†• Phase 2: å¤šç¨® Telegram ç™»å…¥æ–¹å¼ï¼ˆå« QR Codeï¼‰ -->\r\n      <div class=\"telegram-login-section\">\r\n        <!-- ç™»å…¥æ–¹å¼é¸æ“‡å™¨ -->\r\n        <div class=\"login-method-tabs\">\r\n          <button \r\n            class=\"method-tab\" \r\n            [class.active]=\"loginMethod() === 'qrcode'\"\r\n            (click)=\"switchLoginMethod('qrcode')\"\r\n          >\r\n            <span class=\"tab-icon\">ğŸ“·</span>\r\n            <span>{{ t('auth.qrCodeLogin') }}</span>\r\n          </button>\r\n          <button \r\n            class=\"method-tab\" \r\n            [class.active]=\"loginMethod() === 'deeplink'\"\r\n            (click)=\"switchLoginMethod('deeplink')\"\r\n          >\r\n            <span class=\"tab-icon\">ğŸ“±</span>\r\n            <span>{{ t('auth.appLogin') }}</span>\r\n          </button>\r\n          <button \r\n            class=\"method-tab\" \r\n            [class.active]=\"loginMethod() === 'widget'\"\r\n            (click)=\"switchLoginMethod('widget')\"\r\n          >\r\n            <span class=\"tab-icon\">ğŸ’¬</span>\r\n            <span>{{ t('auth.webLogin') }}</span>\r\n          </button>\r\n        </div>\r\n        \r\n        <!-- QR Code ç™»å…¥ï¼ˆé»˜èªï¼‰ -->\r\n        @if (loginMethod() === 'qrcode') {\r\n          <div class=\"qr-login-panel\">\r\n            @if (qrCodeLoading()) {\r\n              <div class=\"qr-loading\">\r\n                <span class=\"loading-spinner\"></span>\r\n                <span>{{ t('auth.generatingQR') }}</span>\r\n              </div>\r\n            } @else if (qrCodeUrl()) {\r\n              <div class=\"qr-container\">\r\n                <div class=\"qr-code-wrapper\">\r\n                  <img [src]=\"qrCodeUrl()\" [alt]=\"t('auth.telegramLoginQR')\" class=\"qr-code-img\" />\r\n                  @if (qrCodeExpired()) {\r\n                    <div class=\"qr-expired-overlay\">\r\n                      <span class=\"expired-text\">{{ t('auth.qrExpired') }}</span>\r\n                      <button class=\"refresh-btn\" (click)=\"refreshQRCode()\">{{ t('auth.clickToRefresh') }}</button>\r\n                    </div>\r\n                  }\r\n                </div>\r\n                <div class=\"qr-instructions\">\r\n                  <p class=\"step\"><span class=\"step-num\">1</span> {{ t('auth.openTelegram') }}</p>\r\n                  <p class=\"step\"><span class=\"step-num\">2</span> {{ t('auth.scanQRCode') }}</p>\r\n                  <p class=\"step\"><span class=\"step-num\">3</span> {{ t('auth.confirmLogin') }}</p>\r\n                </div>\r\n                \r\n                <!-- ğŸ†• é©—è­‰ç¢¼ï¼ˆè€ç”¨æˆ¶å‚™ç”¨ï¼‰ -->\r\n                @if (verifyCode()) {\r\n                  <div class=\"verify-code-section\">\r\n                    <p class=\"verify-hint\">æƒç¢¼ç„¡æ•ˆï¼Ÿåœ¨ Bot ä¸­è¼¸å…¥é©—è­‰ç¢¼ï¼š</p>\r\n                    <div class=\"verify-code\">{{ verifyCode() }}</div>\r\n                  </div>\r\n                }\r\n                @if (!qrCodeExpired()) {\r\n                  <div class=\"qr-countdown\">\r\n                    <span class=\"ws-status\" [class.connected]=\"wsConnected()\">\r\n                      {{ wsConnected() ? ('ğŸŸ¢ ' + t('auth.realtimeConnected')) : ('ğŸ”´ ' + t('auth.reconnecting')) }}\r\n                    </span>\r\n                    <span class=\"countdown-text\">{{ qrCountdown() }}s</span>\r\n                  </div>\r\n                }\r\n              </div>\r\n            } @else {\r\n              <button class=\"generate-qr-btn\" (click)=\"generateQRCode()\">\r\n                <span class=\"btn-icon\">ğŸ“·</span>\r\n                <span>{{ t('auth.generateQRCode') }}</span>\r\n              </button>\r\n            }\r\n          </div>\r\n        }\r\n        \r\n        <!-- Deep Link ç™»å…¥ -->\r\n        @if (loginMethod() === 'deeplink') {\r\n          <div class=\"deeplink-panel\">\r\n            <button \r\n              class=\"social-btn telegram full-width primary-telegram\" \r\n              (click)=\"openDeepLink()\"\r\n              [disabled]=\"telegramLoading()\"\r\n            >\r\n              @if (deepLinkLoading()) {\r\n                <span class=\"loading-spinner small\"></span>\r\n                <span>{{ t('auth.waitingConfirm') }}</span>\r\n              } @else {\r\n                <span class=\"social-icon\">ğŸ“±</span>\r\n                <span>{{ t('auth.openTelegramApp') }}</span>\r\n              }\r\n            </button>\r\n            \r\n            @if (deepLinkLoading()) {\r\n              <div class=\"deep-link-status\">\r\n                <div class=\"status-text\">\r\n                  {{ t('auth.clickConfirmInTelegram') }}\r\n                </div>\r\n                <div class=\"countdown\">\r\n                  {{ t('auth.remainingTime', {seconds: deepLinkCountdown()}) }}\r\n                </div>\r\n                <button class=\"cancel-btn\" (click)=\"cancelDeepLink()\">{{ t('auth.cancel') }}</button>\r\n              </div>\r\n            }\r\n          </div>\r\n        }\r\n        \r\n        <!-- Widget ç™»å…¥ï¼ˆå‚™ç”¨ï¼‰ -->\r\n        @if (loginMethod() === 'widget') {\r\n          <div class=\"widget-panel\">\r\n            <button \r\n              class=\"social-btn telegram full-width secondary-telegram\" \r\n              (click)=\"initTelegramWidget()\"\r\n              [disabled]=\"telegramLoading()\"\r\n            >\r\n              @if (telegramLoading() && !deepLinkLoading()) {\r\n                <span class=\"loading-spinner small\"></span>\r\n                <span>{{ t('auth.loadingTelegram') }}</span>\r\n              } @else {\r\n                <span class=\"social-icon\">ğŸ’¬</span>\r\n                <span>{{ t('auth.useTelegramWidget') }}</span>\r\n              }\r\n            </button>\r\n            <p class=\"widget-hint\">{{ t('auth.widgetHint') }}</p>\r\n          </div>\r\n        }\r\n      </div>\r\n      \r\n      <!-- è¨»å†Šå…¥å£ -->\r\n      <p class=\"register-link\">\r\n        {{ t('auth.noAccount') }}\r\n        <a routerLink=\"/auth/register\">{{ t('auth.registerNow') }}</a>\r\n      </p>\r\n    </div>\r\n  `,\r\n  styles: [`\r\n    .login-page {\r\n      color: var(--text-primary, #fff);\r\n    }\r\n    \r\n    .page-title {\r\n      font-size: 1.75rem;\r\n      font-weight: 700;\r\n      margin-bottom: 0.5rem;\r\n    }\r\n    \r\n    .page-subtitle {\r\n      color: var(--text-secondary, #888);\r\n      margin-bottom: 2rem;\r\n    }\r\n    \r\n    .error-alert {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.5rem;\r\n      padding: 0.875rem 1rem;\r\n      background: rgba(239, 68, 68, 0.1);\r\n      border: 1px solid rgba(239, 68, 68, 0.3);\r\n      border-radius: 8px;\r\n      color: #f87171;\r\n      margin-bottom: 1.5rem;\r\n      font-size: 0.875rem;\r\n    }\r\n    \r\n    .lockout-alert {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.75rem;\r\n      padding: 1rem 1.25rem;\r\n      background: rgba(251, 146, 60, 0.1);\r\n      border: 1px solid rgba(251, 146, 60, 0.3);\r\n      border-radius: 8px;\r\n      color: #fb923c;\r\n      margin-bottom: 1.5rem;\r\n    }\r\n    \r\n    .lockout-icon {\r\n      font-size: 1.5rem;\r\n    }\r\n    \r\n    .lockout-content {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.25rem;\r\n    }\r\n    \r\n    .lockout-title {\r\n      font-weight: 600;\r\n      font-size: 0.9rem;\r\n    }\r\n    \r\n    .lockout-time {\r\n      font-size: 0.8rem;\r\n      opacity: 0.8;\r\n    }\r\n    \r\n    .login-form {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 1.25rem;\r\n    }\r\n    \r\n    .form-group {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.5rem;\r\n    }\r\n    \r\n    .form-group label {\r\n      font-size: 0.875rem;\r\n      font-weight: 500;\r\n      color: var(--text-secondary, #aaa);\r\n    }\r\n    \r\n    .input-wrapper {\r\n      position: relative;\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n    \r\n    .input-icon {\r\n      position: absolute;\r\n      left: 1rem;\r\n      font-size: 1rem;\r\n      opacity: 0.5;\r\n    }\r\n    \r\n    .input-wrapper input {\r\n      width: 100%;\r\n      padding: 0.875rem 1rem 0.875rem 2.75rem;\r\n      background: var(--bg-secondary, #1a1a1a);\r\n      border: 1px solid var(--border-color, #333);\r\n      border-radius: 8px;\r\n      color: var(--text-primary, #fff);\r\n      font-size: 1rem;\r\n      transition: all 0.2s ease;\r\n    }\r\n    \r\n    .input-wrapper input:focus {\r\n      outline: none;\r\n      border-color: var(--primary, #3b82f6);\r\n      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\r\n    }\r\n    \r\n    .input-wrapper input::placeholder {\r\n      color: var(--text-muted, #666);\r\n    }\r\n    \r\n    .toggle-password {\r\n      position: absolute;\r\n      right: 1rem;\r\n      background: none;\r\n      border: none;\r\n      cursor: pointer;\r\n      font-size: 1rem;\r\n      opacity: 0.5;\r\n      transition: opacity 0.2s;\r\n    }\r\n    \r\n    .toggle-password:hover {\r\n      opacity: 1;\r\n    }\r\n    \r\n    .form-options {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      font-size: 0.875rem;\r\n    }\r\n    \r\n    .checkbox-label {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.5rem;\r\n      cursor: pointer;\r\n      color: var(--text-secondary, #aaa);\r\n    }\r\n    \r\n    .checkbox-label input[type=\"checkbox\"] {\r\n      width: 16px;\r\n      height: 16px;\r\n      accent-color: var(--primary, #3b82f6);\r\n    }\r\n    \r\n    .forgot-link {\r\n      color: var(--primary, #3b82f6);\r\n      text-decoration: none;\r\n      transition: color 0.2s;\r\n    }\r\n    \r\n    .forgot-link:hover {\r\n      color: var(--primary-hover, #60a5fa);\r\n      text-decoration: underline;\r\n    }\r\n    \r\n    .submit-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: 0.5rem;\r\n      padding: 0.875rem 1.5rem;\r\n      background: linear-gradient(135deg, #3b82f6, #8b5cf6);\r\n      border: none;\r\n      border-radius: 8px;\r\n      color: white;\r\n      font-size: 1rem;\r\n      font-weight: 600;\r\n      cursor: pointer;\r\n      transition: all 0.2s ease;\r\n      margin-top: 0.5rem;\r\n    }\r\n    \r\n    .submit-btn:hover:not(:disabled) {\r\n      transform: translateY(-1px);\r\n      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\r\n    }\r\n    \r\n    .submit-btn:disabled {\r\n      opacity: 0.6;\r\n      cursor: not-allowed;\r\n    }\r\n    \r\n    .loading-spinner {\r\n      width: 18px;\r\n      height: 18px;\r\n      border: 2px solid rgba(255, 255, 255, 0.3);\r\n      border-top-color: white;\r\n      border-radius: 50%;\r\n      animation: spin 0.8s linear infinite;\r\n    }\r\n    \r\n    @keyframes spin {\r\n      to { transform: rotate(360deg); }\r\n    }\r\n    \r\n    .divider {\r\n      display: flex;\r\n      align-items: center;\r\n      margin: 1.5rem 0;\r\n      color: var(--text-muted, #666);\r\n      font-size: 0.875rem;\r\n    }\r\n    \r\n    .divider::before,\r\n    .divider::after {\r\n      content: '';\r\n      flex: 1;\r\n      height: 1px;\r\n      background: var(--border-color, #333);\r\n    }\r\n    \r\n    .divider span {\r\n      padding: 0 1rem;\r\n    }\r\n    \r\n    .social-login {\r\n      display: flex;\r\n      gap: 1rem;\r\n    }\r\n    \r\n    .social-btn {\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: 0.5rem;\r\n      padding: 0.75rem 1rem;\r\n      background: var(--bg-secondary, #1a1a1a);\r\n      border: 1px solid var(--border-color, #333);\r\n      border-radius: 8px;\r\n      color: var(--text-primary, #fff);\r\n      font-size: 0.875rem;\r\n      cursor: pointer;\r\n      transition: all 0.2s ease;\r\n    }\r\n    \r\n    .social-btn:hover {\r\n      background: var(--bg-tertiary, #252525);\r\n      border-color: var(--border-hover, #444);\r\n    }\r\n    \r\n    .social-btn.google .social-icon {\r\n      color: #ea4335;\r\n      font-weight: bold;\r\n    }\r\n    \r\n    .social-btn.telegram .social-icon {\r\n      color: #0088cc;\r\n    }\r\n    \r\n    .social-btn.full-width {\r\n      width: 100%;\r\n      flex: none;\r\n    }\r\n    \r\n    .social-btn.telegram {\r\n      background: linear-gradient(135deg, #0088cc, #0077b5);\r\n      border-color: #0088cc;\r\n    }\r\n    \r\n    .social-btn.telegram:hover {\r\n      background: linear-gradient(135deg, #0099dd, #0088cc);\r\n    }\r\n    \r\n    /* ğŸ†• Deep Link ä¸»æŒ‰éˆ• */\r\n    .social-btn.primary-telegram {\r\n      background: linear-gradient(135deg, #0088cc, #0066aa);\r\n      border-color: #0088cc;\r\n      font-weight: 600;\r\n    }\r\n    \r\n    .social-btn.primary-telegram:hover {\r\n      background: linear-gradient(135deg, #0099dd, #0077bb);\r\n      transform: translateY(-1px);\r\n      box-shadow: 0 4px 12px rgba(0, 136, 204, 0.3);\r\n    }\r\n    \r\n    /* ğŸ†• Widget å‚™ç”¨æŒ‰éˆ• */\r\n    .social-btn.secondary-telegram {\r\n      background: transparent;\r\n      border: 1px solid #0088cc;\r\n      color: #0088cc;\r\n    }\r\n    \r\n    .social-btn.secondary-telegram:hover {\r\n      background: rgba(0, 136, 204, 0.1);\r\n    }\r\n    \r\n    /* ğŸ†• Deep Link ç‹€æ…‹æç¤º */\r\n    .deep-link-status {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      gap: 0.75rem;\r\n      padding: 1rem;\r\n      background: rgba(0, 136, 204, 0.1);\r\n      border: 1px solid rgba(0, 136, 204, 0.3);\r\n      border-radius: 8px;\r\n      margin: 0.75rem 0;\r\n    }\r\n    \r\n    .deep-link-status .status-text {\r\n      color: #0088cc;\r\n      font-size: 0.875rem;\r\n      text-align: center;\r\n    }\r\n    \r\n    .deep-link-status .countdown {\r\n      font-size: 0.75rem;\r\n      color: var(--text-secondary, #888);\r\n    }\r\n    \r\n    .deep-link-status .cancel-btn {\r\n      padding: 0.375rem 1rem;\r\n      background: transparent;\r\n      border: 1px solid #888;\r\n      border-radius: 4px;\r\n      color: #888;\r\n      font-size: 0.75rem;\r\n      cursor: pointer;\r\n      transition: all 0.2s ease;\r\n    }\r\n    \r\n    .deep-link-status .cancel-btn:hover {\r\n      background: rgba(255, 255, 255, 0.1);\r\n      border-color: #fff;\r\n      color: #fff;\r\n    }\r\n    \r\n    .social-login {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.75rem;\r\n    }\r\n    \r\n    /* ğŸ†• Telegram Widget å®¹å™¨æ¨£å¼ */\r\n    .telegram-widget-container {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      min-height: 48px;\r\n      width: 100%;\r\n    }\r\n    \r\n    .telegram-widget-container iframe {\r\n      border-radius: 8px !important;\r\n    }\r\n    \r\n    #telegram-login-widget {\r\n      display: flex;\r\n      justify-content: center;\r\n    }\r\n    \r\n    .loading-spinner.small {\r\n      width: 14px;\r\n      height: 14px;\r\n      border-width: 2px;\r\n    }\r\n    \r\n    .register-link {\r\n      text-align: center;\r\n      margin-top: 1.5rem;\r\n      color: var(--text-secondary, #888);\r\n      font-size: 0.875rem;\r\n    }\r\n    \r\n    .register-link a {\r\n      color: var(--primary, #3b82f6);\r\n      text-decoration: none;\r\n      font-weight: 500;\r\n    }\r\n    \r\n    .register-link a:hover {\r\n      text-decoration: underline;\r\n    }\r\n    \r\n    /* ğŸ†• Phase 2: ç™»å…¥æ–¹å¼é¸æ“‡å™¨ */\r\n    .telegram-login-section {\r\n      margin-top: 0.5rem;\r\n    }\r\n    \r\n    .login-method-tabs {\r\n      display: flex;\r\n      gap: 0.25rem;\r\n      background: var(--bg-secondary, #1a1a1a);\r\n      padding: 0.25rem;\r\n      border-radius: 8px;\r\n      margin-bottom: 1rem;\r\n    }\r\n    \r\n    .method-tab {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      gap: 0.25rem;\r\n      padding: 0.5rem;\r\n      background: transparent;\r\n      border: none;\r\n      border-radius: 6px;\r\n      color: var(--text-secondary, #888);\r\n      font-size: 0.75rem;\r\n      cursor: pointer;\r\n      transition: all 0.2s ease;\r\n    }\r\n    \r\n    .method-tab:hover {\r\n      background: var(--bg-tertiary, #252525);\r\n      color: var(--text-primary, #fff);\r\n    }\r\n    \r\n    .method-tab.active {\r\n      background: linear-gradient(135deg, #0088cc, #0066aa);\r\n      color: #fff;\r\n    }\r\n    \r\n    .tab-icon {\r\n      font-size: 1.25rem;\r\n    }\r\n    \r\n    /* QR Code é¢æ¿ */\r\n    .qr-login-panel {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      padding: 1.5rem;\r\n      background: var(--bg-secondary, #1a1a1a);\r\n      border-radius: 12px;\r\n      border: 1px solid var(--border-color, #333);\r\n    }\r\n    \r\n    .qr-loading {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      gap: 1rem;\r\n      padding: 2rem;\r\n      color: var(--text-secondary, #888);\r\n    }\r\n    \r\n    .qr-container {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      gap: 1rem;\r\n      width: 100%;\r\n    }\r\n    \r\n    .qr-code-wrapper {\r\n      position: relative;\r\n      padding: 1rem;\r\n      background: #fff;\r\n      border-radius: 12px;\r\n      box-shadow: 0 4px 20px rgba(0, 136, 204, 0.2);\r\n    }\r\n    \r\n    .qr-code-img {\r\n      width: 180px;\r\n      height: 180px;\r\n      display: block;\r\n    }\r\n    \r\n    .qr-expired-overlay {\r\n      position: absolute;\r\n      inset: 0;\r\n      background: rgba(0, 0, 0, 0.85);\r\n      border-radius: 12px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: 0.75rem;\r\n    }\r\n    \r\n    .expired-text {\r\n      color: #f87171;\r\n      font-size: 0.875rem;\r\n    }\r\n    \r\n    .refresh-btn {\r\n      padding: 0.5rem 1rem;\r\n      background: linear-gradient(135deg, #0088cc, #0066aa);\r\n      border: none;\r\n      border-radius: 6px;\r\n      color: #fff;\r\n      font-size: 0.875rem;\r\n      cursor: pointer;\r\n      transition: transform 0.2s ease;\r\n    }\r\n    \r\n    .refresh-btn:hover {\r\n      transform: scale(1.05);\r\n    }\r\n    \r\n    .qr-instructions {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.5rem;\r\n      width: 100%;\r\n    }\r\n    \r\n    .qr-instructions .step {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.75rem;\r\n      color: var(--text-secondary, #888);\r\n      font-size: 0.875rem;\r\n      margin: 0;\r\n    }\r\n    \r\n    .step-num {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 1.5rem;\r\n      height: 1.5rem;\r\n      background: linear-gradient(135deg, #0088cc, #0066aa);\r\n    }\r\n\r\n    /* ğŸ†• é©—è­‰ç¢¼æ¨£å¼ */\r\n    .verify-code-section {\r\n      margin-top: 1.25rem;\r\n      padding-top: 1.25rem;\r\n      border-top: 1px dashed var(--border-color, #333);\r\n      text-align: center;\r\n    }\r\n\r\n    .verify-hint {\r\n      font-size: 0.8rem;\r\n      color: var(--text-muted, #666);\r\n      margin-bottom: 0.75rem;\r\n    }\r\n\r\n    .verify-code {\r\n      font-family: 'Courier New', monospace;\r\n      font-size: 2rem;\r\n      font-weight: 700;\r\n      letter-spacing: 0.5rem;\r\n      padding: 0.75rem 1.5rem;\r\n      background: linear-gradient(135deg, rgba(14, 165, 233, 0.15), rgba(139, 92, 246, 0.15));\r\n      border: 2px solid rgba(14, 165, 233, 0.3);\r\n      border-radius: 12px;\r\n      color: #0ea5e9;\r\n      display: inline-block;\r\n      border-radius: 50%;\r\n      color: #fff;\r\n      font-size: 0.75rem;\r\n      font-weight: 600;\r\n    }\r\n    \r\n    .qr-countdown {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      width: 100%;\r\n      padding: 0.5rem 0;\r\n      border-top: 1px solid var(--border-color, #333);\r\n      margin-top: 0.5rem;\r\n    }\r\n    \r\n    .ws-status {\r\n      font-size: 0.75rem;\r\n      color: #f87171;\r\n    }\r\n    \r\n    .ws-status.connected {\r\n      color: #4ade80;\r\n    }\r\n    \r\n    .countdown-text {\r\n      font-size: 0.875rem;\r\n      color: var(--text-secondary, #888);\r\n    }\r\n    \r\n    .generate-qr-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: 0.5rem;\r\n      padding: 1rem 2rem;\r\n      background: linear-gradient(135deg, #0088cc, #0066aa);\r\n      border: none;\r\n      border-radius: 8px;\r\n      color: #fff;\r\n      font-size: 1rem;\r\n      cursor: pointer;\r\n      transition: all 0.2s ease;\r\n    }\r\n    \r\n    .generate-qr-btn:hover {\r\n      transform: translateY(-2px);\r\n      box-shadow: 0 4px 12px rgba(0, 136, 204, 0.3);\r\n    }\r\n    \r\n    .btn-icon {\r\n      font-size: 1.25rem;\r\n    }\r\n    \r\n    /* Deep Link é¢æ¿ */\r\n    .deeplink-panel, .widget-panel {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.75rem;\r\n    }\r\n    \r\n    .widget-hint {\r\n      text-align: center;\r\n      font-size: 0.75rem;\r\n      color: var(--text-secondary, #888);\r\n      margin: 0;\r\n    }\r\n    \r\n    /* ğŸ†• Phase 3: ç™»å…¥æˆåŠŸå‹•ç•« */\r\n    .success-overlay {\r\n      position: fixed;\r\n      inset: 0;\r\n      background: rgba(0, 0, 0, 0.9);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      z-index: 9999;\r\n      animation: fadeIn 0.3s ease-out;\r\n    }\r\n    \r\n    @keyframes fadeIn {\r\n      from { opacity: 0; }\r\n      to { opacity: 1; }\r\n    }\r\n    \r\n    .success-content {\r\n      text-align: center;\r\n      animation: scaleIn 0.4s ease-out;\r\n    }\r\n    \r\n    @keyframes scaleIn {\r\n      from { transform: scale(0.8); opacity: 0; }\r\n      to { transform: scale(1); opacity: 1; }\r\n    }\r\n    \r\n    .success-icon {\r\n      width: 80px;\r\n      height: 80px;\r\n      margin: 0 auto 1.5rem;\r\n    }\r\n    \r\n    .checkmark {\r\n      width: 80px;\r\n      height: 80px;\r\n      border-radius: 50%;\r\n      display: block;\r\n      stroke-width: 2;\r\n      stroke: #4ade80;\r\n      stroke-miterlimit: 10;\r\n      animation: fill 0.4s ease-in-out 0.4s forwards, scale 0.3s ease-in-out 0.9s both;\r\n    }\r\n    \r\n    .checkmark-circle {\r\n      stroke-dasharray: 166;\r\n      stroke-dashoffset: 166;\r\n      stroke-width: 2;\r\n      stroke-miterlimit: 10;\r\n      stroke: #4ade80;\r\n      fill: none;\r\n      animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;\r\n    }\r\n    \r\n    .checkmark-check {\r\n      transform-origin: 50% 50%;\r\n      stroke-dasharray: 48;\r\n      stroke-dashoffset: 48;\r\n      animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;\r\n    }\r\n    \r\n    @keyframes stroke {\r\n      100% { stroke-dashoffset: 0; }\r\n    }\r\n    \r\n    @keyframes scale {\r\n      0%, 100% { transform: none; }\r\n      50% { transform: scale3d(1.1, 1.1, 1); }\r\n    }\r\n    \r\n    @keyframes fill {\r\n      100% { box-shadow: inset 0px 0px 0px 40px rgba(74, 222, 128, 0.1); }\r\n    }\r\n    \r\n    .success-title {\r\n      color: #4ade80;\r\n      font-size: 1.5rem;\r\n      font-weight: 600;\r\n      margin: 0 0 0.5rem;\r\n    }\r\n    \r\n    .success-user {\r\n      color: #fff;\r\n      font-size: 1rem;\r\n      margin: 0 0 0.5rem;\r\n    }\r\n    \r\n    .success-hint {\r\n      color: var(--text-secondary, #888);\r\n      font-size: 0.875rem;\r\n      margin: 0;\r\n      animation: pulse 1s infinite;\r\n    }\r\n    \r\n    @keyframes pulse {\r\n      0%, 100% { opacity: 1; }\r\n      50% { opacity: 0.5; }\r\n    }\r\n  `]\r\n})\r\nexport class LoginComponent implements OnInit, OnDestroy {\r\n  private authService = inject(AuthService);\r\n  private router = inject(Router);\r\n  private route = inject(ActivatedRoute);\r\n  private i18n = inject(I18nService);\r\n  private security = inject(FrontendSecurityService);\r\n  private ipcService = inject(ElectronIpcService);\r\n  \r\n  // è¡¨å–®æ•¸æ“š\r\n  email = '';\r\n  password = '';\r\n  rememberMe = false;\r\n  \r\n  // ç‹€æ…‹\r\n  showPassword = signal(false);\r\n  isLoading = signal(false);\r\n  telegramLoading = signal(false);\r\n  telegramWidgetReady = signal(false);  // ğŸ†• Widget æ˜¯å¦å·²è¼‰å…¥\r\n  error = signal<string | null>(null);\r\n  \r\n  // ğŸ†• Deep Link ç™»å…¥ç‹€æ…‹\r\n  deepLinkLoading = signal(false);\r\n  deepLinkCountdown = signal(300);  // 5 åˆ†é˜å€’è¨ˆæ™‚\r\n  private deepLinkToken = '';\r\n  private deepLinkPollInterval: any = null;\r\n  private deepLinkCountdownInterval: any = null;\r\n  \r\n  // ğŸ†• Phase 2: QR Code + WebSocket ç™»å…¥ç‹€æ…‹\r\n  loginMethod = signal<'qrcode' | 'deeplink' | 'widget'>('qrcode');  // é»˜èª QR Code\r\n  qrCodeLoading = signal(false);\r\n  qrCodeUrl = signal<string | null>(null);\r\n  qrCodeExpired = signal(false);\r\n  qrCountdown = signal(300);\r\n  wsConnected = signal(false);\r\n  verifyCode = signal<string | null>(null);  // ğŸ†• 6 ä½é©—è­‰ç¢¼\r\n  private qrToken = '';\r\n  private qrWebSocket: WebSocket | null = null;\r\n  private qrCountdownInterval: any = null;\r\n  \r\n  // ğŸ†• Phase 3: ç™»å…¥æˆåŠŸå‹•ç•«\r\n  loginSuccess = signal(false);\r\n  successUserName = signal('');\r\n  \r\n  // P1.5: å®‰å…¨å¢å¼· - ç™»å…¥é™åˆ¶\r\n  isLocked = computed(() => this.security.isLocked());\r\n  lockoutRemaining = computed(() => this.security.lockoutRemaining());\r\n  attemptsLeft = computed(() => this.security.attemptsLeft());\r\n  \r\n  // Telegram é…ç½®\r\n  private telegramBotUsername = '';\r\n  private telegramBotId = '';  // ğŸ†• æ•¸å­—æ ¼å¼çš„ Bot ID\r\n  private lockoutCleanup: (() => void) | null = null;\r\n  \r\n  ngOnInit() {\r\n    // æª¢æŸ¥ç™»å…¥é™åˆ¶ç‹€æ…‹\r\n    this.checkLoginLimit();\r\n    \r\n    // ğŸ†• Phase 3: å„ªå…ˆä½¿ç”¨ä¿å­˜çš„åå¥½\r\n    const savedPreference = this.loadLoginPreference();\r\n    \r\n    if (savedPreference) {\r\n      // ä½¿ç”¨ç”¨æˆ¶ä¹‹å‰çš„é¸æ“‡\r\n      this.loginMethod.set(savedPreference);\r\n      if (savedPreference === 'qrcode') {\r\n        this.generateQRCode();\r\n      }\r\n    } else if (this.isMobileDevice()) {\r\n      // ç§»å‹•ç«¯é»˜èªä½¿ç”¨ Deep Link\r\n      this.loginMethod.set('deeplink');\r\n    } else {\r\n      // æ¡Œé¢ç«¯è‡ªå‹•ç”Ÿæˆ QR Code\r\n      this.generateQRCode();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * æª¢æ¸¬æ˜¯å¦ç‚ºç§»å‹•è¨­å‚™\r\n   */\r\n  private isMobileDevice(): boolean {\r\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n  }\r\n  \r\n  ngOnDestroy() {\r\n    // æ¸…ç†å€’è¨ˆæ™‚\r\n    this.lockoutCleanup?.();\r\n    // æ¸…ç† Deep Link è¼ªè©¢\r\n    this.cancelDeepLink();\r\n    // æ¸…ç† QR Code WebSocket\r\n    this.cleanupQRCode();\r\n  }\r\n  \r\n  private checkLoginLimit() {\r\n    const result = this.security.canAttemptLogin();\r\n    if (!result.allowed) {\r\n      this.error.set(result.message || '');\r\n      // å•Ÿå‹•å€’è¨ˆæ™‚\r\n      this.lockoutCleanup = this.security.startLockoutCountdown((remaining) => {\r\n        if (remaining <= 0) {\r\n          this.error.set(null);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  t(key: string): string {\r\n    return this.i18n.t(key);\r\n  }\r\n  \r\n  async onSubmit() {\r\n    if (!this.email || !this.password) return;\r\n    \r\n    // P1.5: å®‰å…¨æª¢æŸ¥ - ç™»å…¥é™åˆ¶\r\n    const canLogin = this.security.canAttemptLogin();\r\n    if (!canLogin.allowed) {\r\n      this.error.set(canLogin.message || '');\r\n      return;\r\n    }\r\n    \r\n    this.isLoading.set(true);\r\n    this.error.set(null);\r\n    \r\n    try {\r\n      const result = await this.authService.login({\r\n        email: this.email,\r\n        password: this.password,\r\n        remember: this.rememberMe\r\n      });\r\n      \r\n      if (result.success) {\r\n        // è¨˜éŒ„æˆåŠŸå˜—è©¦ï¼ˆæ¸…é™¤é™åˆ¶ï¼‰\r\n        this.security.recordLoginAttempt(true, this.email);\r\n        \r\n        // ç²å–é‡å®šå‘ URL\r\n        const returnUrl = this.route.snapshot.queryParams['returnUrl'] || '/';\r\n        this.router.navigateByUrl(returnUrl);\r\n      } else {\r\n        // è¨˜éŒ„å¤±æ•—å˜—è©¦\r\n        this.security.recordLoginAttempt(false, this.email);\r\n        \r\n        // é¡¯ç¤ºéŒ¯èª¤å’Œå‰©é¤˜å˜—è©¦æ¬¡æ•¸\r\n        const attemptsLeft = this.security.attemptsLeft();\r\n        let errorMsg = result.error || this.t('auth.loginFailed');\r\n        if (attemptsLeft > 0 && attemptsLeft <= 3) {\r\n          errorMsg += ` (å‰©é¤˜ ${attemptsLeft} æ¬¡å˜—è©¦æ©Ÿæœƒ)`;\r\n        }\r\n        this.error.set(errorMsg);\r\n        \r\n        // æª¢æŸ¥æ˜¯å¦éœ€è¦é–å®š\r\n        this.checkLoginLimit();\r\n      }\r\n    } catch (e: any) {\r\n      // è¨˜éŒ„å¤±æ•—å˜—è©¦\r\n      this.security.recordLoginAttempt(false, this.email);\r\n      this.error.set(e.message || this.t('auth.loginFailed'));\r\n      this.checkLoginLimit();\r\n    } finally {\r\n      this.isLoading.set(false);\r\n    }\r\n  }\r\n  \r\n  async socialLogin(provider: string) {\r\n    if (provider === 'telegram') {\r\n      await this.initTelegramWidget();  // ğŸ”§ ä½¿ç”¨åµŒå…¥å¼ Widget\r\n    } else if (provider === 'google') {\r\n      await this.googleLogin();\r\n    }\r\n  }\r\n  \r\n  private async googleLogin() {\r\n    this.isLoading.set(true);\r\n    this.error.set(null);\r\n    \r\n    try {\r\n      // 1. ç²å– Google é…ç½®\r\n      const response = await fetch('/api/v1/oauth/google/config');\r\n      const config = await response.json();\r\n      \r\n      if (!config.success || !config.data?.enabled) {\r\n        this.error.set(this.t('auth.googleNotAvailable'));\r\n        return;\r\n      }\r\n      \r\n      // 2. æ‰“é–‹ Google OAuth å½ˆçª—\r\n      this.openGoogleLoginPopup();\r\n      \r\n    } catch (e: any) {\r\n      console.error('Google login error:', e);\r\n      this.error.set(this.t('auth.googleNotAvailable'));\r\n    } finally {\r\n      this.isLoading.set(false);\r\n    }\r\n  }\r\n  \r\n  private openGoogleLoginPopup() {\r\n    // æ§‹å»ºå›èª¿ URL\r\n    const origin = window.location.origin;\r\n    const callbackUrl = `${origin}/api/v1/oauth/google/callback`;\r\n    \r\n    // Google OAuth æˆæ¬Š URL\r\n    const authUrl = `/api/v1/oauth/google/authorize?callback=${encodeURIComponent(callbackUrl)}`;\r\n    \r\n    // æ‰“é–‹å½ˆçª—\r\n    const width = 550;\r\n    const height = 600;\r\n    const left = window.screenX + (window.outerWidth - width) / 2;\r\n    const top = window.screenY + (window.outerHeight - height) / 2;\r\n    \r\n    const popup = window.open(\r\n      authUrl,\r\n      'GoogleAuth',\r\n      `width=${width},height=${height},left=${left},top=${top},toolbar=no,menubar=no,scrollbars=yes`\r\n    );\r\n    \r\n    // ç›£è½å½ˆçª—æ¶ˆæ¯\r\n    const handleMessage = async (event: MessageEvent) => {\r\n      // æ¥å—ä¾†è‡ªä»»ä½•ä¾†æºçš„æ¶ˆæ¯ï¼ˆå› ç‚º Google å›èª¿æœƒç™¼é€æ¶ˆæ¯ï¼‰\r\n      if (event.data && event.data.type === 'google_auth') {\r\n        window.removeEventListener('message', handleMessage);\r\n        popup?.close();\r\n        \r\n        // è™•ç† Google èªè­‰æ•¸æ“š\r\n        await this.handleGoogleAuth(event.data.auth);\r\n      } else if (event.data && event.data.type === 'google_auth_error') {\r\n        window.removeEventListener('message', handleMessage);\r\n        popup?.close();\r\n        \r\n        this.error.set(event.data.error || 'Google ç™»å…¥å¤±æ•—');\r\n        this.isLoading.set(false);\r\n      }\r\n    };\r\n    \r\n    window.addEventListener('message', handleMessage);\r\n    \r\n    // ç›£æ¸¬å½ˆçª—é—œé–‰\r\n    const checkClosed = setInterval(() => {\r\n      if (popup?.closed) {\r\n        clearInterval(checkClosed);\r\n        window.removeEventListener('message', handleMessage);\r\n        this.isLoading.set(false);\r\n      }\r\n    }, 500);\r\n  }\r\n  \r\n  private async handleGoogleAuth(authData: any) {\r\n    this.isLoading.set(true);\r\n    \r\n    try {\r\n      if (authData.access_token && authData.user) {\r\n        // è¨­ç½®èªè­‰ç‹€æ…‹ï¼ˆç›´æ¥ä½¿ç”¨è¿”å›çš„ tokenï¼‰\r\n        localStorage.setItem('tgm_access_token', authData.access_token);\r\n        if (authData.refresh_token) {\r\n          localStorage.setItem('tgm_refresh_token', authData.refresh_token);\r\n        }\r\n        localStorage.setItem('tgm_user', JSON.stringify(authData.user));\r\n        \r\n        // ğŸ”§ ä¿®å¾©ï¼šé€šçŸ¥ IpcService æ›´æ–° Token\r\n        this.ipcService.setAuthToken(authData.access_token);\r\n        \r\n        // ç™»å…¥æˆåŠŸï¼Œé‡å®šå‘\r\n        const returnUrl = this.route.snapshot.queryParams['returnUrl'] || '/';\r\n        window.location.href = returnUrl;\r\n      } else {\r\n        this.error.set('Google ç™»å…¥å¤±æ•—ï¼šç„¡æ•ˆçš„èªè­‰æ•¸æ“š');\r\n      }\r\n    } catch (e: any) {\r\n      this.error.set(e.message || 'Google ç™»å…¥å¤±æ•—');\r\n    } finally {\r\n      this.isLoading.set(false);\r\n    }\r\n  }\r\n  \r\n  // ==================== ğŸ†• Deep Link ç™»å…¥ ====================\r\n  \r\n  /**\r\n   * æ‰“é–‹ Telegram Deep Link ç™»å…¥\r\n   * æµç¨‹ï¼šç”Ÿæˆ Token â†’ æ‰“é–‹ Telegram App â†’ ç”¨æˆ¶ç¢ºèª â†’ è¼ªè©¢çµæœ\r\n   */\r\n  async openDeepLink() {\r\n    this.error.set(null);\r\n    this.deepLinkLoading.set(true);\r\n    this.telegramLoading.set(true);\r\n    \r\n    try {\r\n      // 1. èª¿ç”¨ API ç”Ÿæˆç™»å…¥ Token\r\n      const response = await fetch('/api/v1/auth/login-token', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ type: 'deep_link' })\r\n      });\r\n      \r\n      const result = await response.json();\r\n      \r\n      if (!result.success || !result.data) {\r\n        this.error.set(result.error || 'ç„¡æ³•ç”Ÿæˆç™»å…¥é€£çµ');\r\n        this.deepLinkLoading.set(false);\r\n        this.telegramLoading.set(false);\r\n        return;\r\n      }\r\n      \r\n      const { token, deep_link_url, expires_in } = result.data;\r\n      this.deepLinkToken = token;\r\n      this.deepLinkCountdown.set(expires_in || 300);\r\n      \r\n      // 2. æ‰“é–‹ Telegram Deep Link\r\n      console.log('[DeepLink] Opening:', deep_link_url);\r\n      window.open(deep_link_url, '_blank');\r\n      \r\n      // 3. é–‹å§‹å€’è¨ˆæ™‚\r\n      this.deepLinkCountdownInterval = setInterval(() => {\r\n        const current = this.deepLinkCountdown();\r\n        if (current <= 0) {\r\n          this.cancelDeepLink();\r\n          this.error.set('ç™»å…¥è¶…æ™‚ï¼Œè«‹é‡è©¦');\r\n        } else {\r\n          this.deepLinkCountdown.set(current - 1);\r\n        }\r\n      }, 1000);\r\n      \r\n      // 4. é–‹å§‹è¼ªè©¢ç™»å…¥ç‹€æ…‹\r\n      this.startPollingLoginStatus();\r\n      \r\n    } catch (e: any) {\r\n      console.error('[DeepLink] Error:', e);\r\n      this.error.set(e.message || 'ç™»å…¥å¤±æ•—');\r\n      this.deepLinkLoading.set(false);\r\n      this.telegramLoading.set(false);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * å–æ¶ˆ Deep Link ç™»å…¥\r\n   */\r\n  cancelDeepLink() {\r\n    if (this.deepLinkPollInterval) {\r\n      clearInterval(this.deepLinkPollInterval);\r\n      this.deepLinkPollInterval = null;\r\n    }\r\n    if (this.deepLinkCountdownInterval) {\r\n      clearInterval(this.deepLinkCountdownInterval);\r\n      this.deepLinkCountdownInterval = null;\r\n    }\r\n    this.deepLinkLoading.set(false);\r\n    this.telegramLoading.set(false);\r\n    this.deepLinkToken = '';\r\n  }\r\n  \r\n  /**\r\n   * è¼ªè©¢ç™»å…¥ç‹€æ…‹\r\n   */\r\n  private startPollingLoginStatus() {\r\n    if (this.deepLinkPollInterval) {\r\n      clearInterval(this.deepLinkPollInterval);\r\n    }\r\n    \r\n    const pollStatus = async () => {\r\n      if (!this.deepLinkToken) return;\r\n      \r\n      try {\r\n        const response = await fetch(`/api/v1/auth/login-token/${this.deepLinkToken}`);\r\n        const result = await response.json();\r\n        \r\n        if (!result.success) {\r\n          console.warn('[DeepLink] Poll error:', result.error);\r\n          return;\r\n        }\r\n        \r\n        const { status, access_token, refresh_token, user } = result.data || {};\r\n        \r\n        if (status === 'confirmed' && access_token) {\r\n          // ç™»å…¥æˆåŠŸï¼\r\n          console.log('[DeepLink] Login confirmed!');\r\n          this.cancelDeepLink();\r\n          \r\n          // ä¿å­˜ Token\r\n          localStorage.setItem('tgm_access_token', access_token);\r\n          if (refresh_token) {\r\n            localStorage.setItem('tgm_refresh_token', refresh_token);\r\n          }\r\n          if (user) {\r\n            localStorage.setItem('tgm_user', JSON.stringify(user));\r\n          }\r\n          \r\n          // è·³è½‰åˆ°ç›®æ¨™é é¢\r\n          const returnUrl = this.route.snapshot.queryParams['returnUrl'] || '/dashboard';\r\n          window.location.href = returnUrl;\r\n          \r\n        } else if (status === 'expired') {\r\n          this.cancelDeepLink();\r\n          this.error.set('ç™»å…¥é€£çµå·²éæœŸï¼Œè«‹é‡è©¦');\r\n        }\r\n        // pending ç‹€æ…‹ç¹¼çºŒè¼ªè©¢\r\n        \r\n      } catch (e) {\r\n        console.error('[DeepLink] Poll error:', e);\r\n      }\r\n    };\r\n    \r\n    // ç«‹å³åŸ·è¡Œä¸€æ¬¡\r\n    pollStatus();\r\n    \r\n    // æ¯ 2 ç§’è¼ªè©¢ä¸€æ¬¡\r\n    this.deepLinkPollInterval = setInterval(pollStatus, 2000);\r\n  }\r\n  \r\n  // ==================== ğŸ†• Phase 2: QR Code + WebSocket ç™»å…¥ ====================\r\n  \r\n  /**\r\n   * åˆ‡æ›ç™»å…¥æ–¹å¼\r\n   */\r\n  switchLoginMethod(method: 'qrcode' | 'deeplink' | 'widget') {\r\n    // æ¸…ç†ç•¶å‰æ–¹å¼çš„è³‡æº\r\n    if (this.loginMethod() === 'qrcode' && method !== 'qrcode') {\r\n      this.cleanupQRCode();\r\n    }\r\n    if (this.loginMethod() === 'deeplink' && method !== 'deeplink') {\r\n      this.cancelDeepLink();\r\n    }\r\n    \r\n    this.loginMethod.set(method);\r\n    this.error.set(null);\r\n    \r\n    // å¦‚æœåˆ‡æ›åˆ° QR Codeï¼Œè‡ªå‹•ç”Ÿæˆ\r\n    if (method === 'qrcode' && !this.qrCodeUrl()) {\r\n      this.generateQRCode();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ç”Ÿæˆ QR Code\r\n   */\r\n  async generateQRCode() {\r\n    this.qrCodeLoading.set(true);\r\n    this.qrCodeExpired.set(false);\r\n    this.error.set(null);\r\n    \r\n    try {\r\n      // 1. èª¿ç”¨ API ç”Ÿæˆç™»å…¥ Token\r\n      const response = await fetch('/api/v1/auth/login-token', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ type: 'qr_code' })\r\n      });\r\n      \r\n      const result = await response.json();\r\n      \r\n      if (!result.success || !result.data) {\r\n        this.error.set(result.error || 'ç„¡æ³•ç”ŸæˆäºŒç¶­ç¢¼');\r\n        this.qrCodeLoading.set(false);\r\n        return;\r\n      }\r\n      \r\n      const { token, deep_link_url, expires_in, qr_image, qr_fallback_url, verify_code } = result.data;\r\n      this.qrToken = token;\r\n      this.qrCountdown.set(expires_in || 300);\r\n      \r\n      // ğŸ†• ä¿å­˜é©—è­‰ç¢¼ï¼ˆè€ç”¨æˆ¶å‚™ç”¨ï¼‰\r\n      this.verifyCode.set(verify_code || null);\r\n      \r\n      // å„ªå…ˆä½¿ç”¨å¾Œç«¯ç”Ÿæˆçš„ QR Code\r\n      const qrDataUrl = qr_image || qr_fallback_url || this.generateQRCodeImage(deep_link_url);\r\n      this.qrCodeUrl.set(qrDataUrl);\r\n      \r\n      // 3. å»ºç«‹ WebSocket é€£æ¥\r\n      this.connectWebSocket(token);\r\n      \r\n      // 4. é–‹å§‹å€’è¨ˆæ™‚\r\n      this.startQRCountdown();\r\n      \r\n    } catch (e: any) {\r\n      console.error('[QRCode] Error:', e);\r\n      this.error.set(e.message || 'ç”ŸæˆäºŒç¶­ç¢¼å¤±æ•—');\r\n    } finally {\r\n      this.qrCodeLoading.set(false);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ç”Ÿæˆ QR Code åœ–ç‰‡ URL\r\n   * ä½¿ç”¨ Google Chart APIï¼ˆç°¡å–®å¯é ï¼‰\r\n   */\r\n  private generateQRCodeImage(data: string): string {\r\n    // æ–¹æ¡ˆ1: Google Chart APIï¼ˆéœ€è¦ç¶²çµ¡ï¼‰\r\n    const encoded = encodeURIComponent(data);\r\n    return `https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=${encoded}&bgcolor=ffffff&color=000000&margin=10`;\r\n    \r\n    // å‚™é¸æ–¹æ¡ˆ: æœ¬åœ°ç”Ÿæˆï¼ˆéœ€è¦ qrcode åº«ï¼‰\r\n    // å¦‚æœéœ€è¦é›¢ç·šæ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ qrcode.js\r\n  }\r\n  \r\n  /**\r\n   * åˆ·æ–° QR Code\r\n   */\r\n  refreshQRCode() {\r\n    this.cleanupQRCode();\r\n    this.generateQRCode();\r\n  }\r\n  \r\n  /**\r\n   * æ¸…ç† QR Code è³‡æº\r\n   */\r\n  private cleanupQRCode() {\r\n    // é—œé–‰ WebSocket\r\n    if (this.qrWebSocket) {\r\n      this.qrWebSocket.close();\r\n      this.qrWebSocket = null;\r\n    }\r\n    \r\n    // æ¸…ç†å€’è¨ˆæ™‚\r\n    if (this.qrCountdownInterval) {\r\n      clearInterval(this.qrCountdownInterval);\r\n      this.qrCountdownInterval = null;\r\n    }\r\n    \r\n    // é‡ç½®ç‹€æ…‹\r\n    this.qrToken = '';\r\n    this.qrCodeUrl.set(null);\r\n    this.qrCodeExpired.set(false);\r\n    this.wsConnected.set(false);\r\n  }\r\n  \r\n  /**\r\n   * é–‹å§‹ QR Code å€’è¨ˆæ™‚\r\n   */\r\n  private startQRCountdown() {\r\n    if (this.qrCountdownInterval) {\r\n      clearInterval(this.qrCountdownInterval);\r\n    }\r\n    \r\n    this.qrCountdownInterval = setInterval(() => {\r\n      const current = this.qrCountdown();\r\n      if (current <= 0) {\r\n        this.qrCodeExpired.set(true);\r\n        clearInterval(this.qrCountdownInterval);\r\n        this.qrCountdownInterval = null;\r\n      } else {\r\n        this.qrCountdown.set(current - 1);\r\n      }\r\n    }, 1000);\r\n  }\r\n  \r\n  /**\r\n   * å»ºç«‹ WebSocket é€£æ¥\r\n   */\r\n  private connectWebSocket(token: string) {\r\n    // é—œé–‰ç¾æœ‰é€£æ¥\r\n    if (this.qrWebSocket) {\r\n      this.qrWebSocket.close();\r\n    }\r\n    \r\n    // æ§‹å»º WebSocket URL\r\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\r\n    const host = window.location.host;\r\n    const wsUrl = `${protocol}//${host}/ws/login-token/${token}`;\r\n    \r\n    console.log('[WebSocket] Connecting to:', wsUrl);\r\n    \r\n    try {\r\n      this.qrWebSocket = new WebSocket(wsUrl);\r\n      \r\n      this.qrWebSocket.onopen = () => {\r\n        console.log('[WebSocket] Connected');\r\n        this.wsConnected.set(true);\r\n      };\r\n      \r\n      this.qrWebSocket.onmessage = (event) => {\r\n        try {\r\n          const data = JSON.parse(event.data);\r\n          console.log('[WebSocket] Message:', data);\r\n          \r\n          // è™•ç†ä¸åŒé¡å‹çš„æ¶ˆæ¯\r\n          if (data.type === 'login_success' || data.event === 'login_confirmed') {\r\n            // ç™»å…¥æˆåŠŸï¼\r\n            this.handleLoginSuccess(data.data);\r\n          } else if (data.type === 'login_token_update') {\r\n            // Token ç‹€æ…‹æ›´æ–°\r\n            if (data.status === 'confirmed') {\r\n              // ç‹€æ…‹å·²ç¢ºèªï¼Œç™¼é€ check_status ç²å–å®Œæ•´æ•¸æ“š\r\n              this.qrWebSocket?.send(JSON.stringify({ type: 'check_status' }));\r\n            }\r\n          } else if (data.status === 'confirmed' && data.data?.access_token) {\r\n            // ç›´æ¥åŒ…å« token çš„ç¢ºèªæ¶ˆæ¯\r\n            this.handleLoginSuccess(data.data);\r\n          }\r\n        } catch (e) {\r\n          console.error('[WebSocket] Parse error:', e);\r\n        }\r\n      };\r\n      \r\n      this.qrWebSocket.onclose = () => {\r\n        console.log('[WebSocket] Disconnected');\r\n        this.wsConnected.set(false);\r\n        \r\n        // å¦‚æœæœªéæœŸä¸”æœªæˆåŠŸï¼Œå˜—è©¦é‡é€£\r\n        if (!this.qrCodeExpired() && this.qrToken) {\r\n          setTimeout(() => {\r\n            if (this.qrToken && !this.qrCodeExpired()) {\r\n              console.log('[WebSocket] Reconnecting...');\r\n              this.connectWebSocket(this.qrToken);\r\n            }\r\n          }, 3000);\r\n        }\r\n      };\r\n      \r\n      this.qrWebSocket.onerror = (error) => {\r\n        console.error('[WebSocket] Error:', error);\r\n        this.wsConnected.set(false);\r\n      };\r\n      \r\n      // è¨­ç½®å¿ƒè·³\r\n      const heartbeat = setInterval(() => {\r\n        if (this.qrWebSocket?.readyState === WebSocket.OPEN) {\r\n          this.qrWebSocket.send(JSON.stringify({ type: 'ping' }));\r\n        } else {\r\n          clearInterval(heartbeat);\r\n        }\r\n      }, 15000);\r\n      \r\n    } catch (e) {\r\n      console.error('[WebSocket] Create error:', e);\r\n      this.wsConnected.set(false);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * è™•ç†ç™»å…¥æˆåŠŸ\r\n   * \r\n   * ğŸ†• Phase 3: æ·»åŠ æˆåŠŸå‹•ç•«\r\n   */\r\n  private handleLoginSuccess(data: any) {\r\n    console.log('[Login] Success - Full data:', JSON.stringify(data));\r\n    console.log('[Login] access_token exists:', !!data?.access_token);\r\n    \r\n    if (!data?.access_token) {\r\n      console.error('[Login] âŒ No access_token in data!');\r\n      this.error.set('ç™»å…¥å¤±æ•—ï¼šæœªæ”¶åˆ°èªè­‰ä»¤ç‰Œ');\r\n      return;\r\n    }\r\n    \r\n    // æ¸…ç†è³‡æº\r\n    this.cleanupQRCode();\r\n    this.cancelDeepLink();\r\n    \r\n    // ğŸ†• ä½¿ç”¨ AuthService è¨­ç½®æœƒè©±ï¼ˆç¢ºä¿ç‹€æ…‹åŒæ­¥ï¼‰\r\n    this.authService.setSession({\r\n      access_token: data.access_token,\r\n      refresh_token: data.refresh_token,\r\n      user: data.user,\r\n      session_id: data.session_id\r\n    });\r\n    \r\n    // ğŸ”§ ä¿®å¾©ï¼šé€šçŸ¥ IpcService é‡æ–°é€£æ¥å¸¶èªè­‰çš„ WebSocket\r\n    this.ipcService.setAuthToken(data.access_token);\r\n    \r\n    console.log('[Login] âœ… Session set via AuthService');\r\n    console.log('[Login] isAuthenticated:', this.authService.isAuthenticated());\r\n    \r\n    // ğŸ†• Phase 3: é¡¯ç¤ºæˆåŠŸå‹•ç•«\r\n    this.successUserName.set(data?.user?.display_name || data?.user?.username || 'User');\r\n    this.loginSuccess.set(true);\r\n    \r\n    // è¨˜ä½ç™»å…¥æ–¹å¼åå¥½\r\n    this.saveLoginPreference();\r\n    \r\n    // ğŸ”§ ä½¿ç”¨ Angular Router è·³è½‰ï¼ˆé¿å…å®Œå…¨åˆ·æ–°é é¢ï¼‰\r\n    const returnUrl = this.route.snapshot.queryParams['returnUrl'] || '/dashboard';\r\n    console.log('[Login] Will navigate to:', returnUrl, 'in 1.5 seconds');\r\n    \r\n    setTimeout(() => {\r\n      console.log('[Login] Navigating now...');\r\n      console.log('[Login] Final check - isAuthenticated:', this.authService.isAuthenticated());\r\n      console.log('[Login] Final check - accessToken:', !!this.authService.accessToken());\r\n      \r\n      // ä½¿ç”¨ Angular Router å°èˆªï¼ˆä¿æŒ SPA ç‹€æ…‹ï¼‰\r\n      this.router.navigateByUrl(returnUrl).then(() => {\r\n        console.log('[Login] âœ… Navigation complete');\r\n      }).catch(err => {\r\n        console.error('[Login] Navigation error:', err);\r\n        // å‚™ç”¨ï¼šä½¿ç”¨ location.href\r\n        window.location.href = returnUrl;\r\n      });\r\n    }, 1500);  // 1.5 ç§’å¾Œè·³è½‰\r\n  }\r\n  \r\n  /**\r\n   * ğŸ†• Phase 3: ä¿å­˜ç™»å…¥æ–¹å¼åå¥½\r\n   */\r\n  private saveLoginPreference() {\r\n    try {\r\n      localStorage.setItem('tgm_login_method', this.loginMethod());\r\n    } catch (e) {\r\n      console.debug('Could not save login preference');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ğŸ†• Phase 3: è®€å–ç™»å…¥æ–¹å¼åå¥½\r\n   */\r\n  private loadLoginPreference(): 'qrcode' | 'deeplink' | 'widget' | null {\r\n    try {\r\n      const saved = localStorage.getItem('tgm_login_method');\r\n      if (saved === 'qrcode' || saved === 'deeplink' || saved === 'widget') {\r\n        return saved;\r\n      }\r\n    } catch (e) {\r\n      console.debug('Could not load login preference');\r\n    }\r\n    return null;\r\n  }\r\n  \r\n  // ==================== Telegram Widget ç™»å…¥ ====================\r\n  \r\n  /**\r\n   * ğŸ†• åˆå§‹åŒ–åµŒå…¥å¼ Telegram Login Widget\r\n   * å„ªé»ï¼šè‡ªå‹•æª¢æ¸¬å·²ç™»å…¥çš„ Telegram å¸³è™Ÿï¼Œä¸€éµç¢ºèªç™»å…¥\r\n   */\r\n  async initTelegramWidget() {\r\n    this.telegramLoading.set(true);\r\n    this.error.set(null);\r\n    \r\n    try {\r\n      // 1. ç²å– Telegram é…ç½®\r\n      const config = await this.authService.getTelegramConfig();\r\n      \r\n      if (!config.enabled || !config.bot_id) {\r\n        this.error.set(this.t('auth.telegramNotConfigured'));\r\n        return;\r\n      }\r\n      \r\n      this.telegramBotUsername = config.bot_username || '';\r\n      this.telegramBotId = config.bot_id;\r\n      \r\n      // 2. å®šç¾©å…¨å±€å›èª¿å‡½æ•¸\r\n      (window as any).onTelegramAuth = (user: any) => {\r\n        console.log('Telegram auth callback:', user);\r\n        this.handleTelegramAuth(user);\r\n      };\r\n      \r\n      // ğŸ†• å„ªå…ˆå˜—è©¦ Widgetï¼ˆæ”¯æŒä¸€éµç™»å…¥ï¼‰ï¼Œå¤±æ•—å‰‡å›é€€åˆ° OAuth\r\n      try {\r\n        await this.loadTelegramWidget();\r\n      } catch (widgetError) {\r\n        console.warn('Widget failed, falling back to OAuth:', widgetError);\r\n        this.openTelegramOAuth();\r\n      }\r\n      \r\n    } catch (e: any) {\r\n      console.error('Telegram login error:', e);\r\n      this.error.set(e.message || 'Telegram ç™»å…¥å¤±æ•—');\r\n    } finally {\r\n      this.telegramLoading.set(false);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ğŸ†• è¼‰å…¥ Telegram Login Widgetï¼ˆæ”¯æŒä¸€éµç™»å…¥ï¼‰\r\n   */\r\n  private loadTelegramWidget(): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      // å‰µå»ºå½ˆçª—å®¹å™¨\r\n      const popup = window.open('', 'telegram-widget', 'width=550,height=470,scrollbars=yes');\r\n      if (!popup) {\r\n        reject(new Error('Popup blocked'));\r\n        return;\r\n      }\r\n      \r\n      // å¯«å…¥ Widget HTML\r\n      popup.document.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n          <title>Telegram ç™»å…¥</title>\r\n          <style>\r\n            body { \r\n              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\r\n              display: flex; \r\n              flex-direction: column;\r\n              justify-content: center; \r\n              align-items: center; \r\n              height: 100vh; \r\n              margin: 0;\r\n              background: linear-gradient(135deg, #0f172a, #1e293b);\r\n              color: white;\r\n            }\r\n            h2 { margin-bottom: 30px; }\r\n            #telegram-login { min-height: 50px; }\r\n            .hint { color: #94a3b8; font-size: 14px; margin-top: 20px; text-align: center; }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <h2>ä½¿ç”¨ Telegram ç™»å…¥</h2>\r\n          <div id=\"telegram-login\"></div>\r\n          <p class=\"hint\">å¦‚æœæ‚¨å·²åœ¨ç€è¦½å™¨ç™»å…¥ Telegramï¼Œå°‡é¡¯ç¤ºä¸€éµç™»å…¥æŒ‰éˆ•</p>\r\n          <script>\r\n            window.onTelegramAuth = function(user) {\r\n              window.opener.onTelegramAuth(user);\r\n              window.close();\r\n            };\r\n          </script>\r\n          <script async src=\"https://telegram.org/js/telegram-widget.js?22\"\r\n            data-telegram-login=\"${this.telegramBotUsername}\"\r\n            data-size=\"large\"\r\n            data-radius=\"8\"\r\n            data-onauth=\"onTelegramAuth(user)\"\r\n            data-request-access=\"write\">\r\n          </script>\r\n        </body>\r\n        </html>\r\n      `);\r\n      popup.document.close();\r\n      \r\n      // ç›£è½å½ˆçª—é—œé–‰\r\n      const checkClosed = setInterval(() => {\r\n        if (popup.closed) {\r\n          clearInterval(checkClosed);\r\n          resolve();\r\n        }\r\n      }, 500);\r\n      \r\n      // 5ç§’è¶…æ™‚\r\n      setTimeout(() => {\r\n        clearInterval(checkClosed);\r\n        resolve();\r\n      }, 30000);\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * ğŸ”§ æ”¹ç”¨ OAuth URL é‡å®šå‘æ–¹å¼ï¼ˆæ›´å¯é ï¼‰\r\n   * ä¸ä¾è³´å¤–éƒ¨è…³æœ¬åŠ è¼‰ï¼Œç›´æ¥è·³è½‰åˆ° Telegram æˆæ¬Šé é¢\r\n   */\r\n  private openTelegramOAuth(): void {\r\n    // æ§‹å»ºå›èª¿ URL\r\n    const callbackUrl = `${window.location.origin}/auth/telegram-callback`;\r\n    \r\n    // æ§‹å»º Telegram OAuth URL\r\n    const authUrl = `https://oauth.telegram.org/auth?bot_id=${this.telegramBotId}&origin=${encodeURIComponent(window.location.origin)}&request_access=write&return_to=${encodeURIComponent(callbackUrl)}`;\r\n    \r\n    console.log('Opening Telegram OAuth:', authUrl);\r\n    \r\n    // åœ¨æ–°çª—å£æ‰“é–‹ï¼ˆé¿å…é›¢é–‹ç•¶å‰é é¢ï¼‰\r\n    const width = 550;\r\n    const height = 470;\r\n    const left = (window.innerWidth - width) / 2;\r\n    const top = (window.innerHeight - height) / 2;\r\n    \r\n    const popup = window.open(\r\n      authUrl,\r\n      'telegram-oauth',\r\n      `width=${width},height=${height},left=${left},top=${top},scrollbars=yes`\r\n    );\r\n    \r\n    // ç›£è½æˆæ¬Šçµæœ\r\n    if (popup) {\r\n      const checkPopup = setInterval(() => {\r\n        try {\r\n          if (popup.closed) {\r\n            clearInterval(checkPopup);\r\n            // ç”¨æˆ¶é—œé–‰äº†å½ˆçª—\r\n            this.telegramLoading.set(false);\r\n          }\r\n        } catch (e) {\r\n          // è·¨åŸŸéŒ¯èª¤ï¼Œå¿½ç•¥\r\n        }\r\n      }, 500);\r\n    }\r\n  }\r\n  \r\n  private async handleTelegramAuth(authData: any) {\r\n    this.telegramLoading.set(true);\r\n    this.error.set(null);\r\n    \r\n    console.log('[TelegramAuth] Processing auth data:', authData);\r\n    \r\n    try {\r\n      // ğŸ†• P1.4: éŒ¯èª¤é‡è©¦æ©Ÿåˆ¶ï¼ˆæœ€å¤šé‡è©¦ 3 æ¬¡ï¼‰\r\n      let result: { success: boolean; error?: string } = { success: false };\r\n      let retries = 0;\r\n      const maxRetries = 3;\r\n      \r\n      while (retries < maxRetries) {\r\n        try {\r\n          result = await this.authService.telegramLogin(authData);\r\n          break;  // æˆåŠŸå‰‡è·³å‡ºå¾ªç’°\r\n        } catch (e: any) {\r\n          retries++;\r\n          console.warn(`[TelegramAuth] Retry ${retries}/${maxRetries}:`, e.message);\r\n          if (retries >= maxRetries) throw e;\r\n          await new Promise(r => setTimeout(r, 1000 * retries));  // éå¢å»¶é²\r\n        }\r\n      }\r\n      \r\n      if (result.success) {\r\n        console.log('[TelegramAuth] Login successful, redirecting...');\r\n        // ğŸ†• ç™»å…¥æˆåŠŸï¼Œä½¿ç”¨ window.location å¼·åˆ¶åˆ·æ–°ä»¥ç¢ºä¿ç‹€æ…‹æ›´æ–°\r\n        const returnUrl = this.route.snapshot.queryParams['returnUrl'] || '/dashboard';\r\n        window.location.href = returnUrl;\r\n      } else {\r\n        console.error('[TelegramAuth] Login failed:', result.error);\r\n        this.error.set(result.error || this.t('auth.telegramLoginFailed'));\r\n      }\r\n    } catch (e: any) {\r\n      console.error('[TelegramAuth] Exception:', e);\r\n      this.error.set(e.message || this.t('auth.telegramLoginFailed'));\r\n    } finally {\r\n      this.telegramLoading.set(false);\r\n    }\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
