{
  "version": 3,
  "sources": ["src/core/api.service.ts"],
  "sourcesContent": ["/**\r\n * TG-Matrix Áµ±‰∏Ä API ÊúçÂãô\r\n * \r\n * ÂÑ™ÂåñË®≠Ë®àÔºö\r\n * 1. Ëá™ÂãïÊ™¢Ê∏¨Áí∞Â¢ÉÔºàElectron vs WebÔºâ\r\n * 2. Áµ±‰∏ÄÁöÑË´ãÊ±Ç/ÈüøÊáâÊé•Âè£\r\n * 3. Ëá™ÂãïÈáçË©¶ÂíåÈåØË™§ËôïÁêÜ\r\n * 4. Ë´ãÊ±ÇÁ∑©Â≠òÂíåÂéªÈáç\r\n * 5. WebSocket ÂØ¶ÊôÇÈÄöË®äÊîØÊåÅ\r\n */\r\n\r\nimport { Injectable, inject, signal, computed } from '@angular/core';\r\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\r\nimport { Observable, Subject, BehaviorSubject, from, of, throwError } from 'rxjs';\r\nimport { map, catchError, retry, shareReplay, tap, timeout } from 'rxjs/operators';\r\n\r\n// Áí∞Â¢ÉÈÖçÁΩÆ\r\nexport interface ApiConfig {\r\n  mode: 'ipc' | 'http';\r\n  baseUrl?: string;\r\n  wsUrl?: string;\r\n  timeout?: number;\r\n  retries?: number;\r\n}\r\n\r\n// API ÈüøÊáâÊ†ºÂºè\r\nexport interface ApiResponse<T = any> {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: string;\r\n  message?: string;\r\n  request_id?: string;\r\n}\r\n\r\n// WebSocket Ê∂àÊÅØÊ†ºÂºè\r\nexport interface WsMessage {\r\n  type: 'event' | 'response' | 'error';\r\n  event?: string;\r\n  data?: any;\r\n  request_id?: string;\r\n  timestamp?: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ApiService {\r\n  private http = inject(HttpClient);\r\n  \r\n  // Áí∞Â¢ÉÊ™¢Ê∏¨\r\n  private _isElectron = signal<boolean>(this.detectElectron());\r\n  private _isConnected = signal<boolean>(false);\r\n  private _config = signal<ApiConfig>(this.getDefaultConfig());\r\n  \r\n  // WebSocket\r\n  private ws: WebSocket | null = null;\r\n  private wsReconnectTimer: any = null;\r\n  private wsMessageSubject = new Subject<WsMessage>();\r\n  private pendingRequests = new Map<string, { resolve: Function; reject: Function }>();\r\n  \r\n  // Ë´ãÊ±ÇÁ∑©Â≠ò\r\n  private cache = new Map<string, { data: any; timestamp: number }>();\r\n  private cacheTimeout = 30000; // 30 ÁßíÁ∑©Â≠ò\r\n  \r\n  // Ë´ãÊ±ÇÂéªÈáç\r\n  private inflightRequests = new Map<string, Promise<any>>();\r\n  \r\n  // ÂÖ¨ÈñãÁãÄÊÖã\r\n  readonly isElectron = computed(() => this._isElectron());\r\n  readonly isConnected = computed(() => this._isConnected());\r\n  readonly mode = computed(() => this._config().mode);\r\n  \r\n  // ‰∫ã‰ª∂ÊµÅ\r\n  readonly events$ = this.wsMessageSubject.asObservable();\r\n  \r\n  constructor() {\r\n    this.init();\r\n  }\r\n  \r\n  // ==================== ÂàùÂßãÂåñ ====================\r\n  \r\n  private init(): void {\r\n    console.log(`[ApiService] Initializing in ${this._config().mode} mode`);\r\n    \r\n    if (this._config().mode === 'http') {\r\n      this.connectWebSocket();\r\n    }\r\n    \r\n    // Ê∏¨Ë©¶ÈÄ£Êé•\r\n    this.healthCheck().then(ok => {\r\n      this._isConnected.set(ok);\r\n      console.log(`[ApiService] Connection status: ${ok ? 'connected' : 'disconnected'}`);\r\n    });\r\n  }\r\n  \r\n  private detectElectron(): boolean {\r\n    return !!(window as any).electron || !!(window as any).require;\r\n  }\r\n  \r\n  private getDefaultConfig(): ApiConfig {\r\n    // ÂÑ™ÂÖàÂæûÁí∞Â¢ÉËÆäÈáèÁç≤Âèñ\r\n    const envMode = (window as any).__API_MODE__ || 'auto';\r\n    const envBaseUrl = (window as any).__API_BASE_URL__;\r\n    \r\n    if (envMode === 'http' || envBaseUrl) {\r\n      return {\r\n        mode: 'http',\r\n        baseUrl: envBaseUrl || this.detectApiUrl(),\r\n        wsUrl: this.detectWsUrl(),\r\n        timeout: 30000,\r\n        retries: 2\r\n      };\r\n    }\r\n    \r\n    if (this.detectElectron()) {\r\n      return {\r\n        mode: 'ipc',\r\n        timeout: 30000,\r\n        retries: 2\r\n      };\r\n    }\r\n    \r\n    // Web Áí∞Â¢ÉÈªòË™ç‰ΩøÁî® HTTP\r\n    return {\r\n      mode: 'http',\r\n      baseUrl: this.detectApiUrl(),\r\n      wsUrl: this.detectWsUrl(),\r\n      timeout: 30000,\r\n      retries: 2\r\n    };\r\n  }\r\n  \r\n  private detectApiUrl(): string {\r\n    // ÈñãÁôºÁí∞Â¢É\r\n    if (window.location.hostname === 'localhost' && window.location.port === '4200') {\r\n      return 'http://localhost:8000';\r\n    }\r\n    // ÁîüÁî¢Áí∞Â¢É - ÂêåÊ∫ê\r\n    return `${window.location.protocol}//${window.location.host}`;\r\n  }\r\n  \r\n  private detectWsUrl(): string {\r\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\r\n    if (window.location.hostname === 'localhost' && window.location.port === '4200') {\r\n      return 'ws://localhost:8000/ws';\r\n    }\r\n    return `${protocol}//${window.location.host}/ws`;\r\n  }\r\n  \r\n  // ==================== Ê†∏ÂøÉË´ãÊ±ÇÊñπÊ≥ï ====================\r\n  \r\n  /**\r\n   * Âü∑Ë°åÂëΩ‰ª§ - Ê†∏ÂøÉÊñπÊ≥ï\r\n   * Ëá™ÂãïÈÅ∏Êìá IPC Êàñ HTTP\r\n   */\r\n  async command<T = any>(cmd: string, payload: any = {}): Promise<ApiResponse<T>> {\r\n    const requestKey = `${cmd}:${JSON.stringify(payload)}`;\r\n    \r\n    // Ë´ãÊ±ÇÂéªÈáç\r\n    if (this.inflightRequests.has(requestKey)) {\r\n      return this.inflightRequests.get(requestKey)!;\r\n    }\r\n    \r\n    const promise = this._executeCommand<T>(cmd, payload);\r\n    this.inflightRequests.set(requestKey, promise);\r\n    \r\n    try {\r\n      const result = await promise;\r\n      return result;\r\n    } finally {\r\n      this.inflightRequests.delete(requestKey);\r\n    }\r\n  }\r\n  \r\n  private async _executeCommand<T>(cmd: string, payload: any): Promise<ApiResponse<T>> {\r\n    if (this._config().mode === 'ipc') {\r\n      return this.ipcCommand(cmd, payload);\r\n    } else {\r\n      return this.httpCommand(cmd, payload);\r\n    }\r\n  }\r\n  \r\n  // ==================== IPC Ê®°Âºè ====================\r\n  \r\n  private async ipcCommand<T>(cmd: string, payload: any): Promise<ApiResponse<T>> {\r\n    const electron = (window as any).electron;\r\n    if (!electron?.ipcRenderer) {\r\n      throw new Error('Electron IPC not available');\r\n    }\r\n    \r\n    try {\r\n      const result = await electron.ipcRenderer.invoke(cmd, payload);\r\n      return this.normalizeResponse(result);\r\n    } catch (error: any) {\r\n      return { success: false, error: error.message || 'IPC error' };\r\n    }\r\n  }\r\n  \r\n  // ==================== HTTP Ê®°Âºè ====================\r\n  \r\n  private async httpCommand<T>(cmd: string, payload: any): Promise<ApiResponse<T>> {\r\n    const config = this._config();\r\n    const url = `${config.baseUrl}/api/command`;\r\n    \r\n    // üîß Áç≤ÂèñË™çË≠â Token\r\n    const token = localStorage.getItem('tgm_access_token');\r\n    const headers: HeadersInit = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n    \r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify({ command: cmd, payload })\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n      \r\n      const result = await response.json();\r\n      return this.normalizeResponse(result);\r\n    } catch (error: any) {\r\n      // Ëá™ÂãïÈáçË©¶\r\n      if (config.retries && config.retries > 0) {\r\n        console.warn(`[ApiService] Retrying command: ${cmd}`);\r\n        const newConfig = { ...config, retries: config.retries - 1 };\r\n        this._config.set(newConfig);\r\n        return this.httpCommand(cmd, payload);\r\n      }\r\n      \r\n      return { success: false, error: error.message || 'HTTP error' };\r\n    }\r\n  }\r\n  \r\n  private normalizeResponse<T>(result: any): ApiResponse<T> {\r\n    if (typeof result === 'object' && result !== null) {\r\n      if ('success' in result) {\r\n        return result;\r\n      }\r\n      return { success: true, data: result };\r\n    }\r\n    return { success: true, data: result as T };\r\n  }\r\n  \r\n  // ==================== WebSocket ====================\r\n  \r\n  private connectWebSocket(): void {\r\n    const wsUrl = this._config().wsUrl;\r\n    if (!wsUrl) return;\r\n    \r\n    try {\r\n      this.ws = new WebSocket(wsUrl);\r\n      \r\n      this.ws.onopen = () => {\r\n        console.log('[ApiService] WebSocket connected');\r\n        this._isConnected.set(true);\r\n        if (this.wsReconnectTimer) {\r\n          clearTimeout(this.wsReconnectTimer);\r\n          this.wsReconnectTimer = null;\r\n        }\r\n      };\r\n      \r\n      this.ws.onmessage = (event) => {\r\n        try {\r\n          const message = JSON.parse(event.data) as WsMessage;\r\n          \r\n          // ËôïÁêÜË´ãÊ±ÇÈüøÊáâ\r\n          if (message.request_id && this.pendingRequests.has(message.request_id)) {\r\n            const { resolve } = this.pendingRequests.get(message.request_id)!;\r\n            this.pendingRequests.delete(message.request_id);\r\n            resolve(message);\r\n          }\r\n          \r\n          // Âª£Êí≠‰∫ã‰ª∂\r\n          this.wsMessageSubject.next(message);\r\n        } catch (e) {\r\n          console.error('[ApiService] WebSocket message parse error', e);\r\n        }\r\n      };\r\n      \r\n      this.ws.onclose = () => {\r\n        console.log('[ApiService] WebSocket disconnected');\r\n        this._isConnected.set(false);\r\n        this.scheduleReconnect();\r\n      };\r\n      \r\n      this.ws.onerror = (error) => {\r\n        console.error('[ApiService] WebSocket error', error);\r\n      };\r\n    } catch (e) {\r\n      console.error('[ApiService] WebSocket connection failed', e);\r\n      this.scheduleReconnect();\r\n    }\r\n  }\r\n  \r\n  private scheduleReconnect(): void {\r\n    if (this.wsReconnectTimer) return;\r\n    \r\n    this.wsReconnectTimer = setTimeout(() => {\r\n      console.log('[ApiService] Attempting WebSocket reconnection...');\r\n      this.wsReconnectTimer = null;\r\n      this.connectWebSocket();\r\n    }, 5000);\r\n  }\r\n  \r\n  /**\r\n   * ÈÄöÈÅé WebSocket ÁôºÈÄÅÂëΩ‰ª§\r\n   */\r\n  async wsCommand<T>(cmd: string, payload: any = {}): Promise<ApiResponse<T>> {\r\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\r\n      // ÈôçÁ¥öÂà∞ HTTP\r\n      return this.httpCommand(cmd, payload);\r\n    }\r\n    \r\n    const requestId = crypto.randomUUID();\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      this.pendingRequests.set(requestId, { resolve, reject });\r\n      \r\n      // Ë∂ÖÊôÇËôïÁêÜ\r\n      setTimeout(() => {\r\n        if (this.pendingRequests.has(requestId)) {\r\n          this.pendingRequests.delete(requestId);\r\n          reject(new Error('WebSocket request timeout'));\r\n        }\r\n      }, this._config().timeout || 30000);\r\n      \r\n      this.ws!.send(JSON.stringify({\r\n        command: cmd,\r\n        payload,\r\n        request_id: requestId\r\n      }));\r\n    });\r\n  }\r\n  \r\n  // ==================== ‰æøÊç∑ÊñπÊ≥ï ====================\r\n  \r\n  /**\r\n   * ÂÅ•Â∫∑Ê™¢Êü•\r\n   */\r\n  async healthCheck(): Promise<boolean> {\r\n    try {\r\n      const result = await this.command('get-initial-state');\r\n      return result.success;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Â∏∂Á∑©Â≠òÁöÑË´ãÊ±Ç\r\n   */\r\n  async cachedCommand<T>(cmd: string, payload: any = {}, ttl: number = this.cacheTimeout): Promise<ApiResponse<T>> {\r\n    const cacheKey = `${cmd}:${JSON.stringify(payload)}`;\r\n    const cached = this.cache.get(cacheKey);\r\n    \r\n    if (cached && Date.now() - cached.timestamp < ttl) {\r\n      return { success: true, data: cached.data };\r\n    }\r\n    \r\n    const result = await this.command<T>(cmd, payload);\r\n    \r\n    if (result.success && result.data) {\r\n      this.cache.set(cacheKey, { data: result.data, timestamp: Date.now() });\r\n    }\r\n    \r\n    return result;\r\n  }\r\n  \r\n  /**\r\n   * Ê∏ÖÈô§Á∑©Â≠ò\r\n   */\r\n  clearCache(pattern?: string): void {\r\n    if (pattern) {\r\n      for (const key of this.cache.keys()) {\r\n        if (key.includes(pattern)) {\r\n          this.cache.delete(key);\r\n        }\r\n      }\r\n    } else {\r\n      this.cache.clear();\r\n    }\r\n  }\r\n  \r\n  // ==================== RESTful HTTP ÊñπÊ≥ï ====================\r\n  \r\n  /**\r\n   * HTTP GET Ë´ãÊ±Ç\r\n   */\r\n  async get<T = any>(endpoint: string, options?: { cache?: boolean; ttl?: number }): Promise<ApiResponse<T>> {\r\n    const config = this._config();\r\n    const url = endpoint.startsWith('http') ? endpoint : `${config.baseUrl}${endpoint}`;\r\n    \r\n    // Á∑©Â≠òÊ™¢Êü•\r\n    if (options?.cache !== false) {\r\n      const cached = this.cache.get(url);\r\n      if (cached && Date.now() - cached.timestamp < (options?.ttl || this.cacheTimeout)) {\r\n        return { success: true, data: cached.data };\r\n      }\r\n    }\r\n    \r\n    const token = localStorage.getItem('tgm_access_token');\r\n    const headers: HeadersInit = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n    \r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'GET',\r\n        headers\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        // ËôïÁêÜ 401 Êú™ÊéàÊ¨äÈåØË™§ - Ê∏ÖÈô§Ë™çË≠â‰∏¶ÈáçÂÆöÂêëÂà∞ÁôªÈåÑÈ†Å\r\n        if (response.status === 401) {\r\n          console.warn('[ApiService] 401 Unauthorized - clearing auth and redirecting');\r\n          this.handleUnauthorized();\r\n          return { success: false, error: 'ÁôªÈåÑÂ∑≤ÈÅéÊúüÔºåË´ãÈáçÊñ∞ÁôªÈåÑ' };\r\n        }\r\n        \r\n        const errorData = await response.json().catch(() => ({}));\r\n        return { \r\n          success: false, \r\n          error: errorData.error || errorData.message || `HTTP ${response.status}: ${response.statusText}` \r\n        };\r\n      }\r\n      \r\n      const result = await response.json();\r\n      \r\n      // Á∑©Â≠òÁµêÊûú\r\n      if (options?.cache !== false && result.success !== false) {\r\n        this.cache.set(url, { data: result.data || result, timestamp: Date.now() });\r\n      }\r\n      \r\n      return this.normalizeResponse(result);\r\n    } catch (error: any) {\r\n      console.error(`[ApiService] GET ${endpoint} error:`, error);\r\n      return { success: false, error: error.message || 'Network error' };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ËôïÁêÜ 401 Êú™ÊéàÊ¨äÈåØË™§\r\n   * Ê≥®ÊÑèÔºö‰∏çÂÜçËá™ÂãïÊ∏ÖÈô§Ë™çË≠âÊàñÈáçÂÆöÂêëÔºåÂè™Ë®òÈåÑÊó•Ë™å\r\n   * ËÆìÁî®Êà∂ÊâãÂãïÈáçÊñ∞ÁôªÈåÑ‰ª•ÈÅøÂÖçÊÑèÂ§ñÁôªÂá∫\r\n   */\r\n  private handleUnauthorized() {\r\n    console.warn('[ApiService] 401 Unauthorized - Token may be expired or invalid');\r\n    console.warn('[ApiService] Please try logging out and logging back in');\r\n    \r\n    // ÁôºÈÄÅ‰∫ã‰ª∂ÈÄöÁü•Ôºà‰∏çÂº∑Âà∂ÈáçÂÆöÂêëÔºâ\r\n    window.dispatchEvent(new CustomEvent('auth:unauthorized', { \r\n      detail: { message: 'ÁôªÈåÑÂ∑≤ÈÅéÊúüÔºåË´ãÈáçÊñ∞ÁôªÈåÑ' } \r\n    }));\r\n  }\r\n  \r\n  /**\r\n   * HTTP POST Ë´ãÊ±Ç\r\n   */\r\n  async post<T = any>(endpoint: string, body: any = {}): Promise<ApiResponse<T>> {\r\n    const config = this._config();\r\n    const url = endpoint.startsWith('http') ? endpoint : `${config.baseUrl}${endpoint}`;\r\n    \r\n    const token = localStorage.getItem('tgm_access_token');\r\n    const headers: HeadersInit = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n    \r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        // ËôïÁêÜ 401 Êú™ÊéàÊ¨äÈåØË™§ - Ê∏ÖÈô§Ë™çË≠â‰∏¶ÈáçÂÆöÂêëÂà∞ÁôªÈåÑÈ†Å\r\n        if (response.status === 401) {\r\n          console.warn('[ApiService] 401 Unauthorized on POST - clearing auth and redirecting');\r\n          this.handleUnauthorized();\r\n          return { success: false, error: 'ÁôªÈåÑÂ∑≤ÈÅéÊúüÔºåË´ãÈáçÊñ∞ÁôªÈåÑ' };\r\n        }\r\n        \r\n        const errorData = await response.json().catch(() => ({}));\r\n        return { \r\n          success: false, \r\n          error: errorData.error || errorData.message || `HTTP ${response.status}: ${response.statusText}` \r\n        };\r\n      }\r\n      \r\n      const result = await response.json();\r\n      return this.normalizeResponse(result);\r\n    } catch (error: any) {\r\n      console.error(`[ApiService] POST ${endpoint} error:`, error);\r\n      return { success: false, error: error.message || 'Network error' };\r\n    }\r\n  }\r\n  \r\n  // ==================== Â∏∏Áî® API Âø´Êç∑ÊñπÊ≥ï ====================\r\n  \r\n  // Â∏≥Ëôü\r\n  getAccounts() { return this.cachedCommand('get-accounts'); }\r\n  addAccount(data: any) { return this.command('add-account', data); }\r\n  loginAccount(id: string | number) { return this.command('login-account', { id }); }\r\n  logoutAccount(id: string | number) { return this.command('logout-account', { id }); }\r\n  \r\n  // Ë™çË≠â\r\n  sendCode(phone: string, apiId?: string, apiHash?: string) {\r\n    return this.command('send-code', { phone, apiId, apiHash });\r\n  }\r\n  verifyCode(phone: string, code: string, phoneCodeHash: string) {\r\n    return this.command('verify-code', { phone, code, phoneCodeHash });\r\n  }\r\n  \r\n  // API ÊÜëË≠â\r\n  getCredentials() { return this.cachedCommand('get-api-credentials'); }\r\n  addCredential(data: any) { return this.command('add-api-credential', data); }\r\n  getRecommendedCredential() { return this.cachedCommand('get-api-recommendation'); }\r\n  \r\n  // Áõ£Êéß\r\n  getMonitoringStatus() { return this.command('get-monitoring-status'); }\r\n  startMonitoring(config?: any) { return this.command('start-monitoring', config); }\r\n  stopMonitoring() { return this.command('stop-monitoring'); }\r\n  \r\n  // ÂàùÂßãÁãÄÊÖã\r\n  getInitialState() { return this.cachedCommand('get-initial-state', {}, 5000); }\r\n  \r\n  // Ë®≠ÁΩÆ\r\n  getSettings() { return this.cachedCommand('get-settings'); }\r\n  saveSettings(settings: any) {\r\n    this.clearCache('get-settings');\r\n    return this.command('save-settings', settings);\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
