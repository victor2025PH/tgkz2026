import{J as h,N as u,a as g,aa as l}from"./chunk-XBIFDY2N.js";var M=[{command:"user-register",httpMethod:"POST",endpoint:"/api/v1/auth/register",responseEvents:["user-registered","auth-state-changed"]},{command:"user-login",httpMethod:"POST",endpoint:"/api/v1/auth/login",responseEvents:["user-logged-in","auth-state-changed"]},{command:"user-logout",httpMethod:"POST",endpoint:"/api/v1/auth/logout",responseEvents:["user-logged-out","auth-state-changed"]},{command:"user-refresh-token",httpMethod:"POST",endpoint:"/api/v1/auth/refresh",responseEvents:["token-refreshed"]},{command:"get-current-user",httpMethod:"GET",endpoint:"/api/v1/auth/me",responseEvents:["current-user-loaded"]},{command:"oauth-telegram",httpMethod:"POST",endpoint:"/api/v1/oauth/telegram",responseEvents:["oauth-telegram-success","auth-state-changed"]},{command:"oauth-telegram-config",httpMethod:"GET",endpoint:"/api/v1/oauth/telegram/config",responseEvents:["oauth-telegram-config-loaded"]},{command:"oauth-google",httpMethod:"POST",endpoint:"/api/v1/oauth/google",responseEvents:["oauth-google-success","auth-state-changed"]},{command:"oauth-providers",httpMethod:"GET",endpoint:"/api/v1/oauth/providers",responseEvents:["oauth-providers-loaded"]},{command:"send-verification-email",httpMethod:"POST",endpoint:"/api/v1/auth/send-verification",responseEvents:["verification-email-sent"],requiresAuth:!0},{command:"verify-email",httpMethod:"POST",endpoint:"/api/v1/auth/verify-email",responseEvents:["email-verified"]},{command:"verify-email-code",httpMethod:"POST",endpoint:"/api/v1/auth/verify-email-code",responseEvents:["email-verified"]},{command:"forgot-password",httpMethod:"POST",endpoint:"/api/v1/auth/forgot-password",responseEvents:["password-reset-requested"]},{command:"reset-password",httpMethod:"POST",endpoint:"/api/v1/auth/reset-password",responseEvents:["password-reset-completed"]},{command:"reset-password-code",httpMethod:"POST",endpoint:"/api/v1/auth/reset-password-code",responseEvents:["password-reset-completed"]},{command:"update-current-user",httpMethod:"PUT",endpoint:"/api/v1/auth/me",responseEvents:["current-user-updated"]},{command:"change-password",httpMethod:"POST",endpoint:"/api/v1/auth/change-password",responseEvents:["password-changed"]},{command:"get-user-sessions",httpMethod:"GET",endpoint:"/api/v1/auth/sessions",responseEvents:["sessions-loaded"]},{command:"revoke-session",httpMethod:"DELETE",endpoint:"/api/v1/auth/sessions/{id}",responseEvents:["session-revoked"]},{command:"get-accounts",httpMethod:"GET",endpoint:"/api/v1/accounts",responseEvents:["accounts-updated"]},{command:"add-account",httpMethod:"POST",endpoint:"/api/v1/accounts",responseEvents:["login-requires-code","login-requires-2fa","login-success","login-error","accounts-updated"]},{command:"login-account",httpMethod:"POST",endpoint:"/api/command",responseEvents:["login-requires-code","login-requires-2fa","login-success","login-error"],useCommandEndpoint:!0},{command:"logout-account",httpMethod:"POST",endpoint:"/api/command",responseEvents:["logout-result"],useCommandEndpoint:!0},{command:"update-account",httpMethod:"PUT",endpoint:"/api/v1/accounts/{id}",responseEvents:["account-updated"]},{command:"update-account-data",httpMethod:"PUT",endpoint:"/api/v1/accounts/{id}",responseEvents:["account-updated"]},{command:"delete-account",httpMethod:"DELETE",endpoint:"/api/v1/accounts/{id}",responseEvents:["account-deleted","accounts-updated"]},{command:"remove-account",httpMethod:"DELETE",endpoint:"/api/v1/accounts/{id}",responseEvents:["account-deleted","accounts-updated"]},{command:"connect-account",httpMethod:"POST",endpoint:"/api/command",responseEvents:["account-connection-status"],useCommandEndpoint:!0},{command:"disconnect-account",httpMethod:"POST",endpoint:"/api/command",responseEvents:["account-disconnected"],useCommandEndpoint:!0},{command:"check-account-status",httpMethod:"POST",endpoint:"/api/command",responseEvents:["account-status-checked"],useCommandEndpoint:!0},{command:"import-session",httpMethod:"POST",endpoint:"/api/command",responseEvents:["session-imported"],useCommandEndpoint:!0},{command:"export-session",httpMethod:"POST",endpoint:"/api/command",responseEvents:["session-exported"],useCommandEndpoint:!0},{command:"bulk-assign-role",httpMethod:"POST",endpoint:"/api/command",responseEvents:["accounts-updated"],useCommandEndpoint:!0},{command:"bulk-delete-accounts",httpMethod:"POST",endpoint:"/api/command",responseEvents:["accounts-updated"],useCommandEndpoint:!0},{command:"start-monitoring",httpMethod:"POST",endpoint:"/api/v1/monitoring/start",responseEvents:["monitoring-started","monitoring-status"]},{command:"stop-monitoring",httpMethod:"POST",endpoint:"/api/v1/monitoring/stop",responseEvents:["monitoring-stopped","monitoring-status"]},{command:"get-monitoring-status",httpMethod:"GET",endpoint:"/api/v1/monitoring/status",responseEvents:["monitoring-status"]},{command:"one-click-start",httpMethod:"POST",endpoint:"/api/command",responseEvents:["one-click-started","monitoring-status"],useCommandEndpoint:!0},{command:"one-click-stop",httpMethod:"POST",endpoint:"/api/command",responseEvents:["one-click-stopped","monitoring-status"],useCommandEndpoint:!0},{command:"get-system-status",httpMethod:"GET",endpoint:"/api/v1/system/health",responseEvents:["system-status"]},{command:"get-monitored-groups",httpMethod:"GET",endpoint:"/api/v1/groups",responseEvents:["monitored-groups-updated"]},{command:"add-group",httpMethod:"POST",endpoint:"/api/v1/groups",responseEvents:["group-added","monitored-groups-updated"]},{command:"remove-group",httpMethod:"POST",endpoint:"/api/command",responseEvents:["group-removed","monitored-groups-updated"],useCommandEndpoint:!0},{command:"join-group",httpMethod:"POST",endpoint:"/api/command",responseEvents:["group-joined"],useCommandEndpoint:!0},{command:"leave-group",httpMethod:"POST",endpoint:"/api/command",responseEvents:["group-left"],useCommandEndpoint:!0},{command:"join-and-monitor-with-account",httpMethod:"POST",endpoint:"/api/command",responseEvents:["join-and-monitor-result","monitored-groups-updated"],useCommandEndpoint:!0},{command:"join-and-monitor-resource",httpMethod:"POST",endpoint:"/api/command",responseEvents:["join-and-monitor-result","monitored-groups-updated"],useCommandEndpoint:!0},{command:"batch-join-and-monitor",httpMethod:"POST",endpoint:"/api/command",responseEvents:["batch-join-result"],useCommandEndpoint:!0},{command:"batch-join-resources",httpMethod:"POST",endpoint:"/api/command",responseEvents:["batch-join-result"],useCommandEndpoint:!0},{command:"get-keyword-sets",httpMethod:"GET",endpoint:"/api/v1/keywords",responseEvents:["keyword-sets-updated"]},{command:"add-keyword-set",httpMethod:"POST",endpoint:"/api/v1/keywords",responseEvents:["keyword-set-added","keyword-sets-updated"]},{command:"add-keyword",httpMethod:"POST",endpoint:"/api/command",responseEvents:["keyword-added"],useCommandEndpoint:!0},{command:"remove-keyword",httpMethod:"POST",endpoint:"/api/command",responseEvents:["keyword-removed"],useCommandEndpoint:!0},{command:"get-queue-status",httpMethod:"POST",endpoint:"/api/command",responseEvents:["queue-status"],useCommandEndpoint:!0},{command:"get-queue-messages",httpMethod:"POST",endpoint:"/api/command",responseEvents:["queue-messages"],useCommandEndpoint:!0},{command:"clear-queue",httpMethod:"POST",endpoint:"/api/command",responseEvents:["queue-cleared"],useCommandEndpoint:!0},{command:"retry-message",httpMethod:"POST",endpoint:"/api/command",responseEvents:["message-retried"],useCommandEndpoint:!0},{command:"cancel-message",httpMethod:"POST",endpoint:"/api/command",responseEvents:["message-cancelled"],useCommandEndpoint:!0},{command:"pause-queue",httpMethod:"POST",endpoint:"/api/command",responseEvents:["queue-paused"],useCommandEndpoint:!0},{command:"resume-queue",httpMethod:"POST",endpoint:"/api/command",responseEvents:["queue-resumed"],useCommandEndpoint:!0},{command:"send-message",httpMethod:"POST",endpoint:"/api/command",responseEvents:["message-sent"],useCommandEndpoint:!0},{command:"send-group-message",httpMethod:"POST",endpoint:"/api/command",responseEvents:["message-sent"],useCommandEndpoint:!0},{command:"schedule-message",httpMethod:"POST",endpoint:"/api/command",responseEvents:["message-sent"],useCommandEndpoint:!0},{command:"get-leads",httpMethod:"POST",endpoint:"/api/command",responseEvents:["leads-updated"],useCommandEndpoint:!0},{command:"get-leads-paginated",httpMethod:"POST",endpoint:"/api/command",responseEvents:["leads-updated"],useCommandEndpoint:!0},{command:"add-lead",httpMethod:"POST",endpoint:"/api/command",responseEvents:["lead-added","leads-updated"],useCommandEndpoint:!0},{command:"update-lead-status",httpMethod:"POST",endpoint:"/api/command",responseEvents:["lead-status-updated"],useCommandEndpoint:!0},{command:"delete-lead",httpMethod:"POST",endpoint:"/api/command",responseEvents:["lead-deleted"],useCommandEndpoint:!0},{command:"batch-delete-leads",httpMethod:"POST",endpoint:"/api/command",responseEvents:["leads-batch-deleted"],useCommandEndpoint:!0},{command:"batch-update-lead-status",httpMethod:"POST",endpoint:"/api/command",responseEvents:["leads-status-batch-updated"],useCommandEndpoint:!0},{command:"search-leads",httpMethod:"POST",endpoint:"/api/command",responseEvents:["leads-search-result"],useCommandEndpoint:!0},{command:"get-all-tags",httpMethod:"POST",endpoint:"/api/command",responseEvents:["tags-updated"],useCommandEndpoint:!0},{command:"create-tag",httpMethod:"POST",endpoint:"/api/command",responseEvents:["tag-created","tags-updated"],useCommandEndpoint:!0},{command:"delete-tag",httpMethod:"POST",endpoint:"/api/command",responseEvents:["tag-deleted","tags-updated"],useCommandEndpoint:!0},{command:"batch-add-tag",httpMethod:"POST",endpoint:"/api/command",responseEvents:["tags-batch-added"],useCommandEndpoint:!0},{command:"batch-remove-tag",httpMethod:"POST",endpoint:"/api/command",responseEvents:["tags-batch-removed"],useCommandEndpoint:!0},{command:"add-to-dnc",httpMethod:"POST",endpoint:"/api/command",responseEvents:["dnc-added"],useCommandEndpoint:!0},{command:"batch-add-to-dnc",httpMethod:"POST",endpoint:"/api/command",responseEvents:["dnc-batch-added"],useCommandEndpoint:!0},{command:"search-resources",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resources-search-result"],useCommandEndpoint:!0},{command:"search-jiso",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resources-search-result"],useCommandEndpoint:!0},{command:"get-resources",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resources-updated"],useCommandEndpoint:!0},{command:"save-resource",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resource-saved"],useCommandEndpoint:!0},{command:"unsave-resource",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resource-unsaved"],useCommandEndpoint:!0},{command:"get-resource-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resource-stats"],useCommandEndpoint:!0},{command:"clear-all-resources",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resources-cleared"],useCommandEndpoint:!0},{command:"clear-resources",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resources-cleared"],useCommandEndpoint:!0},{command:"delete-resource",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resource-deleted"],useCommandEndpoint:!0},{command:"delete-resources-batch",httpMethod:"POST",endpoint:"/api/command",responseEvents:["resources-batch-deleted"],useCommandEndpoint:!0},{command:"extract-members",httpMethod:"POST",endpoint:"/api/command",responseEvents:["members-extracted"],useCommandEndpoint:!0},{command:"batch-extract-members",httpMethod:"POST",endpoint:"/api/command",responseEvents:["members-extracted"],useCommandEndpoint:!0},{command:"collect-users-from-history",httpMethod:"POST",endpoint:"/api/command",responseEvents:["collect-from-history-result"],useCommandEndpoint:!0},{command:"collect-users-from-history-advanced",httpMethod:"POST",endpoint:"/api/command",responseEvents:["history-collection-result"],useCommandEndpoint:!0},{command:"get-history-collection-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["history-collection-stats"],useCommandEndpoint:!0},{command:"get-group-collected-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["group-collected-stats"],useCommandEndpoint:!0},{command:"get-collected-users-count",httpMethod:"POST",endpoint:"/api/command",responseEvents:["collected-users-count"],useCommandEndpoint:!0},{command:"check-group-monitoring-status",httpMethod:"POST",endpoint:"/api/command",responseEvents:["group-monitoring-status"],useCommandEndpoint:!0},{command:"export-members",httpMethod:"POST",endpoint:"/api/command",responseEvents:["members-exported"],useCommandEndpoint:!0},{command:"deduplicate-members",httpMethod:"POST",endpoint:"/api/command",responseEvents:["members-deduplicated"],useCommandEndpoint:!0},{command:"batch-tag-members",httpMethod:"POST",endpoint:"/api/command",responseEvents:["members-tagged"],useCommandEndpoint:!0},{command:"get-all-tags",httpMethod:"POST",endpoint:"/api/command",responseEvents:["all-tags-result"],useCommandEndpoint:!0},{command:"get-group-profile",httpMethod:"POST",endpoint:"/api/command",responseEvents:["group-profile-result"],useCommandEndpoint:!0},{command:"compare-groups",httpMethod:"POST",endpoint:"/api/command",responseEvents:["groups-compared"],useCommandEndpoint:!0},{command:"recalculate-scores",httpMethod:"POST",endpoint:"/api/command",responseEvents:["scores-recalculated"],useCommandEndpoint:!0},{command:"get-extraction-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["extraction-stats-result"],useCommandEndpoint:!0},{command:"start-background-extraction",httpMethod:"POST",endpoint:"/api/command",responseEvents:["background-extraction-started"],useCommandEndpoint:!0},{command:"get-background-tasks",httpMethod:"POST",endpoint:"/api/command",responseEvents:["background-tasks-result"],useCommandEndpoint:!0},{command:"clear-extraction-cache",httpMethod:"POST",endpoint:"/api/command",responseEvents:["extraction-cache-cleared"],useCommandEndpoint:!0},{command:"generate-ai-response",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ai-response-generated"],useCommandEndpoint:!0},{command:"test-ai-connection",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ai-connection-tested"],useCommandEndpoint:!0},{command:"test-local-ai",httpMethod:"POST",endpoint:"/api/command",responseEvents:["local-ai-tested"],useCommandEndpoint:!0},{command:"get-ollama-models",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ollama-models"],useCommandEndpoint:!0},{command:"search-rag",httpMethod:"POST",endpoint:"/api/command",responseEvents:["rag-search-result"],useCommandEndpoint:!0},{command:"get-rag-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["rag-stats"],useCommandEndpoint:!0},{command:"init-rag-system",httpMethod:"POST",endpoint:"/api/command",responseEvents:["rag-initialized"],useCommandEndpoint:!0},{command:"trigger-rag-learning",httpMethod:"POST",endpoint:"/api/command",responseEvents:["rag-learning-triggered"],useCommandEndpoint:!0},{command:"add-rag-knowledge",httpMethod:"POST",endpoint:"/api/command",responseEvents:["rag-knowledge-added"],useCommandEndpoint:!0},{command:"search-vector-memories",httpMethod:"POST",endpoint:"/api/command",responseEvents:["vector-memories-result"],useCommandEndpoint:!0},{command:"add-vector-memory",httpMethod:"POST",endpoint:"/api/command",responseEvents:["vector-memory-added"],useCommandEndpoint:!0},{command:"get-memory-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["memory-stats"],useCommandEndpoint:!0},{command:"delete-vector-memory",httpMethod:"POST",endpoint:"/api/command",responseEvents:["vector-memory-deleted"],useCommandEndpoint:!0},{command:"get-ad-templates",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ad-templates-updated"],useCommandEndpoint:!0},{command:"create-ad-template",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ad-template-created"],useCommandEndpoint:!0},{command:"delete-ad-template",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ad-template-deleted"],useCommandEndpoint:!0},{command:"get-ad-schedules",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ad-schedules-updated"],useCommandEndpoint:!0},{command:"get-ad-send-logs",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ad-send-logs"],useCommandEndpoint:!0},{command:"get-ad-overview-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ad-overview-stats"],useCommandEndpoint:!0},{command:"get-marketing-stats",httpMethod:"POST",endpoint:"/api/command",responseEvents:["marketing-stats"],useCommandEndpoint:!0},{command:"get-marketing-campaigns",httpMethod:"POST",endpoint:"/api/command",responseEvents:["marketing-campaigns-updated"],useCommandEndpoint:!0},{command:"create-marketing-campaign",httpMethod:"POST",endpoint:"/api/command",responseEvents:["marketing-campaign-created"],useCommandEndpoint:!0},{command:"start-marketing-campaign",httpMethod:"POST",endpoint:"/api/command",responseEvents:["marketing-campaign-started"],useCommandEndpoint:!0},{command:"get-settings",httpMethod:"GET",endpoint:"/api/v1/settings",responseEvents:["settings-loaded"]},{command:"save-settings",httpMethod:"POST",endpoint:"/api/v1/settings",responseEvents:["settings-saved"]},{command:"save-ai-settings",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ai-settings-saved"],useCommandEndpoint:!0},{command:"update-ai-chat-settings",httpMethod:"POST",endpoint:"/api/command",responseEvents:["ai-settings-saved"],useCommandEndpoint:!0},{command:"get-initial-state",httpMethod:"GET",endpoint:"/api/v1/initial-state",responseEvents:["initial-state","initial-state-core","initial-state-config","initial-state-data","accounts-updated"]},{command:"list-backups",httpMethod:"POST",endpoint:"/api/command",responseEvents:["backups-listed"],useCommandEndpoint:!0},{command:"create-backup",httpMethod:"POST",endpoint:"/api/command",responseEvents:["backup-created"],useCommandEndpoint:!0},{command:"restore-backup",httpMethod:"POST",endpoint:"/api/command",responseEvents:["backup-restored"],useCommandEndpoint:!0},{command:"delete-backup",httpMethod:"POST",endpoint:"/api/command",responseEvents:["backup-deleted"],useCommandEndpoint:!0},{command:"get-logs",httpMethod:"POST",endpoint:"/api/command",responseEvents:["logs-updated"],useCommandEndpoint:!0},{command:"clear-logs",httpMethod:"POST",endpoint:"/api/command",responseEvents:["logs-cleared"],useCommandEndpoint:!0},{command:"export-logs",httpMethod:"POST",endpoint:"/api/command",responseEvents:["logs-exported"],useCommandEndpoint:!0},{command:"get-alerts",httpMethod:"POST",endpoint:"/api/command",responseEvents:["alerts-updated"],useCommandEndpoint:!0},{command:"acknowledge-alert",httpMethod:"POST",endpoint:"/api/command",responseEvents:["alert-updated"],useCommandEndpoint:!0},{command:"resolve-alert",httpMethod:"POST",endpoint:"/api/command",responseEvents:["alert-updated"],useCommandEndpoint:!0},{command:"get-api-credentials",httpMethod:"GET",endpoint:"/api/v1/credentials",responseEvents:["api-credentials-updated"]},{command:"add-api-credential",httpMethod:"POST",endpoint:"/api/v1/credentials",responseEvents:["api-credential-added"]},{command:"remove-api-credential",httpMethod:"DELETE",endpoint:"/api/v1/credentials/{id}",responseEvents:["api-credential-removed"]},{command:"get-api-recommendation",httpMethod:"GET",endpoint:"/api/v1/credentials/recommend",responseEvents:["api-recommendation"]},{command:"get-quota-status",httpMethod:"GET",endpoint:"/api/v1/quota",responseEvents:["quota-status-loaded"]},{command:"check-quota",httpMethod:"POST",endpoint:"/api/v1/quota/check",responseEvents:["quota-check-result"]},{command:"get-quota-alerts",httpMethod:"GET",endpoint:"/api/v1/quota/alerts",responseEvents:["quota-alerts-loaded"]},{command:"acknowledge-quota-alert",httpMethod:"POST",endpoint:"/api/v1/quota/alerts/acknowledge",responseEvents:["quota-alert-acknowledged"]},{command:"get-membership-levels",httpMethod:"GET",endpoint:"/api/v1/membership/levels",responseEvents:["membership-levels-loaded"]},{command:"get-quota-trend",httpMethod:"GET",endpoint:"/api/v1/quota/trend",responseEvents:["quota-trend-loaded"]},{command:"get-quota-history",httpMethod:"GET",endpoint:"/api/v1/quota/history",responseEvents:["quota-history-loaded"]},{command:"get-quota-packs",httpMethod:"GET",endpoint:"/api/v1/billing/quota-packs",responseEvents:["quota-packs-loaded"]},{command:"purchase-quota-pack",httpMethod:"POST",endpoint:"/api/v1/billing/quota-packs/purchase",responseEvents:["quota-pack-purchased"]},{command:"get-my-packages",httpMethod:"GET",endpoint:"/api/v1/billing/my-packages",responseEvents:["my-packages-loaded"]},{command:"get-user-bills",httpMethod:"GET",endpoint:"/api/v1/billing/bills",responseEvents:["user-bills-loaded"]},{command:"pay-bill",httpMethod:"POST",endpoint:"/api/v1/billing/bills/pay",responseEvents:["bill-paid"]},{command:"get-overage-info",httpMethod:"GET",endpoint:"/api/v1/billing/overage",responseEvents:["overage-info-loaded"]},{command:"get-freeze-status",httpMethod:"GET",endpoint:"/api/v1/billing/freeze-status",responseEvents:["freeze-status-loaded"]},{command:"create-payment",httpMethod:"POST",endpoint:"/api/v1/payment/create",responseEvents:["payment-created"]},{command:"get-payment-status",httpMethod:"GET",endpoint:"/api/v1/payment/status",responseEvents:["payment-status-loaded"]},{command:"get-payment-history",httpMethod:"GET",endpoint:"/api/v1/payment/history",responseEvents:["payment-history-loaded"]},{command:"get-invoices",httpMethod:"GET",endpoint:"/api/v1/invoices",responseEvents:["invoices-loaded"]},{command:"get-invoice-detail",httpMethod:"GET",endpoint:"/api/v1/invoices/{invoice_id}",responseEvents:["invoice-detail-loaded"]}];function v(m){return M.find(t=>t.command===m)}function E(m,t){let e=m.endpoint,n=e.match(/\{(\w+)\}/g);if(n)for(let s of n){let o=s.slice(1,-1),a=t[o]||t.id||t.accountId;a&&(e=e.replace(s,String(a)))}return e}var f=class m{constructor(t){this.ngZone=t;this.listeners=[];this.channelListeners=new Map;this.ws=null;this.wsReconnectTimer=null;this.wsConnected=!1;this.webListeners=new Map;this.apiBaseUrl="";this.isWebMode=!1;this.wsReconnectAttempts=0;this.WS_MAX_RECONNECT_ATTEMPTS=3;this.WS_RECONNECT_DELAYS=[5e3,1e4,2e4,4e4,6e4];this.isDegradedMode=!1;this.pollingInterval=null;this.POLLING_INTERVAL_MS=3e4;this.wsHeartbeatTimer=null;this.WS_HEARTBEAT_INTERVAL=3e4;this.wsLastPong=0;this.WS_PONG_TIMEOUT=1e4;this.httpConnected=!1;this.authToken=null;if(window.require)try{let e=window.require("electron");e&&e.ipcRenderer?(this.ipcRenderer=e.ipcRenderer,console.log("Electron IPC renderer successfully loaded.")):(console.warn("Electron IPC renderer not found, running in browser mode."),this.initWebMode())}catch(e){console.error("Could not load Electron IPC renderer:",e),this.initWebMode()}else console.warn("Electron IPC not available, running in browser mode."),this.initWebMode()}initWebMode(){this.isWebMode=!0,window.location.hostname==="localhost"&&window.location.port==="4200"?this.apiBaseUrl="http://localhost:8000":this.apiBaseUrl=`${window.location.protocol}//${window.location.host}`,console.log(`[Web Mode] API URL: ${this.apiBaseUrl}`),this.connectWebSocket()}connectWebSocket(){let t=window.location.protocol==="https:"?"wss:":"ws:",e;window.location.hostname==="localhost"&&window.location.port==="4200"?e="ws://localhost:8000/ws":e=`${t}//${window.location.host}/ws`,console.log(`[Web Mode] Connecting WebSocket: ${e} (attempt ${this.wsReconnectAttempts+1})`);try{this.ws=new WebSocket(e),this.ws.onopen=()=>{console.log("[Web Mode] \u2705 WebSocket connected"),this.wsConnected=!0,this.wsReconnectAttempts=0,this.wsLastPong=Date.now(),this.startHeartbeat(),this.isDegradedMode&&(console.log("[Web Mode] \u{1F504} Recovered from degraded mode"),this.isDegradedMode=!1,this.stopPolling(),this.triggerEvent("connection-mode-changed",{mode:"websocket"})),this.wsReconnectTimer&&(clearTimeout(this.wsReconnectTimer),this.wsReconnectTimer=null),this.triggerEvent("websocket-connected",{timestamp:Date.now()})},this.ws.onmessage=n=>{try{this.wsLastPong=Date.now();let s=JSON.parse(n.data);if(s.type==="pong"||s.event==="pong")return;let o=s.event||s.type,a=s.data||s.payload||s,i=this.webListeners.get(o);i&&this.ngZone.run(()=>{i.forEach(p=>{try{p(a)}catch(d){console.error(`[Web Mode] Listener error for ${o}:`,d)}})})}catch(s){console.error("[Web Mode] WebSocket message parse error:",s)}},this.ws.onclose=n=>{console.log(`[Web Mode] WebSocket disconnected (code: ${n.code}, reason: ${n.reason})`),this.wsConnected=!1,this.stopHeartbeat(),this.triggerEvent("websocket-disconnected",{code:n.code,reason:n.reason}),this.scheduleReconnect()},this.ws.onerror=n=>{console.error("[Web Mode] WebSocket error:",n),this.wsReconnectAttempts++}}catch(n){console.error("[Web Mode] WebSocket connection failed:",n),this.wsReconnectAttempts++,this.scheduleReconnect()}}startHeartbeat(){this.stopHeartbeat(),this.wsHeartbeatTimer=setInterval(()=>{if(this.ws&&this.wsConnected){if(Date.now()-this.wsLastPong>this.WS_HEARTBEAT_INTERVAL+this.WS_PONG_TIMEOUT){console.warn("[Web Mode] WebSocket heartbeat timeout, reconnecting..."),this.ws.close();return}try{this.ws.send(JSON.stringify({type:"ping",timestamp:Date.now()}))}catch(e){console.error("[Web Mode] Failed to send heartbeat:",e)}}},this.WS_HEARTBEAT_INTERVAL)}stopHeartbeat(){this.wsHeartbeatTimer&&(clearInterval(this.wsHeartbeatTimer),this.wsHeartbeatTimer=null)}scheduleReconnect(){if(this.wsReconnectTimer)return;if(this.wsReconnectAttempts>=this.WS_MAX_RECONNECT_ATTEMPTS){this.isDegradedMode||(console.log("[Web Mode] \u26A0\uFE0F WebSocket failed, switching to HTTP polling mode"),this.isDegradedMode=!0,this.startPolling(),this.triggerEvent("connection-mode-changed",{mode:"polling"})),this.wsReconnectTimer=setTimeout(()=>{this.wsReconnectTimer=null,console.log("[Web Mode] Background WebSocket reconnection attempt..."),this.connectWebSocket()},6e4);return}let t=this.WS_RECONNECT_DELAYS[Math.min(this.wsReconnectAttempts,this.WS_RECONNECT_DELAYS.length-1)];console.log(`[Web Mode] Reconnecting in ${t/1e3}s...`),this.wsReconnectTimer=setTimeout(()=>{this.wsReconnectTimer=null,this.connectWebSocket()},t)}startPolling(){this.pollingInterval||(console.log("[Web Mode] Starting HTTP polling mode"),this.pollingInterval=setInterval(()=>{this.httpConnected&&this.httpSend("get-system-status",{})},this.POLLING_INTERVAL_MS))}stopPolling(){this.pollingInterval&&(console.log("[Web Mode] Stopping HTTP polling mode"),clearInterval(this.pollingInterval),this.pollingInterval=null)}getConnectionMode(){return this.wsConnected?"websocket":this.isDegradedMode&&this.httpConnected?"polling":"disconnected"}ngOnDestroy(){this.cleanupAll(),this.ws&&(this.ws.close(),this.ws=null),this.wsReconnectTimer&&clearTimeout(this.wsReconnectTimer)}send(t,...e){this.ipcRenderer?(console.log(`[IPC Service] \u2192 Sending '${t}':`,e),this.ipcRenderer.send(t,...e)):this.isWebMode?(console.log(`[Web Mode] \u2192 Sending '${t}':`,e),this.httpSend(t,e[0]||{})):console.log(`[Browser Mode] IPC Send to '${t}':`,...e)}setAuthToken(t){this.authToken=t}async httpSend(t,e){try{let n=v(t),s,o,a;if(n&&!n.useCommandEndpoint){let r=E(n,e);s=`${this.apiBaseUrl}${r}`,o=n.httpMethod,o==="GET"?a=void 0:a=JSON.stringify(e)}else s=`${this.apiBaseUrl}/api/command`,o="POST",a=JSON.stringify({command:t,payload:e});console.log(`[Web Mode] ${o} ${s}`,n?"(registry)":"(fallback)",{command:t,payload:e});let i={"Content-Type":"application/json"};this.authToken&&(i.Authorization=`Bearer ${this.authToken}`);let p={method:o,headers:i};a&&(p.body=a);let d=await fetch(s,p);if(!d.ok){console.error(`[Web Mode] HTTP error: ${d.status} ${d.statusText}`);let r=await d.text();if(console.error("[Web Mode] Error body:",r),d.status===401){this.triggerEvent("auth-error",{error:"\u8A8D\u8B49\u5931\u6557",message:"\u8ACB\u91CD\u65B0\u767B\u5165"});return}this.triggerEvent("connection-error",{error:`HTTP \u932F\u8AA4: ${d.status}`,message:r,command:t}),this.handleResponseEvents(t,{success:!1,error:r||`HTTP ${d.status}`,status:d.status});return}let c=await d.json();if(console.log(`[Web Mode] Response for '${t}':`,c),this.httpConnected||(this.httpConnected=!0,console.log("[Web Mode] \u2705 HTTP connection confirmed"),this.triggerEvent("connection-confirmed",{mode:"http",timestamp:Date.now()})),c.events&&Array.isArray(c.events))for(let r of c.events)this.triggerEvent(r.name||r.type,r.data||r.payload);if(c.event){let r=this.webListeners.get(c.event);r&&this.ngZone.run(()=>{r.forEach(T=>T(c.data||c))})}this.handleResponseEvents(t,c)}catch(n){console.error(`[Web Mode] HTTP send error for '${t}':`,n),this.triggerEvent("connection-error",{error:n.message||"\u7DB2\u7D61\u9023\u63A5\u932F\u8AA4",message:"\u7121\u6CD5\u9023\u63A5\u5230\u670D\u52D9\u5668\uFF0C\u8ACB\u6AA2\u67E5\u7DB2\u7D61\u9023\u63A5",command:t}),this.handleResponseEvents(t,{success:!1,error:n.message||"\u7DB2\u7D61\u932F\u8AA4"})}}handleResponseEvents(t,e){if((t==="login-account"||t==="add-account")&&(e.success&&e.requires_code?this.triggerEvent("login-requires-code",{accountId:e.account_id||e.accountId,phone:e.phone,phoneCodeHash:e.phone_code_hash||e.phoneCodeHash,sendType:e.send_type||e.sendType||"app",message:e.message}):e.success&&e.requires_2fa?this.triggerEvent("login-requires-2fa",{accountId:e.account_id||e.accountId,phone:e.phone}):e.success&&(e.status==="Online"||e.logged_in)?this.triggerEvent("login-success",{accountId:e.account_id||e.accountId,phone:e.phone,userInfo:e.user_info||e.userInfo}):e.success||this.triggerEvent("login-error",{accountId:e.account_id||e.accountId,error:e.error||e.message,phone:e.phone,codeExpired:e.code_expired||e.codeExpired})),t==="get-accounts"){let n=e.accounts||e.data||e;Array.isArray(n)&&this.triggerEvent("accounts-updated",n)}if((t==="update-account"||t==="update-account-data")&&this.triggerEvent("account-updated",{success:e.success!==!1,account:e.account||e.data,accountId:e.accountId||e.account_id}),(t==="delete-account"||t==="remove-account")&&this.triggerEvent("account-deleted",{success:e.success!==!1,accountId:e.accountId||e.account_id,error:e.error}),t==="connect-account"&&this.triggerEvent("account-connection-status",{accountId:e.accountId||e.account_id,status:e.status||(e.success?"Connecting":"Error"),error:e.error}),t==="disconnect-account"&&this.triggerEvent("account-disconnected",{accountId:e.accountId||e.account_id,success:e.success!==!1}),t==="logout-account"&&this.triggerEvent("logout-result",{success:e.success!==!1,accountId:e.accountId||e.account_id,error:e.error}),t==="check-account-status"&&this.triggerEvent("account-status-checked",{accountId:e.accountId||e.account_id,status:e.status,online:e.online}),e.accounts&&Array.isArray(e.accounts)&&this.triggerEvent("accounts-updated",e.accounts),t==="start-monitoring"&&(this.triggerEvent("monitoring-started",{success:e.success!==!1,error:e.error}),e.success!==!1&&this.triggerEvent("monitoring-status",g({running:!0},e))),t==="stop-monitoring"&&(this.triggerEvent("monitoring-stopped",{success:e.success!==!1,error:e.error}),e.success!==!1&&this.triggerEvent("monitoring-status",g({running:!1},e))),t==="get-monitoring-status"&&this.triggerEvent("monitoring-status",e),t==="one-click-start"&&this.triggerEvent("one-click-started",e),t==="one-click-stop"&&this.triggerEvent("one-click-stopped",e),t==="get-monitored-groups"&&this.triggerEvent("monitored-groups-updated",{groups:e.groups||e.data||e}),t==="add-group"&&this.triggerEvent("group-added",{success:e.success!==!1,group:e.group||e.data,error:e.error}),t==="remove-group"&&this.triggerEvent("group-removed",{success:e.success!==!1,groupId:e.groupId||e.group_id,error:e.error}),t==="join-group"&&this.triggerEvent("group-joined",{success:e.success!==!1,group:e.group,error:e.error}),t==="leave-group"&&this.triggerEvent("group-left",{success:e.success!==!1,groupId:e.groupId||e.group_id,error:e.error}),(t==="join-and-monitor-with-account"||t==="join-and-monitor-resource")&&this.triggerEvent("join-and-monitor-result",{success:e.success!==!1,group:e.group,error:e.error}),(t==="batch-join-and-monitor"||t==="batch-join-resources")&&this.triggerEvent("batch-join-result",{success:e.success!==!1,results:e.results||e.data,error:e.error}),t==="get-keyword-sets"&&this.triggerEvent("keyword-sets-updated",{keywordSets:e.keywordSets||e.data||e}),t==="add-keyword-set"&&this.triggerEvent("keyword-set-added",{success:e.success!==!1,setId:e.setId||e.id,keywordSet:e.keywordSet||e.data,error:e.error}),t==="add-keyword"&&this.triggerEvent("keyword-added",{success:e.success!==!1,setId:e.setId,keyword:e.keyword,error:e.error}),t==="remove-keyword"&&this.triggerEvent("keyword-removed",{success:e.success!==!1,setId:e.setId,keywordId:e.keywordId,error:e.error}),t==="get-queue-status"&&this.triggerEvent("queue-status",e),t==="get-queue-messages"&&this.triggerEvent("queue-messages",{messages:e.messages||e.data||e}),t==="clear-queue"&&this.triggerEvent("queue-cleared",{success:e.success!==!1,error:e.error}),t==="retry-message"&&this.triggerEvent("message-retried",{success:e.success!==!1,messageId:e.messageId,error:e.error}),t==="cancel-message"&&this.triggerEvent("message-cancelled",{success:e.success!==!1,messageId:e.messageId,error:e.error}),t==="pause-queue"&&this.triggerEvent("queue-paused",{success:e.success!==!1,phone:e.phone,error:e.error}),t==="resume-queue"&&this.triggerEvent("queue-resumed",{success:e.success!==!1,phone:e.phone,error:e.error}),(t==="send-message"||t==="send-group-message"||t==="schedule-message")&&this.triggerEvent("message-sent",{success:e.success!==!1,messageId:e.messageId||e.message_id,error:e.error}),(t==="get-leads"||t==="get-leads-paginated")&&this.triggerEvent("leads-updated",{leads:e.leads||e.data||e,total:e.total||e.leadsTotal,hasMore:e.hasMore||e.leadsHasMore}),t==="add-lead"&&this.triggerEvent("lead-added",{success:e.success!==!1,lead:e.lead||e.data,error:e.error}),t==="update-lead-status"&&this.triggerEvent("lead-status-updated",{success:e.success!==!1,leadId:e.leadId,newStatus:e.newStatus||e.status,error:e.error}),t==="delete-lead"&&this.triggerEvent("lead-deleted",{success:e.success!==!1,leadId:e.leadId,error:e.error}),t==="batch-delete-leads"&&this.triggerEvent("leads-batch-deleted",{success:e.success!==!1,count:e.count,error:e.error}),t==="batch-update-lead-status"&&this.triggerEvent("leads-status-batch-updated",{success:e.success!==!1,count:e.count,error:e.error}),t==="search-leads"&&this.triggerEvent("leads-search-result",{leads:e.leads||e.data||e,total:e.total}),t==="get-all-tags"&&this.triggerEvent("tags-updated",{tags:e.tags||e.data||e}),(t==="search-resources"||t==="search-jiso")&&this.triggerEvent("resources-search-result",{resources:e.resources||e.data||e,total:e.total,source:t==="search-jiso"?"jiso":"telegram"}),t==="get-resources"&&this.triggerEvent("resources-updated",{resources:e.resources||e.data||e}),t==="save-resource"&&this.triggerEvent("resource-saved",{success:e.success!==!1,resource:e.resource,error:e.error}),t==="unsave-resource"&&this.triggerEvent("resource-unsaved",{success:e.success!==!1,resourceId:e.resourceId,error:e.error}),t==="get-resource-stats"&&this.triggerEvent("resource-stats",e),(t==="clear-all-resources"||t==="clear-resources")&&this.triggerEvent("resources-cleared",{success:e.success!==!1,error:e.error}),(t==="extract-members"||t==="batch-extract-members")&&this.triggerEvent("members-extracted",{success:e.success!==!1,members:e.members||e.data,count:e.count,error:e.error}),t==="generate-ai-response"&&this.triggerEvent("ai-response-generated",{success:e.success!==!1,response:e.response||e.message,error:e.error}),t==="test-ai-connection"&&this.triggerEvent("ai-connection-tested",{success:e.success!==!1,provider:e.provider,error:e.error}),t==="get-ollama-models"&&this.triggerEvent("ollama-models",{models:e.models||e.data||e}),t==="search-rag"&&this.triggerEvent("rag-search-result",{results:e.results||e.data||e}),t==="get-rag-stats"&&this.triggerEvent("rag-stats",e),t==="search-vector-memories"&&this.triggerEvent("vector-memories-result",{memories:e.memories||e.data||e}),t==="get-memory-stats"&&this.triggerEvent("memory-stats",e),t==="get-ad-templates"&&this.triggerEvent("ad-templates-updated",{templates:e.templates||e.data||e}),t==="create-ad-template"&&this.triggerEvent("ad-template-created",{success:e.success!==!1,template:e.template||e.data,error:e.error}),t==="delete-ad-template"&&this.triggerEvent("ad-template-deleted",{success:e.success!==!1,templateId:e.templateId,error:e.error}),t==="get-ad-schedules"&&this.triggerEvent("ad-schedules-updated",{schedules:e.schedules||e.data||e}),t==="get-ad-send-logs"&&this.triggerEvent("ad-send-logs",{logs:e.logs||e.data||e}),t==="get-ad-overview-stats"&&this.triggerEvent("ad-overview-stats",e),t==="get-marketing-stats"&&this.triggerEvent("marketing-stats",e),t==="get-marketing-campaigns"&&this.triggerEvent("marketing-campaigns-updated",{campaigns:e.campaigns||e.data||e}),t==="create-marketing-campaign"&&this.triggerEvent("marketing-campaign-created",{success:e.success!==!1,campaign:e.campaign||e.data,error:e.error}),t==="start-marketing-campaign"&&this.triggerEvent("marketing-campaign-started",{success:e.success!==!1,campaignId:e.campaignId,error:e.error}),t==="get-settings"&&this.triggerEvent("settings-loaded",{settings:e.settings||e.data||e}),t==="save-settings"&&this.triggerEvent("settings-saved",{success:e.success!==!1,error:e.error}),(t==="save-ai-settings"||t==="update-ai-chat-settings")&&this.triggerEvent("ai-settings-saved",{success:e.success!==!1,error:e.error}),t==="list-backups"&&this.triggerEvent("backups-listed",{backups:e.backups||e.data||e}),t==="create-backup"&&this.triggerEvent("backup-created",{success:e.success!==!1,backup:e.backup||e.data,error:e.error}),t==="restore-backup"&&this.triggerEvent("backup-restored",{success:e.success!==!1,error:e.error}),t==="delete-backup"&&this.triggerEvent("backup-deleted",{success:e.success!==!1,error:e.error}),t==="import-session"&&this.triggerEvent("session-imported",{success:e.success!==!1,account:e.account,error:e.error}),t==="export-session"&&this.triggerEvent("session-exported",{success:e.success!==!1,path:e.path,error:e.error}),t==="get-logs"&&this.triggerEvent("logs-updated",{logs:e.logs||e.data||e}),t==="clear-logs"&&this.triggerEvent("logs-cleared",{success:e.success!==!1,error:e.error}),t==="get-alerts"&&this.triggerEvent("alerts-updated",{alerts:e.alerts||e.data||e}),(t==="acknowledge-alert"||t==="resolve-alert")&&this.triggerEvent("alert-updated",{success:e.success!==!1,alertId:e.alertId,error:e.error}),t==="get-api-credentials"&&this.triggerEvent("api-credentials-updated",{credentials:e.credentials||e.data||[]}),t==="add-api-credential"&&this.triggerEvent("api-credential-added",{success:e.success!==!1,credential:e.credential||e.data,error:e.error}),t==="remove-api-credential"&&this.triggerEvent("api-credential-removed",{success:e.success!==!1,credentialId:e.credentialId,error:e.error}),t==="get-system-status"&&this.triggerEvent("system-status",e),t==="get-initial-state"&&((e.accounts||e.settings)&&this.triggerEvent("initial-state-core",{accounts:e.accounts||[],settings:e.settings||{},isMonitoring:e.isMonitoring||!1}),(e.keywordSets||e.monitoredGroups||e.campaigns)&&this.triggerEvent("initial-state-config",{keywordSets:e.keywordSets||[],monitoredGroups:e.monitoredGroups||[],campaigns:e.campaigns||[],messageTemplates:e.messageTemplates||[],chatTemplates:e.chatTemplates||[],triggerRules:e.triggerRules||[]}),(e.leads||e.logs)&&this.triggerEvent("initial-state-data",{leads:e.leads||[],leadsTotal:e.leadsTotal||0,leadsHasMore:e.leadsHasMore||!1,logs:e.logs||[]}),this.triggerEvent("initial-state",e),e.accounts&&e.accounts.length>0&&this.triggerEvent("accounts-updated",e.accounts)),!this.isCommandHandled(t)){let n=t.replace(/-/g,"-")+"-result";this.triggerEvent(n,{success:e.success!==!1,data:e.data||e,error:e.error})}}isCommandHandled(t){return["login-account","add-account","get-accounts","update-account","update-account-data","delete-account","remove-account","connect-account","disconnect-account","logout-account","check-account-status","start-monitoring","stop-monitoring","get-monitoring-status","one-click-start","one-click-stop","get-monitored-groups","add-group","remove-group","join-group","leave-group","join-and-monitor-with-account","join-and-monitor-resource","batch-join-and-monitor","batch-join-resources","get-keyword-sets","add-keyword-set","add-keyword","remove-keyword","get-queue-status","get-queue-messages","clear-queue","retry-message","cancel-message","pause-queue","resume-queue","send-message","send-group-message","schedule-message","get-leads","get-leads-paginated","add-lead","update-lead-status","delete-lead","batch-delete-leads","batch-update-lead-status","search-leads","get-all-tags","search-resources","search-jiso","get-resources","save-resource","unsave-resource","get-resource-stats","clear-all-resources","clear-resources","extract-members","batch-extract-members","generate-ai-response","test-ai-connection","get-ollama-models","search-rag","get-rag-stats","search-vector-memories","get-memory-stats","get-ad-templates","create-ad-template","delete-ad-template","get-ad-schedules","get-ad-send-logs","get-ad-overview-stats","get-marketing-stats","get-marketing-campaigns","create-marketing-campaign","start-marketing-campaign","get-settings","save-settings","save-ai-settings","update-ai-chat-settings","list-backups","create-backup","restore-backup","delete-backup","import-session","export-session","get-logs","clear-logs","get-alerts","acknowledge-alert","resolve-alert","get-api-credentials","add-api-credential","remove-api-credential","get-system-status","get-initial-state"].includes(t)}triggerEvent(t,e){let n=this.webListeners.get(t);n&&n.size>0&&(console.log(`[Web Mode] Triggering event '${t}':`,e),this.ngZone.run(()=>{n.forEach(s=>{try{s(e)}catch(o){console.error(`[Web Mode] Listener error for ${t}:`,o)}})}))}on(t,e){if(this.isWebMode)return this.webListeners.has(t)||this.webListeners.set(t,new Set),this.webListeners.get(t).add(e),console.log(`[Web Mode] Added listener for '${t}'`),()=>{let a=this.webListeners.get(t);a&&(a.delete(e),console.log(`[Web Mode] Removed listener for '${t}'`))};if(!this.ipcRenderer)return()=>{};let n=(a,...i)=>{this.ngZone.run(()=>{e(...i)})},s={channel:t,originalListener:e,wrappedListener:n};this.listeners.push(s);let o=this.channelListeners.get(t)||[];return o.push(s),this.channelListeners.set(t,o),this.ipcRenderer.on(t,n),()=>{this.removeListener(t,e)}}once(t,e){if(this.isWebMode){let i=(...p)=>{this.webListeners.get(t)?.delete(i),e(...p)};return this.webListeners.has(t)||this.webListeners.set(t,new Set),this.webListeners.get(t).add(i),()=>{this.webListeners.get(t)?.delete(i)}}if(!this.ipcRenderer)return()=>{};let n=!1,s=(i,...p)=>{n||(n=!0,this.removeListenerByWrapped(t,s),this.ngZone.run(()=>{e(...p)}))},o={channel:t,originalListener:e,wrappedListener:s};this.listeners.push(o);let a=this.channelListeners.get(t)||[];return a.push(o),this.channelListeners.set(t,a),this.ipcRenderer.on(t,s),()=>{n||this.removeListenerByWrapped(t,s)}}invoke(t,...e){return this.isWebMode?this.httpInvoke(t,e[0]||{}):this.ipcRenderer?this.ipcRenderer.invoke(t,...e):(console.log(`[Browser Mode] IPC Invoke to '${t}':`,...e),Promise.resolve(null))}async httpInvoke(t,e){try{let n=`${this.apiBaseUrl}/api/command`,s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:t,payload:e})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return await s.json()}catch(n){return console.error(`[Web Mode] HTTP invoke error for '${t}':`,n),{success:!1,error:n.message}}}removeListener(t,e){if(this.isWebMode){this.webListeners.get(t)?.delete(e);return}if(!this.ipcRenderer)return;let n=this.channelListeners.get(t);if(!n)return;let s=n.findIndex(o=>o.originalListener===e);if(s!==-1){let o=n[s];this.ipcRenderer.removeListener(t,o.wrappedListener),n.splice(s,1);let a=this.listeners.findIndex(i=>i===o);a!==-1&&this.listeners.splice(a,1)}}removeListenerByWrapped(t,e){if(!this.ipcRenderer)return;this.ipcRenderer.removeListener(t,e);let n=this.channelListeners.get(t);if(n){let s=n.findIndex(o=>o.wrappedListener===e);if(s!==-1){let o=n[s];n.splice(s,1);let a=this.listeners.findIndex(i=>i===o);a!==-1&&this.listeners.splice(a,1)}}}cleanup(t){if(this.isWebMode){this.webListeners.delete(t);return}if(!this.ipcRenderer)return;this.ipcRenderer.removeAllListeners(t);let e=this.channelListeners.get(t);e&&(e.forEach(n=>{let s=this.listeners.findIndex(o=>o===n);s!==-1&&this.listeners.splice(s,1)}),this.channelListeners.delete(t))}cleanupAll(){if(this.isWebMode){this.webListeners.clear();return}if(!this.ipcRenderer)return;new Set(this.listeners.map(e=>e.channel)).forEach(e=>{this.ipcRenderer.removeAllListeners(e)}),this.listeners=[],this.channelListeners.clear(),console.log("[IPC] All listeners cleaned up")}off(t,e){this.cleanup(t)}getListenerCount(t){if(this.isWebMode){if(t)return this.webListeners.get(t)?.size||0;let e=0;return this.webListeners.forEach(n=>e+=n.size),e}return t?this.channelListeners.get(t)?.length||0:this.listeners.length}getActiveChannels(){return this.isWebMode?Array.from(this.webListeners.keys()):Array.from(this.channelListeners.keys())}async selectFileForAttachment(t,e=!1){return this.isWebMode?(console.warn("[Web Mode] selectFileForAttachment - using browser file picker"),{success:!1,canceled:!0}):this.ipcRenderer?this.invoke("select-file-for-attachment",{type:t,multiple:e}):(console.warn("[Browser Mode] selectFileForAttachment not available"),{success:!1,canceled:!0})}static{this.\u0275fac=function(e){return new(e||m)(u(l))}}static{this.\u0275prov=h({token:m,factory:m.\u0275fac,providedIn:"root"})}};export{f as a};
