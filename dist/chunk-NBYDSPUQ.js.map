{
  "version": 3,
  "sources": ["src/i18n.service.ts"],
  "sourcesContent": ["/**\n * Internationalization (i18n) Service\n * åœ‹éš›åŒ–æœå‹™ - å¤šèªè¨€æ”¯æŒ\n * \n * å„ªåŒ–ç‰ˆæœ¬ï¼šç¿»è­¯å·²ç§»è‡³ JSON æ–‡ä»¶\n * - src/assets/i18n/en.json\n * - src/assets/i18n/zh-CN.json\n * - src/assets/i18n/zh-TW.json\n */\nimport { Injectable, signal, computed, effect } from '@angular/core';\n\nexport type SupportedLocale = 'en' | 'zh-CN' | 'zh-TW';\n\nexport interface LocaleInfo {\n  code: SupportedLocale;\n  name: string;\n  nativeName: string;\n  flag: string;\n}\n\nexport const SUPPORTED_LOCALES: LocaleInfo[] = [\n  { code: 'en', name: 'English', nativeName: 'English', flag: 'ğŸ‡ºğŸ‡¸' },\n  { code: 'zh-CN', name: 'Simplified Chinese', nativeName: 'ç®€ä½“ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' },\n  { code: 'zh-TW', name: 'Traditional Chinese', nativeName: 'ç¹é«”ä¸­æ–‡', flag: 'ğŸ‡¹ğŸ‡¼' }\n];\n\ntype TranslationKey = string;\ntype TranslationValue = string | Record<string, any>;\ntype Translations = Record<TranslationKey, TranslationValue>;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class I18nService {\n  // ç•¶å‰èªè¨€\n  private _locale = signal<SupportedLocale>('zh-TW');\n  locale = this._locale.asReadonly();\n  \n  // èªè¨€åŒ…ç·©å­˜\n  private translations = signal<Record<SupportedLocale, Translations>>({\n    'en': {},\n    'zh-CN': {},\n    'zh-TW': {}\n  });\n  \n  // åŠ è¼‰ç‹€æ…‹\n  private _loading = signal(false);\n  loading = this._loading.asReadonly();\n  \n  // è¨ˆç®—å±¬æ€§\n  currentLocaleInfo = computed(() => \n    SUPPORTED_LOCALES.find(l => l.code === this._locale()) || SUPPORTED_LOCALES[2]\n  );\n  \n  supportedLocales = SUPPORTED_LOCALES;\n  \n  constructor() {\n    this.initLocale();\n    this.loadTranslations();\n    \n    // ç›£è½èªè¨€è®ŠåŒ–ï¼Œè‡ªå‹•ä¿å­˜\n    effect(() => {\n      const locale = this._locale();\n      localStorage.setItem('tg-matrix-locale', locale);\n      document.documentElement.lang = locale;\n    });\n  }\n  \n  /**\n   * åˆå§‹åŒ–èªè¨€è¨­ç½®\n   * ğŸ”§ å„ªåŒ–ï¼šé»˜èªä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼Œå› ç‚ºä¸»è¦ç”¨æˆ¶ç¾¤é«”æ˜¯ä¸­æ–‡ç”¨æˆ¶\n   */\n  private initLocale(): void {\n    // å„ªå…ˆå¾æœ¬åœ°å­˜å„²è®€å–\n    const stored = localStorage.getItem('tg-matrix-locale') as SupportedLocale;\n    if (stored && SUPPORTED_LOCALES.some(l => l.code === stored)) {\n      this._locale.set(stored);\n      return;\n    }\n    \n    // è‡ªå‹•æª¢æ¸¬ç€è¦½å™¨èªè¨€\n    const browserLang = navigator.language;\n    if (browserLang.startsWith('en')) {\n      // åªæœ‰æ˜ç¢ºæ˜¯è‹±æ–‡æ‰ä½¿ç”¨è‹±æ–‡\n      this._locale.set('en');\n    } else if (browserLang === 'zh-CN' || browserLang === 'zh-Hans') {\n      // ç°¡é«”ä¸­æ–‡\n      this._locale.set('zh-CN');\n    } else {\n      // ğŸ”§ å…¶ä»–æ‰€æœ‰æƒ…æ³ï¼ˆåŒ…æ‹¬ç¹é«”ä¸­æ–‡ã€æœªçŸ¥èªè¨€ï¼‰é»˜èªä½¿ç”¨ç¹é«”ä¸­æ–‡\n      this._locale.set('zh-TW');\n    }\n  }\n  \n  /**\n   * åŠ è¼‰èªè¨€åŒ… - å¾ JSON æ–‡ä»¶åŠ è¼‰\n   */\n  private async loadTranslations(): Promise<void> {\n    this._loading.set(true);\n    \n    try {\n      const locales: SupportedLocale[] = ['en', 'zh-CN', 'zh-TW'];\n      const loaded: Record<SupportedLocale, Translations> = {\n        'en': {},\n        'zh-CN': {},\n        'zh-TW': {}\n      };\n      \n      // ä¸¦è¡ŒåŠ è¼‰æ‰€æœ‰èªè¨€åŒ…\n      await Promise.all(locales.map(async (locale) => {\n        try {\n          const response = await fetch(`/assets/i18n/${locale}.json`);\n          if (response.ok) {\n            loaded[locale] = await response.json();\n          } else {\n            console.warn(`Failed to load ${locale}.json: ${response.status}`);\n            loaded[locale] = this.getFallbackTranslations(locale);\n          }\n        } catch (e) {\n          console.warn(`Error loading ${locale}.json:`, e);\n          loaded[locale] = this.getFallbackTranslations(locale);\n        }\n      }));\n      \n      this.translations.set(loaded);\n    } catch (e) {\n      console.error('Failed to load translations:', e);\n    } finally {\n      this._loading.set(false);\n    }\n  }\n  \n  /**\n   * åˆ‡æ›èªè¨€\n   */\n  setLocale(locale: SupportedLocale): void {\n    if (SUPPORTED_LOCALES.some(l => l.code === locale)) {\n      this._locale.set(locale);\n    }\n  }\n  \n  /**\n   * ç¿»è­¯æ–‡æœ¬\n   * @param key ç¿»è­¯éµï¼Œæ”¯æŒé»è™Ÿåˆ†éš”çš„åµŒå¥—éµ (å¦‚ 'menu.dashboard')\n   * @param params æ’å€¼åƒæ•¸\n   */\n  t(key: string, params?: Record<string, string | number>): string {\n    const locale = this._locale();\n    const allTranslations = this.translations();\n    const localeTranslations = allTranslations[locale] || {};\n    \n    let value: any;\n    \n    // 1. å˜—è©¦åµŒå¥—éµï¼ˆå¦‚ 'menu.dashboard'ï¼‰\n    value = this.getNestedValue(localeTranslations, key);\n    if (typeof value === 'string') {\n      return this.interpolate(value, params);\n    }\n    \n    // 2. å˜—è©¦æ‰å¹³éµæ˜ å°„ï¼ˆèˆŠä»£ç¢¼å…¼å®¹ï¼‰\n    const flatKey = this.getFlatKeyMapping(key);\n    if (flatKey) {\n      value = this.getNestedValue(localeTranslations, flatKey);\n      if (typeof value === 'string') {\n        return this.interpolate(value, params);\n      }\n    }\n    \n    // 3. å¾ç¹é«”ä¸­æ–‡å›é€€\n    if (locale !== 'zh-TW') {\n      value = this.getNestedValue(allTranslations['zh-TW'], key);\n      if (typeof value === 'string') {\n        return this.interpolate(value, params);\n      }\n      \n      if (flatKey) {\n        value = this.getNestedValue(allTranslations['zh-TW'], flatKey);\n        if (typeof value === 'string') {\n          return this.interpolate(value, params);\n        }\n      }\n    }\n    \n    // 4. è¿”å›éµå\n    return key;\n  }\n  \n  /**\n   * åƒæ•¸æ’å€¼\n   */\n  private interpolate(value: string, params?: Record<string, string | number>): string {\n    if (!params) return value;\n    let result = value;\n    Object.entries(params).forEach(([k, v]) => {\n      result = result.replace(new RegExp(`{{${k}}}`, 'g'), String(v));\n    });\n    return result;\n  }\n  \n  /**\n   * èˆŠæ‰å¹³éµåˆ°æ–°åµŒå¥—éµçš„æ˜ å°„ï¼ˆå‘ä¸‹å…¼å®¹ï¼‰\n   */\n  private getFlatKeyMapping(flatKey: string): string | undefined {\n    const mapping: Record<string, string> = {\n      // èœå–®é …\n      'dashboard': 'menu.dashboard',\n      'accounts': 'menu.accounts',\n      'automation': 'menu.automation',\n      'leads': 'menu.leads',\n      'analytics': 'menu.analytics',\n      'logs': 'menu.logs',\n      'performance': 'menu.performance',\n      'alerts': 'menu.alerts',\n      'settings': 'menu.settings',\n      'aiCenter': 'menu.aiCenter',\n      'resourceDiscoveryMenu': 'menu.resourceDiscovery',\n      'monitoringCenter': 'menu.monitoringCenter',\n      'resourceManagement': 'menu.resourceManagement',\n      'marketingAutomation': 'menu.marketingAutomation',\n      'aiIntelligence': 'menu.aiIntelligence',\n      'systemMonitor': 'menu.systemMonitor',\n      // é€šç”¨\n      'save': 'common.save',\n      'cancel': 'common.cancel',\n      'delete': 'common.delete',\n      'edit': 'common.edit',\n      'add': 'common.add',\n      'close': 'common.close',\n      'confirm': 'common.confirm',\n      'search': 'common.search',\n      'loading': 'common.loading',\n      'success': 'common.success',\n      'error': 'common.error',\n      'warning': 'common.warning',\n      'refresh': 'common.refresh',\n      'start': 'common.start',\n      'stop': 'common.stop',\n      'active': 'common.active',\n      'inactive': 'common.inactive',\n      // å„€è¡¨æ¿\n      'totalAccounts': 'dashboard.totalAccounts',\n      'onlineAccounts': 'dashboard.onlineAccounts',\n      'leadsToday': 'dashboard.leadsToday',\n      'messagesSentToday': 'dashboard.messagesSentToday',\n      'systemControl': 'dashboard.systemControl',\n      'monitoringStatus': 'dashboard.monitoringStatus',\n      'recentLogs': 'dashboard.recentLogs',\n      'recentLeads': 'dashboard.recentLeads',\n      // å¸³è™Ÿ\n      'addNewAccount': 'accounts.addNewAccount',\n      'phoneNumber': 'accounts.phoneNumber',\n      'apiId': 'accounts.apiId',\n      'apiHash': 'accounts.apiHash',\n      'proxy': 'accounts.proxy',\n      'login': 'accounts.login',\n      'importSession': 'accounts.importSession',\n      'exportSession': 'accounts.exportSession',\n      'health': 'accounts.health',\n      'group': 'accounts.group',\n      'role': 'accounts.role',\n      // è¨­å®š\n      'appearance': 'settings.appearance',\n      'language': 'settings.language',\n      'light': 'settings.light',\n      'dark': 'settings.dark',\n      // ç‹€æ…‹\n      'Online': 'status.Online',\n      'Offline': 'status.Offline',\n      'Recently': 'status.Recently',\n      'Unknown': 'status.Unknown',\n      'Listener': 'status.Listener',\n      'Sender': 'status.Sender',\n      'Banned': 'status.Banned',\n      'Unassigned': 'status.Unassigned'\n    };\n    return mapping[flatKey];\n  }\n  \n  /**\n   * ç²å–åµŒå¥—å€¼\n   */\n  private getNestedValue(obj: any, key: string): any {\n    if (!key || typeof key !== 'string') return undefined;\n    return key.split('.').reduce((o, k) => o?.[k], obj);\n  }\n  \n  /**\n   * ç²å–å›é€€ç¿»è­¯ï¼ˆç•¶ JSON åŠ è¼‰å¤±æ•—æ™‚ä½¿ç”¨ï¼‰\n   */\n  private getFallbackTranslations(locale: SupportedLocale): Translations {\n    // æœ€å°åŒ–çš„å›é€€ç¿»è­¯\n    const fallbacks: Record<SupportedLocale, Translations> = {\n      'en': {\n        app: { title: 'TG-AIæ™ºæ§ç‹', subtitle: 'AI Smart Marketing System' },\n        common: { loading: 'Loading...', error: 'Error', success: 'Success' },\n        menu: { dashboard: 'Dashboard', accounts: 'Accounts', settings: 'Settings' }\n      },\n      'zh-CN': {\n        app: { title: 'TG-AIæ™ºæ§ç‹', subtitle: 'AI æ™ºèƒ½è¥é”€ç³»ç»Ÿ' },\n        common: { loading: 'åŠ è½½ä¸­...', error: 'é”™è¯¯', success: 'æˆåŠŸ' },\n        menu: { dashboard: 'ä»ªè¡¨ç›˜', accounts: 'è´¦å·ç®¡ç†', settings: 'è®¾ç½®' }\n      },\n      'zh-TW': {\n        app: { title: 'TG-AIæ™ºæ§ç‹', subtitle: 'AI æ™ºèƒ½è¡ŒéŠ·ç³»çµ±' },\n        common: { loading: 'è¼‰å…¥ä¸­...', error: 'éŒ¯èª¤', success: 'æˆåŠŸ' },\n        menu: { dashboard: 'å„€è¡¨æ¿', accounts: 'å¸³è™Ÿç®¡ç†', settings: 'è¨­å®š' }\n      }\n    };\n    return fallbacks[locale];\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
