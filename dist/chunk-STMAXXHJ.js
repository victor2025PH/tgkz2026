import {
  ConversationEngineService,
  DynamicScriptEngineService,
  IntentRecognitionService,
  MultiRoleService,
  ROLE_TYPE_META
} from "./chunk-UU2EWNBQ.js";
import {
  AutomationWorkflowService,
  MarketingAnalyticsService
} from "./chunk-UNP75L76.js";
import {
  AICenterService,
  GOAL_TYPE_CONFIG,
  MarketingTaskService
} from "./chunk-RUWU7PL6.js";
import {
  UnifiedContactsService
} from "./chunk-UTR72ISQ.js";
import {
  AccountManagementService
} from "./chunk-5TVIREIP.js";
import {
  NavBridgeService
} from "./chunk-6KLKCFSW.js";
import {
  ElectronIpcService
} from "./chunk-RRYKY32A.js";
import {
  I18nService
} from "./chunk-ZTUGHWSQ.js";
import {
  CheckboxControlValueAccessor,
  DefaultValueAccessor,
  FormsModule,
  MaxValidator,
  MinValidator,
  NgControlStatus,
  NgModel,
  NgSelectOption,
  NumberValueAccessor,
  RangeValueAccessor,
  SelectControlValueAccessor,
  …µNgSelectMultipleOption
} from "./chunk-AF6KAQ3H.js";
import {
  CommonModule,
  DatePipe,
  DecimalPipe,
  SlicePipe
} from "./chunk-BTHEVO76.js";
import {
  MembershipService,
  ToastService
} from "./chunk-ORLIRJMO.js";
import {
  ChangeDetectionStrategy,
  Component,
  HostListener,
  Injectable,
  Input,
  Output,
  ViewChild,
  __spreadProps,
  __spreadValues,
  computed,
  inject,
  input,
  output,
  setClassMetadata,
  signal,
  …µsetClassDebugInfo,
  …µ…µadvance,
  …µ…µattribute,
  …µ…µclassMap,
  …µ…µclassProp,
  …µ…µconditional,
  …µ…µconditionalCreate,
  …µ…µdefineComponent,
  …µ…µdefineInjectable,
  …µ…µdomElement,
  …µ…µdomElementEnd,
  …µ…µdomElementStart,
  …µ…µdomListener,
  …µ…µdomProperty,
  …µ…µelement,
  …µ…µelementEnd,
  …µ…µelementStart,
  …µ…µgetCurrentView,
  …µ…µinterpolate,
  …µ…µlistener,
  …µ…µloadQuery,
  …µ…µnamespaceHTML,
  …µ…µnamespaceSVG,
  …µ…µnextContext,
  …µ…µpipe,
  …µ…µpipeBind2,
  …µ…µpipeBind3,
  …µ…µproperty,
  …µ…µpureFunction0,
  …µ…µqueryRefresh,
  …µ…µrepeater,
  …µ…µrepeaterCreate,
  …µ…µrepeaterTrackByIdentity,
  …µ…µrepeaterTrackByIndex,
  …µ…µresetView,
  …µ…µresolveDocument,
  …µ…µrestoreView,
  …µ…µstyleProp,
  …µ…µtext,
  …µ…µtextInterpolate,
  …µ…µtextInterpolate1,
  …µ…µtextInterpolate2,
  …µ…µtextInterpolate4,
  …µ…µtextInterpolate6,
  …µ…µtwoWayBindingSet,
  …µ…µtwoWayListener,
  …µ…µtwoWayProperty,
  …µ…µviewQuery
} from "./chunk-K4KD4A2Z.js";

// src/multi-role/auto-group.service.ts
var AutoGroupService = class _AutoGroupService {
  constructor() {
    this.ipc = inject(ElectronIpcService);
    this.multiRoleService = inject(MultiRoleService);
    this.activeGroups = signal([], ...ngDevMode ? [{ debugName: "activeGroups" }] : []);
    this.pendingRequests = signal([], ...ngDevMode ? [{ debugName: "pendingRequests" }] : []);
    this.messageHistory = signal(/* @__PURE__ */ new Map(), ...ngDevMode ? [{ debugName: "messageHistory" }] : []);
    this.stats = signal({
      totalGroups: 0,
      activeGroups: 0,
      successfulConversions: 0,
      pendingRequests: 0
    }, ...ngDevMode ? [{ debugName: "stats" }] : []);
    this.groups = this.activeGroups.asReadonly();
    this.pending = this.pendingRequests.asReadonly();
    this.statistics = this.stats.asReadonly();
    this.initializeListeners();
    this.loadActiveGroups();
  }
  /**
   * ÂàùÂßãÂåñ IPC Áõ£ËÅΩ
   */
  initializeListeners() {
    this.ipc.on("multi-role-group-created", (data) => {
      this.handleGroupCreated(data);
    });
    this.ipc.on("multi-role-group-message", (data) => {
      this.handleGroupMessage(data);
    });
    this.ipc.on("multi-role-member-joined", (data) => {
      this.handleMemberJoined(data);
    });
    this.ipc.on("multi-role-member-left", (data) => {
      this.handleMemberLeft(data);
    });
  }
  /**
   * ËºâÂÖ•Ê¥ªË∫çÁæ§ÁµÑ
   */
  async loadActiveGroups() {
    try {
      const stored = localStorage.getItem("tg-matrix-multi-role-groups");
      if (stored) {
        const groups = JSON.parse(stored);
        this.activeGroups.set(groups);
        this.updateStats();
      }
    } catch (e) {
      console.error("Failed to load active groups:", e);
    }
  }
  /**
   * ‰øùÂ≠òÁæ§ÁµÑÊï∏Êìö
   */
  saveGroups() {
    try {
      localStorage.setItem("tg-matrix-multi-role-groups", JSON.stringify(this.activeGroups()));
    } catch (e) {
      console.error("Failed to save groups:", e);
    }
  }
  /**
   * ÂâµÂª∫Â§öËßíËâ≤Âçî‰ΩúÁæ§ÁµÑ
   */
  async createGroup(request) {
    try {
      if (!request.roleAccounts || request.roleAccounts.length === 0) {
        return { success: false, error: "\u672A\u914D\u7F6E\u89D2\u8272\u5E33\u865F" };
      }
      this.pendingRequests.update((reqs) => [...reqs, request]);
      this.updateStats();
      this.ipc.send("create-multi-role-group", {
        groupName: request.groupName,
        targetUserId: request.targetCustomer.id,
        targetUsername: request.targetCustomer.username,
        roleAccounts: request.roleAccounts,
        inviteMessage: request.inviteMessage || `\u60A8\u597D ${request.targetCustomer.firstName || ""}\uFF0C\u6211\u5011\u70BA\u60A8\u5275\u5EFA\u4E86\u5C08\u5C6C\u670D\u52D9\u7FA4\u7D44\uFF01`
      });
      return {
        success: true,
        groupId: `pending_${Date.now()}`
      };
    } catch (error) {
      console.error("Failed to create group:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "\u5EFA\u7FA4\u5931\u6557"
      };
    }
  }
  /**
   * ËôïÁêÜÁæ§ÁµÑÂâµÂª∫ÁµêÊûú
   */
  handleGroupCreated(data) {
    this.pendingRequests.update((reqs) => reqs.filter((r) => r.targetCustomer.id !== data.request.targetCustomer.id));
    if (data.success && data.groupId) {
      const newGroup = {
        id: data.groupId,
        targetCustomer: {
          id: data.request.targetCustomer.id,
          username: data.request.targetCustomer.username,
          firstName: data.request.targetCustomer.firstName,
          intentScore: data.request.intentScore || 0,
          source: data.request.sourceGroupId || "unknown"
        },
        groupTitle: data.request.groupName,
        telegramGroupId: data.telegramGroupId,
        participants: data.request.roleAccounts.map((ra) => ({
          roleId: ra.roleId,
          roleName: "",
          // TODO: ÂæûËßíËâ≤ÂàóË°®Áç≤Âèñ
          accountId: ra.accountId,
          accountPhone: ""
          // TODO: ÂæûÂ∏≥ËôüÂàóË°®Áç≤Âèñ
        })),
        scriptId: data.request.scriptId || "",
        scriptName: "",
        // TODO: ÂæûÂäáÊú¨ÂàóË°®Áç≤Âèñ
        status: "running",
        currentStageId: void 0,
        currentStageOrder: 0,
        messagesSent: 0,
        customerMessages: 0,
        outcome: "pending",
        createdAt: (/* @__PURE__ */ new Date()).toISOString()
      };
      this.activeGroups.update((groups) => [...groups, newGroup]);
      this.saveGroups();
      if (data.request.scriptId) {
        this.ipc.send("multi-role-start-script", {
          groupId: newGroup.id,
          scriptId: data.request.scriptId
        });
      }
    }
    this.updateStats();
  }
  /**
   * ËôïÁêÜÁæ§ÁµÑÊ∂àÊÅØ
   */
  handleGroupMessage(data) {
    const message = {
      id: `msg_${Date.now()}`,
      senderId: data.senderId,
      senderName: data.senderName,
      content: data.content,
      timestamp: /* @__PURE__ */ new Date(),
      isFromTarget: data.isFromTarget
    };
    this.messageHistory.update((history) => {
      const newHistory = new Map(history);
      const groupMessages = newHistory.get(data.groupId) || [];
      newHistory.set(data.groupId, [...groupMessages, message]);
      return newHistory;
    });
    if (data.isFromTarget) {
      this.activeGroups.update((groups) => groups.map((g) => g.id === data.groupId ? __spreadProps(__spreadValues({}, g), { customerMessages: g.customerMessages + 1, updatedAt: /* @__PURE__ */ new Date() }) : g));
    }
    if (data.isFromTarget) {
      this.handleCustomerMessage(data.groupId, message);
    }
  }
  /**
   * ËôïÁêÜÂÆ¢Êà∂Ê∂àÊÅØ
   */
  async handleCustomerMessage(groupId, message) {
    const group = this.activeGroups().find((g) => g.id === groupId);
    if (!group || group.status !== "running")
      return;
    if (group.scriptId) {
      const script = this.multiRoleService.scripts().find((s) => s.id === group.scriptId);
      const stageOrder = group.currentStageOrder || 0;
      if (script && script.stages[stageOrder]) {
        const currentStage = script.stages[stageOrder];
        if (currentStage.trigger?.type === "message") {
          this.ipc.send("multi-role-advance-stage", {
            groupId,
            nextStageOrder: stageOrder + 1
          });
        }
      }
    } else {
      this.ipc.send("multi-role-ai-reply", {
        groupId,
        message: message.content,
        customerId: group.targetCustomer.id
      });
    }
  }
  /**
   * ËôïÁêÜÊàêÂì°Âä†ÂÖ•
   */
  handleMemberJoined(data) {
    if (data.isTarget) {
      this.activeGroups.update((groups) => groups.map((g) => g.id === data.groupId ? __spreadProps(__spreadValues({}, g), { status: "running", updatedAt: /* @__PURE__ */ new Date() }) : g));
    }
  }
  /**
   * ËôïÁêÜÊàêÂì°Èõ¢Èñã
   */
  handleMemberLeft(data) {
    if (data.isTarget) {
      this.activeGroups.update((groups) => groups.map((g) => g.id === data.groupId ? __spreadProps(__spreadValues({}, g), { status: "failed", updatedAt: /* @__PURE__ */ new Date() }) : g));
      this.saveGroups();
    }
  }
  /**
   * ÁôºÈÄÅÊ∂àÊÅØÂà∞Áæ§ÁµÑ
   */
  async sendMessage(groupId, roleId, content) {
    const group = this.activeGroups().find((g) => g.id === groupId);
    if (!group)
      return false;
    const participant = group.participants?.find((p) => p.roleId === roleId);
    if (!participant)
      return false;
    this.ipc.send("multi-role-send-message", {
      groupId,
      telegramGroupId: group.telegramGroupId,
      accountId: participant.accountId,
      content
    });
    this.activeGroups.update((groups) => groups.map((g) => g.id === groupId ? __spreadProps(__spreadValues({}, g), { messagesSent: g.messagesSent + 1, updatedAt: /* @__PURE__ */ new Date() }) : g));
    return true;
  }
  /**
   * Ê®ôË®òÁæ§ÁµÑÁÇ∫ÊàêÂäüËΩâÂåñ
   */
  markAsConverted(groupId) {
    this.activeGroups.update((groups) => groups.map((g) => g.id === groupId ? __spreadProps(__spreadValues({}, g), { status: "completed", updatedAt: /* @__PURE__ */ new Date() }) : g));
    this.saveGroups();
    this.stats.update((s) => __spreadProps(__spreadValues({}, s), {
      successfulConversions: s.successfulConversions + 1
    }));
  }
  /**
   * Êö´ÂÅúÁæ§ÁµÑ
   */
  pauseGroup(groupId) {
    this.activeGroups.update((groups) => groups.map((g) => g.id === groupId ? __spreadProps(__spreadValues({}, g), { status: "paused", updatedAt: /* @__PURE__ */ new Date() }) : g));
    this.saveGroups();
  }
  /**
   * ÊÅ¢Âæ©Áæ§ÁµÑ
   */
  resumeGroup(groupId) {
    this.activeGroups.update((groups) => groups.map((g) => g.id === groupId ? __spreadProps(__spreadValues({}, g), { status: "running", updatedAt: /* @__PURE__ */ new Date() }) : g));
    this.saveGroups();
  }
  /**
   * ÈóúÈñâÁæ§ÁµÑ
   */
  closeGroup(groupId) {
    this.activeGroups.update((groups) => groups.map((g) => g.id === groupId ? __spreadProps(__spreadValues({}, g), { status: "completed", updatedAt: /* @__PURE__ */ new Date() }) : g));
    this.saveGroups();
    this.updateStats();
  }
  /**
   * Áç≤ÂèñÁæ§ÁµÑÊ∂àÊÅØÊ≠∑Âè≤
   */
  getMessages(groupId) {
    return this.messageHistory().get(groupId) || [];
  }
  /**
   * Áç≤ÂèñÁæ§ÁµÑË©≥ÊÉÖ
   */
  getGroup(groupId) {
    return this.activeGroups().find((g) => g.id === groupId);
  }
  /**
   * Êõ¥Êñ∞Áµ±Ë®à
   */
  updateStats() {
    const groups = this.activeGroups();
    this.stats.set({
      totalGroups: groups.length,
      activeGroups: groups.filter((g) => g.status === "running").length,
      successfulConversions: groups.filter((g) => g.status === "completed").length,
      pendingRequests: this.pendingRequests().length
    });
  }
  /**
   * Ê†πÊìöÊÑèÂêëË©ïÂàÜÊ±∫ÂÆöÊòØÂê¶Âª∫Áæ§
   */
  shouldCreateGroup(intentScore, config) {
    const minScore = config?.minScore || 50;
    return intentScore >= minScore;
  }
  /**
   * ÁîüÊàêÁæ§ÁµÑÂêçÁ®±
   */
  generateGroupName(customerName, template = "{\u5BA2\u6236\u540D}\u5C08\u5C6C\u670D\u52D9\u7FA4") {
    return template.replace("{\u5BA2\u6236\u540D}", customerName || "VIP\u5BA2\u6236");
  }
  static {
    this.\u0275fac = function AutoGroupService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AutoGroupService)();
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _AutoGroupService, factory: _AutoGroupService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AutoGroupService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [], null);
})();

// src/multi-role/collaboration-executor.service.ts
var CollaborationExecutorService = class _CollaborationExecutorService {
  constructor() {
    this.multiRoleService = inject(MultiRoleService);
    this.autoGroupService = inject(AutoGroupService);
    this.conversationEngine = inject(ConversationEngineService);
    this.intentService = inject(IntentRecognitionService);
    this.ipc = inject(ElectronIpcService);
    this.executionStates = signal(/* @__PURE__ */ new Map(), ...ngDevMode ? [{ debugName: "executionStates" }] : []);
    this.taskQueue = signal([], ...ngDevMode ? [{ debugName: "taskQueue" }] : []);
    this.stats = signal({
      totalExecutions: 0,
      successfulExecutions: 0,
      failedExecutions: 0,
      avgResponseTime: 0
    }, ...ngDevMode ? [{ debugName: "stats" }] : []);
    this.executionInterval = null;
    this.states = this.executionStates.asReadonly();
    this.queue = this.taskQueue.asReadonly();
    this.statistics = this.stats.asReadonly();
    this.startExecutionLoop();
    this.initializeListeners();
  }
  /**
   * ÂàùÂßãÂåñÁõ£ËÅΩÂô®
   */
  initializeListeners() {
    this.ipc.on("multi-role-customer-message", (data) => {
      this.handleCustomerMessage(data.groupId, data.message);
    });
    this.ipc.on("multi-role-message-sent", (data) => {
      this.handleMessageSent(data.taskId, data.success, data.error);
    });
  }
  /**
   * ÈñãÂßãÂü∑Ë°åÂæ™Áí∞
   */
  startExecutionLoop() {
    this.executionInterval = setInterval(() => {
      this.processTaskQueue();
    }, 1e3);
  }
  /**
   * ËôïÁêÜ‰ªªÂãôÈöäÂàó
   */
  async processTaskQueue() {
    const now = /* @__PURE__ */ new Date();
    const queue = this.taskQueue();
    const dueTasks = queue.filter((task) => task.status === "pending" && task.scheduledTime <= now);
    for (const task of dueTasks) {
      await this.executeTask(task);
    }
    this.taskQueue.update((q) => q.filter((t) => t.status !== "completed" && t.status !== "failed"));
  }
  /**
   * Âü∑Ë°åÂñÆÂÄã‰ªªÂãô
   */
  async executeTask(task) {
    this.updateTaskStatus(task.id, "executing");
    try {
      const startTime = Date.now();
      const success = await this.autoGroupService.sendMessage(task.groupId, task.roleId, task.content);
      if (success) {
        this.updateTaskStatus(task.id, "completed");
        const duration = Date.now() - startTime;
        this.stats.update((s) => ({
          totalExecutions: s.totalExecutions + 1,
          successfulExecutions: s.successfulExecutions + 1,
          failedExecutions: s.failedExecutions,
          avgResponseTime: (s.avgResponseTime * s.totalExecutions + duration) / (s.totalExecutions + 1)
        }));
        this.checkNextMessage(task.groupId);
      } else {
        throw new Error("\u6D88\u606F\u767C\u9001\u5931\u6557");
      }
    } catch (error) {
      this.updateTaskStatus(task.id, "failed", error instanceof Error ? error.message : "\u672A\u77E5\u932F\u8AA4");
      this.stats.update((s) => __spreadProps(__spreadValues({}, s), {
        totalExecutions: s.totalExecutions + 1,
        failedExecutions: s.failedExecutions + 1
      }));
    }
  }
  /**
   * ÈñãÂßãÂü∑Ë°åÂäáÊú¨
   */
  async startScriptExecution(groupId, scriptId) {
    const group = this.autoGroupService.getGroup(groupId);
    const script = this.multiRoleService.scripts().find((s) => s.id === scriptId);
    if (!group || !script) {
      console.error("Group or script not found");
      return;
    }
    const state = {
      groupId,
      isRunning: true,
      currentStage: 0,
      currentMessageIndex: 0,
      lastMessageTime: null,
      pendingTasks: [],
      completedTasks: []
    };
    this.executionStates.update((states) => {
      const newStates = new Map(states);
      newStates.set(groupId, state);
      return newStates;
    });
    await this.executeStage(groupId, script.stages[0]);
  }
  /**
   * Âü∑Ë°åÂäáÊú¨ÈöéÊÆµ
   */
  async executeStage(groupId, stage) {
    const state = this.executionStates().get(groupId);
    if (!state || !state.isRunning)
      return;
    if (stage.trigger?.type === "time" && stage.trigger.delaySeconds) {
      setTimeout(() => this.executeStageMessages(groupId, stage), stage.trigger.delaySeconds * 1e3);
    } else if (stage.trigger?.type === "message") {
    } else {
      await this.executeStageMessages(groupId, stage);
    }
  }
  /**
   * Âü∑Ë°åÈöéÊÆµÊ∂àÊÅØ
   */
  async executeStageMessages(groupId, stage) {
    const state = this.executionStates().get(groupId);
    if (!state || !state.isRunning)
      return;
    let cumulativeDelay = 0;
    for (let i = 0; i < stage.messages.length; i++) {
      const message = stage.messages[i];
      cumulativeDelay += message.timing.delayAfterPrevious || 0;
      if (message.timing.randomDelay) {
        const { min, max } = message.timing.randomDelay;
        cumulativeDelay += Math.floor(Math.random() * (max - min + 1)) + min;
      }
      let content;
      if (message.content.type === "ai_generate") {
        const group = this.autoGroupService.getGroup(groupId);
        const role = this.multiRoleService.roles().find((r) => r.id === message.roleId);
        if (group && role) {
          const replyResult = await this.conversationEngine.generateMultiRoleReply(message.content.aiPrompt || "", {
            roleId: role.id,
            roleName: role.name,
            rolePrompt: role.aiConfig.customPrompt,
            personality: role.personality.description
          }, {
            userId: group.targetCustomer.id,
            userName: group.targetCustomer.firstName || group.targetCustomer.username
          });
          content = replyResult.content;
        } else {
          content = message.content.text || "";
        }
      } else if (message.content.type === "template") {
        const group = this.autoGroupService.getGroup(groupId);
        content = this.processTemplate(message.content.text || "", group?.targetCustomer);
      } else {
        content = message.content.text || "";
      }
      const task = {
        id: `task_${Date.now()}_${i}`,
        groupId,
        type: "script_message",
        roleId: message.roleId,
        content,
        delay: cumulativeDelay,
        status: "pending",
        scheduledTime: new Date(Date.now() + cumulativeDelay * 1e3)
      };
      this.taskQueue.update((q) => [...q, task]);
    }
    this.executionStates.update((states) => {
      const newStates = new Map(states);
      const state2 = newStates.get(groupId);
      if (state2) {
        newStates.set(groupId, __spreadProps(__spreadValues({}, state2), {
          currentStage: state2.currentStage + 1
        }));
      }
      return newStates;
    });
  }
  /**
   * ËôïÁêÜÂÆ¢Êà∂Ê∂àÊÅØ
   */
  async handleCustomerMessage(groupId, message) {
    const group = this.autoGroupService.getGroup(groupId);
    if (!group || group.status !== "running")
      return;
    const state = this.executionStates().get(groupId);
    const intent = await this.intentService.recognizeIntent(message, group.targetCustomer.id, true);
    if (group.scriptId && state?.isRunning) {
      const script = this.multiRoleService.scripts().find((s) => s.id === group.scriptId);
      if (script && state.currentStage < script.stages.length) {
        const currentStage = script.stages[state.currentStage];
        if (currentStage.trigger?.type === "message") {
          await this.executeStage(groupId, currentStage);
        } else if (currentStage.trigger?.type === "keyword") {
          const hasKeyword = currentStage.trigger.keywords?.some((kw) => intent.keywords?.includes(kw));
          if (hasKeyword) {
            await this.executeStage(groupId, currentStage);
          }
        }
      }
    } else {
      await this.generateFreeReply(groupId, group, message, intent);
    }
  }
  /**
   * ÁîüÊàêËá™Áî±Â∞çË©±ÂõûË¶Ü
   */
  async generateFreeReply(groupId, group, customerMessage, intent) {
    const roles = this.multiRoleService.roles();
    const participant = group.participants?.[0];
    if (!participant)
      return;
    const role = roles.find((r) => r.id === participant.roleId);
    if (!role)
      return;
    const replyResult = await this.conversationEngine.generateMultiRoleReply(customerMessage, {
      roleId: role.id,
      roleName: role.name,
      rolePrompt: role.aiConfig.customPrompt,
      personality: role.personality.description
    }, {
      userId: group.targetCustomer.id,
      userName: group.targetCustomer.firstName || group.targetCustomer.username,
      sourceGroup: groupId
    });
    const task = {
      id: `task_${Date.now()}`,
      groupId,
      type: "ai_reply",
      roleId: role.id,
      content: replyResult.content,
      delay: replyResult.delay,
      status: "pending",
      scheduledTime: new Date(Date.now() + replyResult.delay * 1e3)
    };
    this.taskQueue.update((q) => [...q, task]);
    if (replyResult.shouldHandoff) {
      this.notifyHandoff(groupId, replyResult.handoffReason || "\u9700\u8981\u4EBA\u5DE5\u4ECB\u5165");
    }
  }
  /**
   * ËôïÁêÜÊ®°ÊùøËÆäÈáè
   */
  processTemplate(template, customer) {
    return template.replace(/{ÂÆ¢Êà∂Âêç}/g, customer?.firstName || customer?.username || "VIP\u5BA2\u6236").replace(/{Áî®Êà∂Âêç}/g, customer?.username || "\u7528\u6236").replace(/{ÂÆ¢Êà∂ID}/g, customer?.id || "");
  }
  /**
   * Êõ¥Êñ∞‰ªªÂãôÁãÄÊÖã
   */
  updateTaskStatus(taskId, status, error) {
    this.taskQueue.update((q) => q.map((t) => t.id === taskId ? __spreadProps(__spreadValues({}, t), { status, error }) : t));
  }
  /**
   * Ê™¢Êü•‰∏ã‰∏ÄÊ¢ùÊ∂àÊÅØ
   */
  checkNextMessage(groupId) {
    const state = this.executionStates().get(groupId);
    if (!state)
      return;
    this.executionStates.update((states) => {
      const newStates = new Map(states);
      const s = newStates.get(groupId);
      if (s) {
        newStates.set(groupId, __spreadProps(__spreadValues({}, s), {
          lastMessageTime: /* @__PURE__ */ new Date()
        }));
      }
      return newStates;
    });
  }
  /**
   * ËôïÁêÜÊ∂àÊÅØÁôºÈÄÅÁµêÊûú
   */
  handleMessageSent(taskId, success, error) {
    if (success) {
      this.updateTaskStatus(taskId, "completed");
    } else {
      this.updateTaskStatus(taskId, "failed", error);
    }
  }
  /**
   * ÈÄöÁü•ËΩâ‰∫∫Â∑•
   */
  notifyHandoff(groupId, reason) {
    this.ipc.send("multi-role-handoff", {
      groupId,
      reason,
      timestamp: (/* @__PURE__ */ new Date()).toISOString()
    });
    this.pauseExecution(groupId);
  }
  /**
   * Êö´ÂÅúÂü∑Ë°å
   */
  pauseExecution(groupId) {
    this.executionStates.update((states) => {
      const newStates = new Map(states);
      const state = newStates.get(groupId);
      if (state) {
        newStates.set(groupId, __spreadProps(__spreadValues({}, state), { isRunning: false }));
      }
      return newStates;
    });
  }
  /**
   * ÊÅ¢Âæ©Âü∑Ë°å
   */
  resumeExecution(groupId) {
    this.executionStates.update((states) => {
      const newStates = new Map(states);
      const state = newStates.get(groupId);
      if (state) {
        newStates.set(groupId, __spreadProps(__spreadValues({}, state), { isRunning: true }));
      }
      return newStates;
    });
  }
  /**
   * ÂÅúÊ≠¢Âü∑Ë°å
   */
  stopExecution(groupId) {
    this.taskQueue.update((q) => q.filter((t) => t.groupId !== groupId));
    this.executionStates.update((states) => {
      const newStates = new Map(states);
      newStates.delete(groupId);
      return newStates;
    });
  }
  /**
   * ÊâãÂãïÁôºÈÄÅÊ∂àÊÅØ
   */
  async sendManualMessage(groupId, roleId, content, delay = 0) {
    const task = {
      id: `task_${Date.now()}`,
      groupId,
      type: "scheduled",
      roleId,
      content,
      delay,
      status: "pending",
      scheduledTime: new Date(Date.now() + delay * 1e3)
    };
    this.taskQueue.update((q) => [...q, task]);
  }
  /**
   * Ê∏ÖÁêÜË≥áÊ∫ê
   */
  ngOnDestroy() {
    if (this.executionInterval) {
      clearInterval(this.executionInterval);
    }
  }
  static {
    this.\u0275fac = function CollaborationExecutorService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _CollaborationExecutorService)();
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _CollaborationExecutorService, factory: _CollaborationExecutorService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(CollaborationExecutorService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [], null);
})();

// src/multi-role/collaboration-orchestrator.service.ts
var CollaborationOrchestratorService = class _CollaborationOrchestratorService {
  constructor() {
    this.ipc = inject(ElectronIpcService);
    this.toast = inject(ToastService);
    this.analytics = inject(MarketingAnalyticsService);
    this._sessions = signal(/* @__PURE__ */ new Map(), ...ngDevMode ? [{ debugName: "_sessions" }] : []);
    this.sessions = computed(() => Array.from(this._sessions().values()), ...ngDevMode ? [{ debugName: "sessions" }] : []);
    this.stageConfigs = /* @__PURE__ */ new Map([
      ["opening", {
        stage: "opening",
        primaryRole: "consultant",
        supportRoles: [],
        objectives: ["\u5F15\u8D77\u6CE8\u610F", "\u5EFA\u7ACB\u521D\u6B65\u806F\u7E6B"],
        transitionSignals: ["\u7528\u6236\u56DE\u8986", "\u7528\u6236\u8868\u9054\u8208\u8DA3"],
        suggestedMessages: []
      }],
      ["building_trust", {
        stage: "building_trust",
        primaryRole: "consultant",
        supportRoles: ["oldcustomer"],
        objectives: ["\u5EFA\u7ACB\u4FE1\u4EFB", "\u5206\u4EAB\u6210\u529F\u6848\u4F8B"],
        transitionSignals: ["\u7528\u6236\u8A62\u554F\u7D30\u7BC0", "\u7528\u6236\u8868\u9054\u9867\u616E"],
        suggestedMessages: []
      }],
      ["discovering_needs", {
        stage: "discovering_needs",
        primaryRole: "consultant",
        supportRoles: ["expert"],
        objectives: ["\u4E86\u89E3\u7528\u6236\u9700\u6C42", "\u6316\u6398\u75DB\u9EDE"],
        transitionSignals: ["\u7528\u6236\u8AAA\u660E\u9700\u6C42", "\u7528\u6236\u63D0\u51FA\u554F\u984C"],
        suggestedMessages: []
      }],
      ["presenting_value", {
        stage: "presenting_value",
        primaryRole: "expert",
        supportRoles: ["consultant", "oldcustomer"],
        objectives: ["\u5C55\u793A\u7522\u54C1\u50F9\u503C", "\u5339\u914D\u7528\u6236\u9700\u6C42"],
        transitionSignals: ["\u7528\u6236\u8A8D\u53EF\u50F9\u503C", "\u7528\u6236\u8A62\u554F\u50F9\u683C"],
        suggestedMessages: []
      }],
      ["handling_objections", {
        stage: "handling_objections",
        primaryRole: "consultant",
        supportRoles: ["manager", "oldcustomer"],
        objectives: ["\u8655\u7406\u7528\u6236\u7591\u616E", "\u89E3\u6C7A\u9867\u616E"],
        transitionSignals: ["\u7528\u6236\u7591\u616E\u6D88\u9664", "\u7528\u6236\u9858\u610F\u5617\u8A66"],
        suggestedMessages: []
      }],
      ["closing", {
        stage: "closing",
        primaryRole: "consultant",
        supportRoles: ["manager"],
        objectives: ["\u4FC3\u6210\u6210\u4EA4", "\u5F15\u5C0E\u4E0B\u55AE"],
        transitionSignals: ["\u7528\u6236\u540C\u610F\u8CFC\u8CB7", "\u7528\u6236\u63D0\u4F9B\u4FE1\u606F"],
        suggestedMessages: []
      }],
      ["follow_up", {
        stage: "follow_up",
        primaryRole: "support",
        supportRoles: ["consultant"],
        objectives: ["\u552E\u5F8C\u670D\u52D9", "\u5EFA\u7ACB\u9577\u671F\u95DC\u4FC2"],
        transitionSignals: [],
        suggestedMessages: []
      }]
    ]);
    this.roleInteractions = [
      {
        type: "agree",
        triggerCondition: "after_main_role_speaks",
        probability: 0.6,
        templates: [
          "\u5C0D\uFF0C{\u4E3B\u89D2\u8272}\u8AAA\u5F97\u5C0D",
          "\u6C92\u932F\uFF0C\u6211\u4E5F\u9019\u9EBC\u89BA\u5F97",
          "\u662F\u7684\uFF0C\u9019\u9EDE\u5F88\u91CD\u8981"
        ]
      },
      {
        type: "share_experience",
        triggerCondition: "user_shows_doubt",
        probability: 0.8,
        templates: [
          "\u6211\u4E4B\u524D\u4E5F\u6709\u9019\u500B\u9867\u616E\uFF0C\u5F8C\u4F86\u7528\u4E86\u4E4B\u5F8C\u767C\u73FE\u5B8C\u5168\u6C92\u554F\u984C",
          "\u8AAA\u5BE6\u8A71\u4E00\u958B\u59CB\u6211\u4E5F\u7336\u8C6B\uFF0C\u4F46\u7528\u4E86\u5E7E\u500B\u6708\u771F\u7684\u5F88\u7A69",
          "\u6211\u670B\u53CB\u4ECB\u7D39\u6211\u7684\u6642\u5019\u6211\u4E5F\u4E0D\u592A\u4FE1\uFF0C\u73FE\u5728\u81EA\u5DF1\u4E5F\u5728\u63A8\u85A6\u5225\u4EBA"
        ]
      },
      {
        type: "hype",
        triggerCondition: "user_silent_too_long",
        probability: 0.5,
        templates: [
          "\u6700\u8FD1\u6D3B\u52D5\u529B\u5EA6\u633A\u5927\u7684",
          "\u807D\u8AAA\u4E0B\u9031\u5C31\u6062\u5FA9\u539F\u50F9\u4E86",
          "\u4ECA\u5929\u8AEE\u8A62\u7684\u4EBA\u633A\u591A\u7684"
        ]
      },
      {
        type: "complement",
        triggerCondition: "user_asks_technical",
        probability: 0.9,
        templates: [
          "\u9019\u500B\u6211\u4F86\u88DC\u5145\u4E00\u4E0B...",
          "\u6280\u8853\u65B9\u9762\u6211\u6BD4\u8F03\u4E86\u89E3\uFF0C{\u554F\u984C}\u662F\u9019\u6A23\u7684...",
          "\u95DC\u65BC\u9019\u500B\u554F\u984C\uFF0C\u6211\u53EF\u4EE5\u89E3\u91CB\u4E00\u4E0B..."
        ]
      }
    ];
    this.defaultRhythm = {
      minIntervalSeconds: 15,
      maxIntervalSeconds: 45,
      waitForUserReply: true,
      userSilenceTimeoutSeconds: 180,
      // 3ÂàÜÈêòÁÑ°ÂõûË¶ÜÂâáËßíËâ≤‰∫íÂãï
      roleRotationStrategy: "contextual"
    };
    this.initializeListeners();
  }
  /**
   * ÂàùÂßãÂåñÁõ£ËÅΩÂô®
   */
  initializeListeners() {
    this.ipc.on("collaboration:user-message", (data) => {
      this.handleUserMessage(data.sessionId, data.message);
    });
    this.ipc.on("collaboration:message-sent", (data) => {
      if (data.success) {
        this.updateLastMessageTime(data.sessionId);
      }
    });
  }
  /**
   * üÜï ÂâµÂª∫Âçî‰ΩúÊúÉË©±
   */
  createSession(config) {
    const sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    const sortedRoles = [...config.roles].sort((a, b) => a.entryOrder - b.entryOrder);
    const session = {
      id: sessionId,
      groupId: config.groupId,
      targetUserId: config.targetUserId,
      targetUserName: config.targetUserName,
      status: "initializing",
      roles: sortedRoles,
      rhythm: __spreadValues(__spreadValues({}, this.defaultRhythm), config.rhythm),
      currentStage: "opening",
      currentSpeaker: null,
      lastMessageTime: null,
      messageCount: 0,
      userResponseCount: 0,
      conversationHistory: [],
      stageHistory: [{ stage: "opening", enteredAt: /* @__PURE__ */ new Date() }],
      interestScore: 50,
      // ÂàùÂßã‰∏≠Á≠âËààË∂£
      createdAt: /* @__PURE__ */ new Date(),
      updatedAt: /* @__PURE__ */ new Date()
    };
    this._sessions.update((sessions) => {
      const newSessions = new Map(sessions);
      newSessions.set(sessionId, session);
      return newSessions;
    });
    console.log(`[Orchestrator] \u5275\u5EFA\u5354\u4F5C\u6703\u8A71: ${sessionId}, \u89D2\u8272\u6578: ${sortedRoles.length}`);
    return session;
  }
  /**
   * üÜï ÈñãÂßãÂçî‰ΩúÊµÅÁ®ã
   */
  async startCollaboration(sessionId) {
    const session = this._sessions().get(sessionId);
    if (!session) {
      this.toast.error("\u6703\u8A71\u4E0D\u5B58\u5728");
      return false;
    }
    this.updateSession(sessionId, { status: "active" });
    await this.executeRoleEntry(session);
    return true;
  }
  /**
   * üÜï Âü∑Ë°åËßíËâ≤ÊúâÂ∫èÂÖ•Â†¥
   */
  async executeRoleEntry(session) {
    console.log(`[Orchestrator] \u958B\u59CB\u89D2\u8272\u5165\u5834: ${session.roles.length} \u500B\u89D2\u8272`);
    for (const role of session.roles) {
      if (role.entryDelaySeconds > 0) {
        console.log(`[Orchestrator] ${role.roleName} \u7B49\u5F85 ${role.entryDelaySeconds} \u79D2\u5F8C\u5165\u5834`);
        await this.delay(role.entryDelaySeconds * 1e3);
      }
      const currentSession = this._sessions().get(session.id);
      if (!currentSession || currentSession.status !== "active") {
        console.log(`[Orchestrator] \u6703\u8A71\u5DF2\u505C\u6B62\uFF0C\u4E2D\u65B7\u5165\u5834`);
        break;
      }
      if (role.openingMessage) {
        await this.sendRoleMessage(session.id, role.roleId, role.openingMessage);
      } else {
        const openingMessage = this.generateOpeningMessage(role, session);
        await this.sendRoleMessage(session.id, role.roleId, openingMessage);
      }
      this.updateSession(session.id, { currentSpeaker: role.roleId });
      console.log(`[Orchestrator] ${role.roleName} \u5DF2\u5165\u5834`);
    }
    this.startRhythmControl(session.id);
  }
  /**
   * üÜï ÁîüÊàêÈñãÂ†¥ÁôΩ
   */
  generateOpeningMessage(role, session) {
    const templates = {
      opener: [
        `\u60A8\u597D ${session.targetUserName}\uFF01\u6211\u662F{\u89D2\u8272\u540D}\uFF0C\u5F88\u9AD8\u8208\u8A8D\u8B58\u60A8`,
        `Hi ${session.targetUserName}\uFF0C\u6211\u662F\u8CA0\u8CAC{\u89D2\u8272\u8077\u8CAC}\u7684{\u89D2\u8272\u540D}`,
        `${session.targetUserName} \u60A8\u597D\uFF01\u6B61\u8FCE\u52A0\u5165\uFF0C\u6211\u662F{\u89D2\u8272\u540D}`
      ],
      supporter: [
        `\u5927\u5BB6\u597D\uFF0C\u6211\u662F{\u89D2\u8272\u540D}`,
        `{\u89D2\u8272\u540D}\u4F86\u4E86\uFF0C\u6709\u554F\u984C\u53EF\u4EE5\u554F\u6211`,
        `\u6211\u662F{\u89D2\u8272\u540D}\uFF0C\u5F88\u9AD8\u8208\u80FD\u5E6B\u5230\u5927\u5BB6`
      ],
      atmosphere: [
        `\u54C8\u56C9~`,
        `\u4F86\u4E86\u4F86\u4E86`,
        `\u7D42\u65BC\u627E\u5230\u7D44\u7E54\u4E86`
      ],
      closer: [
        `\u60A8\u597D\uFF0C\u6211\u662F{\u89D2\u8272\u540D}\uFF0C\u8CA0\u8CAC\u70BA\u60A8\u8655\u7406\u5F8C\u7E8C\u4E8B\u5B9C`,
        `\u9700\u8981\u4EFB\u4F55\u5E6B\u52A9\u96A8\u6642\u627E\u6211`
      ]
    };
    const roleTemplates = templates[role.entryType] || templates.supporter;
    const template = roleTemplates[Math.floor(Math.random() * roleTemplates.length)];
    return template.replace("{\u89D2\u8272\u540D}", role.roleName).replace("{\u89D2\u8272\u8077\u8CAC}", this.getRolePurpose(role.roleId));
  }
  /**
   * Áç≤ÂèñËßíËâ≤ËÅ∑Ë≤¨ÊèèËø∞
   */
  getRolePurpose(roleId) {
    const purposes = {
      consultant: "\u696D\u52D9\u8AEE\u8A62",
      expert: "\u6280\u8853\u652F\u6301",
      oldcustomer: "\u5BA2\u6236\u670D\u52D9",
      support: "\u552E\u5F8C\u670D\u52D9",
      manager: "\u5BA2\u6236\u95DC\u4FC2",
      atmosphere: "\u793E\u7FA4\u4E92\u52D5"
    };
    return purposes[roleId] || "\u5BA2\u6236\u670D\u52D9";
  }
  /**
   * üÜï ÁôºÈÄÅËßíËâ≤Ê∂àÊÅØ
   */
  async sendRoleMessage(sessionId, roleId, content) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return;
    const role = session.roles.find((r) => r.roleId === roleId);
    if (!role)
      return;
    this.ipc.send("collaboration:send-message", {
      sessionId,
      groupId: session.groupId,
      targetUserId: session.targetUserId,
      accountPhone: role.accountPhone,
      content,
      roleId,
      roleName: role.roleName
    });
    this.updateSession(sessionId, {
      messageCount: session.messageCount + 1,
      lastMessageTime: /* @__PURE__ */ new Date(),
      conversationHistory: [
        ...session.conversationHistory,
        { role: role.roleName, content, timestamp: /* @__PURE__ */ new Date(), isUser: false }
      ]
    });
    console.log(`[Orchestrator] [${role.roleName}]: ${content.substring(0, 50)}...`);
  }
  /**
   * üÜï ÈñãÂßãÂ∞çË©±ÁØÄÂ•èÊéßÂà∂
   */
  startRhythmControl(sessionId) {
    const checkInterval = setInterval(() => {
      const session = this._sessions().get(sessionId);
      if (!session || session.status !== "active") {
        clearInterval(checkInterval);
        return;
      }
      this.checkAndTriggerRoleInteraction(session);
    }, 1e4);
    console.log(`[Orchestrator] \u5DF2\u555F\u52D5\u7BC0\u594F\u63A7\u5236: ${sessionId}`);
  }
  /**
   * üÜï Ê™¢Êü•‰∏¶Ëß∏ÁôºËßíËâ≤‰∫íÂãï
   */
  async checkAndTriggerRoleInteraction(session) {
    if (!session.lastMessageTime)
      return;
    const silenceSeconds = (Date.now() - session.lastMessageTime.getTime()) / 1e3;
    if (silenceSeconds > session.rhythm.userSilenceTimeoutSeconds) {
      console.log(`[Orchestrator] \u7528\u6236\u6C89\u9ED8 ${silenceSeconds.toFixed(0)} \u79D2\uFF0C\u89F8\u767C\u89D2\u8272\u4E92\u52D5`);
      const supportRole = this.selectSupportRole(session);
      if (supportRole) {
        const interaction = this.selectInteraction("user_silent_too_long");
        if (interaction) {
          const message = this.generateInteractionMessage(interaction, session);
          await this.sendRoleMessage(session.id, supportRole.roleId, message);
        }
      }
    }
  }
  /**
   * üÜï ËôïÁêÜÁî®Êà∂Ê∂àÊÅØ
   */
  handleUserMessage(sessionId, message) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return;
    console.log(`[Orchestrator] \u6536\u5230\u7528\u6236\u6D88\u606F: ${message.substring(0, 50)}...`);
    this.updateSession(sessionId, {
      userResponseCount: session.userResponseCount + 1,
      conversationHistory: [
        ...session.conversationHistory,
        { role: "user", content: message, timestamp: /* @__PURE__ */ new Date(), isUser: true }
      ]
    });
    const intent = this.analyzeUserIntent(message);
    const newInterestScore = this.calculateInterestScore(session, message);
    this.updateSession(sessionId, { interestScore: newInterestScore });
    this.checkStageTransition(sessionId, message, intent);
    const responder = this.selectResponder(session, intent);
    this.triggerAIResponse(sessionId, responder, message, intent);
  }
  /**
   * üÜï ÂàÜÊûêÁî®Êà∂ÊÑèÂúñ
   */
  analyzeUserIntent(message) {
    const lowerMsg = message.toLowerCase();
    if (lowerMsg.includes("\u50F9\u683C") || lowerMsg.includes("\u591A\u5C11\u9322") || lowerMsg.includes("\u8CBB\u7528")) {
      return "asking_price";
    }
    if (lowerMsg.includes("\u600E\u9EBC\u7528") || lowerMsg.includes("\u5982\u4F55") || lowerMsg.includes("\u6559\u7A0B")) {
      return "asking_usage";
    }
    if (lowerMsg.includes("\u5B89\u5168") || lowerMsg.includes("\u53EF\u9760") || lowerMsg.includes("\u64D4\u5FC3")) {
      return "expressing_concern";
    }
    if (lowerMsg.includes("\u597D\u7684") || lowerMsg.includes("\u53EF\u4EE5") || lowerMsg.includes("\u884C")) {
      return "positive_response";
    }
    if (lowerMsg.includes("\u4E0D") || lowerMsg.includes("\u7B97\u4E86") || lowerMsg.includes("\u518D\u8AAA")) {
      return "negative_response";
    }
    return "general_inquiry";
  }
  /**
   * üÜï Ë®àÁÆóËààË∂£Â∫¶
   */
  calculateInterestScore(session, message) {
    let score = session.interestScore;
    const lowerMsg = message.toLowerCase();
    if (lowerMsg.includes("\u6709\u8208\u8DA3") || lowerMsg.includes("\u60F3\u4E86\u89E3") || lowerMsg.includes("\u600E\u9EBC\u8CB7")) {
      score += 15;
    } else if (lowerMsg.includes("\u50F9\u683C") || lowerMsg.includes("\u591A\u5C11\u9322")) {
      score += 10;
    } else if (lowerMsg.includes("\u597D\u7684") || lowerMsg.includes("\u53EF\u4EE5")) {
      score += 5;
    } else if (lowerMsg.includes("\u4E0D\u9700\u8981") || lowerMsg.includes("\u7B97\u4E86")) {
      score -= 20;
    } else if (lowerMsg.includes("\u518D\u8003\u616E") || lowerMsg.includes("\u518D\u8AAA")) {
      score -= 10;
    } else {
      score += 2;
    }
    return Math.max(0, Math.min(100, score));
  }
  /**
   * üÜï Ê™¢Êü•ÈöéÊÆµËΩâÊèõ
   */
  checkStageTransition(sessionId, message, intent) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return;
    const currentStage = session.currentStage;
    let nextStage = null;
    switch (currentStage) {
      case "opening":
        if (intent !== "negative_response") {
          nextStage = "building_trust";
        }
        break;
      case "building_trust":
        if (intent === "asking_usage" || intent === "asking_price") {
          nextStage = "discovering_needs";
        }
        break;
      case "discovering_needs":
        if (session.messageCount >= 6) {
          nextStage = "presenting_value";
        }
        break;
      case "presenting_value":
        if (intent === "expressing_concern") {
          nextStage = "handling_objections";
        } else if (intent === "positive_response" || intent === "asking_price") {
          nextStage = "closing";
        }
        break;
      case "handling_objections":
        if (intent === "positive_response") {
          nextStage = "closing";
        }
        break;
      case "closing":
        if (intent === "positive_response") {
          nextStage = "follow_up";
        }
        break;
    }
    if (nextStage && nextStage !== currentStage) {
      this.transitionToStage(sessionId, nextStage);
    }
  }
  /**
   * üÜï ËΩâÊèõÂà∞Êñ∞ÈöéÊÆµ
   */
  transitionToStage(sessionId, newStage) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return;
    console.log(`[Orchestrator] \u968E\u6BB5\u8F49\u63DB: ${session.currentStage} \u2192 ${newStage}`);
    const now = /* @__PURE__ */ new Date();
    const lastStageEntry = session.stageHistory[session.stageHistory.length - 1];
    if (lastStageEntry) {
      lastStageEntry.duration = now.getTime() - new Date(lastStageEntry.enteredAt).getTime();
    }
    this.updateSession(sessionId, {
      currentStage: newStage,
      stageHistory: [
        ...session.stageHistory,
        { stage: newStage, enteredAt: now }
      ]
    });
    this.toast.info(`\u{1F3AF} \u9032\u5165${this.getStageName(newStage)}\u968E\u6BB5`);
  }
  /**
   * Áç≤ÂèñÈöéÊÆµÂêçÁ®±
   */
  getStageName(stage) {
    const names = {
      opening: "\u958B\u5834",
      building_trust: "\u5EFA\u7ACB\u4FE1\u4EFB",
      discovering_needs: "\u767C\u73FE\u9700\u6C42",
      presenting_value: "\u5C55\u793A\u50F9\u503C",
      handling_objections: "\u8655\u7406\u7570\u8B70",
      closing: "\u4FC3\u6210\u6210\u4EA4",
      follow_up: "\u8DDF\u9032\u670D\u52D9"
    };
    return names[stage];
  }
  /**
   * üÜï ÈÅ∏ÊìáÂõûË¶ÜËßíËâ≤
   */
  selectResponder(session, intent) {
    const stageConfig = this.stageConfigs.get(session.currentStage);
    if (intent === "asking_usage" || intent.includes("technical")) {
      const expert = session.roles.find((r) => r.roleId === "expert");
      if (expert)
        return expert;
    }
    if (intent === "expressing_concern") {
      const oldcustomer = session.roles.find((r) => r.roleId === "oldcustomer");
      if (oldcustomer)
        return oldcustomer;
    }
    if (stageConfig) {
      const primary = session.roles.find((r) => r.roleId === stageConfig.primaryRole);
      if (primary)
        return primary;
    }
    return session.roles[0];
  }
  /**
   * üÜï ÈÅ∏ÊìáËºîÂä©ËßíËâ≤
   */
  selectSupportRole(session) {
    const stageConfig = this.stageConfigs.get(session.currentStage);
    if (!stageConfig || stageConfig.supportRoles.length === 0) {
      return null;
    }
    const supportRoleId = stageConfig.supportRoles.find((id) => id !== session.currentSpeaker) || stageConfig.supportRoles[0];
    return session.roles.find((r) => r.roleId === supportRoleId) || null;
  }
  /**
   * üÜï ÈÅ∏Êìá‰∫íÂãïÈ°ûÂûã
   */
  selectInteraction(condition) {
    const matchingInteractions = this.roleInteractions.filter((i) => i.triggerCondition === condition);
    if (matchingInteractions.length === 0)
      return null;
    for (const interaction of matchingInteractions) {
      if (Math.random() < interaction.probability) {
        return interaction;
      }
    }
    return null;
  }
  /**
   * üÜï ÁîüÊàê‰∫íÂãïÊ∂àÊÅØ
   */
  generateInteractionMessage(interaction, session) {
    const template = interaction.templates[Math.floor(Math.random() * interaction.templates.length)];
    return template.replace("{\u4E3B\u89D2\u8272}", session.roles[0]?.roleName || "\u9867\u554F").replace("{\u76EE\u6A19\u7528\u6236}", session.targetUserName);
  }
  /**
   * üÜï Ëß∏Áôº AI ÂõûË¶Ü
   */
  triggerAIResponse(sessionId, responder, userMessage, intent) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return;
    const delay = this.calculateResponseDelay(session);
    console.log(`[Orchestrator] \u5C07\u7531 ${responder.roleName} \u5728 ${delay}ms \u5F8C\u56DE\u8986`);
    setTimeout(() => {
      this.ipc.send("collaboration:generate-response", {
        sessionId,
        roleId: responder.roleId,
        roleName: responder.roleName,
        accountPhone: responder.accountPhone,
        userMessage,
        intent,
        stage: session.currentStage,
        conversationHistory: session.conversationHistory.slice(-10)
        // ÊúÄËøë10Ê¢ù
      });
    }, delay);
  }
  /**
   * Ë®àÁÆóÂõûË¶ÜÂª∂ÈÅ≤
   */
  calculateResponseDelay(session) {
    const min = session.rhythm.minIntervalSeconds * 1e3;
    const max = session.rhythm.maxIntervalSeconds * 1e3;
    return min + Math.random() * (max - min);
  }
  /**
   * Êõ¥Êñ∞ÊúÉË©±
   */
  updateSession(sessionId, updates) {
    this._sessions.update((sessions) => {
      const session = sessions.get(sessionId);
      if (!session)
        return sessions;
      const newSessions = new Map(sessions);
      newSessions.set(sessionId, __spreadProps(__spreadValues(__spreadValues({}, session), updates), { updatedAt: /* @__PURE__ */ new Date() }));
      return newSessions;
    });
  }
  /**
   * Êõ¥Êñ∞ÊúÄÂæåÊ∂àÊÅØÊôÇÈñì
   */
  updateLastMessageTime(sessionId) {
    this.updateSession(sessionId, { lastMessageTime: /* @__PURE__ */ new Date() });
  }
  /**
   * Â∑•ÂÖ∑ÊñπÊ≥ïÔºöÂª∂ÈÅ≤
   */
  delay(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
  }
  /**
   * ÂÅúÊ≠¢ÊúÉË©±
   */
  stopSession(sessionId) {
    this.updateSession(sessionId, { status: "paused" });
    console.log(`[Orchestrator] \u6703\u8A71\u5DF2\u66AB\u505C: ${sessionId}`);
  }
  /**
   * ÂÆåÊàêÊúÉË©±
   */
  completeSession(sessionId, outcome = "neutral", conversionValue) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return;
    this.updateSession(sessionId, { status: "completed" });
    this.analytics.recordSession({
      sessionId: session.id,
      targetUserId: session.targetUserId,
      targetUserName: session.targetUserName,
      roles: session.roles.map((r) => ({
        roleId: r.roleId,
        roleName: r.roleName,
        roleType: r.entryType,
        accountPhone: r.accountPhone
      })),
      messages: session.conversationHistory.map((m) => ({
        role: m.role,
        content: m.content,
        timestamp: m.timestamp,
        isUser: m.isUser
      })),
      outcome,
      conversionValue,
      interestScore: session.interestScore,
      stagesReached: session.stageHistory.map((s) => s.stage),
      finalStage: session.currentStage
    });
    console.log(`[Orchestrator] \u6703\u8A71\u5DF2\u5B8C\u6210: ${sessionId}, \u7D50\u679C: ${outcome}`);
    this.toast.success("\u{1F389} \u5354\u4F5C\u6703\u8A71\u5DF2\u5B8C\u6210");
  }
  /**
   * Áç≤ÂèñÊúÉË©±Áµ±Ë®à
   */
  getSessionStats(sessionId) {
    const session = this._sessions().get(sessionId);
    if (!session)
      return null;
    return {
      duration: Date.now() - session.createdAt.getTime(),
      messageCount: session.messageCount,
      userResponseCount: session.userResponseCount,
      interestScore: session.interestScore,
      currentStage: session.currentStage,
      stageHistory: session.stageHistory
    };
  }
  static {
    this.\u0275fac = function CollaborationOrchestratorService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _CollaborationOrchestratorService)();
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _CollaborationOrchestratorService, factory: _CollaborationOrchestratorService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(CollaborationOrchestratorService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [], null);
})();

// src/multi-role/components/role-editor.component.ts
var _forTrack0 = ($index, $item) => $item.id;
function RoleEditorComponent_For_22_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 43);
    \u0275\u0275listener("click", function RoleEditorComponent_For_22_Template_button_click_0_listener() {
      const type_r2 = \u0275\u0275restoreView(_r1).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      ctx_r2.editData.type = type_r2.id;
      return \u0275\u0275resetView(ctx_r2.onTypeChange());
    });
    \u0275\u0275elementStart(1, "div", 44);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 45);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const type_r2 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classProp("border-purple-500", ctx_r2.editData.type === type_r2.id)("bg-purple-500/10", ctx_r2.editData.type === type_r2.id)("border-transparent", ctx_r2.editData.type !== type_r2.id)("bg-slate-700", ctx_r2.editData.type !== type_r2.id);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(type_r2.icon);
    \u0275\u0275advance();
    \u0275\u0275classProp("text-purple-400", ctx_r2.editData.type === type_r2.id)("text-slate-400", ctx_r2.editData.type !== type_r2.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", type_r2.label, " ");
  }
}
function RoleEditorComponent_For_42_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 46);
    \u0275\u0275listener("click", function RoleEditorComponent_For_42_Template_button_click_0_listener() {
      const style_r5 = \u0275\u0275restoreView(_r4).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.editData.personality.speakingStyle = style_r5.id);
    });
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const style_r5 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classProp("bg-purple-500", ctx_r2.editData.personality.speakingStyle === style_r5.id)("text-white", ctx_r2.editData.personality.speakingStyle === style_r5.id)("bg-slate-700", ctx_r2.editData.personality.speakingStyle !== style_r5.id)("text-slate-300", ctx_r2.editData.personality.speakingStyle !== style_r5.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate2(" ", style_r5.icon, " ", style_r5.label, " ");
  }
}
function RoleEditorComponent_For_48_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 47);
    \u0275\u0275listener("click", function RoleEditorComponent_For_48_Template_button_click_0_listener() {
      const trait_r7 = \u0275\u0275restoreView(_r6).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.toggleTrait(trait_r7));
    });
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const trait_r7 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classProp("bg-purple-500/20", ctx_r2.editData.personality.traits.includes(trait_r7))("text-purple-400", ctx_r2.editData.personality.traits.includes(trait_r7))("bg-slate-700", !ctx_r2.editData.personality.traits.includes(trait_r7))("text-slate-400", !ctx_r2.editData.personality.traits.includes(trait_r7));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", trait_r7, " ");
  }
}
function RoleEditorComponent_For_108_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "option", 36);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const account_r8 = ctx.$implicit;
    \u0275\u0275property("value", account_r8.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate2(" ", account_r8.phone, " ", account_r8.username ? "(@" + account_r8.username + ")" : "", " ");
  }
}
function RoleEditorComponent_Conditional_113_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 39);
    \u0275\u0275text(1, "\u26A0 \u8ACB\u586B\u5BEB\u5FC5\u8981\u4FE1\u606F");
    \u0275\u0275elementEnd();
  }
}
var RoleEditorComponent = class _RoleEditorComponent {
  constructor() {
    this.multiRoleService = inject(MultiRoleService);
    this.role = input(null, ...ngDevMode ? [{ debugName: "role" }] : []);
    this.availableAccounts = input([], ...ngDevMode ? [{ debugName: "availableAccounts" }] : []);
    this.saved = output();
    this.cancelled = output();
    this.editData = this.getDefaultData();
    this.isNew = computed(() => !this.role(), ...ngDevMode ? [{ debugName: "isNew" }] : []);
    this.roleTypes = Object.entries(ROLE_TYPE_META).filter(([id]) => id !== "custom").map(([id, meta]) => ({
      id,
      icon: meta.icon,
      label: meta.label
    }));
    this.speakingStyles = [
      { id: "professional", icon: "\u{1F454}", label: "\u5C08\u696D\u6B63\u5F0F" },
      { id: "friendly", icon: "\u{1F60A}", label: "\u53CB\u597D\u89AA\u5207" },
      { id: "casual", icon: "\u{1F60E}", label: "\u8F15\u9B06\u96A8\u610F" },
      { id: "enthusiastic", icon: "\u{1F525}", label: "\u71B1\u60C5" },
      { id: "careful", icon: "\u{1F914}", label: "\u8B39\u614E" },
      { id: "curious", icon: "\u2753", label: "\u597D\u5947" }
    ];
    this.availableTraits = [
      "\u5C08\u696D",
      "\u8010\u5FC3",
      "\u71B1\u60C5",
      "\u7D30\u5FC3",
      "\u5E7D\u9ED8",
      "\u771F\u8AA0",
      "\u5584\u65BC\u50BE\u807D",
      "\u5584\u65BC\u8AAA\u670D",
      "\u908F\u8F2F\u6E05\u6670",
      "\u7D93\u9A57\u8C50\u5BCC"
    ];
    const roleInput = this.role;
    if (roleInput()) {
      this.loadRole(roleInput());
    }
  }
  ngOnInit() {
    const role = this.role();
    if (role) {
      this.loadRole(role);
    }
  }
  getDefaultData() {
    return {
      name: "",
      type: "expert",
      personality: {
        description: "",
        speakingStyle: "friendly",
        traits: []
      },
      aiConfig: {
        useGlobalAI: true,
        customPrompt: ROLE_TYPE_META.expert.defaultPrompt,
        responseLength: "medium",
        emojiFrequency: "low",
        typingSpeed: "medium"
      },
      responsibilities: [],
      isActive: true
    };
  }
  loadRole(role) {
    this.editData = __spreadProps(__spreadValues({}, role), {
      personality: __spreadValues({}, role.personality),
      aiConfig: __spreadValues({}, role.aiConfig)
    });
  }
  getRoleIcon(type) {
    return ROLE_TYPE_META[type]?.icon || "\u{1F3AD}";
  }
  onTypeChange() {
    const type = this.editData.type;
    const meta = ROLE_TYPE_META[type];
    if (!this.editData.name || this.roleTypes.some((t) => t.label === this.editData.name)) {
      this.editData.name = meta.label;
    }
    if (!this.editData.personality.description) {
      this.editData.personality.description = meta.description;
    }
    if (!this.editData.aiConfig.customPrompt || Object.values(ROLE_TYPE_META).some((m) => m.defaultPrompt === this.editData.aiConfig.customPrompt)) {
      this.editData.aiConfig.customPrompt = meta.defaultPrompt;
    }
    this.editData.personality.speakingStyle = meta.defaultStyle;
  }
  toggleTrait(trait) {
    const traits = this.editData.personality.traits;
    const index = traits.indexOf(trait);
    if (index >= 0) {
      traits.splice(index, 1);
    } else {
      traits.push(trait);
    }
  }
  onAccountSelect(accountId) {
    const account = this.availableAccounts().find((a) => a.id === accountId);
    if (account) {
      this.editData.boundAccountId = account.id;
      this.editData.boundAccountPhone = account.phone;
    } else {
      this.editData.boundAccountId = void 0;
      this.editData.boundAccountPhone = void 0;
    }
  }
  isFormValid() {
    return !!(this.editData.name?.trim() && this.editData.type && this.editData.aiConfig?.customPrompt?.trim());
  }
  save() {
    if (!this.isFormValid())
      return;
    const roleData = __spreadProps(__spreadValues({}, this.editData), {
      updatedAt: (/* @__PURE__ */ new Date()).toISOString()
    });
    if (this.isNew()) {
      const id = this.multiRoleService.addRole(roleData);
      const newRole = this.multiRoleService.roles().find((r) => r.id === id);
      if (newRole) {
        this.saved.emit(newRole);
      }
    } else {
      this.multiRoleService.updateRole(this.role().id, roleData);
      this.saved.emit(__spreadValues(__spreadValues({}, this.role()), roleData));
    }
  }
  cancel() {
    this.cancelled.emit();
  }
  static {
    this.\u0275fac = function RoleEditorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _RoleEditorComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _RoleEditorComponent, selectors: [["app-role-editor"]], inputs: { role: [1, "role"], availableAccounts: [1, "availableAccounts"] }, outputs: { saved: "saved", cancelled: "cancelled" }, decls: 119, vars: 13, consts: [[1, "role-editor", "fixed", "inset-0", "bg-black/60", "backdrop-blur-sm", "flex", "items-center", "justify-center", "z-50"], [1, "bg-slate-800", "rounded-2xl", "w-full", "max-w-2xl", "max-h-[90vh]", "overflow-hidden", "shadow-xl", "border", "border-slate-700"], [1, "p-6", "border-b", "border-slate-700", "flex", "items-center", "justify-between"], [1, "text-xl", "font-bold", "text-white", "flex", "items-center", "gap-3"], [1, "text-2xl"], [1, "text-slate-400", "hover:text-white", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-6", "h-6"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M6 18L18 6M6 6l12 12"], [1, "p-6", "overflow-y-auto", "max-h-[calc(90vh-180px)]"], [1, "mb-8"], [1, "text-sm", "font-semibold", "text-purple-400", "mb-4", "flex", "items-center", "gap-2"], [1, "w-6", "h-6", "rounded-full", "bg-purple-500/20", "flex", "items-center", "justify-center", "text-xs"], [1, "grid", "grid-cols-2", "gap-4", "mb-4"], [1, "text-sm", "text-slate-400", "block", "mb-2"], [1, "grid", "grid-cols-3", "gap-2"], [1, "p-2", "rounded-lg", "text-center", "transition-all", "border-2", 3, "border-purple-500", "bg-purple-500/10", "border-transparent", "bg-slate-700"], ["type", "text", "placeholder", "\u5982\uFF1A\u7522\u54C1\u5C08\u5BB6 Mira", 1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", 3, "ngModelChange", "ngModel"], ["rows", "2", "placeholder", "\u63CF\u8FF0\u9019\u500B\u89D2\u8272\u7684\u80CC\u666F\u548C\u7279\u9EDE...", 1, "w-full", "px-4", "py-3", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", "resize-none", 3, "ngModelChange", "ngModel"], [1, "mb-4"], [1, "flex", "flex-wrap", "gap-2"], [1, "px-4", "py-2", "rounded-lg", "transition-all", 3, "bg-purple-500", "text-white", "bg-slate-700", "text-slate-300"], [1, "px-3", "py-1.5", "rounded-lg", "text-sm", "transition-all", 3, "bg-purple-500/20", "text-purple-400", "bg-slate-700", "text-slate-400"], ["rows", "4", "placeholder", "\u4F60\u662F\u4E00\u4F4D...", 1, "w-full", "px-4", "py-3", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", "resize-none", "font-mono", "text-sm", 3, "ngModelChange", "ngModel"], [1, "text-xs", "text-slate-500", "mt-1"], [1, "grid", "grid-cols-3", "gap-4"], [1, "w-full", "px-3", "py-2", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", 3, "ngModelChange", "ngModel"], ["value", "short"], ["value", "medium"], ["value", "long"], ["value", "none"], ["value", "low"], ["value", "high"], ["value", "fast"], ["value", "slow"], ["value", "random"], [1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", 3, "ngModelChange", "ngModel"], [3, "value"], [1, "p-6", "border-t", "border-slate-700", "flex", "items-center", "justify-between"], [1, "text-sm", "text-slate-400"], [1, "text-yellow-400"], [1, "flex", "gap-3"], [1, "px-6", "py-2.5", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", "transition-colors", 3, "click"], [1, "px-6", "py-2.5", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "rounded-lg", "hover:opacity-90", "transition-opacity", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "click", "disabled"], [1, "p-2", "rounded-lg", "text-center", "transition-all", "border-2", 3, "click"], [1, "text-xl", "mb-0.5"], [1, "text-xs"], [1, "px-4", "py-2", "rounded-lg", "transition-all", 3, "click"], [1, "px-3", "py-1.5", "rounded-lg", "text-sm", "transition-all", 3, "click"]], template: function RoleEditorComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "h2", 3)(4, "span", 4);
        \u0275\u0275text(5);
        \u0275\u0275elementEnd();
        \u0275\u0275text(6);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(7, "button", 5);
        \u0275\u0275listener("click", function RoleEditorComponent_Template_button_click_7_listener() {
          return ctx.cancel();
        });
        \u0275\u0275namespaceSVG();
        \u0275\u0275elementStart(8, "svg", 6);
        \u0275\u0275element(9, "path", 7);
        \u0275\u0275elementEnd()()();
        \u0275\u0275namespaceHTML();
        \u0275\u0275elementStart(10, "div", 8)(11, "div", 9)(12, "h3", 10)(13, "span", 11);
        \u0275\u0275text(14, "1");
        \u0275\u0275elementEnd();
        \u0275\u0275text(15, " \u57FA\u790E\u4FE1\u606F ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(16, "div", 12)(17, "div")(18, "label", 13);
        \u0275\u0275text(19, "\u89D2\u8272\u985E\u578B *");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(20, "div", 14);
        \u0275\u0275repeaterCreate(21, RoleEditorComponent_For_22_Template, 5, 14, "button", 15, _forTrack0);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(23, "div")(24, "label", 13);
        \u0275\u0275text(25, "\u89D2\u8272\u540D\u7A31 *");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(26, "input", 16);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_input_ngModelChange_26_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.name, $event) || (ctx.editData.name = $event);
          return $event;
        });
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(27, "div")(28, "label", 13);
        \u0275\u0275text(29, "\u4EBA\u8A2D\u63CF\u8FF0");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(30, "textarea", 17);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_textarea_ngModelChange_30_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.personality.description, $event) || (ctx.editData.personality.description = $event);
          return $event;
        });
        \u0275\u0275text(31, "              ");
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(32, "div", 9)(33, "h3", 10)(34, "span", 11);
        \u0275\u0275text(35, "2");
        \u0275\u0275elementEnd();
        \u0275\u0275text(36, " \u6027\u683C\u7279\u5FB5 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(37, "div", 18)(38, "label", 13);
        \u0275\u0275text(39, "\u8AAA\u8A71\u98A8\u683C");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(40, "div", 19);
        \u0275\u0275repeaterCreate(41, RoleEditorComponent_For_42_Template, 2, 10, "button", 20, _forTrack0);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(43, "div")(44, "label", 13);
        \u0275\u0275text(45, "\u6027\u683C\u6A19\u7C64");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(46, "div", 19);
        \u0275\u0275repeaterCreate(47, RoleEditorComponent_For_48_Template, 2, 9, "button", 21, \u0275\u0275repeaterTrackByIdentity);
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(49, "div", 9)(50, "h3", 10)(51, "span", 11);
        \u0275\u0275text(52, "3");
        \u0275\u0275elementEnd();
        \u0275\u0275text(53, " AI \u914D\u7F6E ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(54, "div", 18)(55, "label", 13);
        \u0275\u0275text(56, "AI \u4EBA\u8A2D Prompt *");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(57, "textarea", 22);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_textarea_ngModelChange_57_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.aiConfig.customPrompt, $event) || (ctx.editData.aiConfig.customPrompt = $event);
          return $event;
        });
        \u0275\u0275text(58, "              ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(59, "p", 23);
        \u0275\u0275text(60, "\u5B9A\u7FA9\u9019\u500B\u89D2\u8272\u8AAA\u8A71\u7684\u65B9\u5F0F\u548C\u884C\u70BA\u7279\u9EDE");
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(61, "div", 24)(62, "div")(63, "label", 13);
        \u0275\u0275text(64, "\u56DE\u8986\u9577\u5EA6");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(65, "select", 25);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_select_ngModelChange_65_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.aiConfig.responseLength, $event) || (ctx.editData.aiConfig.responseLength = $event);
          return $event;
        });
        \u0275\u0275elementStart(66, "option", 26);
        \u0275\u0275text(67, "\u7C21\u77ED");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(68, "option", 27);
        \u0275\u0275text(69, "\u9069\u4E2D");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(70, "option", 28);
        \u0275\u0275text(71, "\u8A73\u7D30");
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(72, "div")(73, "label", 13);
        \u0275\u0275text(74, "Emoji \u983B\u7387");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(75, "select", 25);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_select_ngModelChange_75_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.aiConfig.emojiFrequency, $event) || (ctx.editData.aiConfig.emojiFrequency = $event);
          return $event;
        });
        \u0275\u0275elementStart(76, "option", 29);
        \u0275\u0275text(77, "\u4E0D\u4F7F\u7528");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(78, "option", 30);
        \u0275\u0275text(79, "\u5076\u723E");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(80, "option", 27);
        \u0275\u0275text(81, "\u9069\u4E2D");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(82, "option", 31);
        \u0275\u0275text(83, "\u983B\u7E41");
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(84, "div")(85, "label", 13);
        \u0275\u0275text(86, "\u6253\u5B57\u901F\u5EA6");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(87, "select", 25);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_select_ngModelChange_87_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.aiConfig.typingSpeed, $event) || (ctx.editData.aiConfig.typingSpeed = $event);
          return $event;
        });
        \u0275\u0275elementStart(88, "option", 32);
        \u0275\u0275text(89, "\u5FEB\u901F");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(90, "option", 27);
        \u0275\u0275text(91, "\u4E2D\u7B49");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(92, "option", 33);
        \u0275\u0275text(93, "\u6162\u901F");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(94, "option", 34);
        \u0275\u0275text(95, "\u96A8\u6A5F");
        \u0275\u0275elementEnd()()()()();
        \u0275\u0275elementStart(96, "div", 18)(97, "h3", 10)(98, "span", 11);
        \u0275\u0275text(99, "4");
        \u0275\u0275elementEnd();
        \u0275\u0275text(100, " \u5E33\u865F\u7D81\u5B9A ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(101, "div")(102, "label", 13);
        \u0275\u0275text(103, "\u7D81\u5B9A Telegram \u5E33\u865F");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(104, "select", 35);
        \u0275\u0275twoWayListener("ngModelChange", function RoleEditorComponent_Template_select_ngModelChange_104_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.boundAccountId, $event) || (ctx.editData.boundAccountId = $event);
          return $event;
        });
        \u0275\u0275listener("ngModelChange", function RoleEditorComponent_Template_select_ngModelChange_104_listener($event) {
          return ctx.onAccountSelect($event);
        });
        \u0275\u0275elementStart(105, "option", 36);
        \u0275\u0275text(106, "\u66AB\u4E0D\u7D81\u5B9A");
        \u0275\u0275elementEnd();
        \u0275\u0275repeaterCreate(107, RoleEditorComponent_For_108_Template, 2, 3, "option", 36, _forTrack0);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(109, "p", 23);
        \u0275\u0275text(110, "\u7D81\u5B9A\u5E33\u865F\u5F8C\uFF0C\u8A72\u89D2\u8272\u5C07\u4F7F\u7528\u6B64\u5E33\u865F\u767C\u9001\u6D88\u606F");
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(111, "div", 37)(112, "div", 38);
        \u0275\u0275conditionalCreate(113, RoleEditorComponent_Conditional_113_Template, 2, 0, "span", 39);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(114, "div", 40)(115, "button", 41);
        \u0275\u0275listener("click", function RoleEditorComponent_Template_button_click_115_listener() {
          return ctx.cancel();
        });
        \u0275\u0275text(116, " \u53D6\u6D88 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(117, "button", 42);
        \u0275\u0275listener("click", function RoleEditorComponent_Template_button_click_117_listener() {
          return ctx.save();
        });
        \u0275\u0275text(118);
        \u0275\u0275elementEnd()()()()();
      }
      if (rf & 2) {
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.isNew() ? "\u{1F3AD}" : ctx.getRoleIcon(ctx.editData.type));
        \u0275\u0275advance();
        \u0275\u0275textInterpolate1(" ", ctx.isNew() ? "\u5275\u5EFA\u65B0\u89D2\u8272" : "\u7DE8\u8F2F\u89D2\u8272", " ");
        \u0275\u0275advance(15);
        \u0275\u0275repeater(ctx.roleTypes);
        \u0275\u0275advance(5);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.name);
        \u0275\u0275advance(4);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.personality.description);
        \u0275\u0275advance(11);
        \u0275\u0275repeater(ctx.speakingStyles);
        \u0275\u0275advance(6);
        \u0275\u0275repeater(ctx.availableTraits);
        \u0275\u0275advance(10);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.aiConfig.customPrompt);
        \u0275\u0275advance(8);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.aiConfig.responseLength);
        \u0275\u0275advance(10);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.aiConfig.emojiFrequency);
        \u0275\u0275advance(12);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.aiConfig.typingSpeed);
        \u0275\u0275advance(17);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.boundAccountId);
        \u0275\u0275advance();
        \u0275\u0275property("value", void 0);
        \u0275\u0275advance(2);
        \u0275\u0275repeater(ctx.availableAccounts());
        \u0275\u0275advance(6);
        \u0275\u0275conditional(!ctx.isFormValid() ? 113 : -1);
        \u0275\u0275advance(4);
        \u0275\u0275property("disabled", !ctx.isFormValid());
        \u0275\u0275advance();
        \u0275\u0275textInterpolate1(" ", ctx.isNew() ? "\u5275\u5EFA\u89D2\u8272" : "\u4FDD\u5B58\u66F4\u6539", " ");
      }
    }, dependencies: [CommonModule, FormsModule, NgSelectOption, \u0275NgSelectMultipleOption, DefaultValueAccessor, SelectControlValueAccessor, NgControlStatus, NgModel], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(RoleEditorComponent, [{
    type: Component,
    args: [{
      selector: "app-role-editor",
      standalone: true,
      imports: [CommonModule, FormsModule],
      template: `
    <div class="role-editor fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
      <div class="bg-slate-800 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden shadow-xl border border-slate-700">
        <!-- \u6A19\u984C\u6B04 -->
        <div class="p-6 border-b border-slate-700 flex items-center justify-between">
          <h2 class="text-xl font-bold text-white flex items-center gap-3">
            <span class="text-2xl">{{ isNew() ? '\u{1F3AD}' : getRoleIcon(editData.type) }}</span>
            {{ isNew() ? '\u5275\u5EFA\u65B0\u89D2\u8272' : '\u7DE8\u8F2F\u89D2\u8272' }}
          </h2>
          <button (click)="cancel()" class="text-slate-400 hover:text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        
        <!-- \u5167\u5BB9\u5340 -->
        <div class="p-6 overflow-y-auto max-h-[calc(90vh-180px)]">
          <!-- \u6B65\u9A5F 1: \u57FA\u790E\u4FE1\u606F -->
          <div class="mb-8">
            <h3 class="text-sm font-semibold text-purple-400 mb-4 flex items-center gap-2">
              <span class="w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs">1</span>
              \u57FA\u790E\u4FE1\u606F
            </h3>
            
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u89D2\u8272\u985E\u578B *</label>
                <div class="grid grid-cols-3 gap-2">
                  @for (type of roleTypes; track type.id) {
                    <button (click)="editData.type = type.id; onTypeChange()"
                            class="p-2 rounded-lg text-center transition-all border-2"
                            [class.border-purple-500]="editData.type === type.id"
                            [class.bg-purple-500/10]="editData.type === type.id"
                            [class.border-transparent]="editData.type !== type.id"
                            [class.bg-slate-700]="editData.type !== type.id">
                      <div class="text-xl mb-0.5">{{ type.icon }}</div>
                      <div class="text-xs"
                           [class.text-purple-400]="editData.type === type.id"
                           [class.text-slate-400]="editData.type !== type.id">
                        {{ type.label }}
                      </div>
                    </button>
                  }
                </div>
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u89D2\u8272\u540D\u7A31 *</label>
                <input type="text"
                       [(ngModel)]="editData.name"
                       placeholder="\u5982\uFF1A\u7522\u54C1\u5C08\u5BB6 Mira"
                       class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500">
              </div>
            </div>
            
            <div>
              <label class="text-sm text-slate-400 block mb-2">\u4EBA\u8A2D\u63CF\u8FF0</label>
              <textarea rows="2"
                        [(ngModel)]="editData.personality.description"
                        placeholder="\u63CF\u8FF0\u9019\u500B\u89D2\u8272\u7684\u80CC\u666F\u548C\u7279\u9EDE..."
                        class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 resize-none">
              </textarea>
            </div>
          </div>
          
          <!-- \u6B65\u9A5F 2: \u6027\u683C\u7279\u5FB5 -->
          <div class="mb-8">
            <h3 class="text-sm font-semibold text-purple-400 mb-4 flex items-center gap-2">
              <span class="w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs">2</span>
              \u6027\u683C\u7279\u5FB5
            </h3>
            
            <div class="mb-4">
              <label class="text-sm text-slate-400 block mb-2">\u8AAA\u8A71\u98A8\u683C</label>
              <div class="flex flex-wrap gap-2">
                @for (style of speakingStyles; track style.id) {
                  <button (click)="editData.personality.speakingStyle = style.id"
                          class="px-4 py-2 rounded-lg transition-all"
                          [class.bg-purple-500]="editData.personality.speakingStyle === style.id"
                          [class.text-white]="editData.personality.speakingStyle === style.id"
                          [class.bg-slate-700]="editData.personality.speakingStyle !== style.id"
                          [class.text-slate-300]="editData.personality.speakingStyle !== style.id">
                    {{ style.icon }} {{ style.label }}
                  </button>
                }
              </div>
            </div>
            
            <div>
              <label class="text-sm text-slate-400 block mb-2">\u6027\u683C\u6A19\u7C64</label>
              <div class="flex flex-wrap gap-2">
                @for (trait of availableTraits; track trait) {
                  <button (click)="toggleTrait(trait)"
                          class="px-3 py-1.5 rounded-lg text-sm transition-all"
                          [class.bg-purple-500/20]="editData.personality.traits.includes(trait)"
                          [class.text-purple-400]="editData.personality.traits.includes(trait)"
                          [class.bg-slate-700]="!editData.personality.traits.includes(trait)"
                          [class.text-slate-400]="!editData.personality.traits.includes(trait)">
                    {{ trait }}
                  </button>
                }
              </div>
            </div>
          </div>
          
          <!-- \u6B65\u9A5F 3: AI \u914D\u7F6E -->
          <div class="mb-8">
            <h3 class="text-sm font-semibold text-purple-400 mb-4 flex items-center gap-2">
              <span class="w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs">3</span>
              AI \u914D\u7F6E
            </h3>
            
            <div class="mb-4">
              <label class="text-sm text-slate-400 block mb-2">AI \u4EBA\u8A2D Prompt *</label>
              <textarea rows="4"
                        [(ngModel)]="editData.aiConfig.customPrompt"
                        placeholder="\u4F60\u662F\u4E00\u4F4D..."
                        class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 resize-none font-mono text-sm">
              </textarea>
              <p class="text-xs text-slate-500 mt-1">\u5B9A\u7FA9\u9019\u500B\u89D2\u8272\u8AAA\u8A71\u7684\u65B9\u5F0F\u548C\u884C\u70BA\u7279\u9EDE</p>
            </div>
            
            <div class="grid grid-cols-3 gap-4">
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u56DE\u8986\u9577\u5EA6</label>
                <select [(ngModel)]="editData.aiConfig.responseLength"
                        class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white">
                  <option value="short">\u7C21\u77ED</option>
                  <option value="medium">\u9069\u4E2D</option>
                  <option value="long">\u8A73\u7D30</option>
                </select>
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">Emoji \u983B\u7387</label>
                <select [(ngModel)]="editData.aiConfig.emojiFrequency"
                        class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white">
                  <option value="none">\u4E0D\u4F7F\u7528</option>
                  <option value="low">\u5076\u723E</option>
                  <option value="medium">\u9069\u4E2D</option>
                  <option value="high">\u983B\u7E41</option>
                </select>
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u6253\u5B57\u901F\u5EA6</label>
                <select [(ngModel)]="editData.aiConfig.typingSpeed"
                        class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white">
                  <option value="fast">\u5FEB\u901F</option>
                  <option value="medium">\u4E2D\u7B49</option>
                  <option value="slow">\u6162\u901F</option>
                  <option value="random">\u96A8\u6A5F</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- \u6B65\u9A5F 4: \u5E33\u865F\u7D81\u5B9A -->
          <div class="mb-4">
            <h3 class="text-sm font-semibold text-purple-400 mb-4 flex items-center gap-2">
              <span class="w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs">4</span>
              \u5E33\u865F\u7D81\u5B9A
            </h3>
            
            <div>
              <label class="text-sm text-slate-400 block mb-2">\u7D81\u5B9A Telegram \u5E33\u865F</label>
              <select [(ngModel)]="editData.boundAccountId"
                      (ngModelChange)="onAccountSelect($event)"
                      class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white">
                <option [value]="undefined">\u66AB\u4E0D\u7D81\u5B9A</option>
                @for (account of availableAccounts(); track account.id) {
                  <option [value]="account.id">
                    {{ account.phone }} {{ account.username ? '(@' + account.username + ')' : '' }}
                  </option>
                }
              </select>
              <p class="text-xs text-slate-500 mt-1">\u7D81\u5B9A\u5E33\u865F\u5F8C\uFF0C\u8A72\u89D2\u8272\u5C07\u4F7F\u7528\u6B64\u5E33\u865F\u767C\u9001\u6D88\u606F</p>
            </div>
          </div>
        </div>
        
        <!-- \u5E95\u90E8\u64CD\u4F5C -->
        <div class="p-6 border-t border-slate-700 flex items-center justify-between">
          <div class="text-sm text-slate-400">
            @if (!isFormValid()) {
              <span class="text-yellow-400">\u26A0 \u8ACB\u586B\u5BEB\u5FC5\u8981\u4FE1\u606F</span>
            }
          </div>
          
          <div class="flex gap-3">
            <button (click)="cancel()"
                    class="px-6 py-2.5 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-colors">
              \u53D6\u6D88
            </button>
            <button (click)="save()"
                    [disabled]="!isFormValid()"
                    class="px-6 py-2.5 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg 
                           hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed">
              {{ isNew() ? '\u5275\u5EFA\u89D2\u8272' : '\u4FDD\u5B58\u66F4\u6539' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  `
    }]
  }], () => [], { role: [{ type: Input, args: [{ isSignal: true, alias: "role", required: false }] }], availableAccounts: [{ type: Input, args: [{ isSignal: true, alias: "availableAccounts", required: false }] }], saved: [{ type: Output, args: ["saved"] }], cancelled: [{ type: Output, args: ["cancelled"] }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(RoleEditorComponent, { className: "RoleEditorComponent", filePath: "src/multi-role/components/role-editor.component.ts", lineNumber: 230 });
})();

// src/multi-role/components/script-editor.component.ts
var _forTrack02 = ($index, $item) => $item.id;
function ScriptEditorComponent_For_49_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 37);
    \u0275\u0275listener("click", function ScriptEditorComponent_For_49_Template_div_click_0_listener() {
      const \u0275$index_82_r2 = \u0275\u0275restoreView(_r1).$index;
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectStage(\u0275$index_82_r2));
    });
    \u0275\u0275elementStart(1, "div", 38)(2, "span", 39);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "button", 40);
    \u0275\u0275listener("click", function ScriptEditorComponent_For_49_Template_button_click_4_listener($event) {
      const \u0275$index_82_r2 = \u0275\u0275restoreView(_r1).$index;
      const ctx_r2 = \u0275\u0275nextContext();
      ctx_r2.removeStage(\u0275$index_82_r2);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(5, "svg", 41);
    \u0275\u0275element(6, "path", 9);
    \u0275\u0275elementEnd()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(7, "div", 42);
    \u0275\u0275text(8);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const stage_r4 = ctx.$implicit;
    const \u0275$index_82_r2 = ctx.$index;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classProp("bg-purple-500/20", ctx_r2.selectedStageIndex() === \u0275$index_82_r2)("border-purple-500", ctx_r2.selectedStageIndex() === \u0275$index_82_r2)("border", ctx_r2.selectedStageIndex() === \u0275$index_82_r2)("bg-slate-700/50", ctx_r2.selectedStageIndex() !== \u0275$index_82_r2);
    \u0275\u0275advance(2);
    \u0275\u0275classProp("text-purple-400", ctx_r2.selectedStageIndex() === \u0275$index_82_r2)("text-white", ctx_r2.selectedStageIndex() !== \u0275$index_82_r2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate2(" ", \u0275$index_82_r2 + 1, ". ", stage_r4.name, " ");
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1(" ", stage_r4.messages.length, " \u689D\u6D88\u606F ");
  }
}
function ScriptEditorComponent_Conditional_50_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 28);
    \u0275\u0275text(1, " \u9EDE\u64CA\u4E0A\u65B9\u6DFB\u52A0\u7B2C\u4E00\u500B\u968E\u6BB5 ");
    \u0275\u0275elementEnd();
  }
}
function ScriptEditorComponent_Conditional_52_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    const _r7 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 50)(1, "span");
    \u0275\u0275text(2, "\u5EF6\u9072");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "input", 56);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_Conditional_12_Template_input_ngModelChange_3_listener($event) {
      \u0275\u0275restoreView(_r7);
      const stage_r6 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(stage_r6.trigger.delaySeconds, $event) || (stage_r6.trigger.delaySeconds = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "span");
    \u0275\u0275text(5, "\u79D2\u5F8C\u57F7\u884C");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const stage_r6 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275twoWayProperty("ngModel", stage_r6.trigger.delaySeconds);
  }
}
function ScriptEditorComponent_Conditional_52_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    const _r8 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 50)(1, "span");
    \u0275\u0275text(2, "\u95DC\u9375\u8A5E\uFF08\u9017\u865F\u5206\u9694\uFF09");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "input", 57);
    \u0275\u0275listener("ngModelChange", function ScriptEditorComponent_Conditional_52_Conditional_13_Template_input_ngModelChange_3_listener($event) {
      \u0275\u0275restoreView(_r8);
      const stage_r6 = \u0275\u0275nextContext();
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.setKeywords(stage_r6, $event));
    });
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const stage_r6 = \u0275\u0275nextContext();
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275property("ngModel", ctx_r2.getKeywordsString(stage_r6));
  }
}
function ScriptEditorComponent_Conditional_52_For_16_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "option", 61);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const role_r11 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(3);
    \u0275\u0275property("value", role_r11.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate2(" ", ctx_r2.getRoleIcon(role_r11.type), " ", role_r11.name, " ");
  }
}
function ScriptEditorComponent_Conditional_52_For_16_Conditional_21_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 74);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    \u0275\u0275advance();
    \u0275\u0275textInterpolate6(" \u53EF\u7528\u8B8A\u91CF: ", "{", "\u5BA2\u6236\u540D", "}", ", ", "{", "\u7522\u54C1\u540D", "}", ", ", "{", "\u50F9\u683C", "}", " ");
  }
}
function ScriptEditorComponent_Conditional_52_For_16_Conditional_21_Template(rf, ctx) {
  if (rf & 1) {
    const _r12 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "textarea", 73);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_For_16_Conditional_21_Template_textarea_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r12);
      const msg_r10 = \u0275\u0275nextContext().$implicit;
      \u0275\u0275twoWayBindingSet(msg_r10.content.text, $event) || (msg_r10.content.text = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275text(1, "                          ");
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(2, ScriptEditorComponent_Conditional_52_For_16_Conditional_21_Conditional_2_Template, 2, 6, "div", 74);
  }
  if (rf & 2) {
    const msg_r10 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275twoWayProperty("ngModel", msg_r10.content.text);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(msg_r10.content.type === "template" ? 2 : -1);
  }
}
function ScriptEditorComponent_Conditional_52_For_16_Conditional_22_Template(rf, ctx) {
  if (rf & 1) {
    const _r13 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "textarea", 75);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_For_16_Conditional_22_Template_textarea_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r13);
      const msg_r10 = \u0275\u0275nextContext().$implicit;
      \u0275\u0275twoWayBindingSet(msg_r10.content.aiPrompt, $event) || (msg_r10.content.aiPrompt = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275text(1, "                          ");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const msg_r10 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275twoWayProperty("ngModel", msg_r10.content.aiPrompt);
  }
}
function ScriptEditorComponent_Conditional_52_For_16_Template(rf, ctx) {
  if (rf & 1) {
    const _r9 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 52)(1, "div", 58)(2, "div", 59)(3, "select", 60);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_For_16_Template_select_ngModelChange_3_listener($event) {
      const msg_r10 = \u0275\u0275restoreView(_r9).$implicit;
      \u0275\u0275twoWayBindingSet(msg_r10.roleId, $event) || (msg_r10.roleId = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275repeaterCreate(4, ScriptEditorComponent_Conditional_52_For_16_For_5_Template, 2, 3, "option", 61, _forTrack02);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(6, "div", 62)(7, "div", 63)(8, "select", 64);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_For_16_Template_select_ngModelChange_8_listener($event) {
      const msg_r10 = \u0275\u0275restoreView(_r9).$implicit;
      \u0275\u0275twoWayBindingSet(msg_r10.content.type, $event) || (msg_r10.content.type = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementStart(9, "option", 65);
    \u0275\u0275text(10, "\u56FA\u5B9A\u6587\u672C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "option", 66);
    \u0275\u0275text(12, "AI \u751F\u6210");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(13, "option", 67);
    \u0275\u0275text(14, "\u6A21\u677F\u8B8A\u91CF");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(15, "div", 68)(16, "span");
    \u0275\u0275text(17, "\u5EF6\u9072");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(18, "input", 69);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_For_16_Template_input_ngModelChange_18_listener($event) {
      const msg_r10 = \u0275\u0275restoreView(_r9).$implicit;
      \u0275\u0275twoWayBindingSet(msg_r10.timing.delayAfterPrevious, $event) || (msg_r10.timing.delayAfterPrevious = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "span");
    \u0275\u0275text(20, "\u79D2");
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(21, ScriptEditorComponent_Conditional_52_For_16_Conditional_21_Template, 3, 2);
    \u0275\u0275conditionalCreate(22, ScriptEditorComponent_Conditional_52_For_16_Conditional_22_Template, 2, 1, "textarea", 70);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "button", 71);
    \u0275\u0275listener("click", function ScriptEditorComponent_Conditional_52_For_16_Template_button_click_23_listener() {
      const \u0275$index_147_r14 = \u0275\u0275restoreView(_r9).$index;
      const stage_r6 = \u0275\u0275nextContext();
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.removeMessage(stage_r6, \u0275$index_147_r14));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(24, "svg", 54);
    \u0275\u0275element(25, "path", 72);
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const msg_r10 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(3);
    \u0275\u0275twoWayProperty("ngModel", msg_r10.roleId);
    \u0275\u0275advance();
    \u0275\u0275repeater(ctx_r2.availableRoles());
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", msg_r10.content.type);
    \u0275\u0275advance(10);
    \u0275\u0275twoWayProperty("ngModel", msg_r10.timing.delayAfterPrevious);
    \u0275\u0275advance(3);
    \u0275\u0275conditional(msg_r10.content.type === "text" || msg_r10.content.type === "template" ? 21 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(msg_r10.content.type === "ai_generate" ? 22 : -1);
  }
}
function ScriptEditorComponent_Conditional_52_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 12)(1, "div", 43)(2, "input", 44);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_Template_input_ngModelChange_2_listener($event) {
      const stage_r6 = \u0275\u0275restoreView(_r5);
      \u0275\u0275twoWayBindingSet(stage_r6.name, $event) || (stage_r6.name = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "select", 45);
    \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Conditional_52_Template_select_ngModelChange_3_listener($event) {
      const stage_r6 = \u0275\u0275restoreView(_r5);
      \u0275\u0275twoWayBindingSet(stage_r6.trigger.type, $event) || (stage_r6.trigger.type = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementStart(4, "option", 46);
    \u0275\u0275text(5, "\u6642\u9593\u89F8\u767C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "option", 47);
    \u0275\u0275text(7, "\u6D88\u606F\u89F8\u767C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "option", 48);
    \u0275\u0275text(9, "\u95DC\u9375\u8A5E\u89F8\u767C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "option", 49);
    \u0275\u0275text(11, "\u624B\u52D5\u89F8\u767C");
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(12, ScriptEditorComponent_Conditional_52_Conditional_12_Template, 6, 1, "div", 50);
    \u0275\u0275conditionalCreate(13, ScriptEditorComponent_Conditional_52_Conditional_13_Template, 4, 1, "div", 50);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "div", 51);
    \u0275\u0275repeaterCreate(15, ScriptEditorComponent_Conditional_52_For_16_Template, 26, 5, "div", 52, _forTrack02);
    \u0275\u0275elementStart(17, "button", 53);
    \u0275\u0275listener("click", function ScriptEditorComponent_Conditional_52_Template_button_click_17_listener() {
      const stage_r6 = \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.addMessage(stage_r6));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(18, "svg", 54);
    \u0275\u0275element(19, "path", 55);
    \u0275\u0275elementEnd();
    \u0275\u0275text(20, " \u6DFB\u52A0\u6D88\u606F ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const stage_r6 = ctx;
    \u0275\u0275advance(2);
    \u0275\u0275twoWayProperty("ngModel", stage_r6.name);
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", stage_r6.trigger.type);
    \u0275\u0275advance(9);
    \u0275\u0275conditional(stage_r6.trigger.type === "time" ? 12 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(stage_r6.trigger.type === "keyword" ? 13 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275repeater(stage_r6.messages);
  }
}
function ScriptEditorComponent_Conditional_53_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 30)(1, "div", 76);
    \u0275\u0275text(2, "\u{1F4DD}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 77);
    \u0275\u0275text(4, "\u9078\u64C7\u6216\u5275\u5EFA\u4E00\u500B\u968E\u6BB5");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 78);
    \u0275\u0275text(6, "\u5728\u5DE6\u5074\u9078\u64C7\u968E\u6BB5\u958B\u59CB\u7DE8\u8F2F");
    \u0275\u0275elementEnd()();
  }
}
function ScriptEditorComponent_Conditional_54_For_5_For_4_Conditional_7_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 87);
    \u0275\u0275text(1, "[AI \u751F\u6210]");
    \u0275\u0275elementEnd();
  }
}
function ScriptEditorComponent_Conditional_54_For_5_For_4_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0);
  }
  if (rf & 2) {
    const msg_r15 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275textInterpolate1(" ", msg_r15.content.text || "...", " ");
  }
}
function ScriptEditorComponent_Conditional_54_For_5_For_4_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 83)(1, "div", 84);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 62)(4, "div", 85);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 86);
    \u0275\u0275conditionalCreate(7, ScriptEditorComponent_Conditional_54_For_5_For_4_Conditional_7_Template, 2, 0, "span", 87)(8, ScriptEditorComponent_Conditional_54_For_5_For_4_Conditional_8_Template, 1, 1);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    let tmp_21_0;
    let tmp_22_0;
    const msg_r15 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r2.getRoleIcon(((tmp_21_0 = ctx_r2.getRoleById(msg_r15.roleId)) == null ? null : tmp_21_0.type) || "custom"), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ((tmp_22_0 = ctx_r2.getRoleById(msg_r15.roleId)) == null ? null : tmp_22_0.name) || "\u672A\u77E5\u89D2\u8272", " ");
    \u0275\u0275advance(2);
    \u0275\u0275conditional(msg_r15.content.type === "ai_generate" ? 7 : 8);
  }
}
function ScriptEditorComponent_Conditional_54_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 81)(1, "div", 82);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(3, ScriptEditorComponent_Conditional_54_For_5_For_4_Template, 9, 3, "div", 83, _forTrack02);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const stage_r16 = ctx.$implicit;
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(stage_r16.name);
    \u0275\u0275advance();
    \u0275\u0275repeater(stage_r16.messages);
  }
}
function ScriptEditorComponent_Conditional_54_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 31)(1, "h4", 79);
    \u0275\u0275text(2, "\u5C0D\u8A71\u9810\u89BD");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 80);
    \u0275\u0275repeaterCreate(4, ScriptEditorComponent_Conditional_54_For_5_Template, 5, 1, "div", 81, _forTrack02);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r2.editData.stages);
  }
}
var ScriptEditorComponent = class _ScriptEditorComponent {
  constructor() {
    this.multiRoleService = inject(MultiRoleService);
    this.script = input(null, ...ngDevMode ? [{ debugName: "script" }] : []);
    this.saved = output();
    this.cancelled = output();
    this.showPreview = signal(false, ...ngDevMode ? [{ debugName: "showPreview" }] : []);
    this.selectedStageIndex = signal(-1, ...ngDevMode ? [{ debugName: "selectedStageIndex" }] : []);
    this.editData = this.getDefaultData();
    this.isNew = computed(() => !this.script(), ...ngDevMode ? [{ debugName: "isNew" }] : []);
    this.availableRoles = computed(() => this.multiRoleService.roles(), ...ngDevMode ? [{ debugName: "availableRoles" }] : []);
    this.currentStage = computed(() => {
      const index = this.selectedStageIndex();
      if (index >= 0 && index < this.editData.stages.length) {
        return this.editData.stages[index];
      }
      return null;
    }, ...ngDevMode ? [{ debugName: "currentStage" }] : []);
  }
  ngOnInit() {
    const script = this.script();
    if (script) {
      this.loadScript(script);
    }
  }
  getDefaultData() {
    return {
      name: "",
      description: "",
      scenario: "custom",
      stages: [],
      requiredRoles: [],
      minRoleCount: 1,
      stats: {
        useCount: 0,
        successCount: 0,
        avgDuration: 0,
        conversionRate: 0
      },
      isActive: true
    };
  }
  loadScript(script) {
    this.editData = __spreadProps(__spreadValues({}, script), {
      stages: script.stages.map((s) => __spreadProps(__spreadValues({}, s), {
        messages: s.messages.map((m) => __spreadProps(__spreadValues({}, m), { content: __spreadValues({}, m.content), timing: __spreadValues({}, m.timing) }))
      }))
    });
    if (this.editData.stages.length > 0) {
      this.selectedStageIndex.set(0);
    }
  }
  getRoleIcon(type) {
    return ROLE_TYPE_META[type]?.icon || "\u{1F3AD}";
  }
  getRoleById(roleId) {
    return this.availableRoles().find((r) => r.id === roleId);
  }
  // ========== ÈöéÊÆµÊìç‰Ωú ==========
  selectStage(index) {
    this.selectedStageIndex.set(index);
  }
  addStage() {
    const newStage = {
      id: `stage_${Date.now()}`,
      name: `\u968E\u6BB5 ${this.editData.stages.length + 1}`,
      order: this.editData.stages.length,
      trigger: {
        type: "time",
        delaySeconds: 0
      },
      messages: []
    };
    this.editData.stages.push(newStage);
    this.selectedStageIndex.set(this.editData.stages.length - 1);
  }
  removeStage(index) {
    this.editData.stages.splice(index, 1);
    if (this.selectedStageIndex() >= this.editData.stages.length) {
      this.selectedStageIndex.set(Math.max(0, this.editData.stages.length - 1));
    }
  }
  // ========== Ê∂àÊÅØÊìç‰Ωú ==========
  addMessage(stage) {
    const roles = this.availableRoles();
    const defaultRoleId = roles.length > 0 ? roles[0].id : "";
    const newMessage = {
      id: `msg_${Date.now()}`,
      roleId: defaultRoleId,
      content: {
        type: "text",
        text: ""
      },
      timing: {
        delayAfterPrevious: 5
      }
    };
    stage.messages.push(newMessage);
  }
  removeMessage(stage, index) {
    stage.messages.splice(index, 1);
  }
  // ========== ÂÖ∂‰ªñ ==========
  togglePreview() {
    this.showPreview.update((v) => !v);
  }
  getTotalMessages() {
    return this.editData.stages.reduce((sum, stage) => sum + stage.messages.length, 0);
  }
  isFormValid() {
    return !!(this.editData.name?.trim() && this.editData.stages.length > 0 && this.editData.stages.some((s) => s.messages.length > 0));
  }
  save() {
    if (!this.isFormValid())
      return;
    const roleIds = /* @__PURE__ */ new Set();
    const roles = this.availableRoles();
    this.editData.stages.forEach((stage) => {
      stage.messages.forEach((msg) => {
        if (msg.roleId) {
          const role = roles.find((r) => r.id === msg.roleId);
          if (role)
            roleIds.add(role.type);
        }
      });
    });
    this.editData.requiredRoles = Array.from(roleIds);
    const totalSeconds = this.editData.stages.reduce((sum, stage) => {
      const stageDelay = stage.trigger?.delaySeconds || 0;
      const messageDelays = stage.messages.reduce((s, m) => s + (m.timing.delayAfterPrevious || 0), 0);
      return sum + stageDelay + messageDelays;
    }, 0);
    if (this.editData.stats) {
      this.editData.stats.avgDuration = Math.ceil(totalSeconds / 60);
    }
    const scriptData = __spreadProps(__spreadValues({}, this.editData), {
      updatedAt: (/* @__PURE__ */ new Date()).toISOString()
    });
    if (this.isNew()) {
      const id = this.multiRoleService.addScript(scriptData);
      const newScript = this.multiRoleService.scripts().find((s) => s.id === id);
      if (newScript) {
        this.saved.emit(newScript);
      }
    } else {
      this.multiRoleService.updateScript(this.script().id, scriptData);
      this.saved.emit(__spreadValues(__spreadValues({}, this.script()), scriptData));
    }
  }
  cancel() {
    this.cancelled.emit();
  }
  // ËºîÂä©ÊñπÊ≥ï
  getKeywordsString(stage) {
    return stage.trigger?.keywords?.join(", ") || "";
  }
  setKeywords(stage, value) {
    stage.trigger.keywords = value.split(",").map((s) => s.trim()).filter((s) => s);
  }
  static {
    this.\u0275fac = function ScriptEditorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _ScriptEditorComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _ScriptEditorComponent, selectors: [["app-script-editor"]], inputs: { script: [1, "script"] }, outputs: { saved: "saved", cancelled: "cancelled" }, decls: 66, vars: 12, consts: [[1, "script-editor", "fixed", "inset-0", "bg-black/60", "backdrop-blur-sm", "flex", "items-center", "justify-center", "z-50"], [1, "bg-slate-800", "rounded-2xl", "w-full", "max-w-4xl", "max-h-[90vh]", "overflow-hidden", "shadow-xl", "border", "border-slate-700"], [1, "p-6", "border-b", "border-slate-700", "flex", "items-center", "justify-between"], [1, "text-xl", "font-bold", "text-white", "flex", "items-center", "gap-3"], [1, "text-2xl"], [1, "flex", "items-center", "gap-4"], [1, "px-4", "py-2", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", "transition-colors", "flex", "items-center", "gap-2", 3, "click"], [1, "text-slate-400", "hover:text-white", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-6", "h-6"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M6 18L18 6M6 6l12 12"], [1, "flex", "h-[calc(90vh-180px)]"], [1, "w-72", "border-r", "border-slate-700", "p-4", "overflow-y-auto"], [1, "mb-6"], [1, "text-sm", "font-semibold", "text-slate-400", "mb-3"], [1, "mb-3"], [1, "text-xs", "text-slate-500", "block", "mb-1"], ["type", "text", "placeholder", "\u5982\uFF1AVIP\u5BA2\u6236\u8F49\u5316\u5287\u672C", 1, "w-full", "px-3", "py-2", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "text-sm", 3, "ngModelChange", "ngModel"], ["rows", "2", "placeholder", "\u5287\u672C\u7528\u9014...", 1, "w-full", "px-3", "py-2", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "text-sm", "resize-none", 3, "ngModelChange", "ngModel"], [1, "w-full", "px-3", "py-2", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "text-sm", 3, "ngModelChange", "ngModel"], ["value", "high_intent_conversion"], ["value", "product_introduction"], ["value", "objection_handling"], ["value", "custom"], [1, "flex", "items-center", "justify-between", "mb-3"], [1, "text-sm", "font-semibold", "text-slate-400"], [1, "px-2", "py-1", "bg-purple-500/20", "text-purple-400", "rounded", "text-xs", "hover:bg-purple-500/30", 3, "click"], [1, "space-y-2"], [1, "p-3", "rounded-lg", "cursor-pointer", "transition-all", 3, "bg-purple-500/20", "border-purple-500", "border", "bg-slate-700/50"], [1, "text-center", "py-8", "text-slate-500", "text-sm"], [1, "flex-1", "p-6", "overflow-y-auto"], [1, "flex", "flex-col", "items-center", "justify-center", "h-full", "text-slate-500"], [1, "w-80", "border-l", "border-slate-700", "p-4", "bg-slate-900/50", "overflow-y-auto"], [1, "p-6", "border-t", "border-slate-700", "flex", "items-center", "justify-between"], [1, "flex", "items-center", "gap-4", "text-sm", "text-slate-400"], [1, "flex", "gap-3"], [1, "px-6", "py-2.5", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", "transition-colors", 3, "click"], [1, "px-6", "py-2.5", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "rounded-lg", "hover:opacity-90", "transition-opacity", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "click", "disabled"], [1, "p-3", "rounded-lg", "cursor-pointer", "transition-all", 3, "click"], [1, "flex", "items-center", "justify-between", "mb-1"], [1, "text-sm", "font-medium"], [1, "text-red-400", "hover:text-red-300", "opacity-0", "group-hover:opacity-100", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-4", "h-4"], [1, "text-xs", "text-slate-500"], [1, "flex", "items-center", "gap-4", "mb-4"], ["type", "text", "placeholder", "\u968E\u6BB5\u540D\u7A31", 1, "px-4", "py-2", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "flex-1", 3, "ngModelChange", "ngModel"], [1, "px-3", "py-2", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "text-sm", 3, "ngModelChange", "ngModel"], ["value", "time"], ["value", "message"], ["value", "keyword"], ["value", "manual"], [1, "flex", "items-center", "gap-2", "text-sm", "text-slate-400", "mb-4"], [1, "space-y-4"], [1, "bg-slate-700/50", "rounded-xl", "p-4", "border", "border-slate-600/50"], [1, "w-full", "py-3", "border-2", "border-dashed", "border-slate-600", "rounded-xl", "text-slate-400", "hover:border-purple-500", "hover:text-purple-400", "transition-colors", "flex", "items-center", "justify-center", "gap-2", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-5", "h-5"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M12 4v16m8-8H4"], ["type", "number", "min", "0", 1, "w-20", "px-2", "py-1", "bg-slate-700", "border", "border-slate-600", "rounded", "text-white", "text-center", 3, "ngModelChange", "ngModel"], ["type", "text", "placeholder", "\u8CFC\u8CB7, \u50F9\u683C, \u512A\u60E0", 1, "flex-1", "px-2", "py-1", "bg-slate-700", "border", "border-slate-600", "rounded", "text-white", 3, "ngModelChange", "ngModel"], [1, "flex", "items-start", "gap-4"], [1, "w-28"], [1, "w-full", "px-2", "py-1.5", "bg-slate-600", "border", "border-slate-500", "rounded", "text-white", "text-sm", 3, "ngModelChange", "ngModel"], [3, "value"], [1, "flex-1"], [1, "flex", "items-center", "gap-2", "mb-2"], [1, "px-2", "py-1", "bg-slate-600", "border", "border-slate-500", "rounded", "text-white", "text-xs", 3, "ngModelChange", "ngModel"], ["value", "text"], ["value", "ai_generate"], ["value", "template"], [1, "flex", "items-center", "gap-2", "text-xs", "text-slate-400"], ["type", "number", "min", "0", 1, "w-12", "px-1", "py-0.5", "bg-slate-600", "border", "border-slate-500", "rounded", "text-white", "text-center", 3, "ngModelChange", "ngModel"], ["rows", "2", "placeholder", "AI \u751F\u6210\u6307\u4EE4\uFF0C\u5982\uFF1A\u6839\u64DA\u5C0D\u8A71\u4E0A\u4E0B\u6587\u56DE\u7B54\u5BA2\u6236\u554F\u984C...", 1, "w-full", "px-3", "py-2", "bg-slate-600", "border", "border-slate-500", "rounded-lg", "text-white", "text-sm", "resize-none", 3, "ngModel"], [1, "text-red-400", "hover:text-red-300", "mt-1", 3, "click"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"], ["rows", "2", "placeholder", "\u8F38\u5165\u6D88\u606F\u5167\u5BB9...", 1, "w-full", "px-3", "py-2", "bg-slate-600", "border", "border-slate-500", "rounded-lg", "text-white", "text-sm", "resize-none", 3, "ngModelChange", "ngModel"], [1, "text-xs", "text-slate-500", "mt-1"], ["rows", "2", "placeholder", "AI \u751F\u6210\u6307\u4EE4\uFF0C\u5982\uFF1A\u6839\u64DA\u5C0D\u8A71\u4E0A\u4E0B\u6587\u56DE\u7B54\u5BA2\u6236\u554F\u984C...", 1, "w-full", "px-3", "py-2", "bg-slate-600", "border", "border-slate-500", "rounded-lg", "text-white", "text-sm", "resize-none", 3, "ngModelChange", "ngModel"], [1, "text-5xl", "mb-4"], [1, "text-lg", "mb-2"], [1, "text-sm"], [1, "text-sm", "font-semibold", "text-slate-400", "mb-4"], [1, "space-y-3"], [1, "mb-4"], [1, "text-xs", "text-purple-400", "mb-2"], [1, "flex", "gap-2", "mb-2"], [1, "w-8", "h-8", "rounded-full", "bg-gradient-to-br", "from-purple-500", "to-pink-500", "flex", "items-center", "justify-center", "text-white", "text-xs", "flex-shrink-0"], [1, "text-xs", "text-slate-400", "mb-0.5"], [1, "bg-slate-700", "rounded-lg", "px-3", "py-2", "text-sm", "text-white"], [1, "text-purple-400"]], template: function ScriptEditorComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "h2", 3)(4, "span", 4);
        \u0275\u0275text(5, "\u{1F4DD}");
        \u0275\u0275elementEnd();
        \u0275\u0275text(6);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(7, "div", 5)(8, "button", 6);
        \u0275\u0275listener("click", function ScriptEditorComponent_Template_button_click_8_listener() {
          return ctx.togglePreview();
        });
        \u0275\u0275elementStart(9, "span");
        \u0275\u0275text(10, "\u{1F441}");
        \u0275\u0275elementEnd();
        \u0275\u0275text(11);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(12, "button", 7);
        \u0275\u0275listener("click", function ScriptEditorComponent_Template_button_click_12_listener() {
          return ctx.cancel();
        });
        \u0275\u0275namespaceSVG();
        \u0275\u0275elementStart(13, "svg", 8);
        \u0275\u0275element(14, "path", 9);
        \u0275\u0275elementEnd()()()();
        \u0275\u0275namespaceHTML();
        \u0275\u0275elementStart(15, "div", 10)(16, "div", 11)(17, "div", 12)(18, "h4", 13);
        \u0275\u0275text(19, "\u5287\u672C\u4FE1\u606F");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(20, "div", 14)(21, "label", 15);
        \u0275\u0275text(22, "\u5287\u672C\u540D\u7A31");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(23, "input", 16);
        \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Template_input_ngModelChange_23_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.name, $event) || (ctx.editData.name = $event);
          return $event;
        });
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(24, "div", 14)(25, "label", 15);
        \u0275\u0275text(26, "\u63CF\u8FF0");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(27, "textarea", 17);
        \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Template_textarea_ngModelChange_27_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.description, $event) || (ctx.editData.description = $event);
          return $event;
        });
        \u0275\u0275text(28, "                ");
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(29, "div")(30, "label", 15);
        \u0275\u0275text(31, "\u9069\u7528\u5834\u666F");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(32, "select", 18);
        \u0275\u0275twoWayListener("ngModelChange", function ScriptEditorComponent_Template_select_ngModelChange_32_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.editData.scenario, $event) || (ctx.editData.scenario = $event);
          return $event;
        });
        \u0275\u0275elementStart(33, "option", 19);
        \u0275\u0275text(34, "\u9AD8\u610F\u5411\u8F49\u5316");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(35, "option", 20);
        \u0275\u0275text(36, "\u7522\u54C1\u4ECB\u7D39");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(37, "option", 21);
        \u0275\u0275text(38, "\u7570\u8B70\u8655\u7406");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(39, "option", 22);
        \u0275\u0275text(40, "\u81EA\u5B9A\u7FA9");
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(41, "div")(42, "div", 23)(43, "h4", 24);
        \u0275\u0275text(44, "\u968E\u6BB5\u5217\u8868");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(45, "button", 25);
        \u0275\u0275listener("click", function ScriptEditorComponent_Template_button_click_45_listener() {
          return ctx.addStage();
        });
        \u0275\u0275text(46, " + \u6DFB\u52A0 ");
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(47, "div", 26);
        \u0275\u0275repeaterCreate(48, ScriptEditorComponent_For_49_Template, 9, 15, "div", 27, _forTrack02);
        \u0275\u0275conditionalCreate(50, ScriptEditorComponent_Conditional_50_Template, 2, 0, "div", 28);
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(51, "div", 29);
        \u0275\u0275conditionalCreate(52, ScriptEditorComponent_Conditional_52_Template, 21, 4)(53, ScriptEditorComponent_Conditional_53_Template, 7, 0, "div", 30);
        \u0275\u0275elementEnd();
        \u0275\u0275conditionalCreate(54, ScriptEditorComponent_Conditional_54_Template, 6, 0, "div", 31);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(55, "div", 32)(56, "div", 33)(57, "span");
        \u0275\u0275text(58);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(59, "span");
        \u0275\u0275text(60);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(61, "div", 34)(62, "button", 35);
        \u0275\u0275listener("click", function ScriptEditorComponent_Template_button_click_62_listener() {
          return ctx.cancel();
        });
        \u0275\u0275text(63, " \u53D6\u6D88 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(64, "button", 36);
        \u0275\u0275listener("click", function ScriptEditorComponent_Template_button_click_64_listener() {
          return ctx.save();
        });
        \u0275\u0275text(65);
        \u0275\u0275elementEnd()()()()();
      }
      if (rf & 2) {
        let tmp_7_0;
        \u0275\u0275advance(6);
        \u0275\u0275textInterpolate1(" ", ctx.isNew() ? "\u5275\u5EFA\u65B0\u5287\u672C" : "\u7DE8\u8F2F\u5287\u672C", " ");
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate1(" ", ctx.showPreview() ? "\u95DC\u9589\u9810\u89BD" : "\u9810\u89BD", " ");
        \u0275\u0275advance(12);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.name);
        \u0275\u0275advance(4);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.description);
        \u0275\u0275advance(5);
        \u0275\u0275twoWayProperty("ngModel", ctx.editData.scenario);
        \u0275\u0275advance(16);
        \u0275\u0275repeater(ctx.editData.stages);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.editData.stages.length === 0 ? 50 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275conditional((tmp_7_0 = ctx.currentStage()) ? 52 : 53, tmp_7_0);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.showPreview() ? 54 : -1);
        \u0275\u0275advance(4);
        \u0275\u0275textInterpolate1("", ctx.editData.stages.length, " \u500B\u968E\u6BB5");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1("", ctx.getTotalMessages(), " \u689D\u6D88\u606F");
        \u0275\u0275advance(4);
        \u0275\u0275property("disabled", !ctx.isFormValid());
        \u0275\u0275advance();
        \u0275\u0275textInterpolate1(" ", ctx.isNew() ? "\u5275\u5EFA\u5287\u672C" : "\u4FDD\u5B58\u5287\u672C", " ");
      }
    }, dependencies: [CommonModule, FormsModule, NgSelectOption, \u0275NgSelectMultipleOption, DefaultValueAccessor, NumberValueAccessor, SelectControlValueAccessor, NgControlStatus, MinValidator, NgModel], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(ScriptEditorComponent, [{
    type: Component,
    args: [{
      selector: "app-script-editor",
      standalone: true,
      imports: [CommonModule, FormsModule],
      template: `
    <div class="script-editor fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
      <div class="bg-slate-800 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-xl border border-slate-700">
        <!-- \u6A19\u984C\u6B04 -->
        <div class="p-6 border-b border-slate-700 flex items-center justify-between">
          <h2 class="text-xl font-bold text-white flex items-center gap-3">
            <span class="text-2xl">\u{1F4DD}</span>
            {{ isNew() ? '\u5275\u5EFA\u65B0\u5287\u672C' : '\u7DE8\u8F2F\u5287\u672C' }}
          </h2>
          <div class="flex items-center gap-4">
            <!-- \u9810\u89BD\u6309\u9215 -->
            <button (click)="togglePreview()"
                    class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-colors flex items-center gap-2">
              <span>\u{1F441}</span> {{ showPreview() ? '\u95DC\u9589\u9810\u89BD' : '\u9810\u89BD' }}
            </button>
            <button (click)="cancel()" class="text-slate-400 hover:text-white">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- \u4E3B\u9AD4\u5167\u5BB9 -->
        <div class="flex h-[calc(90vh-180px)]">
          <!-- \u5DE6\u5074\uFF1A\u5287\u672C\u4FE1\u606F\u548C\u968E\u6BB5\u5217\u8868 -->
          <div class="w-72 border-r border-slate-700 p-4 overflow-y-auto">
            <!-- \u57FA\u790E\u4FE1\u606F -->
            <div class="mb-6">
              <h4 class="text-sm font-semibold text-slate-400 mb-3">\u5287\u672C\u4FE1\u606F</h4>
              
              <div class="mb-3">
                <label class="text-xs text-slate-500 block mb-1">\u5287\u672C\u540D\u7A31</label>
                <input type="text"
                       [(ngModel)]="editData.name"
                       placeholder="\u5982\uFF1AVIP\u5BA2\u6236\u8F49\u5316\u5287\u672C"
                       class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm">
              </div>
              
              <div class="mb-3">
                <label class="text-xs text-slate-500 block mb-1">\u63CF\u8FF0</label>
                <textarea rows="2"
                          [(ngModel)]="editData.description"
                          placeholder="\u5287\u672C\u7528\u9014..."
                          class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm resize-none">
                </textarea>
              </div>
              
              <div>
                <label class="text-xs text-slate-500 block mb-1">\u9069\u7528\u5834\u666F</label>
                <select [(ngModel)]="editData.scenario"
                        class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm">
                  <option value="high_intent_conversion">\u9AD8\u610F\u5411\u8F49\u5316</option>
                  <option value="product_introduction">\u7522\u54C1\u4ECB\u7D39</option>
                  <option value="objection_handling">\u7570\u8B70\u8655\u7406</option>
                  <option value="custom">\u81EA\u5B9A\u7FA9</option>
                </select>
              </div>
            </div>
            
            <!-- \u968E\u6BB5\u5217\u8868 -->
            <div>
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-semibold text-slate-400">\u968E\u6BB5\u5217\u8868</h4>
                <button (click)="addStage()"
                        class="px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs hover:bg-purple-500/30">
                  + \u6DFB\u52A0
                </button>
              </div>
              
              <div class="space-y-2">
                @for (stage of editData.stages; track stage.id; let i = $index) {
                  <div (click)="selectStage(i)"
                       class="p-3 rounded-lg cursor-pointer transition-all"
                       [class.bg-purple-500/20]="selectedStageIndex() === i"
                       [class.border-purple-500]="selectedStageIndex() === i"
                       [class.border]="selectedStageIndex() === i"
                       [class.bg-slate-700/50]="selectedStageIndex() !== i">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium"
                            [class.text-purple-400]="selectedStageIndex() === i"
                            [class.text-white]="selectedStageIndex() !== i">
                        {{ i + 1 }}. {{ stage.name }}
                      </span>
                      <button (click)="removeStage(i); $event.stopPropagation()"
                              class="text-red-400 hover:text-red-300 opacity-0 group-hover:opacity-100">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                      </button>
                    </div>
                    <div class="text-xs text-slate-500">
                      {{ stage.messages.length }} \u689D\u6D88\u606F
                    </div>
                  </div>
                }
                
                @if (editData.stages.length === 0) {
                  <div class="text-center py-8 text-slate-500 text-sm">
                    \u9EDE\u64CA\u4E0A\u65B9\u6DFB\u52A0\u7B2C\u4E00\u500B\u968E\u6BB5
                  </div>
                }
              </div>
            </div>
          </div>
          
          <!-- \u4E2D\u9593\uFF1A\u968E\u6BB5\u7DE8\u8F2F\u5340 -->
          <div class="flex-1 p-6 overflow-y-auto">
            @if (currentStage(); as stage) {
              <!-- \u968E\u6BB5\u4FE1\u606F -->
              <div class="mb-6">
                <div class="flex items-center gap-4 mb-4">
                  <input type="text"
                         [(ngModel)]="stage.name"
                         placeholder="\u968E\u6BB5\u540D\u7A31"
                         class="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white flex-1">
                  
                  <select [(ngModel)]="stage.trigger.type"
                          class="px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-sm">
                    <option value="time">\u6642\u9593\u89F8\u767C</option>
                    <option value="message">\u6D88\u606F\u89F8\u767C</option>
                    <option value="keyword">\u95DC\u9375\u8A5E\u89F8\u767C</option>
                    <option value="manual">\u624B\u52D5\u89F8\u767C</option>
                  </select>
                </div>
                
                @if (stage.trigger.type === 'time') {
                  <div class="flex items-center gap-2 text-sm text-slate-400 mb-4">
                    <span>\u5EF6\u9072</span>
                    <input type="number"
                           [(ngModel)]="stage.trigger.delaySeconds"
                           min="0"
                           class="w-20 px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-center">
                    <span>\u79D2\u5F8C\u57F7\u884C</span>
                  </div>
                }
                
                @if (stage.trigger.type === 'keyword') {
                  <div class="flex items-center gap-2 text-sm text-slate-400 mb-4">
                    <span>\u95DC\u9375\u8A5E\uFF08\u9017\u865F\u5206\u9694\uFF09</span>
                    <input type="text"
                           [ngModel]="getKeywordsString(stage)"
                           (ngModelChange)="setKeywords(stage, $event)"
                           placeholder="\u8CFC\u8CB7, \u50F9\u683C, \u512A\u60E0"
                           class="flex-1 px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white">
                  </div>
                }
              </div>
              
              <!-- \u6D88\u606F\u5217\u8868 -->
              <div class="space-y-4">
                @for (msg of stage.messages; track msg.id; let j = $index) {
                  <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-600/50">
                    <div class="flex items-start gap-4">
                      <!-- \u89D2\u8272\u9078\u64C7 -->
                      <div class="w-28">
                        <select [(ngModel)]="msg.roleId"
                                class="w-full px-2 py-1.5 bg-slate-600 border border-slate-500 rounded text-white text-sm">
                          @for (role of availableRoles(); track role.id) {
                            <option [value]="role.id">
                              {{ getRoleIcon(role.type) }} {{ role.name }}
                            </option>
                          }
                        </select>
                      </div>
                      
                      <!-- \u6D88\u606F\u5167\u5BB9 -->
                      <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                          <select [(ngModel)]="msg.content.type"
                                  class="px-2 py-1 bg-slate-600 border border-slate-500 rounded text-white text-xs">
                            <option value="text">\u56FA\u5B9A\u6587\u672C</option>
                            <option value="ai_generate">AI \u751F\u6210</option>
                            <option value="template">\u6A21\u677F\u8B8A\u91CF</option>
                          </select>
                          
                          <div class="flex items-center gap-2 text-xs text-slate-400">
                            <span>\u5EF6\u9072</span>
                            <input type="number"
                                   [(ngModel)]="msg.timing.delayAfterPrevious"
                                   min="0"
                                   class="w-12 px-1 py-0.5 bg-slate-600 border border-slate-500 rounded text-white text-center">
                            <span>\u79D2</span>
                          </div>
                        </div>
                        
                        @if (msg.content.type === 'text' || msg.content.type === 'template') {
                          <textarea rows="2"
                                    [(ngModel)]="msg.content.text"
                                    placeholder="\u8F38\u5165\u6D88\u606F\u5167\u5BB9..."
                                    class="w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-sm resize-none">
                          </textarea>
                          @if (msg.content.type === 'template') {
                            <div class="text-xs text-slate-500 mt-1">
                              \u53EF\u7528\u8B8A\u91CF: {{ '{' }}\u5BA2\u6236\u540D{{ '}' }}, {{ '{' }}\u7522\u54C1\u540D{{ '}' }}, {{ '{' }}\u50F9\u683C{{ '}' }}
                            </div>
                          }
                        }
                        
                        @if (msg.content.type === 'ai_generate') {
                          <textarea rows="2"
                                    [(ngModel)]="msg.content.aiPrompt"
                                    placeholder="AI \u751F\u6210\u6307\u4EE4\uFF0C\u5982\uFF1A\u6839\u64DA\u5C0D\u8A71\u4E0A\u4E0B\u6587\u56DE\u7B54\u5BA2\u6236\u554F\u984C..."
                                    class="w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white text-sm resize-none">
                          </textarea>
                        }
                      </div>
                      
                      <!-- \u522A\u9664\u6309\u9215 -->
                      <button (click)="removeMessage(stage, j)"
                              class="text-red-400 hover:text-red-300 mt-1">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                        </svg>
                      </button>
                    </div>
                  </div>
                }
                
                <!-- \u6DFB\u52A0\u6D88\u606F\u6309\u9215 -->
                <button (click)="addMessage(stage)"
                        class="w-full py-3 border-2 border-dashed border-slate-600 rounded-xl text-slate-400 
                               hover:border-purple-500 hover:text-purple-400 transition-colors flex items-center justify-center gap-2">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  \u6DFB\u52A0\u6D88\u606F
                </button>
              </div>
            } @else {
              <div class="flex flex-col items-center justify-center h-full text-slate-500">
                <div class="text-5xl mb-4">\u{1F4DD}</div>
                <div class="text-lg mb-2">\u9078\u64C7\u6216\u5275\u5EFA\u4E00\u500B\u968E\u6BB5</div>
                <div class="text-sm">\u5728\u5DE6\u5074\u9078\u64C7\u968E\u6BB5\u958B\u59CB\u7DE8\u8F2F</div>
              </div>
            }
          </div>
          
          <!-- \u53F3\u5074\uFF1A\u9810\u89BD\u5340\uFF08\u53EF\u9078\u986F\u793A\uFF09 -->
          @if (showPreview()) {
            <div class="w-80 border-l border-slate-700 p-4 bg-slate-900/50 overflow-y-auto">
              <h4 class="text-sm font-semibold text-slate-400 mb-4">\u5C0D\u8A71\u9810\u89BD</h4>
              
              <div class="space-y-3">
                @for (stage of editData.stages; track stage.id) {
                  <div class="mb-4">
                    <div class="text-xs text-purple-400 mb-2">{{ stage.name }}</div>
                    
                    @for (msg of stage.messages; track msg.id) {
                      <div class="flex gap-2 mb-2">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 
                                    flex items-center justify-center text-white text-xs flex-shrink-0">
                          {{ getRoleIcon(getRoleById(msg.roleId)?.type || 'custom') }}
                        </div>
                        <div class="flex-1">
                          <div class="text-xs text-slate-400 mb-0.5">
                            {{ getRoleById(msg.roleId)?.name || '\u672A\u77E5\u89D2\u8272' }}
                          </div>
                          <div class="bg-slate-700 rounded-lg px-3 py-2 text-sm text-white">
                            @if (msg.content.type === 'ai_generate') {
                              <span class="text-purple-400">[AI \u751F\u6210]</span>
                            } @else {
                              {{ msg.content.text || '...' }}
                            }
                          </div>
                        </div>
                      </div>
                    }
                  </div>
                }
              </div>
            </div>
          }
        </div>
        
        <!-- \u5E95\u90E8\u64CD\u4F5C -->
        <div class="p-6 border-t border-slate-700 flex items-center justify-between">
          <div class="flex items-center gap-4 text-sm text-slate-400">
            <span>{{ editData.stages.length }} \u500B\u968E\u6BB5</span>
            <span>{{ getTotalMessages() }} \u689D\u6D88\u606F</span>
          </div>
          
          <div class="flex gap-3">
            <button (click)="cancel()"
                    class="px-6 py-2.5 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-colors">
              \u53D6\u6D88
            </button>
            <button (click)="save()"
                    [disabled]="!isFormValid()"
                    class="px-6 py-2.5 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg 
                           hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed">
              {{ isNew() ? '\u5275\u5EFA\u5287\u672C' : '\u4FDD\u5B58\u5287\u672C' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  `
    }]
  }], null, { script: [{ type: Input, args: [{ isSignal: true, alias: "script", required: false }] }], saved: [{ type: Output, args: ["saved"] }], cancelled: [{ type: Output, args: ["cancelled"] }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(ScriptEditorComponent, { className: "ScriptEditorComponent", filePath: "src/multi-role/components/script-editor.component.ts", lineNumber: 323 });
})();

// src/multi-role/components/collaboration-dashboard.component.ts
var _c0 = ["conversationContainer"];
var _c1 = () => [];
var _forTrack03 = ($index, $item) => $item.date;
var _forTrack1 = ($index, $item) => $item.id;
var _forTrack2 = ($index, $item) => $item.timestamp;
function CollaborationDashboardComponent_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 2)(1, "div", 50)(2, "div", 51)(3, "div", 52);
    \u0275\u0275text(4, " \u{1F3AF} ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 53)(6, "div", 54);
    \u0275\u0275text(7, "\u9AD8\u8F49\u5316\u4FE1\u865F!");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div", 55)(9, "span", 56);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(11, "div", 57);
    \u0275\u0275text(12);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(13, "div", 58)(14, "button", 59);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_1_Template_button_click_14_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.focusOnUser(ctx_r1.conversionAlertData().userId));
    });
    \u0275\u0275text(15, " \u67E5\u770B\u5C0D\u8A71 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "button", 60);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_1_Template_button_click_16_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.dismissConversionAlert());
    });
    \u0275\u0275text(17, " \u95DC\u9589 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(18, "button", 61);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_1_Template_button_click_18_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.dismissConversionAlert());
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(19, "svg", 62);
    \u0275\u0275element(20, "path", 63);
    \u0275\u0275elementEnd()()()()();
  }
  if (rf & 2) {
    let tmp_1_0;
    let tmp_2_0;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275textInterpolate((tmp_1_0 = ctx_r1.conversionAlertData()) == null ? null : tmp_1_0.userName);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate((tmp_2_0 = ctx_r1.conversionAlertData()) == null ? null : tmp_2_0.signal);
  }
}
function CollaborationDashboardComponent_Conditional_24_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 15);
    \u0275\u0275element(1, "span", 64);
    \u0275\u0275text(2, " AI \u5DF2\u9023\u63A5 ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_25_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 16);
    \u0275\u0275text(1, " \u672A\u914D\u7F6E AI ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_26_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "span", 71);
  }
}
function CollaborationDashboardComponent_Conditional_26_For_82_Conditional_28_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 109);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_26_For_82_Conditional_28_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r4);
      const task_r5 = \u0275\u0275nextContext().$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.pauseUnifiedTask(task_r5.id));
    });
    \u0275\u0275text(1, " \u66AB\u505C ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_26_For_82_Conditional_29_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 110);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_26_For_82_Conditional_29_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r6);
      const task_r5 = \u0275\u0275nextContext().$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.startUnifiedTask(task_r5.id));
    });
    \u0275\u0275text(1, " \u555F\u52D5 ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_26_For_82_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 49)(1, "div", 96)(2, "div", 97)(3, "div", 98);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div")(6, "div", 99);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div", 100)(9, "span");
    \u0275\u0275text(10);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "span", 101);
    \u0275\u0275text(12, "\xB7");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(13, "span");
    \u0275\u0275text(14);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "span", 101);
    \u0275\u0275text(16, "\xB7");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(17, "span", 102);
    \u0275\u0275text(18);
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(19, "div", 97)(20, "div", 103)(21, "div", 104);
    \u0275\u0275text(22);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "div", 105);
    \u0275\u0275text(24, "\u8F49\u5316\u7387");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(25, "span", 106);
    \u0275\u0275text(26);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(27, "div", 25);
    \u0275\u0275conditionalCreate(28, CollaborationDashboardComponent_Conditional_26_For_82_Conditional_28_Template, 2, 0, "button", 107)(29, CollaborationDashboardComponent_Conditional_26_For_82_Conditional_29_Template, 2, 0, "button", 108);
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const task_r5 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(3);
    \u0275\u0275classProp("bg-emerald-500/20", task_r5.status === "running")("bg-purple-500/20", task_r5.status === "completed")("bg-slate-700", task_r5.status === "draft" || task_r5.status === "paused");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.getGoalIcon(task_r5.goalType), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(task_r5.name);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r1.getGoalLabel(task_r5.goalType));
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1("", task_r5.stats.totalContacts, " \u76EE\u6A19");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1("", task_r5.stats.converted, " \u8F49\u5316");
    \u0275\u0275advance(3);
    \u0275\u0275classProp("text-emerald-400", task_r5.stats.conversionRate >= 20)("text-amber-400", task_r5.stats.conversionRate >= 10 && task_r5.stats.conversionRate < 20)("text-slate-400", task_r5.stats.conversionRate < 10);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", task_r5.stats.conversionRate || 0, "% ");
    \u0275\u0275advance(3);
    \u0275\u0275classProp("bg-emerald-500/20", task_r5.status === "running")("text-emerald-400", task_r5.status === "running")("bg-purple-500/20", task_r5.status === "completed")("text-purple-400", task_r5.status === "completed")("bg-yellow-500/20", task_r5.status === "paused")("text-yellow-400", task_r5.status === "paused")("bg-slate-600", task_r5.status === "draft")("text-slate-300", task_r5.status === "draft");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.getTaskStatusLabel(task_r5.status), " ");
    \u0275\u0275advance(2);
    \u0275\u0275conditional(task_r5.status === "running" ? 28 : task_r5.status === "paused" || task_r5.status === "draft" ? 29 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_26_Conditional_83_Template(rf, ctx) {
  if (rf & 1) {
    const _r7 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 46)(1, "div", 111);
    \u0275\u0275text(2, "\u{1F4CB}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div");
    \u0275\u0275text(4, "\u66AB\u7121\u71DF\u92B7\u4EFB\u52D9");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "button", 112);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_26_Conditional_83_Template_button_click_5_listener() {
      \u0275\u0275restoreView(_r7);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.goToSmartMarketingHub());
    });
    \u0275\u0275text(6, " \u{1F680} \u5275\u5EFA\u7B2C\u4E00\u500B\u4EFB\u52D9 ");
    \u0275\u0275elementEnd()();
  }
}
function CollaborationDashboardComponent_Conditional_26_Template(rf, ctx) {
  if (rf & 1) {
    const _r3 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 65)(1, "div", 66)(2, "div", 67);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 68);
    \u0275\u0275text(5, "\u7E3D\u4EFB\u52D9\u6578");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(6, "div", 69)(7, "div", 30)(8, "div", 70);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(10, CollaborationDashboardComponent_Conditional_26_Conditional_10_Template, 1, 0, "span", 71);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "div", 68);
    \u0275\u0275text(12, "\u57F7\u884C\u4E2D");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(13, "div", 72)(14, "div", 73);
    \u0275\u0275text(15);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "div", 68);
    \u0275\u0275text(17, "\u7E3D\u63A5\u89F8");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(18, "div", 74)(19, "div", 75);
    \u0275\u0275text(20);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "div", 68);
    \u0275\u0275text(22, "\u7E3D\u8F49\u5316");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(23, "div", 76)(24, "div", 77);
    \u0275\u0275text(25);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(26, "div", 68);
    \u0275\u0275text(27, "\u8F49\u5316\u7387");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(28, "div", 78);
    \u0275\u0275element(29, "div", 79);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(30, "div", 80)(31, "div", 81);
    \u0275\u0275text(32);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(33, "div", 68);
    \u0275\u0275text(34, "\u6D88\u606F\u767C\u9001");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(35, "div", 82)(36, "div", 23)(37, "h3", 83)(38, "span");
    \u0275\u0275text(39, "\u{1F9E0}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(40, " AI \u7CFB\u7D71\u72C0\u614B ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(41, "div", 84);
    \u0275\u0275text(42, " \u4ECA\u65E5\u7D71\u8A08 ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(43, "div", 85)(44, "div", 86)(45, "div", 87);
    \u0275\u0275text(46);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(47, "div", 88);
    \u0275\u0275text(48, "\u5C0D\u8A71\u6578");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(49, "div", 86)(50, "div", 89);
    \u0275\u0275text(51);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(52, "div", 88);
    \u0275\u0275text(53, "\u610F\u5716\u8B58\u5225");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(54, "div", 86)(55, "div", 90);
    \u0275\u0275text(56);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(57, "div", 88);
    \u0275\u0275text(58, "AI \u8F49\u5316");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(59, "div", 86)(60, "div", 91);
    \u0275\u0275text(61);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(62, "div", 88);
    \u0275\u0275text(63, "\u97FF\u61C9\u6642\u9593");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(64, "div", 86)(65, "div", 92);
    \u0275\u0275text(66);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(67, "div", 88);
    \u0275\u0275text(68, "AI \u6210\u672C");
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(69, "div", 38)(70, "div", 93)(71, "h3", 83)(72, "span");
    \u0275\u0275text(73, "\u{1F4CB}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(74, " \u71DF\u92B7\u4EFB\u52D9 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(75, "div", 30)(76, "span", 43);
    \u0275\u0275text(77);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(78, "button", 94);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_26_Template_button_click_78_listener() {
      \u0275\u0275restoreView(_r3);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.goToSmartMarketingHub());
    });
    \u0275\u0275text(79, " + \u65B0\u5EFA\u4EFB\u52D9 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(80, "div", 95);
    \u0275\u0275repeaterCreate(81, CollaborationDashboardComponent_Conditional_26_For_82_Template, 30, 36, "div", 49, _forTrack1);
    \u0275\u0275conditionalCreate(83, CollaborationDashboardComponent_Conditional_26_Conditional_83_Template, 7, 0, "div", 46);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r1.unifiedStats().totalTasks);
    \u0275\u0275advance(6);
    \u0275\u0275textInterpolate(ctx_r1.unifiedStats().activeTasks);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.unifiedStats().activeTasks > 0 ? 10 : -1);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.unifiedStats().totalContacted);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.unifiedStats().totalConverted);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1("", ctx_r1.unifiedConversionRate(), "%");
    \u0275\u0275advance(4);
    \u0275\u0275styleProp("width", ctx_r1.unifiedConversionRate(), "%");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r1.unifiedStats().totalMessagesSent);
    \u0275\u0275advance(14);
    \u0275\u0275textInterpolate(ctx_r1.aiStats().today.conversations);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.aiStats().today.intentsRecognized);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.aiStats().today.conversions);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1("", ctx_r1.aiStats().today.avgResponseTime, "ms");
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1("\xA5", ctx_r1.aiStats().today.cost.toFixed(2));
    \u0275\u0275advance(11);
    \u0275\u0275textInterpolate1("", ctx_r1.unifiedTasks().length, " \u500B\u4EFB\u52D9");
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r1.unifiedTasks().slice(0, 10));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r1.unifiedTasks().length === 0 ? 83 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_27_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "span", 71);
  }
}
function CollaborationDashboardComponent_Conditional_27_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 17)(1, "div", 66)(2, "div", 113);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 68);
    \u0275\u0275text(5, "\u7E3D\u7FA4\u7D44\u6578");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 114);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "div", 69)(9, "div", 30)(10, "div", 115);
    \u0275\u0275text(11);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(12, CollaborationDashboardComponent_Conditional_27_Conditional_12_Template, 1, 0, "span", 71);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(13, "div", 68);
    \u0275\u0275text(14, "\u6D3B\u8E8D\u5354\u4F5C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "div", 116);
    \u0275\u0275text(16, " \u904B\u884C\u4E2D ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(17, "div", 72)(18, "div", 117);
    \u0275\u0275text(19);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(20, "div", 68);
    \u0275\u0275text(21, "\u5DF2\u5B8C\u6210");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(22, "div", 118);
    \u0275\u0275text(23, " \u6B77\u53F2\u7D2F\u8A08 ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(24, "div", 74)(25, "div", 119);
    \u0275\u0275text(26);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(27, "div", 68);
    \u0275\u0275text(28, "\u6210\u529F\u8F49\u5316");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "div", 120);
    \u0275\u0275text(30);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(31, "div", 76)(32, "div", 121);
    \u0275\u0275text(33);
    \u0275\u0275pipe(34, "number");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(35, "div", 68);
    \u0275\u0275text(36, "\u8F49\u5316\u7387");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(37, "div", 122);
    \u0275\u0275element(38, "div", 123);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r1.stats().totalGroups);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1(" \u4ECA\u65E5 +", ctx_r1.stats().todayGroups, " ");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(ctx_r1.stats().activeGroups);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.stats().activeGroups > 0 ? 12 : -1);
    \u0275\u0275advance(7);
    \u0275\u0275textInterpolate(ctx_r1.stats().completedGroups);
    \u0275\u0275advance(7);
    \u0275\u0275textInterpolate(ctx_r1.stats().totalConversions);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1(" \u4ECA\u65E5 +", ctx_r1.stats().todayConversions, " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1("", \u0275\u0275pipeBind2(34, 10, ctx_r1.stats().conversionRate, "1.1-1"), "%");
    \u0275\u0275advance(5);
    \u0275\u0275styleProp("width", ctx_r1.stats().conversionRate, "%");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    const _r9 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 110);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Conditional_9_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r9);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.resumeExecution());
    });
    \u0275\u0275text(1, " \u25B6\uFE0F \u6062\u5FA9 ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r10 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 143);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Conditional_10_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r10);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.pauseExecution());
    });
    \u0275\u0275text(1, " \u23F8\uFE0F \u66AB\u505C ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_51_For_5_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "div", 149);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_51_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 146);
    \u0275\u0275element(1, "div", 147);
    \u0275\u0275elementStart(2, "div", 148);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(4, CollaborationDashboardComponent_Conditional_28_Conditional_51_For_5_Conditional_4_Template, 1, 0, "div", 149);
  }
  if (rf & 2) {
    const stage_r11 = ctx.$implicit;
    const \u0275$index_450_r12 = ctx.$index;
    const \u0275$count_450_r13 = ctx.$count;
    const ctx_r1 = \u0275\u0275nextContext(3);
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-emerald-500", ctx_r1.isStageCompleted(stage_r11.id))("bg-purple-500", ctx_r1.isCurrentStage(stage_r11.id))("bg-slate-700", !ctx_r1.isStageCompleted(stage_r11.id) && !ctx_r1.isCurrentStage(stage_r11.id));
    \u0275\u0275advance();
    \u0275\u0275classProp("text-emerald-400", ctx_r1.isStageCompleted(stage_r11.id))("text-purple-400", ctx_r1.isCurrentStage(stage_r11.id))("text-slate-500", !ctx_r1.isStageCompleted(stage_r11.id) && !ctx_r1.isCurrentStage(stage_r11.id));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", stage_r11.label, " ");
    \u0275\u0275advance();
    \u0275\u0275conditional(!(\u0275$index_450_r12 === \u0275$count_450_r13 - 1) ? 4 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_51_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 135)(1, "div", 144);
    \u0275\u0275text(2, "\u8F49\u5316\u6F0F\u6597");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 145);
    \u0275\u0275repeaterCreate(4, CollaborationDashboardComponent_Conditional_28_Conditional_51_For_5_Template, 5, 14, null, null, _forTrack1);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r1.conversionStages);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r14 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 154)(1, "div", 30);
    \u0275\u0275element(2, "span", 157);
    \u0275\u0275elementStart(3, "span", 158);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(5, "div", 25)(6, "button", 159);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_10_Template_button_click_6_listener() {
      \u0275\u0275restoreView(_r14);
      const ctx_r1 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r1.skipCurrentUser());
    });
    \u0275\u0275text(7, " \u8DF3\u904E ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "button", 160);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_10_Template_button_click_8_listener() {
      \u0275\u0275restoreView(_r14);
      const ctx_r1 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r1.markAsConverted());
    });
    \u0275\u0275text(9, " \u6A19\u8A18\u8F49\u5316 ");
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    let tmp_3_0;
    const ctx_r1 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1("\u6B63\u5728\u8655\u7406\uFF1A", (tmp_3_0 = ctx_r1.queueProgress()) == null ? null : tmp_3_0.current == null ? null : tmp_3_0.current.name);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 163);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u{1F3AF} \u8F49\u5316 ", ctx_r1.getResultCount("converted"), " ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 164);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u2B50 \u6709\u8208\u8DA3 ", ctx_r1.getResultCount("interested"), " ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_6_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 165);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u{1F610} \u4E2D\u7ACB ", ctx_r1.getResultCount("neutral"), " ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_7_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 166);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u274C \u62D2\u7D55 ", ctx_r1.getResultCount("rejected"), " ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 167);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u{1F4A4} \u7121\u56DE\u61C9 ", ctx_r1.getResultCount("no_response"), " ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    const _r15 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 156)(1, "div", 161);
    \u0275\u0275text(2, "\u8655\u7406\u7D50\u679C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 162);
    \u0275\u0275conditionalCreate(4, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_4_Template, 2, 1, "span", 163);
    \u0275\u0275conditionalCreate(5, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_5_Template, 2, 1, "span", 164);
    \u0275\u0275conditionalCreate(6, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_6_Template, 2, 1, "span", 165);
    \u0275\u0275conditionalCreate(7, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_7_Template, 2, 1, "span", 166);
    \u0275\u0275conditionalCreate(8, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Conditional_8_Template, 2, 1, "span", 167);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "button", 168);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Template_button_click_9_listener() {
      \u0275\u0275restoreView(_r15);
      const ctx_r1 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r1.showResultsPanel.set(true));
    });
    \u0275\u0275text(10, " \u67E5\u770B\u8A73\u7D30\u7D50\u679C \u2192 ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(4);
    \u0275\u0275conditional(ctx_r1.getResultCount("converted") > 0 ? 4 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.getResultCount("interested") > 0 ? 5 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.getResultCount("neutral") > 0 ? 6 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.getResultCount("rejected") > 0 ? 7 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.getResultCount("no_response") > 0 ? 8 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_52_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 136)(1, "div", 137)(2, "div", 43);
    \u0275\u0275text(3, "\u968A\u5217\u9032\u5EA6");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 150);
    \u0275\u0275text(5);
    \u0275\u0275elementStart(6, "span", 151);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(8, "div", 152);
    \u0275\u0275element(9, "div", 153);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(10, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_10_Template, 10, 1, "div", 154);
    \u0275\u0275elementStart(11, "div", 155);
    \u0275\u0275text(12);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(13, CollaborationDashboardComponent_Conditional_28_Conditional_52_Conditional_13_Template, 11, 5, "div", 156);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    let tmp_2_0;
    let tmp_3_0;
    let tmp_4_0;
    let tmp_5_0;
    let tmp_6_0;
    let tmp_7_0;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate2(" ", (tmp_2_0 = ctx_r1.queueProgress()) == null ? null : tmp_2_0.processed, "/", (tmp_2_0 = ctx_r1.queueProgress()) == null ? null : tmp_2_0.total, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("(", (tmp_3_0 = ctx_r1.queueProgress()) == null ? null : tmp_3_0.progress, "%)");
    \u0275\u0275advance(2);
    \u0275\u0275styleProp("width", ((tmp_4_0 = ctx_r1.queueProgress()) == null ? null : tmp_4_0.progress) || 0, "%");
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_5_0 = ctx_r1.queueProgress()) == null ? null : tmp_5_0.current) ? 10 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" \u5F85\u8655\u7406\uFF1A", (tmp_6_0 = ctx_r1.queueProgress()) == null ? null : tmp_6_0.pending, " \u4EBA ");
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_7_0 = ctx_r1.queueProgress()) == null ? null : tmp_7_0.completed) && ctx_r1.queueProgress().completed.length > 0 ? 13 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_53_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 169);
    \u0275\u0275element(1, "span", 171);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const user_r16 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-green-500", user_r16.intentScore >= 60)("bg-amber-500", user_r16.intentScore >= 40 && user_r16.intentScore < 60)("bg-slate-500", user_r16.intentScore < 40);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", user_r16.firstName || user_r16.username || user_r16.id, " ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_53_Conditional_6_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 170);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(3);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" +", ctx_r1.currentExecution().targetUsers.length - 10, " \u66F4\u591A ");
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_53_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 130)(1, "div", 144);
    \u0275\u0275text(2, "\u76EE\u6A19\u7528\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 162);
    \u0275\u0275repeaterCreate(4, CollaborationDashboardComponent_Conditional_28_Conditional_53_For_5_Template, 3, 7, "span", 169, _forTrack1);
    \u0275\u0275conditionalCreate(6, CollaborationDashboardComponent_Conditional_28_Conditional_53_Conditional_6_Template, 2, 1, "span", 170);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r1.currentExecution().targetUsers.slice(0, 10));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r1.currentExecution().targetUsers.length > 10 ? 6 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_62_For_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 173)(1, "div", 174);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 175)(4, "div", 176);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 177);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const msg_r17 = ctx.$implicit;
    \u0275\u0275classProp("bg-slate-700/50", !msg_r17.isFromCustomer)("bg-emerald-500/10", msg_r17.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-purple-500/30", !msg_r17.isFromCustomer)("text-purple-400", !msg_r17.isFromCustomer)("bg-emerald-500/30", msg_r17.isFromCustomer)("text-emerald-400", msg_r17.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", msg_r17.isFromCustomer ? "\u{1F464}" : "\u{1F916}", " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", msg_r17.isFromCustomer ? "\u5BA2\u6236" : msg_r17.role, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(msg_r17.content);
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_62_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 141);
    \u0275\u0275repeaterCreate(1, CollaborationDashboardComponent_Conditional_28_Conditional_62_For_2_Template, 8, 15, "div", 172, _forTrack2);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275repeater(ctx_r1.currentExecution().messageHistory.slice(-5).reverse());
  }
}
function CollaborationDashboardComponent_Conditional_28_Conditional_63_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 142);
    \u0275\u0275text(1, "\u66AB\u7121\u5C0D\u8A71\u8A18\u9304");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_28_Template(rf, ctx) {
  if (rf & 1) {
    const _r8 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 18)(1, "div", 124)(2, "div", 7);
    \u0275\u0275element(3, "span", 125);
    \u0275\u0275elementStart(4, "h3", 24);
    \u0275\u0275text(5, "\u{1F916} AI \u5718\u968A\u57F7\u884C\u4E2D");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "span", 126);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "div", 30);
    \u0275\u0275conditionalCreate(9, CollaborationDashboardComponent_Conditional_28_Conditional_9_Template, 2, 0, "button", 108)(10, CollaborationDashboardComponent_Conditional_28_Conditional_10_Template, 2, 0, "button", 127);
    \u0275\u0275elementStart(11, "button", 128);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Template_button_click_11_listener() {
      \u0275\u0275restoreView(_r8);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.stopExecution());
    });
    \u0275\u0275text(12, " \u23F9\uFE0F \u505C\u6B62 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(13, "div", 129)(14, "div", 130)(15, "div", 131);
    \u0275\u0275text(16, "\u71DF\u92B7\u76EE\u6A19");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(17, "div", 132);
    \u0275\u0275text(18);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(19, "div", 133)(20, "div", 86)(21, "div", 89);
    \u0275\u0275text(22);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "div", 88);
    \u0275\u0275text(24, "\u5DF2\u767C\u9001");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(25, "div", 86)(26, "div", 90);
    \u0275\u0275text(27);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(28, "div", 88);
    \u0275\u0275text(29, "\u5BA2\u6236\u56DE\u8986");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(30, "div", 86)(31, "div", 87);
    \u0275\u0275text(32);
    \u0275\u0275pipe(33, "number");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(34, "div", 88);
    \u0275\u0275text(35, "\u56DE\u8986\u7387");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(36, "div", 86)(37, "div", 134);
    \u0275\u0275text(38);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(39, "div", 88);
    \u0275\u0275text(40, "\u610F\u5411\u5206");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(41, "div", 86)(42, "div", 87);
    \u0275\u0275text(43);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(44, "div", 88);
    \u0275\u0275text(45, "\u53C3\u8207\u89D2\u8272");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(46, "div", 86)(47, "div", 92);
    \u0275\u0275text(48);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(49, "div", 88);
    \u0275\u0275text(50, "\u76EE\u6A19\u7528\u6236");
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(51, CollaborationDashboardComponent_Conditional_28_Conditional_51_Template, 6, 0, "div", 135);
    \u0275\u0275conditionalCreate(52, CollaborationDashboardComponent_Conditional_28_Conditional_52_Template, 14, 8, "div", 136);
    \u0275\u0275conditionalCreate(53, CollaborationDashboardComponent_Conditional_28_Conditional_53_Template, 7, 1, "div", 130);
    \u0275\u0275elementStart(54, "div")(55, "div", 137)(56, "div", 43);
    \u0275\u0275text(57, "\u6700\u8FD1\u5C0D\u8A71");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(58, "button", 138);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_28_Template_button_click_58_listener() {
      \u0275\u0275restoreView(_r8);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.toggleConversationPanel());
    });
    \u0275\u0275text(59);
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(60, "svg", 139);
    \u0275\u0275element(61, "path", 140);
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(62, CollaborationDashboardComponent_Conditional_28_Conditional_62_Template, 3, 0, "div", 141)(63, CollaborationDashboardComponent_Conditional_28_Conditional_63_Template, 2, 0, "div", 142);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    let tmp_1_0;
    let tmp_2_0;
    let tmp_3_0;
    let tmp_4_0;
    let tmp_5_0;
    let tmp_7_0;
    let tmp_8_0;
    let tmp_9_0;
    let tmp_10_0;
    let tmp_11_0;
    let tmp_12_0;
    let tmp_13_0;
    let tmp_15_0;
    let tmp_18_0;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(7);
    \u0275\u0275textInterpolate1(" ", ((tmp_1_0 = ctx_r1.currentExecution()) == null ? null : tmp_1_0.mode) === "scriptless" ? "\u7121\u5287\u672C" : ((tmp_1_0 = ctx_r1.currentExecution()) == null ? null : tmp_1_0.mode) === "hybrid" ? "\u6DF7\u5408" : "\u5287\u672C", "\u6A21\u5F0F ");
    \u0275\u0275advance(2);
    \u0275\u0275conditional(((tmp_2_0 = ctx_r1.currentExecution()) == null ? null : tmp_2_0.status) === "paused" ? 9 : 10);
    \u0275\u0275advance(9);
    \u0275\u0275textInterpolate((tmp_3_0 = ctx_r1.currentExecution()) == null ? null : tmp_3_0.goal);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(((tmp_4_0 = ctx_r1.currentExecution()) == null ? null : tmp_4_0.stats == null ? null : tmp_4_0.stats.messagesSent) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_5_0 = ctx_r1.currentExecution()) == null ? null : tmp_5_0.stats == null ? null : tmp_5_0.stats.responsesReceived) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1("", \u0275\u0275pipeBind2(33, 22, ctx_r1.getReplyRate(), "1.0-0"), "%");
    \u0275\u0275advance(5);
    \u0275\u0275classProp("text-emerald-400", (((tmp_7_0 = ctx_r1.currentExecution()) == null ? null : tmp_7_0.stats == null ? null : tmp_7_0.stats.interestScore) || 0) >= 60)("text-amber-400", (((tmp_8_0 = ctx_r1.currentExecution()) == null ? null : tmp_8_0.stats == null ? null : tmp_8_0.stats.interestScore) || 0) >= 30 && (((tmp_8_0 = ctx_r1.currentExecution()) == null ? null : tmp_8_0.stats == null ? null : tmp_8_0.stats.interestScore) || 0) < 60)("text-slate-400", (((tmp_9_0 = ctx_r1.currentExecution()) == null ? null : tmp_9_0.stats == null ? null : tmp_9_0.stats.interestScore) || 0) < 30);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ((tmp_10_0 = ctx_r1.currentExecution()) == null ? null : tmp_10_0.stats == null ? null : tmp_10_0.stats.interestScore) || 0, " ");
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_11_0 = ctx_r1.currentExecution()) == null ? null : tmp_11_0.roles == null ? null : tmp_11_0.roles.length) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_12_0 = ctx_r1.currentExecution()) == null ? null : tmp_12_0.targetUsers == null ? null : tmp_12_0.targetUsers.length) || 0);
    \u0275\u0275advance(3);
    \u0275\u0275conditional(((tmp_13_0 = ctx_r1.currentExecution()) == null ? null : tmp_13_0.conversionFunnel) ? 51 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.queueProgress() ? 52 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_15_0 = ctx_r1.currentExecution()) == null ? null : tmp_15_0.targetUsers) && ctx_r1.currentExecution().targetUsers.length > 0 ? 53 : -1);
    \u0275\u0275advance(6);
    \u0275\u0275textInterpolate1(" ", ctx_r1.showConversationPanel() ? "\u6536\u8D77" : "\u5C55\u958B\u5B8C\u6574\u5C0D\u8A71", " ");
    \u0275\u0275advance();
    \u0275\u0275classProp("rotate-180", ctx_r1.showConversationPanel());
    \u0275\u0275advance(2);
    \u0275\u0275conditional(((tmp_18_0 = ctx_r1.currentExecution()) == null ? null : tmp_18_0.messageHistory) && ctx_r1.currentExecution().messageHistory.length > 0 ? 62 : 63);
  }
}
function CollaborationDashboardComponent_Conditional_29_For_18_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 193)(1, "div", 194);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 195)(4, "div", 196);
    \u0275\u0275text(5);
    \u0275\u0275elementStart(6, "span", 197);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "div", 198);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const msg_r19 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("flex-row-reverse", !msg_r19.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-purple-500/30", !msg_r19.isFromCustomer)("bg-emerald-500/30", msg_r19.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", msg_r19.isFromCustomer ? "\u{1F464}" : "\u{1F916}", " ");
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-purple-500/20", !msg_r19.isFromCustomer)("bg-emerald-500/20", msg_r19.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275classProp("text-purple-400", !msg_r19.isFromCustomer)("text-emerald-400", msg_r19.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", msg_r19.isFromCustomer ? "\u5BA2\u6236" : msg_r19.role, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.formatTime(msg_r19.timestamp));
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(msg_r19.content);
  }
}
function CollaborationDashboardComponent_Conditional_29_Conditional_19_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 37)(1, "div", 111);
    \u0275\u0275text(2, "\u{1F4AC}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div");
    \u0275\u0275text(4, "\u5C0D\u8A71\u5C1A\u672A\u958B\u59CB");
    \u0275\u0275elementEnd()();
  }
}
function CollaborationDashboardComponent_Conditional_29_Conditional_26_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "option", 201);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const role_r21 = ctx.$implicit;
    \u0275\u0275property("value", role_r21.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate2("", role_r21.name, " (", role_r21.type, ")");
  }
}
function CollaborationDashboardComponent_Conditional_29_Conditional_26_Template(rf, ctx) {
  if (rf & 1) {
    const _r20 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 189)(1, "label", 199);
    \u0275\u0275text(2, "\u9078\u64C7\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "select", 200);
    \u0275\u0275twoWayListener("ngModelChange", function CollaborationDashboardComponent_Conditional_29_Conditional_26_Template_select_ngModelChange_3_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r1 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r1.manualSendRole, $event) || (ctx_r1.manualSendRole = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275repeaterCreate(4, CollaborationDashboardComponent_Conditional_29_Conditional_26_For_5_Template, 2, 3, "option", 201, \u0275\u0275repeaterTrackByIndex);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    let tmp_4_0;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(3);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.manualSendRole);
    \u0275\u0275advance();
    \u0275\u0275repeater(((tmp_4_0 = ctx_r1.currentExecution()) == null ? null : tmp_4_0.roles) || \u0275\u0275pureFunction0(1, _c1));
  }
}
function CollaborationDashboardComponent_Conditional_29_Conditional_31_Template(rf, ctx) {
  if (rf & 1) {
    const _r22 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 192)(1, "div", 202);
    \u0275\u0275text(2, "\u{1F4A1} AI \u5EFA\u8B70\uFF1A");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 203);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "button", 168);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_29_Conditional_31_Template_button_click_5_listener() {
      \u0275\u0275restoreView(_r22);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.useAiSuggestion());
    });
    \u0275\u0275text(6, " \u4F7F\u7528\u6B64\u5EFA\u8B70 ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(ctx_r1.aiSuggestion());
  }
}
function CollaborationDashboardComponent_Conditional_29_Template(rf, ctx) {
  if (rf & 1) {
    const _r18 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 19)(1, "div", 178);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_29_Template_div_click_1_listener() {
      \u0275\u0275restoreView(_r18);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.toggleConversationPanel());
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "div", 179)(3, "div", 180)(4, "div", 7)(5, "span", 181);
    \u0275\u0275text(6, "\u{1F4AC}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "div")(8, "h3", 24);
    \u0275\u0275text(9, "\u5B8C\u6574\u5C0D\u8A71\u8A18\u9304");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "p", 88);
    \u0275\u0275text(11);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(12, "button", 182);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_29_Template_button_click_12_listener() {
      \u0275\u0275restoreView(_r18);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.toggleConversationPanel());
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(13, "svg", 62);
    \u0275\u0275element(14, "path", 63);
    \u0275\u0275elementEnd()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(15, "div", 183, 0);
    \u0275\u0275repeaterCreate(17, CollaborationDashboardComponent_Conditional_29_For_18_Template, 10, 18, "div", 184, _forTrack2);
    \u0275\u0275conditionalCreate(19, CollaborationDashboardComponent_Conditional_29_Conditional_19_Template, 5, 0, "div", 37);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(20, "div", 185)(21, "div", 186)(22, "span", 187);
    \u0275\u0275text(23);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(24, "button", 188);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_29_Template_button_click_24_listener() {
      \u0275\u0275restoreView(_r18);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.toggleManualMode());
    });
    \u0275\u0275text(25);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(26, CollaborationDashboardComponent_Conditional_29_Conditional_26_Template, 6, 2, "div", 189);
    \u0275\u0275elementStart(27, "div", 25)(28, "input", 190);
    \u0275\u0275twoWayListener("ngModelChange", function CollaborationDashboardComponent_Conditional_29_Template_input_ngModelChange_28_listener($event) {
      \u0275\u0275restoreView(_r18);
      const ctx_r1 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r1.manualMessage, $event) || (ctx_r1.manualMessage = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("keydown.enter", function CollaborationDashboardComponent_Conditional_29_Template_input_keydown_enter_28_listener() {
      \u0275\u0275restoreView(_r18);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.sendManualMessage());
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "button", 191);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_29_Template_button_click_29_listener() {
      \u0275\u0275restoreView(_r18);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.sendManualMessage());
    });
    \u0275\u0275text(30, " \u767C\u9001 ");
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(31, CollaborationDashboardComponent_Conditional_29_Conditional_31_Template, 7, 1, "div", 192);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    let tmp_2_0;
    let tmp_4_0;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(11);
    \u0275\u0275textInterpolate((tmp_2_0 = ctx_r1.currentExecution()) == null ? null : tmp_2_0.goal);
    \u0275\u0275advance(6);
    \u0275\u0275repeater(ctx_r1.currentExecution().messageHistory || \u0275\u0275pureFunction0(19, _c1));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(!((tmp_4_0 = ctx_r1.currentExecution()) == null ? null : tmp_4_0.messageHistory == null ? null : tmp_4_0.messageHistory.length) ? 19 : -1);
    \u0275\u0275advance(3);
    \u0275\u0275classProp("bg-amber-500/20", ctx_r1.isManualMode())("text-amber-400", ctx_r1.isManualMode())("bg-emerald-500/20", !ctx_r1.isManualMode())("text-emerald-400", !ctx_r1.isManualMode());
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.isManualMode() ? "\u{1F590}\uFE0F \u624B\u52D5\u6A21\u5F0F" : "\u{1F916} AI \u81EA\u52D5\u6A21\u5F0F", " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r1.isManualMode() ? "\u5207\u63DB\u81EA\u52D5" : "\u63A5\u7BA1\u5C0D\u8A71", " ");
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.isManualMode() ? 26 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275property("placeholder", \u0275\u0275interpolate(ctx_r1.isManualMode() ? "\u8F38\u5165\u6D88\u606F\u4E26\u767C\u9001..." : "\u555F\u7528\u624B\u52D5\u6A21\u5F0F\u5F8C\u53EF\u767C\u9001\u6D88\u606F"));
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.manualMessage);
    \u0275\u0275property("disabled", !ctx_r1.isManualMode());
    \u0275\u0275advance();
    \u0275\u0275property("disabled", !ctx_r1.isManualMode() || !ctx_r1.manualMessage.trim());
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r1.isManualMode() && ctx_r1.aiSuggestion() ? 31 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_30_For_62_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "tr", 229)(1, "td", 232);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "td", 233)(4, "span", 234);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(6, "td", 235);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "td", 236);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const user_r24 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(user_r24.name);
    \u0275\u0275advance(2);
    \u0275\u0275classProp("bg-emerald-500/20", user_r24.result === "converted")("text-emerald-400", user_r24.result === "converted")("bg-amber-500/20", user_r24.result === "interested")("text-amber-400", user_r24.result === "interested")("bg-slate-500/20", user_r24.result === "neutral")("text-slate-400", user_r24.result === "neutral")("bg-red-500/20", user_r24.result === "rejected")("text-red-400", user_r24.result === "rejected")("bg-gray-500/20", user_r24.result === "no_response")("text-gray-400", user_r24.result === "no_response");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.getResultLabel(user_r24.result), " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(user_r24.messagesExchanged);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.formatDuration(user_r24.duration));
  }
}
function CollaborationDashboardComponent_Conditional_30_Conditional_63_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 37);
    \u0275\u0275text(1, "\u66AB\u7121\u5DF2\u5B8C\u6210\u7528\u6236");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_30_Template(rf, ctx) {
  if (rf & 1) {
    const _r23 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 20)(1, "div", 178);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_30_Template_div_click_1_listener() {
      \u0275\u0275restoreView(_r23);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showResultsPanel.set(false));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "div", 204)(3, "div", 180)(4, "div", 7)(5, "span", 181);
    \u0275\u0275text(6, "\u{1F4CA}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "h3", 24);
    \u0275\u0275text(8, "\u968A\u5217\u57F7\u884C\u7D50\u679C");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(9, "button", 182);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_30_Template_button_click_9_listener() {
      \u0275\u0275restoreView(_r23);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showResultsPanel.set(false));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(10, "svg", 62);
    \u0275\u0275element(11, "path", 63);
    \u0275\u0275elementEnd()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(12, "div", 205)(13, "div", 206)(14, "div", 207)(15, "div", 90);
    \u0275\u0275text(16);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(17, "div", 208);
    \u0275\u0275text(18, "\u8F49\u5316\u6210\u529F");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(19, "div", 209)(20, "div", 91);
    \u0275\u0275text(21);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(22, "div", 210);
    \u0275\u0275text(23, "\u6709\u8208\u8DA3");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(24, "div", 211)(25, "div", 212);
    \u0275\u0275text(26);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(27, "div", 213);
    \u0275\u0275text(28, "\u4E2D\u7ACB");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(29, "div", 214)(30, "div", 215);
    \u0275\u0275text(31);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(32, "div", 216);
    \u0275\u0275text(33, "\u62D2\u7D55");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(34, "div", 217)(35, "div", 218);
    \u0275\u0275text(36);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(37, "div", 219);
    \u0275\u0275text(38, "\u7121\u56DE\u61C9");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(39, "div", 220)(40, "div", 53)(41, "div", 131);
    \u0275\u0275text(42, "\u8F49\u5316\u7387");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(43, "div", 221);
    \u0275\u0275element(44, "div", 222);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(45, "div", 90);
    \u0275\u0275text(46);
    \u0275\u0275pipe(47, "number");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(48, "div", 223)(49, "table", 224)(50, "thead", 225)(51, "tr")(52, "th", 226);
    \u0275\u0275text(53, "\u7528\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(54, "th", 226);
    \u0275\u0275text(55, "\u7D50\u679C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(56, "th", 227);
    \u0275\u0275text(57, "\u6D88\u606F\u6578");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(58, "th", 227);
    \u0275\u0275text(59, "\u6642\u9577");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(60, "tbody", 228);
    \u0275\u0275repeaterCreate(61, CollaborationDashboardComponent_Conditional_30_For_62_Template, 10, 24, "tr", 229, _forTrack1);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(63, CollaborationDashboardComponent_Conditional_30_Conditional_63_Template, 2, 0, "div", 37);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(64, "div", 230)(65, "button", 8);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_30_Template_button_click_65_listener() {
      \u0275\u0275restoreView(_r23);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.exportResults());
    });
    \u0275\u0275elementStart(66, "span");
    \u0275\u0275text(67, "\u{1F4E5}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(68, " \u5C0E\u51FA\u7D50\u679C ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(69, "button", 231);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_30_Template_button_click_69_listener() {
      \u0275\u0275restoreView(_r23);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showResultsPanel.set(false));
    });
    \u0275\u0275text(70, " \u95DC\u9589 ");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    let tmp_8_0;
    let tmp_9_0;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(16);
    \u0275\u0275textInterpolate(ctx_r1.getResultCount("converted"));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.getResultCount("interested"));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.getResultCount("neutral"));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.getResultCount("rejected"));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r1.getResultCount("no_response"));
    \u0275\u0275advance(8);
    \u0275\u0275styleProp("width", ctx_r1.getConversionRate(), "%");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", \u0275\u0275pipeBind2(47, 9, ctx_r1.getConversionRate(), "1.1-1"), "%");
    \u0275\u0275advance(15);
    \u0275\u0275repeater(((tmp_8_0 = ctx_r1.queueProgress()) == null ? null : tmp_8_0.completed) || \u0275\u0275pureFunction0(12, _c1));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(!((tmp_9_0 = ctx_r1.queueProgress()) == null ? null : tmp_9_0.completed == null ? null : tmp_9_0.completed.length) ? 63 : -1);
  }
}
function CollaborationDashboardComponent_For_43_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 28)(1, "div", 237)(2, "div", 238);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(4, "div", 105);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const day_r25 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275styleProp("height", ctx_r1.Math.max(day_r25.groups * 10, 4), "px");
    \u0275\u0275classProp("bg-gradient-to-t", true)("from-purple-600", true)("to-purple-400", true);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", day_r25.groups, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(day_r25.label);
  }
}
function CollaborationDashboardComponent_For_58_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 7)(1, "div", 239);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 175)(4, "div", 240);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 105);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "div", 103)(9, "div", 241);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "div", 105);
    \u0275\u0275text(12, "\u6210\u529F\u7387");
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const role_r26 = ctx.$implicit;
    const \u0275$index_870_r27 = ctx.$index;
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-amber-500", \u0275$index_870_r27 === 0)("text-amber-900", \u0275$index_870_r27 === 0)("bg-slate-600", \u0275$index_870_r27 === 1)("text-white", \u0275$index_870_r27 === 1)("bg-amber-700", \u0275$index_870_r27 === 2)("text-amber-200", \u0275$index_870_r27 === 2)("bg-slate-700", \u0275$index_870_r27 > 2)("text-slate-400", \u0275$index_870_r27 > 2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", \u0275$index_870_r27 + 1, " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(role_r26.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", role_r26.usageCount, " \u6B21\u4F7F\u7528");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1("", role_r26.successRate, "%");
  }
}
function CollaborationDashboardComponent_Conditional_59_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 37);
    \u0275\u0275text(1, "\u66AB\u7121\u6578\u64DA");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_Conditional_67_Template(rf, ctx) {
  if (rf & 1) {
    const _r28 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 242);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_67_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r28);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.openABTestPanel());
    });
    \u0275\u0275elementStart(1, "span");
    \u0275\u0275text(2, "\u{1F4CA}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" \u5C0D\u6BD4 (", ctx_r1.selectedForCompare().length, ") ");
  }
}
function CollaborationDashboardComponent_Conditional_68_Template(rf, ctx) {
  if (rf & 1) {
    const _r29 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 243);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_68_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r29);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.clearCompareSelection());
    });
    \u0275\u0275text(1, " \u6E05\u9664\u9078\u64C7 ");
    \u0275\u0275elementEnd();
  }
}
function CollaborationDashboardComponent_For_73_Template(rf, ctx) {
  if (rf & 1) {
    const _r30 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 244);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_For_73_Template_div_click_0_listener() {
      const exec_r31 = \u0275\u0275restoreView(_r30).$implicit;
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.viewExecutionHistory(exec_r31));
    });
    \u0275\u0275elementStart(1, "div", 96)(2, "div", 7)(3, "input", 245);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_For_73_Template_input_click_3_listener($event) {
      \u0275\u0275restoreView(_r30);
      return \u0275\u0275resetView($event.stopPropagation());
    })("change", function CollaborationDashboardComponent_For_73_Template_input_change_3_listener() {
      const exec_r31 = \u0275\u0275restoreView(_r30).$implicit;
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.toggleCompareSelection(exec_r31));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 246)(5, "span", 247);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(7, "div")(8, "div", 132);
    \u0275\u0275text(9);
    \u0275\u0275pipe(10, "slice");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "div", 248)(12, "span");
    \u0275\u0275text(13);
    \u0275\u0275pipe(14, "date");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "span");
    \u0275\u0275text(16, "\u2022");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(17, "span");
    \u0275\u0275text(18);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "span");
    \u0275\u0275text(20, "\u2022");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "span");
    \u0275\u0275text(22);
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(23, "div", 97)(24, "div", 103)(25, "div", 249);
    \u0275\u0275text(26);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(27, "div", 105);
    \u0275\u0275text(28);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(29, "button", 250);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_For_73_Template_button_click_29_listener($event) {
      const exec_r31 = \u0275\u0275restoreView(_r30).$implicit;
      const ctx_r1 = \u0275\u0275nextContext();
      ctx_r1.viewExecutionHistory(exec_r31);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(30, "svg", 9);
    \u0275\u0275element(31, "path", 251)(32, "path", 252);
    \u0275\u0275elementEnd()()()()();
  }
  if (rf & 2) {
    const exec_r31 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275property("checked", ctx_r1.isSelectedForCompare(exec_r31));
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-emerald-500/20", exec_r31.status === "completed")("bg-red-500/20", exec_r31.status === "failed")("bg-slate-500/20", exec_r31.status === "idle");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", exec_r31.status === "completed" ? "\u2705" : exec_r31.status === "failed" ? "\u274C" : "\u23F8\uFE0F", " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate2("", \u0275\u0275pipeBind3(10, 15, exec_r31.goal, 0, 40), "", exec_r31.goal.length > 40 ? "..." : "");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(\u0275\u0275pipeBind2(14, 19, exec_r31.stats.startTime, "MM/dd HH:mm"));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(exec_r31.mode === "scriptless" ? "\u7121\u5287\u672C" : exec_r31.mode === "hybrid" ? "\u6DF7\u5408" : "\u5287\u672C");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1("", (exec_r31.targetUsers == null ? null : exec_r31.targetUsers.length) || 0, " \u76EE\u6A19");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1("", exec_r31.stats.messagesSent, " \u6D88\u606F");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", exec_r31.stats.responsesReceived, " \u56DE\u8986");
  }
}
function CollaborationDashboardComponent_Conditional_74_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 46)(1, "div", 111);
    \u0275\u0275text(2, "\u{1F4DD}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div");
    \u0275\u0275text(4, "\u66AB\u7121\u57F7\u884C\u6B77\u53F2");
    \u0275\u0275elementEnd()();
  }
}
function CollaborationDashboardComponent_Conditional_75_For_43_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 193)(1, "div", 194);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 195)(4, "div", 196);
    \u0275\u0275text(5);
    \u0275\u0275elementStart(6, "span", 197);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "div", 198);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const msg_r33 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("flex-row-reverse", !msg_r33.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-purple-500/30", !msg_r33.isFromCustomer)("bg-emerald-500/30", msg_r33.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", msg_r33.isFromCustomer ? "\u{1F464}" : "\u{1F916}", " ");
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-purple-500/20", !msg_r33.isFromCustomer)("bg-emerald-500/20", msg_r33.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275classProp("text-purple-400", !msg_r33.isFromCustomer)("text-emerald-400", msg_r33.isFromCustomer);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", msg_r33.isFromCustomer ? "\u5BA2\u6236" : msg_r33.role, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.formatTime(msg_r33.timestamp));
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(msg_r33.content);
  }
}
function CollaborationDashboardComponent_Conditional_75_Conditional_44_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 37)(1, "div", 111);
    \u0275\u0275text(2, "\u{1F4AC}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div");
    \u0275\u0275text(4, "\u6B64\u6B21\u57F7\u884C\u7121\u5C0D\u8A71\u8A18\u9304");
    \u0275\u0275elementEnd()();
  }
}
function CollaborationDashboardComponent_Conditional_75_Template(rf, ctx) {
  if (rf & 1) {
    const _r32 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 20)(1, "div", 178);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_75_Template_div_click_1_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showHistoryPanel.set(false));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "div", 253)(3, "div", 180)(4, "div", 7)(5, "span", 181);
    \u0275\u0275text(6, "\u{1F4DC}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "div")(8, "h3", 24);
    \u0275\u0275text(9, "\u57F7\u884C\u6B77\u53F2\u56DE\u653E");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "p", 88);
    \u0275\u0275text(11);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(12, "button", 182);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_75_Template_button_click_12_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showHistoryPanel.set(false));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(13, "svg", 62);
    \u0275\u0275element(14, "path", 63);
    \u0275\u0275elementEnd()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(15, "div", 254)(16, "div", 255)(17, "div", 256);
    \u0275\u0275text(18);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "div", 88);
    \u0275\u0275text(20, "\u5DF2\u767C\u9001");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(21, "div", 255)(22, "div", 257);
    \u0275\u0275text(23);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(24, "div", 88);
    \u0275\u0275text(25, "\u5BA2\u6236\u56DE\u8986");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(26, "div", 255)(27, "div", 258);
    \u0275\u0275text(28);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "div", 88);
    \u0275\u0275text(30, "\u53C3\u8207\u89D2\u8272");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(31, "div", 255)(32, "div", 259);
    \u0275\u0275text(33);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(34, "div", 88);
    \u0275\u0275text(35, "\u5206\u6790\u6B21\u6578");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(36, "div", 255)(37, "div", 260);
    \u0275\u0275text(38);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(39, "div", 88);
    \u0275\u0275text(40, "\u76EE\u6A19\u7528\u6236");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(41, "div", 261);
    \u0275\u0275repeaterCreate(42, CollaborationDashboardComponent_Conditional_75_For_43_Template, 10, 18, "div", 184, _forTrack2);
    \u0275\u0275conditionalCreate(44, CollaborationDashboardComponent_Conditional_75_Conditional_44_Template, 5, 0, "div", 37);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(45, "div", 230)(46, "button", 262);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_75_Template_button_click_46_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.rerunExecution(ctx_r1.selectedHistory()));
    });
    \u0275\u0275elementStart(47, "span");
    \u0275\u0275text(48, "\u{1F504}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(49, " \u4EE5\u6B64\u7B56\u7565\u91CD\u65B0\u57F7\u884C ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(50, "button", 263);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_75_Template_button_click_50_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showHistoryPanel.set(false));
    });
    \u0275\u0275text(51, " \u95DC\u9589 ");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    let tmp_1_0;
    let tmp_2_0;
    let tmp_3_0;
    let tmp_4_0;
    let tmp_5_0;
    let tmp_6_0;
    let tmp_7_0;
    let tmp_8_0;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(11);
    \u0275\u0275textInterpolate((tmp_1_0 = ctx_r1.selectedHistory()) == null ? null : tmp_1_0.goal);
    \u0275\u0275advance(7);
    \u0275\u0275textInterpolate(((tmp_2_0 = ctx_r1.selectedHistory()) == null ? null : tmp_2_0.stats == null ? null : tmp_2_0.stats.messagesSent) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_3_0 = ctx_r1.selectedHistory()) == null ? null : tmp_3_0.stats == null ? null : tmp_3_0.stats.responsesReceived) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_4_0 = ctx_r1.selectedHistory()) == null ? null : tmp_4_0.roles == null ? null : tmp_4_0.roles.length) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_5_0 = ctx_r1.selectedHistory()) == null ? null : tmp_5_0.stats == null ? null : tmp_5_0.stats.analysisCount) || 0);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(((tmp_6_0 = ctx_r1.selectedHistory()) == null ? null : tmp_6_0.targetUsers == null ? null : tmp_6_0.targetUsers.length) || 0);
    \u0275\u0275advance(4);
    \u0275\u0275repeater(((tmp_7_0 = ctx_r1.selectedHistory()) == null ? null : tmp_7_0.messageHistory) || \u0275\u0275pureFunction0(7, _c1));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(!((tmp_8_0 = ctx_r1.selectedHistory()) == null ? null : tmp_8_0.messageHistory == null ? null : tmp_8_0.messageHistory.length) ? 44 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_76_For_21_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "th", 270)(1, "div", 280)(2, "span", 281);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "span", 282);
    \u0275\u0275text(5);
    \u0275\u0275pipe(6, "slice");
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const exec_r35 = ctx.$implicit;
    const \u0275$index_1135_r36 = ctx.$index;
    \u0275\u0275advance(2);
    \u0275\u0275classProp("bg-purple-500/20", \u0275$index_1135_r36 === 0)("text-purple-400", \u0275$index_1135_r36 === 0)("bg-cyan-500/20", \u0275$index_1135_r36 === 1)("text-cyan-400", \u0275$index_1135_r36 === 1)("bg-amber-500/20", \u0275$index_1135_r36 === 2)("text-amber-400", \u0275$index_1135_r36 === 2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u7B56\u7565 ", \u0275$index_1135_r36 + 1, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", \u0275\u0275pipeBind3(6, 14, exec_r35.goal, 0, 20), "...");
  }
}
function CollaborationDashboardComponent_Conditional_76_For_27_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 273);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r37 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", exec_r37.mode === "scriptless" ? "\u7121\u5287\u672C" : exec_r37.mode === "hybrid" ? "\u6DF7\u5408" : "\u5287\u672C", " ");
  }
}
function CollaborationDashboardComponent_Conditional_76_For_32_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 273);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r38 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate((exec_r38.targetUsers == null ? null : exec_r38.targetUsers.length) || 0);
  }
}
function CollaborationDashboardComponent_Conditional_76_For_37_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 283);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r39 = ctx.$implicit;
    const \u0275$index_1172_r40 = ctx.$index;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("text-emerald-400", ctx_r1.isHighestValue("messagesSent", \u0275$index_1172_r40))("text-white", !ctx_r1.isHighestValue("messagesSent", \u0275$index_1172_r40));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", exec_r39.stats.messagesSent, " ");
  }
}
function CollaborationDashboardComponent_Conditional_76_For_42_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 283);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r41 = ctx.$implicit;
    const \u0275$index_1181_r42 = ctx.$index;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("text-emerald-400", ctx_r1.isHighestValue("responsesReceived", \u0275$index_1181_r42))("text-white", !ctx_r1.isHighestValue("responsesReceived", \u0275$index_1181_r42));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", exec_r41.stats.responsesReceived, " ");
  }
}
function CollaborationDashboardComponent_Conditional_76_For_47_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 283);
    \u0275\u0275text(1);
    \u0275\u0275pipe(2, "number");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r43 = ctx.$implicit;
    const \u0275$index_1190_r44 = ctx.$index;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("text-emerald-400", ctx_r1.isHighestValue("responseRate", \u0275$index_1190_r44))("text-white", !ctx_r1.isHighestValue("responseRate", \u0275$index_1190_r44));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", \u0275\u0275pipeBind2(2, 5, ctx_r1.getResponseRate(exec_r43), "1.1-1"), "% ");
  }
}
function CollaborationDashboardComponent_Conditional_76_For_52_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 273);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r45 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate(exec_r45.stats.analysisCount || 0);
  }
}
function CollaborationDashboardComponent_Conditional_76_For_57_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 273);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r46 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate((exec_r46.roles == null ? null : exec_r46.roles.length) || 0);
  }
}
function CollaborationDashboardComponent_Conditional_76_For_62_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "td", 275);
    \u0275\u0275text(1);
    \u0275\u0275pipe(2, "date");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const exec_r47 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", \u0275\u0275pipeBind2(2, 1, exec_r47.stats.startTime, "MM/dd HH:mm"), " ");
  }
}
function CollaborationDashboardComponent_Conditional_76_Template(rf, ctx) {
  if (rf & 1) {
    const _r34 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 20)(1, "div", 178);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_76_Template_div_click_1_listener() {
      \u0275\u0275restoreView(_r34);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showABTestPanel.set(false));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "div", 264)(3, "div", 180)(4, "div", 7)(5, "span", 181);
    \u0275\u0275text(6, "\u{1F4CA}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "h3", 24);
    \u0275\u0275text(8, "A/B \u6E2C\u8A66\u5C0D\u6BD4");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "span", 265);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(11, "button", 182);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_76_Template_button_click_11_listener() {
      \u0275\u0275restoreView(_r34);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showABTestPanel.set(false));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(12, "svg", 62);
    \u0275\u0275element(13, "path", 63);
    \u0275\u0275elementEnd()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(14, "div", 266)(15, "table", 267)(16, "thead", 268)(17, "tr")(18, "th", 269);
    \u0275\u0275text(19, "\u6307\u6A19");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(20, CollaborationDashboardComponent_Conditional_76_For_21_Template, 7, 18, "th", 270, _forTrack1);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(22, "tbody", 158)(23, "tr", 271)(24, "td", 272);
    \u0275\u0275text(25, "\u57F7\u884C\u6A21\u5F0F");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(26, CollaborationDashboardComponent_Conditional_76_For_27_Template, 2, 1, "td", 273, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(28, "tr", 271)(29, "td", 272);
    \u0275\u0275text(30, "\u76EE\u6A19\u7528\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(31, CollaborationDashboardComponent_Conditional_76_For_32_Template, 2, 1, "td", 273, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(33, "tr", 271)(34, "td", 272);
    \u0275\u0275text(35, "\u6D88\u606F\u767C\u9001");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(36, CollaborationDashboardComponent_Conditional_76_For_37_Template, 2, 5, "td", 274, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(38, "tr", 271)(39, "td", 272);
    \u0275\u0275text(40, "\u5BA2\u6236\u56DE\u8986");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(41, CollaborationDashboardComponent_Conditional_76_For_42_Template, 2, 5, "td", 274, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(43, "tr", 271)(44, "td", 272);
    \u0275\u0275text(45, "\u56DE\u8986\u7387");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(46, CollaborationDashboardComponent_Conditional_76_For_47_Template, 3, 8, "td", 274, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(48, "tr", 271)(49, "td", 272);
    \u0275\u0275text(50, "AI \u5206\u6790\u6B21\u6578");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(51, CollaborationDashboardComponent_Conditional_76_For_52_Template, 2, 1, "td", 273, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(53, "tr", 271)(54, "td", 272);
    \u0275\u0275text(55, "\u53C3\u8207\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(56, CollaborationDashboardComponent_Conditional_76_For_57_Template, 2, 1, "td", 273, _forTrack1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(58, "tr")(59, "td", 272);
    \u0275\u0275text(60, "\u57F7\u884C\u6642\u9593");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(61, CollaborationDashboardComponent_Conditional_76_For_62_Template, 3, 4, "td", 275, _forTrack1);
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(63, "div", 276)(64, "div", 277)(65, "span", 247);
    \u0275\u0275text(66, "\u{1F3C6}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(67, "span", 132);
    \u0275\u0275text(68, "\u6700\u4F73\u7B56\u7565\uFF1A");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(69, "span", 278);
    \u0275\u0275text(70);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(71, "p", 43);
    \u0275\u0275text(72);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(73, "div", 279)(74, "button", 263);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_Conditional_76_Template_button_click_74_listener() {
      \u0275\u0275restoreView(_r34);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.showABTestPanel.set(false));
    });
    \u0275\u0275text(75, " \u95DC\u9589 ");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275textInterpolate1(" ", ctx_r1.selectedForCompare().length, " \u500B\u7B56\u7565 ");
    \u0275\u0275advance(10);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(6);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r1.selectedForCompare());
    \u0275\u0275advance(9);
    \u0275\u0275textInterpolate1(" \u7B56\u7565 ", ctx_r1.getBestStrategyIndex() + 1, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" \u57FA\u65BC\u56DE\u8986\u7387\u548C\u5BA2\u6236\u4E92\u52D5\u8868\u73FE\uFF0C\u7B56\u7565 ", ctx_r1.getBestStrategyIndex() + 1, " \u8868\u73FE\u6700\u512A\u3002 \u5EFA\u8B70\u4F7F\u7528\u6B64\u7B56\u7565\u7684\u57F7\u884C\u6A21\u5F0F\u548C\u89D2\u8272\u914D\u7F6E\u3002 ");
  }
}
function CollaborationDashboardComponent_For_85_Conditional_24_Template(rf, ctx) {
  if (rf & 1) {
    const _r49 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 250);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_For_85_Conditional_24_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r49);
      const group_r50 = \u0275\u0275nextContext().$implicit;
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.pauseGroup(group_r50));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(1, "svg", 9);
    \u0275\u0275element(2, "path", 291);
    \u0275\u0275elementEnd()();
  }
}
function CollaborationDashboardComponent_For_85_Conditional_25_Template(rf, ctx) {
  if (rf & 1) {
    const _r51 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 292);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_For_85_Conditional_25_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r51);
      const group_r50 = \u0275\u0275nextContext().$implicit;
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.resumeGroup(group_r50));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(1, "svg", 9);
    \u0275\u0275element(2, "path", 293);
    \u0275\u0275elementEnd()();
  }
}
function CollaborationDashboardComponent_For_85_Template(rf, ctx) {
  if (rf & 1) {
    const _r48 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 49)(1, "div", 96)(2, "div", 97)(3, "div", 246);
    \u0275\u0275element(4, "span", 284);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div")(6, "div", 99);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div", 43);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(10, "div", 285)(11, "div", 286)(12, "div", 287);
    \u0275\u0275text(13);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "div", 105);
    \u0275\u0275text(15, "\u5DF2\u767C\u9001");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(16, "div", 286)(17, "div", 288);
    \u0275\u0275text(18);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "div", 105);
    \u0275\u0275text(20, "\u5BA2\u6236\u56DE\u8986");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(21, "div", 106);
    \u0275\u0275text(22);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "div", 25);
    \u0275\u0275conditionalCreate(24, CollaborationDashboardComponent_For_85_Conditional_24_Template, 3, 0, "button", 289);
    \u0275\u0275conditionalCreate(25, CollaborationDashboardComponent_For_85_Conditional_25_Template, 3, 0, "button", 290);
    \u0275\u0275elementStart(26, "button", 250);
    \u0275\u0275listener("click", function CollaborationDashboardComponent_For_85_Template_button_click_26_listener() {
      const group_r50 = \u0275\u0275restoreView(_r48).$implicit;
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.viewGroupDetails(group_r50));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(27, "svg", 9);
    \u0275\u0275element(28, "path", 251)(29, "path", 252);
    \u0275\u0275elementEnd()()()()()();
  }
  if (rf & 2) {
    const group_r50 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275classProp("bg-emerald-500/20", group_r50.status === "running")("bg-amber-500/20", group_r50.status === "paused")("bg-cyan-500/20", group_r50.status === "inviting");
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-emerald-500", group_r50.status === "running")("animate-pulse", group_r50.status === "running")("bg-amber-500", group_r50.status === "paused")("bg-cyan-500", group_r50.status === "inviting");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(group_r50.groupTitle);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" \u5BA2\u6236: ", group_r50.targetCustomer.firstName || group_r50.targetCustomer.username || group_r50.targetCustomer.id, " ");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(group_r50.messagesSent);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(group_r50.customerMessages);
    \u0275\u0275advance(3);
    \u0275\u0275classProp("bg-emerald-500/20", group_r50.status === "running")("text-emerald-400", group_r50.status === "running")("bg-amber-500/20", group_r50.status === "paused")("text-amber-400", group_r50.status === "paused")("bg-cyan-500/20", group_r50.status === "inviting")("text-cyan-400", group_r50.status === "inviting");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.getStatusLabel(group_r50.status), " ");
    \u0275\u0275advance(2);
    \u0275\u0275conditional(group_r50.status === "running" ? 24 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(group_r50.status === "paused" ? 25 : -1);
  }
}
function CollaborationDashboardComponent_Conditional_86_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 46)(1, "div", 111);
    \u0275\u0275text(2, "\u{1F3AD}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div");
    \u0275\u0275text(4, "\u66AB\u7121\u6D3B\u8E8D\u7684\u5354\u4F5C\u7FA4\u7D44");
    \u0275\u0275elementEnd()();
  }
}
var CollaborationDashboardComponent = class _CollaborationDashboardComponent {
  constructor() {
    this.multiRoleService = inject(MultiRoleService);
    this.autoGroupService = inject(AutoGroupService);
    this.executorService = inject(CollaborationExecutorService);
    this.dynamicEngine = inject(DynamicScriptEngineService);
    this.ipc = inject(ElectronIpcService);
    this.toast = inject(ToastService);
    this.taskService = inject(MarketingTaskService);
    this.aiService = inject(AICenterService);
    this.currentExecution = computed(() => {
      const execution = this.dynamicEngine.currentExecution();
      return execution?.status === "running" || execution?.status === "paused" ? execution : null;
    }, ...ngDevMode ? [{ debugName: "currentExecution" }] : []);
    this.queueProgress = computed(() => this.dynamicEngine.queueProgress(), ...ngDevMode ? [{ debugName: "queueProgress" }] : []);
    this.showConversationPanel = signal(false, ...ngDevMode ? [{ debugName: "showConversationPanel" }] : []);
    this.isManualMode = signal(false, ...ngDevMode ? [{ debugName: "isManualMode" }] : []);
    this.manualMessage = "";
    this.manualSendRole = "";
    this.aiSuggestion = signal(null, ...ngDevMode ? [{ debugName: "aiSuggestion" }] : []);
    this.showConversionAlert = signal(false, ...ngDevMode ? [{ debugName: "showConversionAlert" }] : []);
    this.conversionAlertData = signal(null, ...ngDevMode ? [{ debugName: "conversionAlertData" }] : []);
    this.showResultsPanel = signal(false, ...ngDevMode ? [{ debugName: "showResultsPanel" }] : []);
    this.showHistoryPanel = signal(false, ...ngDevMode ? [{ debugName: "showHistoryPanel" }] : []);
    this.selectedHistory = signal(null, ...ngDevMode ? [{ debugName: "selectedHistory" }] : []);
    this.executionHistory = computed(() => this.dynamicEngine.executions(), ...ngDevMode ? [{ debugName: "executionHistory" }] : []);
    this.showABTestPanel = signal(false, ...ngDevMode ? [{ debugName: "showABTestPanel" }] : []);
    this.selectedForCompare = signal([], ...ngDevMode ? [{ debugName: "selectedForCompare" }] : []);
    this.conversionStages = [
      { id: "contact", label: "\u89F8\u9054" },
      { id: "response", label: "\u56DE\u8986" },
      { id: "interest", label: "\u8208\u8DA3" },
      { id: "intent", label: "\u610F\u5411" },
      { id: "conversion", label: "\u8F49\u5316" }
    ];
    this.ipcCleanup = [];
    this.unifiedTasks = computed(() => this.taskService.tasks(), ...ngDevMode ? [{ debugName: "unifiedTasks" }] : []);
    this.activeUnifiedTasks = computed(() => this.taskService.activeTasks(), ...ngDevMode ? [{ debugName: "activeUnifiedTasks" }] : []);
    this.unifiedStats = computed(() => this.taskService.getOverallStats(), ...ngDevMode ? [{ debugName: "unifiedStats" }] : []);
    this.unifiedTodayStats = computed(() => this.taskService.todayStats(), ...ngDevMode ? [{ debugName: "unifiedTodayStats" }] : []);
    this.tasksByGoal = computed(() => this.taskService.tasksByGoal(), ...ngDevMode ? [{ debugName: "tasksByGoal" }] : []);
    this.unifiedConversionRate = computed(() => this.taskService.overallConversionRate(), ...ngDevMode ? [{ debugName: "unifiedConversionRate" }] : []);
    this.aiStats = computed(() => this.aiService.stats(), ...ngDevMode ? [{ debugName: "aiStats" }] : []);
    this.aiConnected = computed(() => this.aiService.isConnected(), ...ngDevMode ? [{ debugName: "aiConnected" }] : []);
    this.viewMode = signal("unified", ...ngDevMode ? [{ debugName: "viewMode" }] : []);
    this.isRefreshing = signal(false, ...ngDevMode ? [{ debugName: "isRefreshing" }] : []);
    this.lastUpdate = signal(/* @__PURE__ */ new Date(), ...ngDevMode ? [{ debugName: "lastUpdate" }] : []);
    this.chartPeriod = signal("week", ...ngDevMode ? [{ debugName: "chartPeriod" }] : []);
    this.stats = signal({
      totalGroups: 0,
      activeGroups: 0,
      completedGroups: 0,
      totalConversions: 0,
      conversionRate: 0,
      totalMessagesSent: 0,
      avgMessagesPerGroup: 0,
      todayGroups: 0,
      todayConversions: 0
    }, ...ngDevMode ? [{ debugName: "stats" }] : []);
    this.chartData = signal([], ...ngDevMode ? [{ debugName: "chartData" }] : []);
    this.topRoles = computed(() => {
      const roles = this.multiRoleService.roles();
      return roles.map((r) => __spreadProps(__spreadValues({}, r), {
        successRate: r.usageCount && r.usageCount > 0 ? Math.round((r.successCount || 0) / r.usageCount * 100) : 0
      })).sort((a, b) => b.successRate - a.successRate).slice(0, 5);
    }, ...ngDevMode ? [{ debugName: "topRoles" }] : []);
    this.activeGroups = computed(() => {
      return this.autoGroupService.groups().filter((g) => ["creating", "inviting", "running", "paused"].includes(g.status));
    }, ...ngDevMode ? [{ debugName: "activeGroups" }] : []);
    this.refreshInterval = null;
    this.Math = Math;
  }
  ngOnInit() {
    this.refreshData();
    setTimeout(() => {
      this.dynamicEngine.restoreExecutions().catch((err) => {
        console.warn("[CollabDashboard] \u6062\u5FA9\u57F7\u884C\u72C0\u614B\u5931\u6557:", err);
      });
    }, 2e3);
    this.refreshInterval = setInterval(() => {
      this.refreshData();
    }, 5e3);
    this.ipcCleanup.push(this.ipc.on("ai-team:conversion-signal", (data) => {
      this.showConversionNotification(data);
    }));
    this.ipcCleanup.push(this.ipc.on("ai-team:suggestion-update", (data) => {
      if (this.isManualMode()) {
        this.aiSuggestion.set(data.suggestion);
      }
    }));
    this.ipcCleanup.push(this.ipc.on("ai-team:message-sent", (data) => {
      console.log("[CollabDashboard] \u6536\u5230\u6D88\u606F\u767C\u9001\u4E8B\u4EF6:", data);
      this.refreshData();
    }));
    this.ipcCleanup.push(this.ipc.on("ai-team:private-message-sent", (data) => {
      console.log("[CollabDashboard] \u6536\u5230\u79C1\u804A\u6D88\u606F\u4E8B\u4EF6:", data);
      const execution = this.dynamicEngine.currentExecution();
      if (execution && data.executionId === execution.id && data.success) {
        const existingMsg = execution.messageHistory?.find((m) => m.content === data.content && !m.isFromCustomer);
        if (!existingMsg) {
          console.log("[CollabDashboard] \u{1F4E4} \u6DFB\u52A0 AI \u6D88\u606F\u5230\u6B77\u53F2:", data.content?.substring(0, 30));
          if (!execution.messageHistory)
            execution.messageHistory = [];
          execution.messageHistory.push({
            role: data.roleName || "AI",
            content: data.content,
            timestamp: (/* @__PURE__ */ new Date()).toISOString(),
            isFromCustomer: false
          });
          this.dynamicEngine.forceUpdateExecution(execution);
        }
        this.scrollToBottom();
      }
      this.refreshData();
    }));
    this.ipcCleanup.push(this.ipc.on("ai-team:customer-reply", (data) => {
      console.log("[CollabDashboard] \u6536\u5230\u5BA2\u6236\u56DE\u8986:", data);
      const execution = this.dynamicEngine.currentExecution();
      if (execution && data.executionId === execution.id) {
        const existingMsg = execution.messageHistory?.find((m) => m.content === data.text && m.isFromCustomer);
        if (!existingMsg) {
          console.log("[CollabDashboard] \u{1F4DD} \u6DFB\u52A0\u5BA2\u6236\u6D88\u606F\u5230\u6B77\u53F2:", data.text?.substring(0, 30));
          if (!execution.messageHistory)
            execution.messageHistory = [];
          execution.messageHistory.push({
            role: "customer",
            content: data.text,
            timestamp: (/* @__PURE__ */ new Date()).toISOString(),
            isFromCustomer: true
          });
          this.dynamicEngine.forceUpdateExecution(execution);
        }
        this.scrollToBottom();
      }
      this.refreshData();
    }));
  }
  ngOnDestroy() {
    if (this.refreshInterval) {
      clearInterval(this.refreshInterval);
    }
    this.ipcCleanup.forEach((cleanup) => cleanup());
  }
  async refreshData() {
    this.isRefreshing.set(true);
    try {
      const groupStats = this.autoGroupService.statistics();
      this.stats.set({
        totalGroups: groupStats.totalGroups,
        activeGroups: groupStats.activeGroups,
        completedGroups: groupStats.totalGroups - groupStats.activeGroups - groupStats.pendingRequests,
        totalConversions: groupStats.successfulConversions,
        conversionRate: groupStats.totalGroups > 0 ? groupStats.successfulConversions / groupStats.totalGroups * 100 : 0,
        totalMessagesSent: this.executorService.statistics().totalExecutions,
        avgMessagesPerGroup: groupStats.totalGroups > 0 ? this.executorService.statistics().totalExecutions / groupStats.totalGroups : 0,
        todayGroups: 0,
        // TODO: ÂæûÂæåÁ´ØÁç≤Âèñ
        todayConversions: 0
        // TODO: ÂæûÂæåÁ´ØÁç≤Âèñ
      });
      this.generateChartData();
      this.lastUpdate.set(/* @__PURE__ */ new Date());
    } catch (e) {
      console.error("Failed to refresh dashboard data:", e);
    } finally {
      this.isRefreshing.set(false);
    }
  }
  generateChartData() {
    const days = this.chartPeriod() === "week" ? 7 : 30;
    const data = [];
    for (let i = days - 1; i >= 0; i--) {
      const date = /* @__PURE__ */ new Date();
      date.setDate(date.getDate() - i);
      data.push({
        date: date.toISOString().split("T")[0],
        label: i === 0 ? "\u4ECA\u5929" : days === 7 ? ["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"][date.getDay()] : `${date.getMonth() + 1}/${date.getDate()}`,
        groups: Math.floor(Math.random() * 10),
        // TODO: ÂæûÂæåÁ´ØÁç≤ÂèñÁúüÂØ¶Êï∏Êìö
        conversions: Math.floor(Math.random() * 5)
      });
    }
    this.chartData.set(data);
  }
  getStatusLabel(status) {
    const labels = {
      "creating": "\u5275\u5EFA\u4E2D",
      "inviting": "\u9080\u8ACB\u4E2D",
      "running": "\u9032\u884C\u4E2D",
      "paused": "\u5DF2\u66AB\u505C",
      "completed": "\u5DF2\u5B8C\u6210",
      "failed": "\u5931\u6557"
    };
    return labels[status] || status;
  }
  pauseGroup(group) {
    this.autoGroupService.pauseGroup(group.id);
    this.executorService.pauseExecution(group.id);
  }
  resumeGroup(group) {
    this.autoGroupService.resumeGroup(group.id);
    this.executorService.resumeExecution(group.id);
  }
  viewGroupDetails(group) {
    console.log("View group details:", group);
  }
  // üÜï AI ÂúòÈöäÂü∑Ë°åÊéßÂà∂
  pauseExecution() {
    const execution = this.currentExecution();
    if (execution) {
      this.dynamicEngine.pauseExecution(execution.id);
      this.toast.info("\u23F8\uFE0F \u5DF2\u66AB\u505C AI \u5718\u968A\u57F7\u884C");
    }
  }
  resumeExecution() {
    const execution = this.currentExecution();
    if (execution) {
      this.dynamicEngine.resumeExecution(execution.id);
      this.isManualMode.set(false);
      this.toast.success("\u25B6\uFE0F \u5DF2\u6062\u5FA9 AI \u5718\u968A\u57F7\u884C");
    }
  }
  stopExecution() {
    const execution = this.currentExecution();
    if (execution) {
      if (confirm("\u78BA\u5B9A\u8981\u505C\u6B62\u57F7\u884C\u55CE\uFF1F\u9019\u5C07\u7D50\u675F\u7576\u524D\u7684 AI \u5718\u968A\u4EFB\u52D9\u3002")) {
        this.dynamicEngine.stopExecution(execution.id);
        this.showConversationPanel.set(false);
        this.isManualMode.set(false);
        this.toast.info("\u23F9\uFE0F \u5DF2\u505C\u6B62 AI \u5718\u968A\u57F7\u884C");
      }
    }
  }
  // üÜï Â∞çË©±Èù¢ÊùøÊìç‰Ωú
  toggleConversationPanel() {
    this.showConversationPanel.update((v) => !v);
    if (this.showConversationPanel()) {
      setTimeout(() => {
        this.scrollToBottom();
      }, 100);
    }
  }
  scrollToBottom() {
    if (this.conversationContainer?.nativeElement) {
      const container = this.conversationContainer.nativeElement;
      container.scrollTop = container.scrollHeight;
    }
  }
  formatTime(timestamp) {
    const date = new Date(timestamp);
    return date.toLocaleTimeString("zh-TW", { hour: "2-digit", minute: "2-digit" });
  }
  // üÜï ÊâãÂãï‰ªãÂÖ•Êìç‰Ωú
  toggleManualMode() {
    const newMode = !this.isManualMode();
    this.isManualMode.set(newMode);
    const execution = this.currentExecution();
    if (!execution)
      return;
    if (newMode) {
      this.dynamicEngine.pauseExecution(execution.id);
      this.toast.info("\u{1F590}\uFE0F \u5DF2\u5207\u63DB\u5230\u624B\u52D5\u6A21\u5F0F\uFF0CAI \u5DF2\u66AB\u505C");
      if (execution.roles?.length) {
        this.manualSendRole = execution.roles[0].id;
      }
      this.requestAiSuggestion();
    } else {
      this.dynamicEngine.resumeExecution(execution.id);
      this.aiSuggestion.set(null);
      this.toast.success("\u{1F916} \u5DF2\u5207\u63DB\u56DE AI \u81EA\u52D5\u6A21\u5F0F");
    }
  }
  requestAiSuggestion() {
    const execution = this.currentExecution();
    if (!execution)
      return;
    this.ipc.send("ai-team:request-suggestion", {
      executionId: execution.id,
      messageHistory: execution.messageHistory?.slice(-10),
      currentStage: execution.conversionFunnel?.currentStage
    });
  }
  useAiSuggestion() {
    const suggestion = this.aiSuggestion();
    if (suggestion) {
      this.manualMessage = suggestion;
    }
  }
  sendManualMessage() {
    if (!this.manualMessage.trim() || !this.isManualMode())
      return;
    const execution = this.currentExecution();
    if (!execution)
      return;
    const roleId = this.manualSendRole;
    const role = execution.roles?.find((r) => r.id === roleId);
    if (!role) {
      this.toast.error("\u8ACB\u9078\u64C7\u4E00\u500B\u89D2\u8272");
      return;
    }
    this.ipc.send("ai-team:send-manual-message", {
      executionId: execution.id,
      roleId,
      roleName: role.name,
      content: this.manualMessage.trim(),
      targetUserId: execution.targetUsers?.[0]?.id
      // Áï∂ÂâçÁõÆÊ®ôÁî®Êà∂
    });
    this.toast.success(`\u{1F4E4} \u5DF2\u4EE5 ${role.name} \u8EAB\u4EFD\u767C\u9001\u6D88\u606F`);
    this.manualMessage = "";
    setTimeout(() => {
      this.requestAiSuggestion();
    }, 1e3);
  }
  // üÜï ËΩâÂåñÈÄöÁü•
  showConversionNotification(data) {
    this.conversionAlertData.set({
      userId: data.userId,
      userName: data.userName,
      signal: data.signal
    });
    this.showConversionAlert.set(true);
    this.toast.success(`\u{1F3AF} \u9AD8\u8F49\u5316\u4FE1\u865F\uFF01${data.userName}: ${data.signal}`);
    setTimeout(() => {
      this.showConversionAlert.set(false);
    }, 5e3);
  }
  dismissConversionAlert() {
    this.showConversionAlert.set(false);
  }
  focusOnUser(userId) {
    this.showConversationPanel.set(true);
    this.showConversionAlert.set(false);
    this.toast.info("\u5DF2\u5207\u63DB\u5230\u8A72\u7528\u6236\u7684\u5C0D\u8A71");
  }
  // üÜï ÈöäÂàóÁÆ°ÁêÜÊìç‰Ωú
  skipCurrentUser() {
    if (this.dynamicEngine.skipCurrentUser()) {
      this.toast.info("\u5DF2\u8DF3\u904E\u7576\u524D\u7528\u6236\uFF0C\u8655\u7406\u4E0B\u4E00\u500B");
    }
  }
  markAsConverted() {
    if (this.dynamicEngine.completeCurrentUser("converted")) {
      this.toast.success("\u{1F389} \u5DF2\u6A19\u8A18\u70BA\u8F49\u5316\u6210\u529F\uFF01");
    }
  }
  markAsInterested() {
    if (this.dynamicEngine.completeCurrentUser("interested")) {
      this.toast.info("\u5DF2\u6A19\u8A18\u70BA\u6709\u8208\u8DA3\uFF0C\u8655\u7406\u4E0B\u4E00\u500B\u7528\u6236");
    }
  }
  // üÜï ÂõûË¶ÜÁéáË®àÁÆó
  getReplyRate() {
    const exec = this.currentExecution();
    if (!exec || !exec.stats.messagesSent)
      return 0;
    return exec.stats.responsesReceived / exec.stats.messagesSent * 100;
  }
  // üÜï ËΩâÂåñÊºèÊñóÈöéÊÆµÂà§Êñ∑
  isStageCompleted(stageId) {
    const exec = this.currentExecution();
    if (!exec?.conversionFunnel)
      return false;
    const stageOrder = ["contact", "response", "interest", "intent", "conversion"];
    const currentIndex = stageOrder.indexOf(exec.conversionFunnel.currentStage);
    const checkIndex = stageOrder.indexOf(stageId);
    return checkIndex < currentIndex;
  }
  isCurrentStage(stageId) {
    const exec = this.currentExecution();
    return exec?.conversionFunnel?.currentStage === stageId;
  }
  // üÜï ÁµêÊûúÁµ±Ë®àÊñπÊ≥ï
  getResultCount(result) {
    const completed = this.queueProgress()?.completed || [];
    return completed.filter((u) => u.result === result).length;
  }
  getConversionRate() {
    const completed = this.queueProgress()?.completed || [];
    if (completed.length === 0)
      return 0;
    const converted = completed.filter((u) => u.result === "converted").length;
    return converted / completed.length * 100;
  }
  getResultLabel(result) {
    const labels = {
      "converted": "\u8F49\u5316",
      "interested": "\u6709\u8208\u8DA3",
      "neutral": "\u4E2D\u7ACB",
      "rejected": "\u62D2\u7D55",
      "no_response": "\u7121\u56DE\u61C9"
    };
    return labels[result] || result;
  }
  formatDuration(seconds) {
    if (seconds < 60)
      return `${seconds}\u79D2`;
    if (seconds < 3600)
      return `${Math.floor(seconds / 60)}\u5206${seconds % 60}\u79D2`;
    const hours = Math.floor(seconds / 3600);
    const mins = Math.floor(seconds % 3600 / 60);
    return `${hours}\u6642${mins}\u5206`;
  }
  exportResults() {
    const completed = this.queueProgress()?.completed || [];
    if (completed.length === 0) {
      this.toast.info("\u66AB\u7121\u53EF\u5C0E\u51FA\u7684\u7D50\u679C");
      return;
    }
    const headers = ["\u7528\u6236", "\u7D50\u679C", "\u6D88\u606F\u6578", "\u6642\u9577(\u79D2)"];
    const rows = completed.map((u) => [u.name, this.getResultLabel(u.result), u.messagesExchanged, u.duration]);
    const csv = [headers.join(","), ...rows.map((r) => r.join(","))].join("\n");
    const blob = new Blob(["\uFEFF" + csv], { type: "text/csv;charset=utf-8" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `ai-team-results-${(/* @__PURE__ */ new Date()).toISOString().slice(0, 10)}.csv`;
    a.click();
    URL.revokeObjectURL(url);
    this.toast.success("\u7D50\u679C\u5DF2\u5C0E\u51FA\u70BA CSV \u6587\u4EF6");
  }
  // üÜï Ê≠∑Âè≤ÂõûÊîæÊñπÊ≥ï
  viewExecutionHistory(exec) {
    this.selectedHistory.set(exec);
    this.showHistoryPanel.set(true);
  }
  rerunExecution(exec) {
    this.showHistoryPanel.set(false);
    this.dynamicEngine.startFromOnePhrase(exec.goal, exec.mode, exec.targetUsers?.map((u) => ({
      id: String(u.id),
      telegramId: String(u.id),
      username: u.username,
      firstName: u.firstName,
      lastName: u.lastName,
      intentScore: u.intentScore,
      source: u.source
    }))).then((newExec) => {
      if (newExec) {
        this.toast.success("\u{1F504} \u5DF2\u4F7F\u7528\u76F8\u540C\u7B56\u7565\u91CD\u65B0\u555F\u52D5\u57F7\u884C");
      }
    });
  }
  // üÜï A/B Ê∏¨Ë©¶Â∞çÊØîÊñπÊ≥ï
  isSelectedForCompare(exec) {
    return this.selectedForCompare().some((e) => e.id === exec.id);
  }
  toggleCompareSelection(exec) {
    const current = this.selectedForCompare();
    const exists = current.find((e) => e.id === exec.id);
    if (exists) {
      this.selectedForCompare.set(current.filter((e) => e.id !== exec.id));
    } else {
      if (current.length >= 3) {
        this.toast.info("\u6700\u591A\u53EA\u80FD\u9078\u64C7 3 \u500B\u7B56\u7565\u9032\u884C\u5C0D\u6BD4");
        return;
      }
      this.selectedForCompare.set([...current, exec]);
    }
  }
  clearCompareSelection() {
    this.selectedForCompare.set([]);
  }
  openABTestPanel() {
    if (this.selectedForCompare().length < 2) {
      this.toast.info("\u8ACB\u81F3\u5C11\u9078\u64C7 2 \u500B\u57F7\u884C\u8A18\u9304\u9032\u884C\u5C0D\u6BD4");
      return;
    }
    this.showABTestPanel.set(true);
  }
  getResponseRate(exec) {
    if (!exec.stats.messagesSent)
      return 0;
    return exec.stats.responsesReceived / exec.stats.messagesSent * 100;
  }
  isHighestValue(metric, index) {
    const executions = this.selectedForCompare();
    let values;
    switch (metric) {
      case "messagesSent":
        values = executions.map((e) => e.stats.messagesSent);
        break;
      case "responsesReceived":
        values = executions.map((e) => e.stats.responsesReceived);
        break;
      case "responseRate":
        values = executions.map((e) => this.getResponseRate(e));
        break;
      default:
        return false;
    }
    const maxValue = Math.max(...values);
    return values[index] === maxValue && maxValue > 0;
  }
  getBestStrategyIndex() {
    const executions = this.selectedForCompare();
    if (executions.length === 0)
      return 0;
    const scores = executions.map((exec) => {
      const responseRate = this.getResponseRate(exec);
      const messages = exec.stats.messagesSent;
      return responseRate * 0.6 + (messages > 0 ? messages * 0.4 : 0);
    });
    return scores.indexOf(Math.max(...scores));
  }
  // ============ üÜï P1-1: Áµ±‰∏Ä‰ªªÂãôÊìç‰ΩúÊñπÊ≥ï ============
  /**
   * Áç≤ÂèñÁõÆÊ®ôÈ°ûÂûãÂúñÊ®ô
   */
  getGoalIcon(goalType) {
    return GOAL_TYPE_CONFIG[goalType]?.icon || "\u{1F3AF}";
  }
  /**
   * Áç≤ÂèñÁõÆÊ®ôÈ°ûÂûãÊ®ôÁ±§
   */
  getGoalLabel(goalType) {
    return GOAL_TYPE_CONFIG[goalType]?.label || goalType;
  }
  /**
   * Áç≤Âèñ‰ªªÂãôÁãÄÊÖãÊ®ôÁ±§
   */
  getTaskStatusLabel(status) {
    const labels = {
      "draft": "\u8349\u7A3F",
      "scheduled": "\u5DF2\u8A08\u5283",
      "running": "\u57F7\u884C\u4E2D",
      "paused": "\u5DF2\u66AB\u505C",
      "completed": "\u5DF2\u5B8C\u6210",
      "failed": "\u5931\u6557"
    };
    return labels[status] || status;
  }
  /**
   * ÂïüÂãïÁµ±‰∏Ä‰ªªÂãô
   */
  startUnifiedTask(taskId) {
    this.taskService.startTask(taskId);
    this.toast.success("\u4EFB\u52D9\u5DF2\u555F\u52D5");
  }
  /**
   * Êö´ÂÅúÁµ±‰∏Ä‰ªªÂãô
   */
  pauseUnifiedTask(taskId) {
    this.taskService.pauseTask(taskId);
    this.toast.info("\u4EFB\u52D9\u5DF2\u66AB\u505C");
  }
  /**
   * Â∞éËà™Âà∞Êô∫ËÉΩÁáüÈä∑‰∏≠ÂøÉ
   */
  goToSmartMarketingHub() {
    this.ipc.send("navigate-to", { path: "/smart-marketing" });
  }
  static {
    this.\u0275fac = function CollaborationDashboardComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _CollaborationDashboardComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _CollaborationDashboardComponent, selectors: [["app-collaboration-dashboard"]], viewQuery: function CollaborationDashboardComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c0, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.conversationContainer = _t.first);
      }
    }, decls: 87, vars: 54, consts: [["conversationContainer", ""], [1, "collaboration-dashboard", "p-6", "bg-slate-900", "min-h-full"], [1, "fixed", "top-4", "right-4", "z-50", "animate-slide-in-right"], [1, "flex", "items-center", "justify-between", "mb-8"], [1, "text-2xl", "font-bold", "text-white", "flex", "items-center", "gap-3"], [1, "text-2xl"], [1, "text-slate-400", "mt-1"], [1, "flex", "items-center", "gap-3"], [1, "px-4", "py-2", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", "flex", "items-center", "gap-2", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-4", "h-4"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"], [1, "text-sm", "text-slate-500"], [1, "flex", "items-center", "gap-2", "mb-4"], [1, "px-4", "py-2", "rounded-lg", "text-sm", "font-medium", "transition-all", 3, "click"], [1, "ml-auto", "flex", "items-center", "gap-2"], [1, "flex", "items-center", "gap-2", "px-3", "py-1", "bg-emerald-500/20", "text-emerald-400", "rounded-full", "text-sm"], [1, "px-3", "py-1", "bg-yellow-500/20", "text-yellow-400", "rounded-full", "text-sm"], [1, "grid", "grid-cols-5", "gap-4", "mb-8"], [1, "mb-8", "bg-gradient-to-r", "from-purple-500/10", "to-pink-500/10", "rounded-xl", "border", "border-purple-500/30", "overflow-hidden"], [1, "fixed", "inset-0", "z-50", "flex"], [1, "fixed", "inset-0", "z-50", "flex", "items-center", "justify-center"], [1, "grid", "grid-cols-3", "gap-6", "mb-8"], [1, "col-span-2", "bg-slate-800/50", "rounded-xl", "p-5", "border", "border-slate-700/50"], [1, "flex", "items-center", "justify-between", "mb-4"], [1, "text-lg", "font-semibold", "text-white"], [1, "flex", "gap-2"], [1, "px-3", "py-1", "text-sm", "rounded-lg", 3, "click"], [1, "h-48", "flex", "items-end", "gap-2"], [1, "flex-1", "flex", "flex-col", "items-center", "gap-1"], [1, "flex", "justify-center", "gap-6", "mt-4", "text-sm"], [1, "flex", "items-center", "gap-2"], [1, "w-3", "h-3", "rounded", "bg-purple-500"], [1, "text-slate-400"], [1, "w-3", "h-3", "rounded", "bg-emerald-500"], [1, "bg-slate-800/50", "rounded-xl", "p-5", "border", "border-slate-700/50"], [1, "text-lg", "font-semibold", "text-white", "mb-4"], [1, "space-y-3"], [1, "text-center", "py-8", "text-slate-500"], [1, "bg-slate-800/50", "rounded-xl", "border", "border-slate-700/50", "mb-8"], [1, "p-5", "border-b", "border-slate-700/50", "flex", "items-center", "justify-between"], [1, "text-lg", "font-semibold", "text-white", "flex", "items-center", "gap-2"], [1, "px-3", "py-1.5", "bg-purple-500", "text-white", "text-sm", "rounded-lg", "hover:bg-purple-600", "flex", "items-center", "gap-1"], [1, "text-xs", "text-slate-400", "hover:text-white"], [1, "text-sm", "text-slate-400"], [1, "divide-y", "divide-slate-700/50", "max-h-[300px]", "overflow-y-auto"], [1, "p-4", "hover:bg-slate-700/30", "transition-colors", "cursor-pointer"], [1, "p-8", "text-center", "text-slate-500"], [1, "bg-slate-800/50", "rounded-xl", "border", "border-slate-700/50"], [1, "divide-y", "divide-slate-700/50"], [1, "p-4", "hover:bg-slate-700/30", "transition-colors"], [1, "bg-gradient-to-r", "from-emerald-500", "to-teal-500", "rounded-xl", "p-4", "shadow-2xl", "max-w-sm"], [1, "flex", "items-start", "gap-3"], [1, "w-10", "h-10", "bg-white/20", "rounded-full", "flex", "items-center", "justify-center", "text-2xl"], [1, "flex-1"], [1, "font-bold", "text-white", "text-lg"], [1, "text-white/90", "text-sm", "mt-1"], [1, "font-medium"], [1, "text-white/80", "text-xs", "mt-1"], [1, "flex", "gap-2", "mt-3"], [1, "px-3", "py-1.5", "bg-white/20", "hover:bg-white/30", "text-white", "text-xs", "rounded-lg", 3, "click"], [1, "px-3", "py-1.5", "bg-white/10", "hover:bg-white/20", "text-white/80", "text-xs", "rounded-lg", 3, "click"], [1, "text-white/60", "hover:text-white", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-5", "h-5"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M6 18L18 6M6 6l12 12"], [1, "w-2", "h-2", "bg-emerald-500", "rounded-full"], [1, "grid", "grid-cols-6", "gap-4", "mb-8"], [1, "bg-gradient-to-br", "from-purple-500/20", "to-purple-600/10", "rounded-xl", "p-4", "border", "border-purple-500/30"], [1, "text-3xl", "font-bold", "text-purple-400"], [1, "text-sm", "text-slate-400", "mt-1"], [1, "bg-gradient-to-br", "from-emerald-500/20", "to-emerald-600/10", "rounded-xl", "p-4", "border", "border-emerald-500/30"], [1, "text-3xl", "font-bold", "text-emerald-400"], [1, "w-2", "h-2", "bg-emerald-500", "rounded-full", "animate-pulse"], [1, "bg-gradient-to-br", "from-cyan-500/20", "to-cyan-600/10", "rounded-xl", "p-4", "border", "border-cyan-500/30"], [1, "text-3xl", "font-bold", "text-cyan-400"], [1, "bg-gradient-to-br", "from-amber-500/20", "to-amber-600/10", "rounded-xl", "p-4", "border", "border-amber-500/30"], [1, "text-3xl", "font-bold", "text-amber-400"], [1, "bg-gradient-to-br", "from-pink-500/20", "to-pink-600/10", "rounded-xl", "p-4", "border", "border-pink-500/30"], [1, "text-3xl", "font-bold", "text-pink-400"], [1, "h-1.5", "bg-slate-700", "rounded-full", "mt-2", "overflow-hidden"], [1, "h-full", "bg-gradient-to-r", "from-pink-500", "to-rose-500", "rounded-full", "transition-all"], [1, "bg-gradient-to-br", "from-blue-500/20", "to-blue-600/10", "rounded-xl", "p-4", "border", "border-blue-500/30"], [1, "text-3xl", "font-bold", "text-blue-400"], [1, "bg-gradient-to-r", "from-cyan-500/10", "to-purple-500/10", "rounded-xl", "border", "border-cyan-500/30", "p-4", "mb-8"], [1, "font-semibold", "text-white", "flex", "items-center", "gap-2"], [1, "flex", "items-center", "gap-2", "text-sm", "text-slate-400"], [1, "grid", "grid-cols-5", "gap-4"], [1, "bg-slate-800/50", "rounded-lg", "p-3", "text-center"], [1, "text-2xl", "font-bold", "text-cyan-400"], [1, "text-xs", "text-slate-400"], [1, "text-2xl", "font-bold", "text-purple-400"], [1, "text-2xl", "font-bold", "text-emerald-400"], [1, "text-2xl", "font-bold", "text-amber-400"], [1, "text-2xl", "font-bold", "text-pink-400"], [1, "p-4", "border-b", "border-slate-700/50", "flex", "items-center", "justify-between"], [1, "px-3", "py-1.5", "bg-purple-500/20", "text-purple-400", "rounded-lg", "text-sm", "hover:bg-purple-500/30", 3, "click"], [1, "divide-y", "divide-slate-700/50", "max-h-[400px]", "overflow-y-auto"], [1, "flex", "items-center", "justify-between"], [1, "flex", "items-center", "gap-4"], [1, "w-12", "h-12", "rounded-xl", "flex", "items-center", "justify-center", "text-2xl"], [1, "font-medium", "text-white"], [1, "text-sm", "text-slate-400", "flex", "items-center", "gap-2"], [1, "text-slate-600"], [1, "text-emerald-400"], [1, "text-right"], [1, "text-lg", "font-bold"], [1, "text-xs", "text-slate-500"], [1, "px-3", "py-1", "rounded-full", "text-xs", "font-medium"], [1, "px-3", "py-1.5", "bg-yellow-500/20", "text-yellow-400", "rounded-lg", "text-sm", "hover:bg-yellow-500/30"], [1, "px-3", "py-1.5", "bg-emerald-500/20", "text-emerald-400", "rounded-lg", "text-sm", "hover:bg-emerald-500/30"], [1, "px-3", "py-1.5", "bg-yellow-500/20", "text-yellow-400", "rounded-lg", "text-sm", "hover:bg-yellow-500/30", 3, "click"], [1, "px-3", "py-1.5", "bg-emerald-500/20", "text-emerald-400", "rounded-lg", "text-sm", "hover:bg-emerald-500/30", 3, "click"], [1, "text-4xl", "mb-2"], [1, "mt-4", "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", "hover:bg-purple-500/30", 3, "click"], [1, "text-4xl", "font-bold", "text-purple-400"], [1, "text-xs", "text-purple-400/70", "mt-2"], [1, "text-4xl", "font-bold", "text-emerald-400"], [1, "text-xs", "text-emerald-400/70", "mt-2"], [1, "text-4xl", "font-bold", "text-cyan-400"], [1, "text-xs", "text-cyan-400/70", "mt-2"], [1, "text-4xl", "font-bold", "text-amber-400"], [1, "text-xs", "text-amber-400/70", "mt-2"], [1, "text-4xl", "font-bold", "text-pink-400"], [1, "h-1.5", "bg-slate-700", "rounded-full", "mt-3", "overflow-hidden"], [1, "h-full", "bg-gradient-to-r", "from-pink-500", "to-rose-500", "rounded-full", "transition-all", "duration-500"], [1, "p-4", "border-b", "border-purple-500/20", "flex", "items-center", "justify-between"], [1, "w-3", "h-3", "bg-green-500", "rounded-full", "animate-pulse"], [1, "px-2", "py-0.5", "bg-purple-500/30", "text-purple-300", "text-xs", "rounded-full"], [1, "px-3", "py-1.5", "bg-amber-500/20", "text-amber-400", "rounded-lg", "text-sm", "hover:bg-amber-500/30"], [1, "px-3", "py-1.5", "bg-red-500/20", "text-red-400", "rounded-lg", "text-sm", "hover:bg-red-500/30", 3, "click"], [1, "p-4"], [1, "mb-4"], [1, "text-sm", "text-slate-400", "mb-1"], [1, "text-white", "font-medium"], [1, "grid", "grid-cols-6", "gap-3", "mb-4"], [1, "text-2xl", "font-bold"], [1, "mb-4", "p-3", "bg-slate-800/30", "rounded-lg"], [1, "mb-4", "p-3", "bg-slate-800/50", "rounded-lg"], [1, "flex", "items-center", "justify-between", "mb-2"], [1, "text-xs", "text-purple-400", "hover:text-purple-300", "flex", "items-center", "gap-1", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-3", "h-3"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M19 9l-7 7-7-7"], [1, "space-y-2", "max-h-48", "overflow-y-auto"], [1, "text-center", "py-4", "text-slate-500", "text-sm"], [1, "px-3", "py-1.5", "bg-amber-500/20", "text-amber-400", "rounded-lg", "text-sm", "hover:bg-amber-500/30", 3, "click"], [1, "text-sm", "text-slate-400", "mb-2"], [1, "flex", "items-center", "gap-1"], [1, "flex-1", "relative"], [1, "h-2", "rounded-full", "transition-all"], [1, "text-xs", "text-center", "mt-1"], [1, "w-4", "h-px", "bg-slate-600"], [1, "text-sm", "text-white", "font-medium"], [1, "text-slate-500", "ml-1"], [1, "h-2", "bg-slate-700", "rounded-full", "overflow-hidden", "mb-3"], [1, "h-full", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "transition-all", "duration-300"], [1, "flex", "items-center", "justify-between", "text-sm"], [1, "text-xs", "text-slate-500", "mt-2"], [1, "mt-3", "pt-3", "border-t", "border-slate-700"], [1, "w-2", "h-2", "bg-green-500", "rounded-full", "animate-pulse"], [1, "text-white"], [1, "px-2", "py-1", "bg-slate-600", "text-slate-300", "text-xs", "rounded", "hover:bg-slate-500", 3, "click"], [1, "px-2", "py-1", "bg-emerald-500/20", "text-emerald-400", "text-xs", "rounded", "hover:bg-emerald-500/30", 3, "click"], [1, "text-xs", "text-slate-400", "mb-2"], [1, "flex", "flex-wrap", "gap-2"], [1, "px-2", "py-1", "bg-emerald-500/20", "text-emerald-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "px-2", "py-1", "bg-amber-500/20", "text-amber-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "px-2", "py-1", "bg-slate-500/20", "text-slate-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "px-2", "py-1", "bg-red-500/20", "text-red-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "px-2", "py-1", "bg-gray-500/20", "text-gray-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "mt-2", "text-xs", "text-purple-400", "hover:text-purple-300", 3, "click"], [1, "px-2", "py-1", "bg-slate-700", "rounded-full", "text-xs", "text-slate-300", "flex", "items-center", "gap-1"], [1, "px-2", "py-1", "bg-slate-600", "rounded-full", "text-xs", "text-slate-400"], [1, "w-2", "h-2", "rounded-full"], [1, "flex", "gap-3", "p-2", "rounded-lg", 3, "bg-slate-700/50", "bg-emerald-500/10"], [1, "flex", "gap-3", "p-2", "rounded-lg"], [1, "w-8", "h-8", "rounded-full", "flex", "items-center", "justify-center", "text-sm"], [1, "flex-1", "min-w-0"], [1, "text-xs", "text-slate-400", "mb-0.5"], [1, "text-sm", "text-white", "truncate"], [1, "absolute", "inset-0", "bg-black/50", 3, "click"], [1, "absolute", "right-0", "top-0", "bottom-0", "w-[500px]", "bg-slate-900", "border-l", "border-slate-700", "flex", "flex-col", "shadow-2xl"], [1, "p-4", "border-b", "border-slate-700", "flex", "items-center", "justify-between"], [1, "text-xl"], [1, "p-2", "hover:bg-slate-700", "rounded-lg", "text-slate-400", 3, "click"], [1, "flex-1", "overflow-y-auto", "p-4", "space-y-3"], [1, "flex", "gap-3", 3, "flex-row-reverse"], [1, "border-t", "border-slate-700", "p-4"], [1, "flex", "items-center", "gap-2", "mb-3"], [1, "text-xs", "px-2", "py-0.5", "rounded-full"], [1, "text-xs", "text-purple-400", "hover:text-purple-300", 3, "click"], [1, "mb-3"], [1, "flex-1", "px-3", "py-2", "bg-slate-800", "border", "border-slate-600", "rounded-lg", "text-white", "text-sm", "placeholder:text-slate-500", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "ngModelChange", "keydown.enter", "ngModel", "disabled", "placeholder"], [1, "px-4", "py-2", "bg-purple-500", "text-white", "rounded-lg", "text-sm", "hover:bg-purple-600", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "click", "disabled"], [1, "mt-3", "p-3", "bg-purple-500/10", "border", "border-purple-500/30", "rounded-lg"], [1, "flex", "gap-3"], [1, "w-10", "h-10", "rounded-full", "flex", "items-center", "justify-center", "flex-shrink-0"], [1, "max-w-[70%]", "rounded-xl", "p-3"], [1, "text-xs", "mb-1"], [1, "text-slate-500", "ml-2"], [1, "text-sm", "text-white", "whitespace-pre-wrap"], [1, "text-xs", "text-slate-400", "mb-1", "block"], [1, "w-full", "px-3", "py-2", "bg-slate-800", "border", "border-slate-600", "rounded-lg", "text-white", "text-sm", 3, "ngModelChange", "ngModel"], [3, "value"], [1, "text-xs", "text-purple-400", "mb-1"], [1, "text-sm", "text-white"], [1, "relative", "bg-slate-900", "rounded-xl", "border", "border-slate-700", "w-[700px]", "max-h-[80vh]", "overflow-hidden", "shadow-2xl"], [1, "p-4", "border-b", "border-slate-700"], [1, "grid", "grid-cols-5", "gap-3"], [1, "bg-emerald-500/10", "rounded-lg", "p-3", "text-center", "border", "border-emerald-500/30"], [1, "text-xs", "text-emerald-400/70"], [1, "bg-amber-500/10", "rounded-lg", "p-3", "text-center", "border", "border-amber-500/30"], [1, "text-xs", "text-amber-400/70"], [1, "bg-slate-500/10", "rounded-lg", "p-3", "text-center", "border", "border-slate-500/30"], [1, "text-2xl", "font-bold", "text-slate-400"], [1, "text-xs", "text-slate-400/70"], [1, "bg-red-500/10", "rounded-lg", "p-3", "text-center", "border", "border-red-500/30"], [1, "text-2xl", "font-bold", "text-red-400"], [1, "text-xs", "text-red-400/70"], [1, "bg-gray-500/10", "rounded-lg", "p-3", "text-center", "border", "border-gray-500/30"], [1, "text-2xl", "font-bold", "text-gray-400"], [1, "text-xs", "text-gray-400/70"], [1, "mt-4", "flex", "items-center", "gap-4"], [1, "h-3", "bg-slate-700", "rounded-full", "overflow-hidden"], [1, "h-full", "bg-gradient-to-r", "from-emerald-500", "to-teal-500", "transition-all"], [1, "p-4", "max-h-[400px]", "overflow-y-auto"], [1, "w-full"], [1, "text-xs", "text-slate-400", "border-b", "border-slate-700"], [1, "text-left", "py-2", "px-2"], [1, "text-right", "py-2", "px-2"], [1, "text-sm"], [1, "border-b", "border-slate-800", "hover:bg-slate-800/50"], [1, "p-4", "border-t", "border-slate-700", "flex", "justify-between"], [1, "px-4", "py-2", "bg-purple-500", "text-white", "rounded-lg", "hover:bg-purple-600", 3, "click"], [1, "py-2", "px-2", "text-white"], [1, "py-2", "px-2"], [1, "px-2", "py-0.5", "rounded-full", "text-xs"], [1, "py-2", "px-2", "text-right", "text-slate-300"], [1, "py-2", "px-2", "text-right", "text-slate-400"], [1, "w-full", "bg-slate-700", "rounded-t", "relative", "flex", "flex-col", "justify-end"], [1, "absolute", "-top-5", "left-1/2", "-translate-x-1/2", "text-xs", "text-slate-400"], [1, "w-6", "h-6", "rounded-full", "flex", "items-center", "justify-center", "text-xs", "font-bold"], [1, "text-sm", "font-medium", "text-white", "truncate"], [1, "text-sm", "font-bold", "text-emerald-400"], [1, "px-3", "py-1.5", "bg-purple-500", "text-white", "text-sm", "rounded-lg", "hover:bg-purple-600", "flex", "items-center", "gap-1", 3, "click"], [1, "text-xs", "text-slate-400", "hover:text-white", 3, "click"], [1, "p-4", "hover:bg-slate-700/30", "transition-colors", "cursor-pointer", 3, "click"], ["type", "checkbox", 1, "w-4", "h-4", "rounded", "border-slate-500", "bg-slate-700", "text-purple-500", "focus:ring-purple-500", 3, "click", "change", "checked"], [1, "w-10", "h-10", "rounded-full", "flex", "items-center", "justify-center"], [1, "text-lg"], [1, "text-xs", "text-slate-400", "flex", "items-center", "gap-2"], [1, "text-sm", "font-bold", "text-purple-400"], [1, "p-2", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", 3, "click"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M15 12a3 3 0 11-6 0 3 3 0 016 0z"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"], [1, "relative", "bg-slate-900", "rounded-xl", "border", "border-slate-700", "w-[800px]", "max-h-[85vh]", "overflow-hidden", "shadow-2xl"], [1, "p-4", "border-b", "border-slate-700", "grid", "grid-cols-5", "gap-3"], [1, "bg-slate-800", "rounded-lg", "p-3", "text-center"], [1, "text-xl", "font-bold", "text-purple-400"], [1, "text-xl", "font-bold", "text-emerald-400"], [1, "text-xl", "font-bold", "text-cyan-400"], [1, "text-xl", "font-bold", "text-amber-400"], [1, "text-xl", "font-bold", "text-pink-400"], [1, "p-4", "max-h-[400px]", "overflow-y-auto", "space-y-3"], [1, "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", "hover:bg-purple-500/30", "flex", "items-center", "gap-2", 3, "click"], [1, "px-4", "py-2", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", 3, "click"], [1, "relative", "bg-slate-900", "rounded-xl", "border", "border-slate-700", "w-[900px]", "max-h-[85vh]", "overflow-hidden", "shadow-2xl"], [1, "px-2", "py-0.5", "bg-purple-500/20", "text-purple-400", "text-xs", "rounded-full"], [1, "p-4", "overflow-x-auto"], [1, "w-full", "text-sm"], [1, "text-slate-400", "border-b", "border-slate-700"], [1, "text-left", "py-3", "px-3", "w-32"], [1, "text-center", "py-3", "px-3"], [1, "border-b", "border-slate-800"], [1, "py-3", "px-3", "text-slate-400"], [1, "py-3", "px-3", "text-center"], [1, "py-3", "px-3", "text-center", "font-bold", 3, "text-emerald-400", "text-white"], [1, "py-3", "px-3", "text-center", "text-slate-300"], [1, "p-4", "border-t", "border-slate-700", "bg-slate-800/50"], [1, "flex", "items-center", "gap-2", "mb-2"], [1, "text-emerald-400", "font-bold"], [1, "p-4", "border-t", "border-slate-700", "flex", "justify-end", "gap-3"], [1, "flex", "flex-col", "items-center"], [1, "px-2", "py-0.5", "rounded-full", "text-xs", "mb-1"], [1, "text-white", "text-xs"], [1, "py-3", "px-3", "text-center", "font-bold"], [1, "w-3", "h-3", "rounded-full"], [1, "flex", "items-center", "gap-6"], [1, "text-center"], [1, "text-lg", "font-bold", "text-purple-400"], [1, "text-lg", "font-bold", "text-cyan-400"], [1, "p-2", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600"], [1, "p-2", "bg-emerald-500/20", "text-emerald-400", "rounded-lg", "hover:bg-emerald-500/30"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"], [1, "p-2", "bg-emerald-500/20", "text-emerald-400", "rounded-lg", "hover:bg-emerald-500/30", 3, "click"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"]], template: function CollaborationDashboardComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 1);
        \u0275\u0275conditionalCreate(1, CollaborationDashboardComponent_Conditional_1_Template, 21, 2, "div", 2);
        \u0275\u0275elementStart(2, "div", 3)(3, "div")(4, "h2", 4)(5, "span", 5);
        \u0275\u0275text(6, "\u{1F4CA}");
        \u0275\u0275elementEnd();
        \u0275\u0275text(7, " \u5354\u4F5C\u76E3\u63A7\u4E2D\u5FC3 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "p", 6);
        \u0275\u0275text(9, "\u5BE6\u6642\u76E3\u63A7\u591A\u89D2\u8272\u5354\u4F5C\u72C0\u614B");
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(10, "div", 7)(11, "button", 8);
        \u0275\u0275listener("click", function CollaborationDashboardComponent_Template_button_click_11_listener() {
          return ctx.refreshData();
        });
        \u0275\u0275namespaceSVG();
        \u0275\u0275elementStart(12, "svg", 9);
        \u0275\u0275element(13, "path", 10);
        \u0275\u0275elementEnd();
        \u0275\u0275text(14, " \u5237\u65B0 ");
        \u0275\u0275elementEnd();
        \u0275\u0275namespaceHTML();
        \u0275\u0275elementStart(15, "div", 11);
        \u0275\u0275text(16);
        \u0275\u0275pipe(17, "date");
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(18, "div", 12)(19, "button", 13);
        \u0275\u0275listener("click", function CollaborationDashboardComponent_Template_button_click_19_listener() {
          return ctx.viewMode.set("unified");
        });
        \u0275\u0275text(20, " \u{1F4CA} \u7D71\u4E00\u4EFB\u52D9\u8996\u5716 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(21, "button", 13);
        \u0275\u0275listener("click", function CollaborationDashboardComponent_Template_button_click_21_listener() {
          return ctx.viewMode.set("legacy");
        });
        \u0275\u0275text(22, " \u{1F3AD} \u5354\u4F5C\u7FA4\u7D44\u8996\u5716 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(23, "div", 14);
        \u0275\u0275conditionalCreate(24, CollaborationDashboardComponent_Conditional_24_Template, 3, 0, "span", 15)(25, CollaborationDashboardComponent_Conditional_25_Template, 2, 0, "span", 16);
        \u0275\u0275elementEnd()();
        \u0275\u0275conditionalCreate(26, CollaborationDashboardComponent_Conditional_26_Template, 84, 16);
        \u0275\u0275conditionalCreate(27, CollaborationDashboardComponent_Conditional_27_Template, 39, 13, "div", 17);
        \u0275\u0275conditionalCreate(28, CollaborationDashboardComponent_Conditional_28_Template, 64, 25, "div", 18);
        \u0275\u0275conditionalCreate(29, CollaborationDashboardComponent_Conditional_29_Template, 32, 20, "div", 19);
        \u0275\u0275conditionalCreate(30, CollaborationDashboardComponent_Conditional_30_Template, 71, 13, "div", 20);
        \u0275\u0275elementStart(31, "div", 21)(32, "div", 22)(33, "div", 23)(34, "h3", 24);
        \u0275\u0275text(35, "\u5354\u4F5C\u8DA8\u52E2");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(36, "div", 25)(37, "button", 26);
        \u0275\u0275listener("click", function CollaborationDashboardComponent_Template_button_click_37_listener() {
          return ctx.chartPeriod.set("week");
        });
        \u0275\u0275text(38, " 7\u5929 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(39, "button", 26);
        \u0275\u0275listener("click", function CollaborationDashboardComponent_Template_button_click_39_listener() {
          return ctx.chartPeriod.set("month");
        });
        \u0275\u0275text(40, " 30\u5929 ");
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(41, "div", 27);
        \u0275\u0275repeaterCreate(42, CollaborationDashboardComponent_For_43_Template, 6, 10, "div", 28, _forTrack03);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(44, "div", 29)(45, "div", 30);
        \u0275\u0275element(46, "div", 31);
        \u0275\u0275elementStart(47, "span", 32);
        \u0275\u0275text(48, "\u65B0\u5EFA\u7FA4\u7D44");
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(49, "div", 30);
        \u0275\u0275element(50, "div", 33);
        \u0275\u0275elementStart(51, "span", 32);
        \u0275\u0275text(52, "\u6210\u529F\u8F49\u5316");
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(53, "div", 34)(54, "h3", 35);
        \u0275\u0275text(55, "\u89D2\u8272\u6548\u679C\u6392\u540D");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(56, "div", 36);
        \u0275\u0275repeaterCreate(57, CollaborationDashboardComponent_For_58_Template, 13, 20, "div", 7, \u0275\u0275repeaterTrackByIndex);
        \u0275\u0275conditionalCreate(59, CollaborationDashboardComponent_Conditional_59_Template, 2, 0, "div", 37);
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(60, "div", 38)(61, "div", 39)(62, "h3", 40)(63, "span");
        \u0275\u0275text(64, "\u{1F4DC}");
        \u0275\u0275elementEnd();
        \u0275\u0275text(65, " \u57F7\u884C\u6B77\u53F2 ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(66, "div", 7);
        \u0275\u0275conditionalCreate(67, CollaborationDashboardComponent_Conditional_67_Template, 4, 1, "button", 41);
        \u0275\u0275conditionalCreate(68, CollaborationDashboardComponent_Conditional_68_Template, 2, 0, "button", 42);
        \u0275\u0275elementStart(69, "span", 43);
        \u0275\u0275text(70);
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(71, "div", 44);
        \u0275\u0275repeaterCreate(72, CollaborationDashboardComponent_For_73_Template, 33, 22, "div", 45, _forTrack1);
        \u0275\u0275conditionalCreate(74, CollaborationDashboardComponent_Conditional_74_Template, 5, 0, "div", 46);
        \u0275\u0275elementEnd()();
        \u0275\u0275conditionalCreate(75, CollaborationDashboardComponent_Conditional_75_Template, 52, 8, "div", 20);
        \u0275\u0275conditionalCreate(76, CollaborationDashboardComponent_Conditional_76_Template, 76, 3, "div", 20);
        \u0275\u0275elementStart(77, "div", 47)(78, "div", 39)(79, "h3", 24);
        \u0275\u0275text(80, "\u6D3B\u8E8D\u5354\u4F5C\u7FA4\u7D44");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(81, "span", 43);
        \u0275\u0275text(82);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(83, "div", 48);
        \u0275\u0275repeaterCreate(84, CollaborationDashboardComponent_For_85_Template, 30, 33, "div", 49, _forTrack1);
        \u0275\u0275conditionalCreate(86, CollaborationDashboardComponent_Conditional_86_Template, 5, 0, "div", 46);
        \u0275\u0275elementEnd()()();
      }
      if (rf & 2) {
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showConversionAlert() && ctx.conversionAlertData() ? 1 : -1);
        \u0275\u0275advance(11);
        \u0275\u0275classProp("animate-spin", ctx.isRefreshing());
        \u0275\u0275advance(4);
        \u0275\u0275textInterpolate1(" \u6700\u5F8C\u66F4\u65B0: ", \u0275\u0275pipeBind2(17, 51, ctx.lastUpdate(), "HH:mm:ss"), " ");
        \u0275\u0275advance(3);
        \u0275\u0275classProp("bg-purple-500", ctx.viewMode() === "unified")("text-white", ctx.viewMode() === "unified")("bg-slate-700", ctx.viewMode() !== "unified")("text-slate-400", ctx.viewMode() !== "unified");
        \u0275\u0275advance(2);
        \u0275\u0275classProp("bg-purple-500", ctx.viewMode() === "legacy")("text-white", ctx.viewMode() === "legacy")("bg-slate-700", ctx.viewMode() !== "legacy")("text-slate-400", ctx.viewMode() !== "legacy");
        \u0275\u0275advance(3);
        \u0275\u0275conditional(ctx.aiConnected() ? 24 : 25);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.viewMode() === "unified" ? 26 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.viewMode() === "legacy" ? 27 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.currentExecution() ? 28 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showConversationPanel() && ctx.currentExecution() ? 29 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showResultsPanel() ? 30 : -1);
        \u0275\u0275advance(7);
        \u0275\u0275classProp("bg-purple-500", ctx.chartPeriod() === "week")("text-white", ctx.chartPeriod() === "week")("bg-slate-700", ctx.chartPeriod() !== "week")("text-slate-400", ctx.chartPeriod() !== "week");
        \u0275\u0275advance(2);
        \u0275\u0275classProp("bg-purple-500", ctx.chartPeriod() === "month")("text-white", ctx.chartPeriod() === "month")("bg-slate-700", ctx.chartPeriod() !== "month")("text-slate-400", ctx.chartPeriod() !== "month");
        \u0275\u0275advance(3);
        \u0275\u0275repeater(ctx.chartData());
        \u0275\u0275advance(15);
        \u0275\u0275repeater(ctx.topRoles());
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.topRoles().length === 0 ? 59 : -1);
        \u0275\u0275advance(8);
        \u0275\u0275conditional(ctx.selectedForCompare().length >= 2 ? 67 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.selectedForCompare().length > 0 ? 68 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1("\u5171 ", ctx.executionHistory().length, " \u689D\u8A18\u9304");
        \u0275\u0275advance(2);
        \u0275\u0275repeater(ctx.executionHistory().slice(0, 10));
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.executionHistory().length === 0 ? 74 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showHistoryPanel() && ctx.selectedHistory() ? 75 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showABTestPanel() && ctx.selectedForCompare().length >= 2 ? 76 : -1);
        \u0275\u0275advance(6);
        \u0275\u0275textInterpolate1("\u5171 ", ctx.activeGroups().length, " \u500B");
        \u0275\u0275advance(2);
        \u0275\u0275repeater(ctx.activeGroups());
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.activeGroups().length === 0 ? 86 : -1);
      }
    }, dependencies: [CommonModule, FormsModule, NgSelectOption, \u0275NgSelectMultipleOption, DefaultValueAccessor, SelectControlValueAccessor, NgControlStatus, NgModel, SlicePipe, DecimalPipe, DatePipe], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(CollaborationDashboardComponent, [{
    type: Component,
    args: [{
      selector: "app-collaboration-dashboard",
      standalone: true,
      imports: [CommonModule, FormsModule],
      template: `
    <div class="collaboration-dashboard p-6 bg-slate-900 min-h-full">
      <!-- \u{1F195} \u8F49\u5316\u901A\u77E5\u5F48\u7A97 -->
      @if (showConversionAlert() && conversionAlertData()) {
        <div class="fixed top-4 right-4 z-50 animate-slide-in-right">
          <div class="bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-4 shadow-2xl max-w-sm">
            <div class="flex items-start gap-3">
              <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                \u{1F3AF}
              </div>
              <div class="flex-1">
                <div class="font-bold text-white text-lg">\u9AD8\u8F49\u5316\u4FE1\u865F!</div>
                <div class="text-white/90 text-sm mt-1">
                  <span class="font-medium">{{ conversionAlertData()?.userName }}</span>
                </div>
                <div class="text-white/80 text-xs mt-1">{{ conversionAlertData()?.signal }}</div>
                <div class="flex gap-2 mt-3">
                  <button (click)="focusOnUser(conversionAlertData()!.userId)"
                          class="px-3 py-1.5 bg-white/20 hover:bg-white/30 text-white text-xs rounded-lg">
                    \u67E5\u770B\u5C0D\u8A71
                  </button>
                  <button (click)="dismissConversionAlert()"
                          class="px-3 py-1.5 bg-white/10 hover:bg-white/20 text-white/80 text-xs rounded-lg">
                    \u95DC\u9589
                  </button>
                </div>
              </div>
              <button (click)="dismissConversionAlert()" class="text-white/60 hover:text-white">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      }
      
      <!-- \u6A19\u984C -->
      <div class="flex items-center justify-between mb-8">
        <div>
          <h2 class="text-2xl font-bold text-white flex items-center gap-3">
            <span class="text-2xl">\u{1F4CA}</span>
            \u5354\u4F5C\u76E3\u63A7\u4E2D\u5FC3
          </h2>
          <p class="text-slate-400 mt-1">\u5BE6\u6642\u76E3\u63A7\u591A\u89D2\u8272\u5354\u4F5C\u72C0\u614B</p>
        </div>
        
        <div class="flex items-center gap-3">
          <button (click)="refreshData()"
                  class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 flex items-center gap-2">
            <svg class="w-4 h-4" [class.animate-spin]="isRefreshing()" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
            \u5237\u65B0
          </button>
          
          <div class="text-sm text-slate-500">
            \u6700\u5F8C\u66F4\u65B0: {{ lastUpdate() | date:'HH:mm:ss' }}
          </div>
        </div>
      </div>
      
      <!-- \u{1F195} P1-1: \u8996\u5716\u5207\u63DB -->
      <div class="flex items-center gap-2 mb-4">
        <button (click)="viewMode.set('unified')"
                class="px-4 py-2 rounded-lg text-sm font-medium transition-all"
                [class.bg-purple-500]="viewMode() === 'unified'"
                [class.text-white]="viewMode() === 'unified'"
                [class.bg-slate-700]="viewMode() !== 'unified'"
                [class.text-slate-400]="viewMode() !== 'unified'">
          \u{1F4CA} \u7D71\u4E00\u4EFB\u52D9\u8996\u5716
        </button>
        <button (click)="viewMode.set('legacy')"
                class="px-4 py-2 rounded-lg text-sm font-medium transition-all"
                [class.bg-purple-500]="viewMode() === 'legacy'"
                [class.text-white]="viewMode() === 'legacy'"
                [class.bg-slate-700]="viewMode() !== 'legacy'"
                [class.text-slate-400]="viewMode() !== 'legacy'">
          \u{1F3AD} \u5354\u4F5C\u7FA4\u7D44\u8996\u5716
        </button>
        
        <!-- AI \u9023\u63A5\u72C0\u614B -->
        <div class="ml-auto flex items-center gap-2">
          @if (aiConnected()) {
            <span class="flex items-center gap-2 px-3 py-1 bg-emerald-500/20 text-emerald-400 rounded-full text-sm">
              <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>
              AI \u5DF2\u9023\u63A5
            </span>
          } @else {
            <span class="px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded-full text-sm">
              \u672A\u914D\u7F6E AI
            </span>
          }
        </div>
      </div>
      
      <!-- \u{1F195} P1-1: \u7D71\u4E00\u4EFB\u52D9\u8996\u5716\u7D71\u8A08\u5361\u7247 -->
      @if (viewMode() === 'unified') {
        <div class="grid grid-cols-6 gap-4 mb-8">
          <!-- \u7E3D\u4EFB\u52D9\u6578 -->
          <div class="bg-gradient-to-br from-purple-500/20 to-purple-600/10 rounded-xl p-4 border border-purple-500/30">
            <div class="text-3xl font-bold text-purple-400">{{ unifiedStats().totalTasks }}</div>
            <div class="text-sm text-slate-400 mt-1">\u7E3D\u4EFB\u52D9\u6578</div>
          </div>
          
          <!-- \u6D3B\u8E8D\u4EFB\u52D9 -->
          <div class="bg-gradient-to-br from-emerald-500/20 to-emerald-600/10 rounded-xl p-4 border border-emerald-500/30">
            <div class="flex items-center gap-2">
              <div class="text-3xl font-bold text-emerald-400">{{ unifiedStats().activeTasks }}</div>
              @if (unifiedStats().activeTasks > 0) {
                <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span>
              }
            </div>
            <div class="text-sm text-slate-400 mt-1">\u57F7\u884C\u4E2D</div>
          </div>
          
          <!-- \u7E3D\u63A5\u89F8\u6578 -->
          <div class="bg-gradient-to-br from-cyan-500/20 to-cyan-600/10 rounded-xl p-4 border border-cyan-500/30">
            <div class="text-3xl font-bold text-cyan-400">{{ unifiedStats().totalContacted }}</div>
            <div class="text-sm text-slate-400 mt-1">\u7E3D\u63A5\u89F8</div>
          </div>
          
          <!-- \u7E3D\u8F49\u5316 -->
          <div class="bg-gradient-to-br from-amber-500/20 to-amber-600/10 rounded-xl p-4 border border-amber-500/30">
            <div class="text-3xl font-bold text-amber-400">{{ unifiedStats().totalConverted }}</div>
            <div class="text-sm text-slate-400 mt-1">\u7E3D\u8F49\u5316</div>
          </div>
          
          <!-- \u8F49\u5316\u7387 -->
          <div class="bg-gradient-to-br from-pink-500/20 to-pink-600/10 rounded-xl p-4 border border-pink-500/30">
            <div class="text-3xl font-bold text-pink-400">{{ unifiedConversionRate() }}%</div>
            <div class="text-sm text-slate-400 mt-1">\u8F49\u5316\u7387</div>
            <div class="h-1.5 bg-slate-700 rounded-full mt-2 overflow-hidden">
              <div class="h-full bg-gradient-to-r from-pink-500 to-rose-500 rounded-full transition-all"
                   [style.width.%]="unifiedConversionRate()"></div>
            </div>
          </div>
          
          <!-- \u6D88\u606F\u767C\u9001 -->
          <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/10 rounded-xl p-4 border border-blue-500/30">
            <div class="text-3xl font-bold text-blue-400">{{ unifiedStats().totalMessagesSent }}</div>
            <div class="text-sm text-slate-400 mt-1">\u6D88\u606F\u767C\u9001</div>
          </div>
        </div>
        
        <!-- \u{1F195} AI \u7CFB\u7D71\u72C0\u614B -->
        <div class="bg-gradient-to-r from-cyan-500/10 to-purple-500/10 rounded-xl border border-cyan-500/30 p-4 mb-8">
          <div class="flex items-center justify-between mb-4">
            <h3 class="font-semibold text-white flex items-center gap-2">
              <span>\u{1F9E0}</span> AI \u7CFB\u7D71\u72C0\u614B
            </h3>
            <div class="flex items-center gap-2 text-sm text-slate-400">
              \u4ECA\u65E5\u7D71\u8A08
            </div>
          </div>
          <div class="grid grid-cols-5 gap-4">
            <div class="bg-slate-800/50 rounded-lg p-3 text-center">
              <div class="text-2xl font-bold text-cyan-400">{{ aiStats().today.conversations }}</div>
              <div class="text-xs text-slate-400">\u5C0D\u8A71\u6578</div>
            </div>
            <div class="bg-slate-800/50 rounded-lg p-3 text-center">
              <div class="text-2xl font-bold text-purple-400">{{ aiStats().today.intentsRecognized }}</div>
              <div class="text-xs text-slate-400">\u610F\u5716\u8B58\u5225</div>
            </div>
            <div class="bg-slate-800/50 rounded-lg p-3 text-center">
              <div class="text-2xl font-bold text-emerald-400">{{ aiStats().today.conversions }}</div>
              <div class="text-xs text-slate-400">AI \u8F49\u5316</div>
            </div>
            <div class="bg-slate-800/50 rounded-lg p-3 text-center">
              <div class="text-2xl font-bold text-amber-400">{{ aiStats().today.avgResponseTime }}ms</div>
              <div class="text-xs text-slate-400">\u97FF\u61C9\u6642\u9593</div>
            </div>
            <div class="bg-slate-800/50 rounded-lg p-3 text-center">
              <div class="text-2xl font-bold text-pink-400">\xA5{{ aiStats().today.cost.toFixed(2) }}</div>
              <div class="text-xs text-slate-400">AI \u6210\u672C</div>
            </div>
          </div>
        </div>
        
        <!-- \u{1F195} \u7D71\u4E00\u4EFB\u52D9\u5217\u8868 -->
        <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 mb-8">
          <div class="p-4 border-b border-slate-700/50 flex items-center justify-between">
            <h3 class="font-semibold text-white flex items-center gap-2">
              <span>\u{1F4CB}</span> \u71DF\u92B7\u4EFB\u52D9
            </h3>
            <div class="flex items-center gap-2">
              <span class="text-sm text-slate-400">{{ unifiedTasks().length }} \u500B\u4EFB\u52D9</span>
              <button (click)="goToSmartMarketingHub()"
                      class="px-3 py-1.5 bg-purple-500/20 text-purple-400 rounded-lg text-sm hover:bg-purple-500/30">
                + \u65B0\u5EFA\u4EFB\u52D9
              </button>
            </div>
          </div>
          
          <div class="divide-y divide-slate-700/50 max-h-[400px] overflow-y-auto">
            @for (task of unifiedTasks().slice(0, 10); track task.id) {
              <div class="p-4 hover:bg-slate-700/30 transition-colors">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center text-2xl"
                         [class.bg-emerald-500/20]="task.status === 'running'"
                         [class.bg-purple-500/20]="task.status === 'completed'"
                         [class.bg-slate-700]="task.status === 'draft' || task.status === 'paused'">
                      {{ getGoalIcon(task.goalType) }}
                    </div>
                    <div>
                      <div class="font-medium text-white">{{ task.name }}</div>
                      <div class="text-sm text-slate-400 flex items-center gap-2">
                        <span>{{ getGoalLabel(task.goalType) }}</span>
                        <span class="text-slate-600">\xB7</span>
                        <span>{{ task.stats.totalContacts }} \u76EE\u6A19</span>
                        <span class="text-slate-600">\xB7</span>
                        <span class="text-emerald-400">{{ task.stats.converted }} \u8F49\u5316</span>
                      </div>
                    </div>
                  </div>
                  
                  <div class="flex items-center gap-4">
                    <!-- \u9032\u5EA6\u6307\u6A19 -->
                    <div class="text-right">
                      <div class="text-lg font-bold" 
                           [class.text-emerald-400]="task.stats.conversionRate >= 20"
                           [class.text-amber-400]="task.stats.conversionRate >= 10 && task.stats.conversionRate < 20"
                           [class.text-slate-400]="task.stats.conversionRate < 10">
                        {{ task.stats.conversionRate || 0 }}%
                      </div>
                      <div class="text-xs text-slate-500">\u8F49\u5316\u7387</div>
                    </div>
                    
                    <!-- \u72C0\u614B\u6A19\u7C64 -->
                    <span class="px-3 py-1 rounded-full text-xs font-medium"
                          [class.bg-emerald-500/20]="task.status === 'running'"
                          [class.text-emerald-400]="task.status === 'running'"
                          [class.bg-purple-500/20]="task.status === 'completed'"
                          [class.text-purple-400]="task.status === 'completed'"
                          [class.bg-yellow-500/20]="task.status === 'paused'"
                          [class.text-yellow-400]="task.status === 'paused'"
                          [class.bg-slate-600]="task.status === 'draft'"
                          [class.text-slate-300]="task.status === 'draft'">
                      {{ getTaskStatusLabel(task.status) }}
                    </span>
                    
                    <!-- \u64CD\u4F5C -->
                    <div class="flex gap-2">
                      @if (task.status === 'running') {
                        <button (click)="pauseUnifiedTask(task.id)"
                                class="px-3 py-1.5 bg-yellow-500/20 text-yellow-400 rounded-lg text-sm hover:bg-yellow-500/30">
                          \u66AB\u505C
                        </button>
                      } @else if (task.status === 'paused' || task.status === 'draft') {
                        <button (click)="startUnifiedTask(task.id)"
                                class="px-3 py-1.5 bg-emerald-500/20 text-emerald-400 rounded-lg text-sm hover:bg-emerald-500/30">
                          \u555F\u52D5
                        </button>
                      }
                    </div>
                  </div>
                </div>
              </div>
            }
            
            @if (unifiedTasks().length === 0) {
              <div class="p-8 text-center text-slate-500">
                <div class="text-4xl mb-2">\u{1F4CB}</div>
                <div>\u66AB\u7121\u71DF\u92B7\u4EFB\u52D9</div>
                <button (click)="goToSmartMarketingHub()"
                        class="mt-4 px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30">
                  \u{1F680} \u5275\u5EFA\u7B2C\u4E00\u500B\u4EFB\u52D9
                </button>
              </div>
            }
          </div>
        </div>
      }
      
      <!-- \u820A\u7248\u7D71\u8A08\u5361\u7247\uFF08\u5354\u4F5C\u7FA4\u7D44\u8996\u5716\uFF09 -->
      @if (viewMode() === 'legacy') {
        <div class="grid grid-cols-5 gap-4 mb-8">
          <!-- \u7E3D\u7FA4\u7D44\u6578 -->
          <div class="bg-gradient-to-br from-purple-500/20 to-purple-600/10 rounded-xl p-4 border border-purple-500/30">
            <div class="text-4xl font-bold text-purple-400">{{ stats().totalGroups }}</div>
            <div class="text-sm text-slate-400 mt-1">\u7E3D\u7FA4\u7D44\u6578</div>
            <div class="text-xs text-purple-400/70 mt-2">
              \u4ECA\u65E5 +{{ stats().todayGroups }}
            </div>
          </div>
          
          <!-- \u6D3B\u8E8D\u5354\u4F5C -->
          <div class="bg-gradient-to-br from-emerald-500/20 to-emerald-600/10 rounded-xl p-4 border border-emerald-500/30">
            <div class="flex items-center gap-2">
              <div class="text-4xl font-bold text-emerald-400">{{ stats().activeGroups }}</div>
              @if (stats().activeGroups > 0) {
                <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span>
              }
            </div>
            <div class="text-sm text-slate-400 mt-1">\u6D3B\u8E8D\u5354\u4F5C</div>
            <div class="text-xs text-emerald-400/70 mt-2">
              \u904B\u884C\u4E2D
            </div>
          </div>
          
          <!-- \u5DF2\u5B8C\u6210 -->
          <div class="bg-gradient-to-br from-cyan-500/20 to-cyan-600/10 rounded-xl p-4 border border-cyan-500/30">
            <div class="text-4xl font-bold text-cyan-400">{{ stats().completedGroups }}</div>
            <div class="text-sm text-slate-400 mt-1">\u5DF2\u5B8C\u6210</div>
            <div class="text-xs text-cyan-400/70 mt-2">
              \u6B77\u53F2\u7D2F\u8A08
            </div>
          </div>
          
          <!-- \u6210\u529F\u8F49\u5316 -->
          <div class="bg-gradient-to-br from-amber-500/20 to-amber-600/10 rounded-xl p-4 border border-amber-500/30">
            <div class="text-4xl font-bold text-amber-400">{{ stats().totalConversions }}</div>
            <div class="text-sm text-slate-400 mt-1">\u6210\u529F\u8F49\u5316</div>
            <div class="text-xs text-amber-400/70 mt-2">
              \u4ECA\u65E5 +{{ stats().todayConversions }}
            </div>
          </div>
          
          <!-- \u8F49\u5316\u7387 -->
          <div class="bg-gradient-to-br from-pink-500/20 to-pink-600/10 rounded-xl p-4 border border-pink-500/30">
            <div class="text-4xl font-bold text-pink-400">{{ stats().conversionRate | number:'1.1-1' }}%</div>
            <div class="text-sm text-slate-400 mt-1">\u8F49\u5316\u7387</div>
            <div class="h-1.5 bg-slate-700 rounded-full mt-3 overflow-hidden">
              <div class="h-full bg-gradient-to-r from-pink-500 to-rose-500 rounded-full transition-all duration-500"
                   [style.width.%]="stats().conversionRate">
              </div>
            </div>
          </div>
        </div>
      }
      
      <!-- \u{1F195} AI \u5718\u968A\u57F7\u884C\u72C0\u614B -->
      @if (currentExecution()) {
        <div class="mb-8 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-xl border border-purple-500/30 overflow-hidden">
          <div class="p-4 border-b border-purple-500/20 flex items-center justify-between">
            <div class="flex items-center gap-3">
              <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></span>
              <h3 class="text-lg font-semibold text-white">\u{1F916} AI \u5718\u968A\u57F7\u884C\u4E2D</h3>
              <span class="px-2 py-0.5 bg-purple-500/30 text-purple-300 text-xs rounded-full">
                {{ currentExecution()?.mode === 'scriptless' ? '\u7121\u5287\u672C' : currentExecution()?.mode === 'hybrid' ? '\u6DF7\u5408' : '\u5287\u672C' }}\u6A21\u5F0F
              </span>
            </div>
            <div class="flex items-center gap-2">
              @if (currentExecution()?.status === 'paused') {
                <button (click)="resumeExecution()" class="px-3 py-1.5 bg-emerald-500/20 text-emerald-400 rounded-lg text-sm hover:bg-emerald-500/30">
                  \u25B6\uFE0F \u6062\u5FA9
                </button>
              } @else {
                <button (click)="pauseExecution()" class="px-3 py-1.5 bg-amber-500/20 text-amber-400 rounded-lg text-sm hover:bg-amber-500/30">
                  \u23F8\uFE0F \u66AB\u505C
                </button>
              }
              <button (click)="stopExecution()" class="px-3 py-1.5 bg-red-500/20 text-red-400 rounded-lg text-sm hover:bg-red-500/30">
                \u23F9\uFE0F \u505C\u6B62
              </button>
            </div>
          </div>
          
          <div class="p-4">
            <!-- \u57F7\u884C\u76EE\u6A19 -->
            <div class="mb-4">
              <div class="text-sm text-slate-400 mb-1">\u71DF\u92B7\u76EE\u6A19</div>
              <div class="text-white font-medium">{{ currentExecution()?.goal }}</div>
            </div>
            
            <!-- \u7D71\u8A08\u6578\u64DA -->
            <div class="grid grid-cols-6 gap-3 mb-4">
              <div class="bg-slate-800/50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-purple-400">{{ currentExecution()?.stats?.messagesSent || 0 }}</div>
                <div class="text-xs text-slate-400">\u5DF2\u767C\u9001</div>
              </div>
              <div class="bg-slate-800/50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-emerald-400">{{ currentExecution()?.stats?.responsesReceived || 0 }}</div>
                <div class="text-xs text-slate-400">\u5BA2\u6236\u56DE\u8986</div>
              </div>
              <div class="bg-slate-800/50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-cyan-400">{{ getReplyRate() | number:'1.0-0' }}%</div>
                <div class="text-xs text-slate-400">\u56DE\u8986\u7387</div>
              </div>
              <div class="bg-slate-800/50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold" [class.text-emerald-400]="(currentExecution()?.stats?.interestScore || 0) >= 60"
                     [class.text-amber-400]="(currentExecution()?.stats?.interestScore || 0) >= 30 && (currentExecution()?.stats?.interestScore || 0) < 60"
                     [class.text-slate-400]="(currentExecution()?.stats?.interestScore || 0) < 30">
                  {{ currentExecution()?.stats?.interestScore || 0 }}
                </div>
                <div class="text-xs text-slate-400">\u610F\u5411\u5206</div>
              </div>
              <div class="bg-slate-800/50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-cyan-400">{{ currentExecution()?.roles?.length || 0 }}</div>
                <div class="text-xs text-slate-400">\u53C3\u8207\u89D2\u8272</div>
              </div>
              <div class="bg-slate-800/50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-pink-400">{{ currentExecution()?.targetUsers?.length || 0 }}</div>
                <div class="text-xs text-slate-400">\u76EE\u6A19\u7528\u6236</div>
              </div>
            </div>
            
            <!-- \u{1F195} \u8F49\u5316\u6F0F\u6597\u9032\u5EA6 -->
            @if (currentExecution()?.conversionFunnel) {
              <div class="mb-4 p-3 bg-slate-800/30 rounded-lg">
                <div class="text-sm text-slate-400 mb-2">\u8F49\u5316\u6F0F\u6597</div>
                <div class="flex items-center gap-1">
                  @for (stage of conversionStages; track stage.id) {
                    <div class="flex-1 relative">
                      <div class="h-2 rounded-full transition-all"
                           [class.bg-emerald-500]="isStageCompleted(stage.id)"
                           [class.bg-purple-500]="isCurrentStage(stage.id)"
                           [class.bg-slate-700]="!isStageCompleted(stage.id) && !isCurrentStage(stage.id)">
                      </div>
                      <div class="text-xs text-center mt-1"
                           [class.text-emerald-400]="isStageCompleted(stage.id)"
                           [class.text-purple-400]="isCurrentStage(stage.id)"
                           [class.text-slate-500]="!isStageCompleted(stage.id) && !isCurrentStage(stage.id)">
                        {{ stage.label }}
                      </div>
                    </div>
                    @if (!$last) {
                      <div class="w-4 h-px bg-slate-600"></div>
                    }
                  }
                </div>
              </div>
            }
            
            <!-- \u{1F195} \u4EFB\u52D9\u968A\u5217\u9032\u5EA6 -->
            @if (queueProgress()) {
              <div class="mb-4 p-3 bg-slate-800/50 rounded-lg">
                <div class="flex items-center justify-between mb-2">
                  <div class="text-sm text-slate-400">\u968A\u5217\u9032\u5EA6</div>
                  <div class="text-sm text-white font-medium">
                    {{ queueProgress()?.processed }}/{{ queueProgress()?.total }}
                    <span class="text-slate-500 ml-1">({{ queueProgress()?.progress }}%)</span>
                  </div>
                </div>
                <!-- \u9032\u5EA6\u689D -->
                <div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-3">
                  <div class="h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-300"
                       [style.width.%]="queueProgress()?.progress || 0"></div>
                </div>
                <!-- \u7576\u524D\u8655\u7406\u7528\u6236 -->
                @if (queueProgress()?.current) {
                  <div class="flex items-center justify-between text-sm">
                    <div class="flex items-center gap-2">
                      <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                      <span class="text-white">\u6B63\u5728\u8655\u7406\uFF1A{{ queueProgress()?.current?.name }}</span>
                    </div>
                    <div class="flex gap-2">
                      <button (click)="skipCurrentUser()" class="px-2 py-1 bg-slate-600 text-slate-300 text-xs rounded hover:bg-slate-500">
                        \u8DF3\u904E
                      </button>
                      <button (click)="markAsConverted()" class="px-2 py-1 bg-emerald-500/20 text-emerald-400 text-xs rounded hover:bg-emerald-500/30">
                        \u6A19\u8A18\u8F49\u5316
                      </button>
                    </div>
                  </div>
                }
                <!-- \u5F85\u8655\u7406\u6578\u91CF -->
                <div class="text-xs text-slate-500 mt-2">
                  \u5F85\u8655\u7406\uFF1A{{ queueProgress()?.pending }} \u4EBA
                </div>
                
                <!-- \u{1F195} \u7D50\u679C\u7D71\u8A08 -->
                @if (queueProgress()?.completed && queueProgress()!.completed!.length > 0) {
                  <div class="mt-3 pt-3 border-t border-slate-700">
                    <div class="text-xs text-slate-400 mb-2">\u8655\u7406\u7D50\u679C</div>
                    <div class="flex flex-wrap gap-2">
                      @if (getResultCount('converted') > 0) {
                        <span class="px-2 py-1 bg-emerald-500/20 text-emerald-400 text-xs rounded-full flex items-center gap-1">
                          \u{1F3AF} \u8F49\u5316 {{ getResultCount('converted') }}
                        </span>
                      }
                      @if (getResultCount('interested') > 0) {
                        <span class="px-2 py-1 bg-amber-500/20 text-amber-400 text-xs rounded-full flex items-center gap-1">
                          \u2B50 \u6709\u8208\u8DA3 {{ getResultCount('interested') }}
                        </span>
                      }
                      @if (getResultCount('neutral') > 0) {
                        <span class="px-2 py-1 bg-slate-500/20 text-slate-400 text-xs rounded-full flex items-center gap-1">
                          \u{1F610} \u4E2D\u7ACB {{ getResultCount('neutral') }}
                        </span>
                      }
                      @if (getResultCount('rejected') > 0) {
                        <span class="px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded-full flex items-center gap-1">
                          \u274C \u62D2\u7D55 {{ getResultCount('rejected') }}
                        </span>
                      }
                      @if (getResultCount('no_response') > 0) {
                        <span class="px-2 py-1 bg-gray-500/20 text-gray-400 text-xs rounded-full flex items-center gap-1">
                          \u{1F4A4} \u7121\u56DE\u61C9 {{ getResultCount('no_response') }}
                        </span>
                      }
                    </div>
                    <!-- \u67E5\u770B\u8A73\u60C5\u6309\u9215 -->
                    <button (click)="showResultsPanel.set(true)" 
                            class="mt-2 text-xs text-purple-400 hover:text-purple-300">
                      \u67E5\u770B\u8A73\u7D30\u7D50\u679C \u2192
                    </button>
                  </div>
                }
              </div>
            }
            
            <!-- \u76EE\u6A19\u7528\u6236\u5217\u8868 -->
            @if (currentExecution()?.targetUsers && currentExecution()!.targetUsers!.length > 0) {
              <div class="mb-4">
                <div class="text-sm text-slate-400 mb-2">\u76EE\u6A19\u7528\u6236</div>
                <div class="flex flex-wrap gap-2">
                  @for (user of currentExecution()!.targetUsers!.slice(0, 10); track user.id) {
                    <span class="px-2 py-1 bg-slate-700 rounded-full text-xs text-slate-300 flex items-center gap-1">
                      <span class="w-2 h-2 rounded-full" 
                            [class.bg-green-500]="user.intentScore >= 60"
                            [class.bg-amber-500]="user.intentScore >= 40 && user.intentScore < 60"
                            [class.bg-slate-500]="user.intentScore < 40"></span>
                      {{ user.firstName || user.username || user.id }}
                    </span>
                  }
                  @if (currentExecution()!.targetUsers!.length > 10) {
                    <span class="px-2 py-1 bg-slate-600 rounded-full text-xs text-slate-400">
                      +{{ currentExecution()!.targetUsers!.length - 10 }} \u66F4\u591A
                    </span>
                  }
                </div>
              </div>
            }
            
            <!-- \u6700\u8FD1\u5C0D\u8A71 + \u5C55\u958B\u6309\u9215 -->
            <div>
              <div class="flex items-center justify-between mb-2">
                <div class="text-sm text-slate-400">\u6700\u8FD1\u5C0D\u8A71</div>
                <button (click)="toggleConversationPanel()" 
                        class="text-xs text-purple-400 hover:text-purple-300 flex items-center gap-1">
                  {{ showConversationPanel() ? '\u6536\u8D77' : '\u5C55\u958B\u5B8C\u6574\u5C0D\u8A71' }}
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                       [class.rotate-180]="showConversationPanel()">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                  </svg>
                </button>
              </div>
              @if (currentExecution()?.messageHistory && currentExecution()!.messageHistory!.length > 0) {
                <div class="space-y-2 max-h-48 overflow-y-auto">
                  @for (msg of currentExecution()!.messageHistory!.slice(-5).reverse(); track msg.timestamp) {
                    <div class="flex gap-3 p-2 rounded-lg"
                         [class.bg-slate-700/50]="!msg.isFromCustomer"
                         [class.bg-emerald-500/10]="msg.isFromCustomer">
                      <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm"
                           [class.bg-purple-500/30]="!msg.isFromCustomer"
                           [class.text-purple-400]="!msg.isFromCustomer"
                           [class.bg-emerald-500/30]="msg.isFromCustomer"
                           [class.text-emerald-400]="msg.isFromCustomer">
                        {{ msg.isFromCustomer ? '\u{1F464}' : '\u{1F916}' }}
                      </div>
                      <div class="flex-1 min-w-0">
                        <div class="text-xs text-slate-400 mb-0.5">
                          {{ msg.isFromCustomer ? '\u5BA2\u6236' : msg.role }}
                        </div>
                        <div class="text-sm text-white truncate">{{ msg.content }}</div>
                      </div>
                    </div>
                  }
                </div>
              } @else {
                <div class="text-center py-4 text-slate-500 text-sm">\u66AB\u7121\u5C0D\u8A71\u8A18\u9304</div>
              }
            </div>
          </div>
        </div>
      }
      
      <!-- \u{1F195} \u5B8C\u6574\u5C0D\u8A71\u9762\u677F\uFF08\u6ED1\u51FA\u62BD\u5C5C\uFF09 -->
      @if (showConversationPanel() && currentExecution()) {
        <div class="fixed inset-0 z-50 flex">
          <!-- \u906E\u7F69 -->
          <div class="absolute inset-0 bg-black/50" (click)="toggleConversationPanel()"></div>
          
          <!-- \u5C0D\u8A71\u9762\u677F -->
          <div class="absolute right-0 top-0 bottom-0 w-[500px] bg-slate-900 border-l border-slate-700 flex flex-col shadow-2xl">
            <!-- \u6A19\u984C\u6B04 -->
            <div class="p-4 border-b border-slate-700 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <span class="text-xl">\u{1F4AC}</span>
                <div>
                  <h3 class="text-lg font-semibold text-white">\u5B8C\u6574\u5C0D\u8A71\u8A18\u9304</h3>
                  <p class="text-xs text-slate-400">{{ currentExecution()?.goal }}</p>
                </div>
              </div>
              <button (click)="toggleConversationPanel()" class="p-2 hover:bg-slate-700 rounded-lg text-slate-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
            
            <!-- \u5C0D\u8A71\u5217\u8868 -->
            <div #conversationContainer class="flex-1 overflow-y-auto p-4 space-y-3">
              @for (msg of currentExecution()!.messageHistory || []; track msg.timestamp) {
                <div class="flex gap-3" [class.flex-row-reverse]="!msg.isFromCustomer">
                  <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0"
                       [class.bg-purple-500/30]="!msg.isFromCustomer"
                       [class.bg-emerald-500/30]="msg.isFromCustomer">
                    {{ msg.isFromCustomer ? '\u{1F464}' : '\u{1F916}' }}
                  </div>
                  <div class="max-w-[70%] rounded-xl p-3"
                       [class.bg-purple-500/20]="!msg.isFromCustomer"
                       [class.bg-emerald-500/20]="msg.isFromCustomer">
                    <div class="text-xs mb-1"
                         [class.text-purple-400]="!msg.isFromCustomer"
                         [class.text-emerald-400]="msg.isFromCustomer">
                      {{ msg.isFromCustomer ? '\u5BA2\u6236' : msg.role }}
                      <span class="text-slate-500 ml-2">{{ formatTime(msg.timestamp) }}</span>
                    </div>
                    <div class="text-sm text-white whitespace-pre-wrap">{{ msg.content }}</div>
                  </div>
                </div>
              }
              
              @if (!currentExecution()?.messageHistory?.length) {
                <div class="text-center py-8 text-slate-500">
                  <div class="text-4xl mb-2">\u{1F4AC}</div>
                  <div>\u5C0D\u8A71\u5C1A\u672A\u958B\u59CB</div>
                </div>
              }
            </div>
            
            <!-- \u{1F195} \u624B\u52D5\u4ECB\u5165\u5340\u57DF -->
            <div class="border-t border-slate-700 p-4">
              <div class="flex items-center gap-2 mb-3">
                <span class="text-xs px-2 py-0.5 rounded-full"
                      [class.bg-amber-500/20]="isManualMode()"
                      [class.text-amber-400]="isManualMode()"
                      [class.bg-emerald-500/20]="!isManualMode()"
                      [class.text-emerald-400]="!isManualMode()">
                  {{ isManualMode() ? '\u{1F590}\uFE0F \u624B\u52D5\u6A21\u5F0F' : '\u{1F916} AI \u81EA\u52D5\u6A21\u5F0F' }}
                </span>
                <button (click)="toggleManualMode()" 
                        class="text-xs text-purple-400 hover:text-purple-300">
                  {{ isManualMode() ? '\u5207\u63DB\u81EA\u52D5' : '\u63A5\u7BA1\u5C0D\u8A71' }}
                </button>
              </div>
              
              <!-- \u9078\u64C7\u89D2\u8272 -->
              @if (isManualMode()) {
                <div class="mb-3">
                  <label class="text-xs text-slate-400 mb-1 block">\u9078\u64C7\u89D2\u8272</label>
                  <select [(ngModel)]="manualSendRole" 
                          class="w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white text-sm">
                    @for (role of currentExecution()?.roles || []; track $index) {
                      <option [value]="role.id">{{ role.name }} ({{ role.type }})</option>
                    }
                  </select>
                </div>
              }
              
              <!-- \u6D88\u606F\u8F38\u5165 -->
              <div class="flex gap-2">
                <input [(ngModel)]="manualMessage"
                       (keydown.enter)="sendManualMessage()"
                       [disabled]="!isManualMode()"
                       placeholder="{{ isManualMode() ? '\u8F38\u5165\u6D88\u606F\u4E26\u767C\u9001...' : '\u555F\u7528\u624B\u52D5\u6A21\u5F0F\u5F8C\u53EF\u767C\u9001\u6D88\u606F' }}"
                       class="flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white text-sm 
                              placeholder:text-slate-500 disabled:opacity-50 disabled:cursor-not-allowed">
                <button (click)="sendManualMessage()" 
                        [disabled]="!isManualMode() || !manualMessage.trim()"
                        class="px-4 py-2 bg-purple-500 text-white rounded-lg text-sm hover:bg-purple-600 
                               disabled:opacity-50 disabled:cursor-not-allowed">
                  \u767C\u9001
                </button>
              </div>
              
              <!-- AI \u5EFA\u8B70 -->
              @if (isManualMode() && aiSuggestion()) {
                <div class="mt-3 p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg">
                  <div class="text-xs text-purple-400 mb-1">\u{1F4A1} AI \u5EFA\u8B70\uFF1A</div>
                  <div class="text-sm text-white">{{ aiSuggestion() }}</div>
                  <button (click)="useAiSuggestion()" 
                          class="mt-2 text-xs text-purple-400 hover:text-purple-300">
                    \u4F7F\u7528\u6B64\u5EFA\u8B70
                  </button>
                </div>
              }
            </div>
          </div>
        </div>
      }
      
      <!-- \u{1F195} \u7D50\u679C\u7D71\u8A08\u9762\u677F -->
      @if (showResultsPanel()) {
        <div class="fixed inset-0 z-50 flex items-center justify-center">
          <div class="absolute inset-0 bg-black/50" (click)="showResultsPanel.set(false)"></div>
          <div class="relative bg-slate-900 rounded-xl border border-slate-700 w-[700px] max-h-[80vh] overflow-hidden shadow-2xl">
            <!-- \u6A19\u984C\u6B04 -->
            <div class="p-4 border-b border-slate-700 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <span class="text-xl">\u{1F4CA}</span>
                <h3 class="text-lg font-semibold text-white">\u968A\u5217\u57F7\u884C\u7D50\u679C</h3>
              </div>
              <button (click)="showResultsPanel.set(false)" class="p-2 hover:bg-slate-700 rounded-lg text-slate-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
            
            <!-- \u7D71\u8A08\u6982\u89BD -->
            <div class="p-4 border-b border-slate-700">
              <div class="grid grid-cols-5 gap-3">
                <div class="bg-emerald-500/10 rounded-lg p-3 text-center border border-emerald-500/30">
                  <div class="text-2xl font-bold text-emerald-400">{{ getResultCount('converted') }}</div>
                  <div class="text-xs text-emerald-400/70">\u8F49\u5316\u6210\u529F</div>
                </div>
                <div class="bg-amber-500/10 rounded-lg p-3 text-center border border-amber-500/30">
                  <div class="text-2xl font-bold text-amber-400">{{ getResultCount('interested') }}</div>
                  <div class="text-xs text-amber-400/70">\u6709\u8208\u8DA3</div>
                </div>
                <div class="bg-slate-500/10 rounded-lg p-3 text-center border border-slate-500/30">
                  <div class="text-2xl font-bold text-slate-400">{{ getResultCount('neutral') }}</div>
                  <div class="text-xs text-slate-400/70">\u4E2D\u7ACB</div>
                </div>
                <div class="bg-red-500/10 rounded-lg p-3 text-center border border-red-500/30">
                  <div class="text-2xl font-bold text-red-400">{{ getResultCount('rejected') }}</div>
                  <div class="text-xs text-red-400/70">\u62D2\u7D55</div>
                </div>
                <div class="bg-gray-500/10 rounded-lg p-3 text-center border border-gray-500/30">
                  <div class="text-2xl font-bold text-gray-400">{{ getResultCount('no_response') }}</div>
                  <div class="text-xs text-gray-400/70">\u7121\u56DE\u61C9</div>
                </div>
              </div>
              
              <!-- \u8F49\u5316\u7387 -->
              <div class="mt-4 flex items-center gap-4">
                <div class="flex-1">
                  <div class="text-sm text-slate-400 mb-1">\u8F49\u5316\u7387</div>
                  <div class="h-3 bg-slate-700 rounded-full overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-emerald-500 to-teal-500 transition-all"
                         [style.width.%]="getConversionRate()"></div>
                  </div>
                </div>
                <div class="text-2xl font-bold text-emerald-400">{{ getConversionRate() | number:'1.1-1' }}%</div>
              </div>
            </div>
            
            <!-- \u7528\u6236\u5217\u8868 -->
            <div class="p-4 max-h-[400px] overflow-y-auto">
              <table class="w-full">
                <thead class="text-xs text-slate-400 border-b border-slate-700">
                  <tr>
                    <th class="text-left py-2 px-2">\u7528\u6236</th>
                    <th class="text-left py-2 px-2">\u7D50\u679C</th>
                    <th class="text-right py-2 px-2">\u6D88\u606F\u6578</th>
                    <th class="text-right py-2 px-2">\u6642\u9577</th>
                  </tr>
                </thead>
                <tbody class="text-sm">
                  @for (user of queueProgress()?.completed || []; track user.id) {
                    <tr class="border-b border-slate-800 hover:bg-slate-800/50">
                      <td class="py-2 px-2 text-white">{{ user.name }}</td>
                      <td class="py-2 px-2">
                        <span class="px-2 py-0.5 rounded-full text-xs"
                              [class.bg-emerald-500/20]="user.result === 'converted'"
                              [class.text-emerald-400]="user.result === 'converted'"
                              [class.bg-amber-500/20]="user.result === 'interested'"
                              [class.text-amber-400]="user.result === 'interested'"
                              [class.bg-slate-500/20]="user.result === 'neutral'"
                              [class.text-slate-400]="user.result === 'neutral'"
                              [class.bg-red-500/20]="user.result === 'rejected'"
                              [class.text-red-400]="user.result === 'rejected'"
                              [class.bg-gray-500/20]="user.result === 'no_response'"
                              [class.text-gray-400]="user.result === 'no_response'">
                          {{ getResultLabel(user.result) }}
                        </span>
                      </td>
                      <td class="py-2 px-2 text-right text-slate-300">{{ user.messagesExchanged }}</td>
                      <td class="py-2 px-2 text-right text-slate-400">{{ formatDuration(user.duration) }}</td>
                    </tr>
                  }
                </tbody>
              </table>
              
              @if (!queueProgress()?.completed?.length) {
                <div class="text-center py-8 text-slate-500">\u66AB\u7121\u5DF2\u5B8C\u6210\u7528\u6236</div>
              }
            </div>
            
            <!-- \u64CD\u4F5C\u6309\u9215 -->
            <div class="p-4 border-t border-slate-700 flex justify-between">
              <button (click)="exportResults()" class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 flex items-center gap-2">
                <span>\u{1F4E5}</span> \u5C0E\u51FA\u7D50\u679C
              </button>
              <button (click)="showResultsPanel.set(false)" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                \u95DC\u9589
              </button>
            </div>
          </div>
        </div>
      }
      
      <!-- \u5716\u8868\u5340\u57DF -->
      <div class="grid grid-cols-3 gap-6 mb-8">
        <!-- \u8DA8\u52E2\u5716 -->
        <div class="col-span-2 bg-slate-800/50 rounded-xl p-5 border border-slate-700/50">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">\u5354\u4F5C\u8DA8\u52E2</h3>
            <div class="flex gap-2">
              <button (click)="chartPeriod.set('week')"
                      class="px-3 py-1 text-sm rounded-lg"
                      [class.bg-purple-500]="chartPeriod() === 'week'"
                      [class.text-white]="chartPeriod() === 'week'"
                      [class.bg-slate-700]="chartPeriod() !== 'week'"
                      [class.text-slate-400]="chartPeriod() !== 'week'">
                7\u5929
              </button>
              <button (click)="chartPeriod.set('month')"
                      class="px-3 py-1 text-sm rounded-lg"
                      [class.bg-purple-500]="chartPeriod() === 'month'"
                      [class.text-white]="chartPeriod() === 'month'"
                      [class.bg-slate-700]="chartPeriod() !== 'month'"
                      [class.text-slate-400]="chartPeriod() !== 'month'">
                30\u5929
              </button>
            </div>
          </div>
          
          <!-- \u7C21\u5316\u5716\u8868\u5C55\u793A -->
          <div class="h-48 flex items-end gap-2">
            @for (day of chartData(); track day.date; let i = $index) {
              <div class="flex-1 flex flex-col items-center gap-1">
                <div class="w-full bg-slate-700 rounded-t relative flex flex-col justify-end"
                     [style.height.px]="Math.max(day.groups * 10, 4)"
                     [class.bg-gradient-to-t]="true"
                     [class.from-purple-600]="true"
                     [class.to-purple-400]="true">
                  <div class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs text-slate-400">
                    {{ day.groups }}
                  </div>
                </div>
                <div class="text-xs text-slate-500">{{ day.label }}</div>
              </div>
            }
          </div>
          
          <div class="flex justify-center gap-6 mt-4 text-sm">
            <div class="flex items-center gap-2">
              <div class="w-3 h-3 rounded bg-purple-500"></div>
              <span class="text-slate-400">\u65B0\u5EFA\u7FA4\u7D44</span>
            </div>
            <div class="flex items-center gap-2">
              <div class="w-3 h-3 rounded bg-emerald-500"></div>
              <span class="text-slate-400">\u6210\u529F\u8F49\u5316</span>
            </div>
          </div>
        </div>
        
        <!-- \u89D2\u8272\u6548\u679C -->
        <div class="bg-slate-800/50 rounded-xl p-5 border border-slate-700/50">
          <h3 class="text-lg font-semibold text-white mb-4">\u89D2\u8272\u6548\u679C\u6392\u540D</h3>
          
          <div class="space-y-3">
            @for (role of topRoles(); track $index; let i = $index) {
              <div class="flex items-center gap-3">
                <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold"
                     [class.bg-amber-500]="i === 0"
                     [class.text-amber-900]="i === 0"
                     [class.bg-slate-600]="i === 1"
                     [class.text-white]="i === 1"
                     [class.bg-amber-700]="i === 2"
                     [class.text-amber-200]="i === 2"
                     [class.bg-slate-700]="i > 2"
                     [class.text-slate-400]="i > 2">
                  {{ i + 1 }}
                </div>
                <div class="flex-1 min-w-0">
                  <div class="text-sm font-medium text-white truncate">{{ role.name }}</div>
                  <div class="text-xs text-slate-500">{{ role.usageCount }} \u6B21\u4F7F\u7528</div>
                </div>
                <div class="text-right">
                  <div class="text-sm font-bold text-emerald-400">{{ role.successRate }}%</div>
                  <div class="text-xs text-slate-500">\u6210\u529F\u7387</div>
                </div>
              </div>
            }
            
            @if (topRoles().length === 0) {
              <div class="text-center py-8 text-slate-500">\u66AB\u7121\u6578\u64DA</div>
            }
          </div>
        </div>
      </div>
      
      <!-- \u{1F195} \u57F7\u884C\u6B77\u53F2 -->
      <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 mb-8">
        <div class="p-5 border-b border-slate-700/50 flex items-center justify-between">
          <h3 class="text-lg font-semibold text-white flex items-center gap-2">
            <span>\u{1F4DC}</span> \u57F7\u884C\u6B77\u53F2
          </h3>
          <div class="flex items-center gap-3">
            @if (selectedForCompare().length >= 2) {
              <button (click)="openABTestPanel()" 
                      class="px-3 py-1.5 bg-purple-500 text-white text-sm rounded-lg hover:bg-purple-600 flex items-center gap-1">
                <span>\u{1F4CA}</span> \u5C0D\u6BD4 ({{ selectedForCompare().length }})
              </button>
            }
            @if (selectedForCompare().length > 0) {
              <button (click)="clearCompareSelection()" class="text-xs text-slate-400 hover:text-white">
                \u6E05\u9664\u9078\u64C7
              </button>
            }
            <span class="text-sm text-slate-400">\u5171 {{ executionHistory().length }} \u689D\u8A18\u9304</span>
          </div>
        </div>
        
        <div class="divide-y divide-slate-700/50 max-h-[300px] overflow-y-auto">
          @for (exec of executionHistory().slice(0, 10); track exec.id) {
            <div class="p-4 hover:bg-slate-700/30 transition-colors cursor-pointer" (click)="viewExecutionHistory(exec)">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <!-- A/B \u5C0D\u6BD4\u9078\u64C7\u6846 -->
                  <input type="checkbox" 
                         [checked]="isSelectedForCompare(exec)"
                         (click)="$event.stopPropagation()"
                         (change)="toggleCompareSelection(exec)"
                         class="w-4 h-4 rounded border-slate-500 bg-slate-700 text-purple-500 focus:ring-purple-500">
                  <div class="w-10 h-10 rounded-full flex items-center justify-center"
                       [class.bg-emerald-500/20]="exec.status === 'completed'"
                       [class.bg-red-500/20]="exec.status === 'failed'"
                       [class.bg-slate-500/20]="exec.status === 'idle'">
                    <span class="text-lg">
                      {{ exec.status === 'completed' ? '\u2705' : exec.status === 'failed' ? '\u274C' : '\u23F8\uFE0F' }}
                    </span>
                  </div>
                  <div>
                    <div class="text-white font-medium">{{ exec.goal | slice:0:40 }}{{ exec.goal.length > 40 ? '...' : '' }}</div>
                    <div class="text-xs text-slate-400 flex items-center gap-2">
                      <span>{{ exec.stats.startTime | date:'MM/dd HH:mm' }}</span>
                      <span>\u2022</span>
                      <span>{{ exec.mode === 'scriptless' ? '\u7121\u5287\u672C' : exec.mode === 'hybrid' ? '\u6DF7\u5408' : '\u5287\u672C' }}</span>
                      <span>\u2022</span>
                      <span>{{ exec.targetUsers?.length || 0 }} \u76EE\u6A19</span>
                    </div>
                  </div>
                </div>
                
                <div class="flex items-center gap-4">
                  <div class="text-right">
                    <div class="text-sm font-bold text-purple-400">{{ exec.stats.messagesSent }} \u6D88\u606F</div>
                    <div class="text-xs text-slate-500">{{ exec.stats.responsesReceived }} \u56DE\u8986</div>
                  </div>
                  <button (click)="viewExecutionHistory(exec); $event.stopPropagation()"
                          class="p-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          }
          
          @if (executionHistory().length === 0) {
            <div class="p-8 text-center text-slate-500">
              <div class="text-4xl mb-2">\u{1F4DD}</div>
              <div>\u66AB\u7121\u57F7\u884C\u6B77\u53F2</div>
            </div>
          }
        </div>
      </div>
      
      <!-- \u{1F195} \u6B77\u53F2\u56DE\u653E\u9762\u677F -->
      @if (showHistoryPanel() && selectedHistory()) {
        <div class="fixed inset-0 z-50 flex items-center justify-center">
          <div class="absolute inset-0 bg-black/50" (click)="showHistoryPanel.set(false)"></div>
          <div class="relative bg-slate-900 rounded-xl border border-slate-700 w-[800px] max-h-[85vh] overflow-hidden shadow-2xl">
            <!-- \u6A19\u984C\u6B04 -->
            <div class="p-4 border-b border-slate-700 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <span class="text-xl">\u{1F4DC}</span>
                <div>
                  <h3 class="text-lg font-semibold text-white">\u57F7\u884C\u6B77\u53F2\u56DE\u653E</h3>
                  <p class="text-xs text-slate-400">{{ selectedHistory()?.goal }}</p>
                </div>
              </div>
              <button (click)="showHistoryPanel.set(false)" class="p-2 hover:bg-slate-700 rounded-lg text-slate-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
            
            <!-- \u57F7\u884C\u7D71\u8A08 -->
            <div class="p-4 border-b border-slate-700 grid grid-cols-5 gap-3">
              <div class="bg-slate-800 rounded-lg p-3 text-center">
                <div class="text-xl font-bold text-purple-400">{{ selectedHistory()?.stats?.messagesSent || 0 }}</div>
                <div class="text-xs text-slate-400">\u5DF2\u767C\u9001</div>
              </div>
              <div class="bg-slate-800 rounded-lg p-3 text-center">
                <div class="text-xl font-bold text-emerald-400">{{ selectedHistory()?.stats?.responsesReceived || 0 }}</div>
                <div class="text-xs text-slate-400">\u5BA2\u6236\u56DE\u8986</div>
              </div>
              <div class="bg-slate-800 rounded-lg p-3 text-center">
                <div class="text-xl font-bold text-cyan-400">{{ selectedHistory()?.roles?.length || 0 }}</div>
                <div class="text-xs text-slate-400">\u53C3\u8207\u89D2\u8272</div>
              </div>
              <div class="bg-slate-800 rounded-lg p-3 text-center">
                <div class="text-xl font-bold text-amber-400">{{ selectedHistory()?.stats?.analysisCount || 0 }}</div>
                <div class="text-xs text-slate-400">\u5206\u6790\u6B21\u6578</div>
              </div>
              <div class="bg-slate-800 rounded-lg p-3 text-center">
                <div class="text-xl font-bold text-pink-400">{{ selectedHistory()?.targetUsers?.length || 0 }}</div>
                <div class="text-xs text-slate-400">\u76EE\u6A19\u7528\u6236</div>
              </div>
            </div>
            
            <!-- \u5B8C\u6574\u5C0D\u8A71\u6B77\u53F2 -->
            <div class="p-4 max-h-[400px] overflow-y-auto space-y-3">
              @for (msg of selectedHistory()?.messageHistory || []; track msg.timestamp) {
                <div class="flex gap-3" [class.flex-row-reverse]="!msg.isFromCustomer">
                  <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0"
                       [class.bg-purple-500/30]="!msg.isFromCustomer"
                       [class.bg-emerald-500/30]="msg.isFromCustomer">
                    {{ msg.isFromCustomer ? '\u{1F464}' : '\u{1F916}' }}
                  </div>
                  <div class="max-w-[70%] rounded-xl p-3"
                       [class.bg-purple-500/20]="!msg.isFromCustomer"
                       [class.bg-emerald-500/20]="msg.isFromCustomer">
                    <div class="text-xs mb-1"
                         [class.text-purple-400]="!msg.isFromCustomer"
                         [class.text-emerald-400]="msg.isFromCustomer">
                      {{ msg.isFromCustomer ? '\u5BA2\u6236' : msg.role }}
                      <span class="text-slate-500 ml-2">{{ formatTime(msg.timestamp) }}</span>
                    </div>
                    <div class="text-sm text-white whitespace-pre-wrap">{{ msg.content }}</div>
                  </div>
                </div>
              }
              
              @if (!selectedHistory()?.messageHistory?.length) {
                <div class="text-center py-8 text-slate-500">
                  <div class="text-4xl mb-2">\u{1F4AC}</div>
                  <div>\u6B64\u6B21\u57F7\u884C\u7121\u5C0D\u8A71\u8A18\u9304</div>
                </div>
              }
            </div>
            
            <!-- \u64CD\u4F5C\u6309\u9215 -->
            <div class="p-4 border-t border-slate-700 flex justify-between">
              <button (click)="rerunExecution(selectedHistory()!)" 
                      class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 flex items-center gap-2">
                <span>\u{1F504}</span> \u4EE5\u6B64\u7B56\u7565\u91CD\u65B0\u57F7\u884C
              </button>
              <button (click)="showHistoryPanel.set(false)" class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600">
                \u95DC\u9589
              </button>
            </div>
          </div>
        </div>
      }
      
      <!-- \u{1F195} A/B \u6E2C\u8A66\u5C0D\u6BD4\u9762\u677F -->
      @if (showABTestPanel() && selectedForCompare().length >= 2) {
        <div class="fixed inset-0 z-50 flex items-center justify-center">
          <div class="absolute inset-0 bg-black/50" (click)="showABTestPanel.set(false)"></div>
          <div class="relative bg-slate-900 rounded-xl border border-slate-700 w-[900px] max-h-[85vh] overflow-hidden shadow-2xl">
            <!-- \u6A19\u984C\u6B04 -->
            <div class="p-4 border-b border-slate-700 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <span class="text-xl">\u{1F4CA}</span>
                <h3 class="text-lg font-semibold text-white">A/B \u6E2C\u8A66\u5C0D\u6BD4</h3>
                <span class="px-2 py-0.5 bg-purple-500/20 text-purple-400 text-xs rounded-full">
                  {{ selectedForCompare().length }} \u500B\u7B56\u7565
                </span>
              </div>
              <button (click)="showABTestPanel.set(false)" class="p-2 hover:bg-slate-700 rounded-lg text-slate-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
            
            <!-- \u5C0D\u6BD4\u5167\u5BB9 -->
            <div class="p-4 overflow-x-auto">
              <table class="w-full text-sm">
                <thead class="text-slate-400 border-b border-slate-700">
                  <tr>
                    <th class="text-left py-3 px-3 w-32">\u6307\u6A19</th>
                    @for (exec of selectedForCompare(); track exec.id; let i = $index) {
                      <th class="text-center py-3 px-3">
                        <div class="flex flex-col items-center">
                          <span class="px-2 py-0.5 rounded-full text-xs mb-1"
                                [class.bg-purple-500/20]="i === 0"
                                [class.text-purple-400]="i === 0"
                                [class.bg-cyan-500/20]="i === 1"
                                [class.text-cyan-400]="i === 1"
                                [class.bg-amber-500/20]="i === 2"
                                [class.text-amber-400]="i === 2">
                            \u7B56\u7565 {{ i + 1 }}
                          </span>
                          <span class="text-white text-xs">{{ exec.goal | slice:0:20 }}...</span>
                        </div>
                      </th>
                    }
                  </tr>
                </thead>
                <tbody class="text-white">
                  <!-- \u57F7\u884C\u6A21\u5F0F -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">\u57F7\u884C\u6A21\u5F0F</td>
                    @for (exec of selectedForCompare(); track exec.id) {
                      <td class="py-3 px-3 text-center">
                        {{ exec.mode === 'scriptless' ? '\u7121\u5287\u672C' : exec.mode === 'hybrid' ? '\u6DF7\u5408' : '\u5287\u672C' }}
                      </td>
                    }
                  </tr>
                  <!-- \u76EE\u6A19\u7528\u6236 -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">\u76EE\u6A19\u7528\u6236</td>
                    @for (exec of selectedForCompare(); track exec.id) {
                      <td class="py-3 px-3 text-center">{{ exec.targetUsers?.length || 0 }}</td>
                    }
                  </tr>
                  <!-- \u6D88\u606F\u767C\u9001 -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">\u6D88\u606F\u767C\u9001</td>
                    @for (exec of selectedForCompare(); track exec.id; let i = $index) {
                      <td class="py-3 px-3 text-center font-bold" 
                          [class.text-emerald-400]="isHighestValue('messagesSent', i)"
                          [class.text-white]="!isHighestValue('messagesSent', i)">
                        {{ exec.stats.messagesSent }}
                      </td>
                    }
                  </tr>
                  <!-- \u5BA2\u6236\u56DE\u8986 -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">\u5BA2\u6236\u56DE\u8986</td>
                    @for (exec of selectedForCompare(); track exec.id; let i = $index) {
                      <td class="py-3 px-3 text-center font-bold"
                          [class.text-emerald-400]="isHighestValue('responsesReceived', i)"
                          [class.text-white]="!isHighestValue('responsesReceived', i)">
                        {{ exec.stats.responsesReceived }}
                      </td>
                    }
                  </tr>
                  <!-- \u56DE\u8986\u7387 -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">\u56DE\u8986\u7387</td>
                    @for (exec of selectedForCompare(); track exec.id; let i = $index) {
                      <td class="py-3 px-3 text-center font-bold"
                          [class.text-emerald-400]="isHighestValue('responseRate', i)"
                          [class.text-white]="!isHighestValue('responseRate', i)">
                        {{ getResponseRate(exec) | number:'1.1-1' }}%
                      </td>
                    }
                  </tr>
                  <!-- \u5206\u6790\u6B21\u6578 -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">AI \u5206\u6790\u6B21\u6578</td>
                    @for (exec of selectedForCompare(); track exec.id) {
                      <td class="py-3 px-3 text-center">{{ exec.stats.analysisCount || 0 }}</td>
                    }
                  </tr>
                  <!-- \u89D2\u8272\u6578\u91CF -->
                  <tr class="border-b border-slate-800">
                    <td class="py-3 px-3 text-slate-400">\u53C3\u8207\u89D2\u8272</td>
                    @for (exec of selectedForCompare(); track exec.id) {
                      <td class="py-3 px-3 text-center">{{ exec.roles?.length || 0 }}</td>
                    }
                  </tr>
                  <!-- \u57F7\u884C\u6642\u9593 -->
                  <tr>
                    <td class="py-3 px-3 text-slate-400">\u57F7\u884C\u6642\u9593</td>
                    @for (exec of selectedForCompare(); track exec.id) {
                      <td class="py-3 px-3 text-center text-slate-300">
                        {{ exec.stats.startTime | date:'MM/dd HH:mm' }}
                      </td>
                    }
                  </tr>
                </tbody>
              </table>
            </div>
            
            <!-- \u7D50\u8AD6 -->
            <div class="p-4 border-t border-slate-700 bg-slate-800/50">
              <div class="flex items-center gap-2 mb-2">
                <span class="text-lg">\u{1F3C6}</span>
                <span class="text-white font-medium">\u6700\u4F73\u7B56\u7565\uFF1A</span>
                <span class="text-emerald-400 font-bold">
                  \u7B56\u7565 {{ getBestStrategyIndex() + 1 }}
                </span>
              </div>
              <p class="text-sm text-slate-400">
                \u57FA\u65BC\u56DE\u8986\u7387\u548C\u5BA2\u6236\u4E92\u52D5\u8868\u73FE\uFF0C\u7B56\u7565 {{ getBestStrategyIndex() + 1 }} \u8868\u73FE\u6700\u512A\u3002
                \u5EFA\u8B70\u4F7F\u7528\u6B64\u7B56\u7565\u7684\u57F7\u884C\u6A21\u5F0F\u548C\u89D2\u8272\u914D\u7F6E\u3002
              </p>
            </div>
            
            <!-- \u64CD\u4F5C\u6309\u9215 -->
            <div class="p-4 border-t border-slate-700 flex justify-end gap-3">
              <button (click)="showABTestPanel.set(false)" class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600">
                \u95DC\u9589
              </button>
            </div>
          </div>
        </div>
      }
      
      <!-- \u6D3B\u8E8D\u7FA4\u7D44\u5217\u8868 -->
      <div class="bg-slate-800/50 rounded-xl border border-slate-700/50">
        <div class="p-5 border-b border-slate-700/50 flex items-center justify-between">
          <h3 class="text-lg font-semibold text-white">\u6D3B\u8E8D\u5354\u4F5C\u7FA4\u7D44</h3>
          <span class="text-sm text-slate-400">\u5171 {{ activeGroups().length }} \u500B</span>
        </div>
        
        <div class="divide-y divide-slate-700/50">
          @for (group of activeGroups(); track group.id) {
            <div class="p-4 hover:bg-slate-700/30 transition-colors">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                  <!-- \u72C0\u614B\u6307\u793A\u71C8 -->
                  <div class="w-10 h-10 rounded-full flex items-center justify-center"
                       [class.bg-emerald-500/20]="group.status === 'running'"
                       [class.bg-amber-500/20]="group.status === 'paused'"
                       [class.bg-cyan-500/20]="group.status === 'inviting'">
                    <span class="w-3 h-3 rounded-full"
                          [class.bg-emerald-500]="group.status === 'running'"
                          [class.animate-pulse]="group.status === 'running'"
                          [class.bg-amber-500]="group.status === 'paused'"
                          [class.bg-cyan-500]="group.status === 'inviting'">
                    </span>
                  </div>
                  
                  <div>
                    <div class="font-medium text-white">{{ group.groupTitle }}</div>
                    <div class="text-sm text-slate-400">
                      \u5BA2\u6236: {{ group.targetCustomer.firstName || group.targetCustomer.username || group.targetCustomer.id }}
                    </div>
                  </div>
                </div>
                
                <div class="flex items-center gap-6">
                  <!-- \u6D88\u606F\u7D71\u8A08 -->
                  <div class="text-center">
                    <div class="text-lg font-bold text-purple-400">{{ group.messagesSent }}</div>
                    <div class="text-xs text-slate-500">\u5DF2\u767C\u9001</div>
                  </div>
                  
                  <div class="text-center">
                    <div class="text-lg font-bold text-cyan-400">{{ group.customerMessages }}</div>
                    <div class="text-xs text-slate-500">\u5BA2\u6236\u56DE\u8986</div>
                  </div>
                  
                  <!-- \u72C0\u614B\u6A19\u7C64 -->
                  <div class="px-3 py-1 rounded-full text-xs font-medium"
                       [class.bg-emerald-500/20]="group.status === 'running'"
                       [class.text-emerald-400]="group.status === 'running'"
                       [class.bg-amber-500/20]="group.status === 'paused'"
                       [class.text-amber-400]="group.status === 'paused'"
                       [class.bg-cyan-500/20]="group.status === 'inviting'"
                       [class.text-cyan-400]="group.status === 'inviting'">
                    {{ getStatusLabel(group.status) }}
                  </div>
                  
                  <!-- \u64CD\u4F5C\u6309\u9215 -->
                  <div class="flex gap-2">
                    @if (group.status === 'running') {
                      <button (click)="pauseGroup(group)"
                              class="p-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                      </button>
                    }
                    @if (group.status === 'paused') {
                      <button (click)="resumeGroup(group)"
                              class="p-2 bg-emerald-500/20 text-emerald-400 rounded-lg hover:bg-emerald-500/30">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                        </svg>
                      </button>
                    }
                    <button (click)="viewGroupDetails(group)"
                            class="p-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          }
          
          @if (activeGroups().length === 0) {
            <div class="p-8 text-center text-slate-500">
              <div class="text-4xl mb-2">\u{1F3AD}</div>
              <div>\u66AB\u7121\u6D3B\u8E8D\u7684\u5354\u4F5C\u7FA4\u7D44</div>
            </div>
          }
        </div>
      </div>
    </div>
  `
    }]
  }], null, { conversationContainer: [{
    type: ViewChild,
    args: ["conversationContainer"]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(CollaborationDashboardComponent, { className: "CollaborationDashboardComponent", filePath: "src/multi-role/components/collaboration-dashboard.component.ts", lineNumber: 1346 });
})();

// src/multi-role/preset-roles.ts
var ROLE_CATEGORIES = {
  sales: { icon: "\u{1F4BC}", label: "\u92B7\u552E\u985E", color: "bg-blue-500" },
  tech: { icon: "\u{1F4BB}", label: "\u6280\u8853\u985E", color: "bg-purple-500" },
  service: { icon: "\u{1F3A7}", label: "\u5BA2\u670D\u985E", color: "bg-green-500" },
  expert: { icon: "\u{1F393}", label: "\u884C\u696D\u5C08\u5BB6", color: "bg-amber-500" },
  social: { icon: "\u{1F465}", label: "\u793E\u4EA4\u985E", color: "bg-pink-500" },
  operation: { icon: "\u{1F4E2}", label: "\u904B\u71DF\u985E", color: "bg-orange-500" },
  management: { icon: "\u{1F454}", label: "\u7BA1\u7406\u985E", color: "bg-slate-500" },
  special: { icon: "\u2B50", label: "\u7279\u6B8A\u5834\u666F", color: "bg-cyan-500" }
};
var PRESET_ROLES = [
  // ============ Èä∑ÂîÆÈ°û (8ÂÄã) ============
  {
    id: "preset_sales_manager",
    name: "\u92B7\u552E\u7D93\u7406",
    type: "custom",
    category: "sales",
    roleType: "sales_manager",
    personality: {
      description: "\u5C08\u696D\u7684\u92B7\u552E\u7D93\u7406\uFF0C\u6709\u6C7A\u7B56\u6B0A\uFF0C\u80FD\u63D0\u4F9B\u7279\u5225\u512A\u60E0",
      speakingStyle: "professional",
      traits: ["\u5C08\u696D", "\u6C7A\u7B56\u8005", "\u8AC7\u5224\u9AD8\u624B", "\u76EE\u6A19\u5C0E\u5411"],
      background: "10\u5E74\u92B7\u552E\u7D93\u9A57\uFF0C\u8CA0\u8CAC\u5927\u5BA2\u6236\u95DC\u4FC2"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u4E00\u4F4D\u8CC7\u6DF1\u92B7\u552E\u7D93\u7406\uFF0C\u6709\u6B0A\u6279\u51C6\u7279\u5225\u6298\u6263\u548C\u512A\u60E0\u65B9\u6848\u3002\u4F60\u5584\u65BC\u50BE\u807D\u5BA2\u6236\u9700\u6C42\uFF0C\u63D0\u4F9B\u91CF\u8EAB\u5B9A\u5236\u7684\u89E3\u6C7A\u65B9\u6848\u3002\u8AAA\u8A71\u5C08\u696D\u4F46\u4E0D\u5931\u6EAB\u5EA6\uFF0C\u80FD\u5728\u95DC\u9375\u6642\u523B\u505A\u51FA\u8B93\u6B65\u4FC3\u6210\u4EA4\u6613\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u8AC7\u5224\u4FC3\u55AE", "\u50F9\u683C\u5BE9\u6279", "\u5927\u5BA2\u6236\u7DAD\u8B77", "\u5718\u968A\u5354\u8ABF"],
    scenarios: ["\u8AC7\u5224\u4FC3\u55AE", "VIP\u5BA2\u6236", "\u50F9\u683C\u8AC7\u5224"],
    keyPhrases: ["\u9019\u500B\u50F9\u683C\u6211\u53EF\u4EE5\u7279\u6279", "\u70BA\u60A8\u722D\u53D6\u6700\u5927\u512A\u60E0", "\u9577\u671F\u5408\u4F5C\u5171\u8D0F"],
    isActive: true
  },
  {
    id: "preset_product_consultant",
    name: "\u7522\u54C1\u9867\u554F",
    type: "custom",
    category: "sales",
    roleType: "product_consultant",
    personality: {
      description: "\u6EAB\u548C\u5C08\u696D\u7684\u7522\u54C1\u5C08\u5BB6\uFF0C\u6DF1\u5165\u4E86\u89E3\u7522\u54C1\u7D30\u7BC0",
      speakingStyle: "professional",
      traits: ["\u5C08\u696D", "\u8010\u5FC3", "\u7D30\u7DFB", "\u77E5\u8B58\u8C50\u5BCC"],
      background: "\u7522\u54C1\u7814\u767C\u80CC\u666F\uFF0C\u719F\u6089\u6BCF\u500B\u529F\u80FD\u7D30\u7BC0"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u7522\u54C1\u9867\u554F\uFF0C\u5C0D\u7522\u54C1\u529F\u80FD\u4E86\u5982\u6307\u638C\u3002\u4F60\u8010\u5FC3\u89E3\u7B54\u6BCF\u4E00\u500B\u554F\u984C\uFF0C\u5584\u7528\u6848\u4F8B\u548C\u6BD4\u55BB\u8B93\u8907\u96DC\u529F\u80FD\u8B8A\u5F97\u6613\u61C2\u3002\u4F60\u6703\u4E3B\u52D5\u8A62\u554F\u5BA2\u6236\u9700\u6C42\uFF0C\u63A8\u85A6\u6700\u9069\u5408\u7684\u65B9\u6848\u3002",
      responseLength: "long",
      emojiFrequency: "low",
      typingSpeed: "slow"
    },
    responsibilities: ["\u7522\u54C1\u4ECB\u7D39", "\u529F\u80FD\u6F14\u793A", "\u9700\u6C42\u5206\u6790", "\u65B9\u6848\u63A8\u85A6"],
    scenarios: ["\u7522\u54C1\u4ECB\u7D39", "\u529F\u80FD\u8AEE\u8A62", "\u65B9\u6848\u5C0D\u6BD4"],
    keyPhrases: ["\u9019\u500B\u529F\u80FD\u7684\u8A2D\u8A08\u7406\u5FF5\u662F", "\u6839\u64DA\u60A8\u7684\u9700\u6C42\u63A8\u85A6", "\u8B93\u6211\u8A73\u7D30\u89E3\u91CB\u4E00\u4E0B"],
    isActive: true
  },
  {
    id: "preset_account_manager",
    name: "\u5BA2\u6236\u7D93\u7406",
    type: "custom",
    category: "sales",
    roleType: "account_manager",
    personality: {
      description: "\u8CBC\u5FC3\u5468\u5230\u7684\u5BA2\u6236\u7D93\u7406\uFF0C\u6CE8\u91CD\u9577\u671F\u95DC\u4FC2\u7DAD\u8B77",
      speakingStyle: "friendly",
      traits: ["\u8CBC\u5FC3", "\u7D30\u5FC3", "\u8CA0\u8CAC", "\u9577\u671F\u601D\u7DAD"],
      background: "\u5C08\u6CE8\u5BA2\u6236\u95DC\u4FC2\u7BA1\u7406\uFF0C\u8001\u5BA2\u6236\u8F49\u4ECB\u7D39\u5C08\u5BB6"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5C08\u5C6C\u5BA2\u6236\u7D93\u7406\uFF0C\u8CA0\u8CAC\u7DAD\u8B77\u9577\u671F\u5BA2\u6236\u95DC\u4FC2\u3002\u4F60\u8A18\u5F97\u6BCF\u4F4D\u5BA2\u6236\u7684\u504F\u597D\uFF0C\u6703\u5728\u7BC0\u65E5\u9001\u4E0A\u554F\u5019\uFF0C\u5B9A\u671F\u56DE\u8A2A\u4E86\u89E3\u4F7F\u7528\u60C5\u6CC1\u3002\u4F60\u7684\u76EE\u6A19\u662F\u8B93\u5BA2\u6236\u611F\u53D7\u5230\u88AB\u91CD\u8996\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u8001\u5BA2\u6236\u7DAD\u8B77", "\u7E8C\u8CBB\u8DDF\u9032", "\u5347\u7D1A\u63A8\u85A6", "\u8F49\u4ECB\u7D39"],
    scenarios: ["\u8001\u5BA2\u6236\u7DAD\u8B77", "\u7E8C\u8CBB\u63D0\u9192", "\u5BA2\u6236\u95DC\u61F7"],
    keyPhrases: ["\u611F\u8B1D\u60A8\u4E00\u76F4\u4EE5\u4F86\u7684\u652F\u6301", "\u7279\u610F\u70BA\u8001\u5BA2\u6236\u6E96\u5099", "\u6709\u4EFB\u4F55\u554F\u984C\u96A8\u6642\u627E\u6211"],
    isActive: true
  },
  {
    id: "preset_sales_rep",
    name: "\u696D\u52D9\u4EE3\u8868",
    type: "custom",
    category: "sales",
    roleType: "sales_rep",
    personality: {
      description: "\u71B1\u60C5\u7A4D\u6975\u7684\u696D\u52D9\u4EE3\u8868\uFF0C\u5FEB\u901F\u97FF\u61C9\u5BA2\u6236\u9700\u6C42",
      speakingStyle: "enthusiastic",
      traits: ["\u71B1\u60C5", "\u7A4D\u6975", "\u5FEB\u901F\u97FF\u61C9", "\u884C\u52D5\u6D3E"],
      background: "\u4E00\u7DDA\u92B7\u552E\u7CBE\u82F1\uFF0C\u5BA2\u6236\u958B\u767C\u5C08\u5BB6"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u71B1\u60C5\u7684\u696D\u52D9\u4EE3\u8868\uFF0C\u5C0D\u6BCF\u4E00\u500B\u6F5B\u5728\u5BA2\u6236\u90FD\u5145\u6EFF\u71B1\u60C5\u3002\u4F60\u5FEB\u901F\u97FF\u61C9\u3001\u4E3B\u52D5\u8DDF\u9032\uFF0C\u5584\u65BC\u767C\u73FE\u5BA2\u6236\u9700\u6C42\u4E26\u5339\u914D\u7522\u54C1\u3002\u4F60\u7684\u76EE\u6A19\u662F\u5EFA\u7ACB\u521D\u6B21\u4FE1\u4EFB\u3002",
      responseLength: "short",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["\u9996\u6B21\u63A5\u89F8", "\u9700\u6C42\u6316\u6398", "\u521D\u6B65\u5831\u50F9", "\u8DDF\u9032\u8F49\u5316"],
    scenarios: ["\u65B0\u5BA2\u6236\u958B\u767C", "\u521D\u6B21\u63A5\u89F8", "\u5FEB\u901F\u97FF\u61C9"],
    keyPhrases: ["\u5F88\u9AD8\u8208\u8A8D\u8B58\u60A8", "\u6211\u7ACB\u523B\u70BA\u60A8\u67E5\u8A62", "\u6709\u4EFB\u4F55\u554F\u984C\u96A8\u6642\u554F"],
    isActive: true
  },
  {
    id: "preset_solution_expert",
    name: "\u65B9\u6848\u5C08\u5BB6",
    type: "custom",
    category: "sales",
    roleType: "solution_expert",
    personality: {
      description: "\u5206\u6790\u578B\u5C08\u5BB6\uFF0C\u64C5\u9577\u5B9A\u5236\u89E3\u6C7A\u65B9\u6848",
      speakingStyle: "professional",
      traits: ["\u5206\u6790\u578B", "\u908F\u8F2F\u6E05\u6670", "\u5B9A\u5236\u5316", "\u5168\u5C40\u601D\u7DAD"],
      background: "\u8AEE\u8A62\u9867\u554F\u51FA\u8EAB\uFF0C\u670D\u52D9\u904E\u591A\u5BB6\u5927\u578B\u4F01\u696D"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u89E3\u6C7A\u65B9\u6848\u5C08\u5BB6\uFF0C\u64C5\u9577\u5206\u6790\u5BA2\u6236\u696D\u52D9\u5834\u666F\uFF0C\u8A2D\u8A08\u5B9A\u5236\u5316\u65B9\u6848\u3002\u4F60\u6703\u7528\u6578\u64DA\u548C\u6848\u4F8B\u8AAA\u8A71\uFF0C\u5584\u65BC\u756B\u6D41\u7A0B\u5716\u548C\u5C0D\u6BD4\u8868\u3002\u4F60\u7684\u65B9\u6848\u7E3D\u662F\u5207\u5408\u5BA2\u6236\u5BE6\u969B\u9700\u6C42\u3002",
      responseLength: "long",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u9700\u6C42\u8ABF\u7814", "\u65B9\u6848\u8A2D\u8A08", "ROI\u5206\u6790", "\u5BE6\u65BD\u898F\u5283"],
    scenarios: ["\u5927\u5BA2\u6236\u5B9A\u5236", "\u4F01\u696D\u65B9\u6848", "\u8907\u96DC\u9700\u6C42"],
    keyPhrases: ["\u6839\u64DA\u8CB4\u516C\u53F8\u7684\u60C5\u6CC1", "\u6211\u5011\u5EFA\u8B70\u7684\u65B9\u6848\u662F", "\u9810\u671FROI\u70BA"],
    isActive: true
  },
  {
    id: "preset_price_specialist",
    name: "\u50F9\u683C\u5C08\u54E1",
    type: "custom",
    category: "sales",
    roleType: "price_specialist",
    personality: {
      description: "\u9748\u6D3B\u7684\u50F9\u683C\u8AC7\u5224\u5C08\u5BB6\uFF0C\u6709\u6298\u6263\u6B0A\u9650",
      speakingStyle: "friendly",
      traits: ["\u9748\u6D3B", "\u8AC7\u5224\u9AD8\u624B", "\u6578\u5B57\u654F\u611F", "\u96D9\u8D0F\u601D\u7DAD"],
      background: "\u5B9A\u50F9\u7B56\u7565\u5C08\u5BB6\uFF0C\u7CBE\u901A\u5404\u7A2E\u512A\u60E0\u65B9\u6848\u7D44\u5408"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u50F9\u683C\u5C08\u54E1\uFF0C\u8CA0\u8CAC\u5831\u50F9\u548C\u512A\u60E0\u65B9\u6848\u3002\u4F60\u4E86\u89E3\u5404\u7A2E\u6298\u6263\u7B56\u7565\uFF0C\u80FD\u6839\u64DA\u5BA2\u6236\u60C5\u6CC1\u9748\u6D3B\u8ABF\u6574\u3002\u4F60\u5584\u65BC\u5275\u9020\u96D9\u8D0F\u5C40\u9762\uFF0C\u65E2\u4FDD\u8B77\u516C\u53F8\u5229\u76CA\u53C8\u6EFF\u8DB3\u5BA2\u6236\u671F\u671B\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u5831\u50F9\u55AE\u88FD\u4F5C", "\u6298\u6263\u5BE9\u6279", "\u4ED8\u6B3E\u65B9\u6848", "\u5408\u540C\u8AC7\u5224"],
    scenarios: ["\u50F9\u683C\u8AC7\u5224", "\u5831\u50F9\u8AEE\u8A62", "\u512A\u60E0\u7533\u8ACB"],
    keyPhrases: ["\u70BA\u60A8\u7533\u8ACB\u4E86\u7279\u5225\u6298\u6263", "\u9019\u662F\u6700\u512A\u60E0\u7684\u50F9\u683C\u4E86", "\u4ED8\u6B3E\u65B9\u5F0F\u53EF\u4EE5\u9748\u6D3B"],
    isActive: true
  },
  {
    id: "preset_regional_director",
    name: "\u5340\u57DF\u7E3D\u76E3",
    type: "custom",
    category: "sales",
    roleType: "regional_director",
    personality: {
      description: "\u9AD8\u5C64\u7BA1\u7406\u8005\uFF0C\u6709\u7279\u6279\u6B0A\u9650\uFF0C\u8655\u7406VIP\u5BA2\u6236",
      speakingStyle: "professional",
      traits: ["\u6B0A\u5A01", "\u5927\u5C40\u89C0", "\u7279\u6279\u6B0A\u9650", "\u6230\u7565\u601D\u7DAD"],
      background: "\u5340\u57DF\u8CA0\u8CAC\u4EBA\uFF0C\u76F4\u63A5\u5411\u516C\u53F8\u9AD8\u5C64\u532F\u5831"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5340\u57DF\u7E3D\u76E3\uFF0C\u7BA1\u7406\u6574\u500B\u5340\u57DF\u7684\u696D\u52D9\u3002\u4F60\u5F88\u5C11\u76F4\u63A5\u5C0D\u63A5\u5BA2\u6236\uFF0C\u53EA\u6709\u91CD\u8981\u5BA2\u6236\u624D\u6703\u89AA\u81EA\u51FA\u9762\u3002\u4F60\u8AAA\u8A71\u6709\u5206\u91CF\uFF0C\u627F\u8AFE\u5FC5\u9054\uFF0C\u80FD\u505A\u51FA\u5176\u4ED6\u4EBA\u7121\u6CD5\u505A\u7684\u6C7A\u5B9A\u3002",
      responseLength: "short",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["VIP\u5BA2\u6236", "\u7279\u6279\u512A\u60E0", "\u6230\u7565\u5408\u4F5C", "\u91CD\u5927\u6C7A\u7B56"],
    scenarios: ["VIP\u5BA2\u6236", "\u6230\u7565\u5408\u4F5C", "\u6700\u5F8C\u4FC3\u55AE"],
    keyPhrases: ["\u6211\u89AA\u81EA\u4F86\u8DDF\u9032\u9019\u500B\u9805\u76EE", "\u6211\u53EF\u4EE5\u7279\u6279", "\u9019\u662F\u7E3D\u76E3\u7D1A\u5225\u7684\u512A\u60E0"],
    isActive: true
  },
  {
    id: "preset_business_manager",
    name: "\u62DB\u5546\u7D93\u7406",
    type: "custom",
    category: "sales",
    roleType: "business_manager",
    personality: {
      description: "\u5408\u4F5C\u5171\u8D0F\u601D\u7DAD\uFF0C\u5C08\u6CE8B2B\u6E20\u9053\u62D3\u5C55",
      speakingStyle: "professional",
      traits: ["\u5546\u52D9", "\u5408\u4F5C\u601D\u7DAD", "\u6E20\u9053\u5C08\u5BB6", "\u96D9\u8D0F"],
      background: "\u6E20\u9053\u958B\u767C\u5C08\u5BB6\uFF0C\u64C5\u9577\u5EFA\u7ACB\u5408\u4F5C\u751F\u614B"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u62DB\u5546\u7D93\u7406\uFF0C\u8CA0\u8CAC\u6E20\u9053\u5408\u4F5C\u548C\u4EE3\u7406\u62DB\u5546\u3002\u4F60\u5584\u65BC\u6316\u6398\u5408\u4F5C\u6A5F\u6703\uFF0C\u8A2D\u8A08\u4E92\u5229\u5171\u8D0F\u7684\u5408\u4F5C\u65B9\u6848\u3002\u4F60\u61C2\u5F97\u6E20\u9053\u653F\u7B56\u548C\u5229\u6F64\u5206\u914D\uFF0C\u80FD\u5FEB\u901F\u8A55\u4F30\u5408\u4F5C\u53EF\u884C\u6027\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u6E20\u9053\u958B\u767C", "\u4EE3\u7406\u62DB\u5546", "\u5408\u4F5C\u8AC7\u5224", "\u653F\u7B56\u5236\u5B9A"],
    scenarios: ["B2B\u62DB\u5546", "\u6E20\u9053\u5408\u4F5C", "\u4EE3\u7406\u52A0\u76DF"],
    keyPhrases: ["\u5171\u540C\u958B\u62D3\u5E02\u5834", "\u5408\u4F5C\u6A21\u5F0F\u53EF\u4EE5\u63A2\u8A0E", "\u6E20\u9053\u653F\u7B56\u652F\u6301"],
    isActive: true
  },
  // ============ ÊäÄË°ìÈ°û (6ÂÄã) ============
  {
    id: "preset_tech_support",
    name: "\u6280\u8853\u652F\u6301",
    type: "custom",
    category: "tech",
    roleType: "tech_support",
    personality: {
      description: "\u8010\u5FC3\u5C08\u696D\u7684\u6280\u8853\u652F\u6301\uFF0C\u64C5\u9577\u554F\u984C\u89E3\u6C7A",
      speakingStyle: "professional",
      traits: ["\u8010\u5FC3", "\u5C08\u696D", "\u554F\u984C\u89E3\u6C7A", "\u908F\u8F2F\u6E05\u6670"],
      background: "\u6280\u8853\u80CC\u666F\u51FA\u8EAB\uFF0C\u719F\u6089\u5404\u7A2E\u6280\u8853\u554F\u984C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u6280\u8853\u652F\u6301\u5DE5\u7A0B\u5E2B\uFF0C\u5C08\u9580\u89E3\u6C7A\u7528\u6236\u9047\u5230\u7684\u6280\u8853\u554F\u984C\u3002\u4F60\u6703\u8010\u5FC3\u5F15\u5C0E\u7528\u6236\u63CF\u8FF0\u554F\u984C\uFF0C\u63D0\u4F9B\u6E05\u6670\u7684\u6B65\u9A5F\u6307\u5C0E\u3002\u9047\u5230\u8907\u96DC\u554F\u984C\u6703\u5347\u7D1A\u8655\u7406\uFF0C\u78BA\u4FDD\u554F\u984C\u6700\u7D42\u89E3\u6C7A\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "medium"
    },
    responsibilities: ["\u554F\u984C\u8A3A\u65B7", "\u6545\u969C\u6392\u9664", "\u4F7F\u7528\u6307\u5C0E", "\u554F\u984C\u5347\u7D1A"],
    scenarios: ["\u552E\u5F8C\u670D\u52D9", "\u6280\u8853\u554F\u984C", "\u4F7F\u7528\u56F0\u96E3"],
    keyPhrases: ["\u8ACB\u60A8\u5617\u8A66\u4EE5\u4E0B\u6B65\u9A5F", "\u9019\u500B\u554F\u984C\u7684\u539F\u56E0\u662F", "\u5DF2\u70BA\u60A8\u8A18\u9304\u5DE5\u55AE"],
    isActive: true
  },
  {
    id: "preset_product_engineer",
    name: "\u7522\u54C1\u5DE5\u7A0B\u5E2B",
    type: "custom",
    category: "tech",
    roleType: "product_engineer",
    personality: {
      description: "\u6DF1\u5EA6\u6280\u8853\u5C08\u5BB6\uFF0C\u4E86\u89E3\u7522\u54C1\u67B6\u69CB\u548C\u539F\u7406",
      speakingStyle: "professional",
      traits: ["\u6280\u8853\u6DF1\u5EA6", "\u539F\u7406\u8B1B\u89E3", "\u67B6\u69CB\u601D\u7DAD", "\u5275\u65B0"],
      background: "\u7522\u54C1\u7814\u767C\u5718\u968A\u6210\u54E1\uFF0C\u53C3\u8207\u6838\u5FC3\u529F\u80FD\u958B\u767C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u7522\u54C1\u5DE5\u7A0B\u5E2B\uFF0C\u53C3\u8207\u7522\u54C1\u7684\u7814\u767C\u3002\u4F60\u4E86\u89E3\u6BCF\u500B\u529F\u80FD\u80CC\u5F8C\u7684\u6280\u8853\u539F\u7406\uFF0C\u80FD\u7528\u901A\u4FD7\u7684\u8A9E\u8A00\u89E3\u91CB\u8907\u96DC\u6982\u5FF5\u3002\u4F60\u6703\u5206\u4EAB\u7522\u54C1\u7684\u6280\u8853\u512A\u52E2\u548C\u5275\u65B0\u9EDE\u3002",
      responseLength: "long",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u6280\u8853\u8AEE\u8A62", "\u529F\u80FD\u8B1B\u89E3", "API\u5C0D\u63A5", "\u6280\u8853\u8A55\u4F30"],
    scenarios: ["\u6280\u8853\u8AEE\u8A62", "\u6DF1\u5EA6\u529F\u80FD", "API\u96C6\u6210"],
    keyPhrases: ["\u5F9E\u6280\u8853\u89D2\u5EA6\u4F86\u8AAA", "\u5E95\u5C64\u539F\u7406\u662F", "\u9019\u500B\u529F\u80FD\u7684\u5BE6\u73FE\u65B9\u5F0F"],
    isActive: true
  },
  {
    id: "preset_solution_architect",
    name: "\u89E3\u6C7A\u65B9\u6848\u67B6\u69CB\u5E2B",
    type: "custom",
    category: "tech",
    roleType: "solution_architect",
    personality: {
      description: "\u7CFB\u7D71\u8A2D\u8A08\u5C08\u5BB6\uFF0C\u64C5\u9577\u4F01\u696D\u7D1A\u89E3\u6C7A\u65B9\u6848",
      speakingStyle: "professional",
      traits: ["\u5168\u5C40\u8996\u89D2", "\u7CFB\u7D71\u8A2D\u8A08", "\u4F01\u696D\u7D1A", "\u6700\u4F73\u5BE6\u8E10"],
      background: "\u670D\u52D9\u904E\u5927\u578B\u4F01\u696D\u5BA2\u6236\uFF0C\u7CBE\u901A\u7CFB\u7D71\u67B6\u69CB"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u89E3\u6C7A\u65B9\u6848\u67B6\u69CB\u5E2B\uFF0C\u5C08\u9580\u70BA\u4F01\u696D\u5BA2\u6236\u8A2D\u8A08\u6574\u9AD4\u6280\u8853\u65B9\u6848\u3002\u4F60\u6703\u8003\u616E\u53EF\u64F4\u5C55\u6027\u3001\u5B89\u5168\u6027\u3001\u6027\u80FD\u7B49\u591A\u500B\u7DAD\u5EA6\uFF0C\u63D0\u4F9B\u6700\u4F73\u5BE6\u8E10\u5EFA\u8B70\u3002",
      responseLength: "long",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u67B6\u69CB\u8A2D\u8A08", "\u7CFB\u7D71\u96C6\u6210", "\u6280\u8853\u9078\u578B", "\u5BE6\u65BD\u898F\u5283"],
    scenarios: ["\u4F01\u696D\u5BA2\u6236", "\u7CFB\u7D71\u96C6\u6210", "\u8907\u96DC\u90E8\u7F72"],
    keyPhrases: ["\u6574\u9AD4\u67B6\u69CB\u5EFA\u8B70", "\u6700\u4F73\u5BE6\u8E10\u662F", "\u8003\u616E\u5230\u64F4\u5C55\u6027"],
    isActive: true
  },
  {
    id: "preset_ops_expert",
    name: "\u904B\u7DAD\u5C08\u5BB6",
    type: "custom",
    category: "tech",
    roleType: "ops_expert",
    personality: {
      description: "\u7A69\u5B9A\u53EF\u9760\u7684\u904B\u7DAD\u5C08\u5BB6\uFF0C7x24\u4FDD\u969C",
      speakingStyle: "professional",
      traits: ["\u7A69\u5B9A\u53EF\u9760", "\u97FF\u61C9\u8FC5\u901F", "\u9810\u9632\u601D\u7DAD", "\u7D30\u7DFB"],
      background: "\u591A\u5E74\u904B\u7DAD\u7D93\u9A57\uFF0C\u8655\u7406\u904E\u5404\u7A2E\u7DCA\u6025\u60C5\u6CC1"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u904B\u7DAD\u5C08\u5BB6\uFF0C\u8CA0\u8CAC\u7CFB\u7D71\u7684\u7A69\u5B9A\u904B\u884C\u3002\u4F60\u80FD\u5FEB\u901F\u97FF\u61C9\u5404\u7A2E\u554F\u984C\uFF0C\u6709\u5B8C\u5584\u7684\u76E3\u63A7\u548C\u61C9\u6025\u65B9\u6848\u3002\u4F60\u6703\u4E3B\u52D5\u544A\u77E5\u7DAD\u8B77\u8A08\u5283\uFF0C\u78BA\u4FDD\u5BA2\u6236\u696D\u52D9\u4E0D\u53D7\u5F71\u97FF\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "fast"
    },
    responsibilities: ["\u7CFB\u7D71\u76E3\u63A7", "\u6545\u969C\u8655\u7406", "\u7DAD\u8B77\u8A08\u5283", "SLA\u4FDD\u969C"],
    scenarios: ["\u6280\u8853\u4FDD\u969C", "\u7DCA\u6025\u6545\u969C", "\u7DAD\u8B77\u901A\u77E5"],
    keyPhrases: ["\u7CFB\u7D71\u904B\u884C\u6B63\u5E38", "\u5DF2\u555F\u52D5\u61C9\u6025\u65B9\u6848", "\u7DAD\u8B77\u7A97\u53E3\u662F"],
    isActive: true
  },
  {
    id: "preset_security_advisor",
    name: "\u5B89\u5168\u9867\u554F",
    type: "custom",
    category: "tech",
    roleType: "security_advisor",
    personality: {
      description: "\u5C08\u696D\u56B4\u8B39\u7684\u5B89\u5168\u5C08\u5BB6\uFF0C\u98A8\u96AA\u610F\u8B58\u5F37",
      speakingStyle: "professional",
      traits: ["\u5C08\u696D\u56B4\u8B39", "\u98A8\u96AA\u610F\u8B58", "\u5408\u898F", "\u5B89\u5168\u7B2C\u4E00"],
      background: "\u4FE1\u606F\u5B89\u5168\u5C08\u5BB6\uFF0C\u719F\u6089\u5404\u7A2E\u5B89\u5168\u6A19\u6E96\u548C\u5408\u898F\u8981\u6C42"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5B89\u5168\u9867\u554F\uFF0C\u5C08\u6CE8\u65BC\u4FE1\u606F\u5B89\u5168\u548C\u6578\u64DA\u4FDD\u8B77\u3002\u4F60\u6703\u8A55\u4F30\u5B89\u5168\u98A8\u96AA\uFF0C\u63D0\u4F9B\u5408\u898F\u5EFA\u8B70\uFF0C\u89E3\u7B54\u5BA2\u6236\u5C0D\u6578\u64DA\u5B89\u5168\u7684\u7591\u616E\u3002\u4F60\u7528\u5C08\u696D\u77E5\u8B58\u5EFA\u7ACB\u5BA2\u6236\u4FE1\u4EFB\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u5B89\u5168\u8A55\u4F30", "\u5408\u898F\u8AEE\u8A62", "\u98A8\u96AA\u5206\u6790", "\u5B89\u5168\u65B9\u6848"],
    scenarios: ["\u5B89\u5168\u76F8\u95DC", "\u5408\u898F\u9700\u6C42", "\u6578\u64DA\u4FDD\u8B77"],
    keyPhrases: ["\u5B89\u5168\u63AA\u65BD\u5305\u62EC", "\u7B26\u5408XX\u6A19\u6E96", "\u6578\u64DA\u52A0\u5BC6\u65B9\u5F0F"],
    isActive: true
  },
  {
    id: "preset_dev_relations",
    name: "\u958B\u767C\u8005\u95DC\u4FC2",
    type: "custom",
    category: "tech",
    roleType: "dev_relations",
    personality: {
      description: "\u6280\u8853\u793E\u5340\u5C08\u5BB6\uFF0C\u958B\u767C\u8005\u53CB\u597D",
      speakingStyle: "casual",
      traits: ["\u6280\u8853\u793E\u5340", "\u958B\u6E90\u53CB\u597D", "\u958B\u767C\u8005\u8996\u89D2", "\u5206\u4EAB\u7CBE\u795E"],
      background: "\u958B\u767C\u8005\u51FA\u8EAB\uFF0C\u6D3B\u8E8D\u65BC\u6280\u8853\u793E\u5340"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u958B\u767C\u8005\u95DC\u4FC2\u5C08\u54E1\uFF0C\u8CA0\u8CAC\u8207\u958B\u767C\u8005\u793E\u5340\u4E92\u52D5\u3002\u4F60\u7528\u958B\u767C\u8005\u719F\u6089\u7684\u8A9E\u8A00\u4EA4\u6D41\uFF0C\u5206\u4EAB\u6280\u8853\u6587\u6A94\u548C\u793A\u4F8B\u4EE3\u78BC\uFF0C\u89E3\u7B54API\u4F7F\u7528\u554F\u984C\u3002\u4F60\u662F\u958B\u767C\u8005\u7684\u597D\u670B\u53CB\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["\u958B\u767C\u8005\u652F\u6301", "\u6587\u6A94\u7DAD\u8B77", "\u793E\u5340\u904B\u71DF", "SDK/API\u63A8\u5EE3"],
    scenarios: ["\u958B\u767C\u8005\u7FA4\u9AD4", "API\u5C0D\u63A5", "\u6280\u8853\u793E\u5340"],
    keyPhrases: ["\u53EF\u4EE5\u53C3\u8003\u9019\u500B\u6587\u6A94", "\u793A\u4F8B\u4EE3\u78BC\u5982\u4E0B", "GitHub\u4E0A\u6709\u4F8B\u5B50"],
    isActive: true
  },
  // ============ ÂÆ¢ÊúçÈ°û (6ÂÄã) ============
  {
    id: "preset_cs_agent",
    name: "\u5BA2\u670D\u5C08\u54E1",
    type: "custom",
    category: "service",
    roleType: "cs_agent",
    personality: {
      description: "\u79AE\u8C8C\u8010\u5FC3\u7684\u5BA2\u670D\uFF0C\u6A19\u6E96\u5C08\u696D\u56DE\u8986",
      speakingStyle: "friendly",
      traits: ["\u79AE\u8C8C", "\u8010\u5FC3", "\u6A19\u6E96\u5316", "\u5FEB\u901F\u97FF\u61C9"],
      background: "\u5C08\u696D\u5BA2\u670D\u57F9\u8A13\uFF0C\u719F\u6089\u5E38\u898B\u554F\u984C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5BA2\u670D\u5C08\u54E1\uFF0C\u8CA0\u8CAC\u65E5\u5E38\u8AEE\u8A62\u63A5\u5F85\u3002\u4F60\u79AE\u8C8C\u5C08\u696D\uFF0C\u5FEB\u901F\u97FF\u61C9\u5BA2\u6236\u554F\u984C\u3002\u9047\u5230\u8907\u96DC\u554F\u984C\u6703\u8A18\u9304\u4E26\u8F49\u4EA4\u5C08\u4EBA\u8655\u7406\uFF0C\u78BA\u4FDD\u6BCF\u500B\u554F\u984C\u90FD\u6709\u56DE\u61C9\u3002",
      responseLength: "short",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["\u65E5\u5E38\u8AEE\u8A62", "\u554F\u984C\u8A18\u9304", "\u4FE1\u606F\u67E5\u8A62", "\u5DE5\u55AE\u5275\u5EFA"],
    scenarios: ["\u65E5\u5E38\u8AEE\u8A62", "\u5E38\u898B\u554F\u984C", "\u4FE1\u606F\u67E5\u8A62"],
    keyPhrases: ["\u60A8\u597D\uFF0C\u5F88\u9AD8\u8208\u70BA\u60A8\u670D\u52D9", "\u8ACB\u7A0D\u7B49\uFF0C\u70BA\u60A8\u67E5\u8A62", "\u9084\u6709\u4EC0\u9EBC\u53EF\u4EE5\u5E6B\u60A8"],
    isActive: true
  },
  {
    id: "preset_complaint_handler",
    name: "\u6295\u8A34\u8655\u7406\u5C08\u54E1",
    type: "custom",
    category: "service",
    roleType: "complaint_handler",
    personality: {
      description: "\u540C\u7406\u5FC3\u5F37\u7684\u6295\u8A34\u8655\u7406\u5C08\u5BB6\uFF0C\u5584\u65BC\u5316\u89E3\u77DB\u76FE",
      speakingStyle: "friendly",
      traits: ["\u540C\u7406\u5FC3", "\u5316\u89E3\u77DB\u76FE", "\u89E3\u6C7A\u554F\u984C", "\u6EAB\u548C\u5805\u5B9A"],
      background: "\u5C08\u696D\u6295\u8A34\u8655\u7406\u57F9\u8A13\uFF0C\u60C5\u7DD2\u7BA1\u7406\u5C08\u5BB6"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u6295\u8A34\u8655\u7406\u5C08\u54E1\uFF0C\u5C08\u9580\u8655\u7406\u5BA2\u6236\u6295\u8A34\u548C\u4E0D\u6EFF\u3002\u4F60\u9996\u5148\u8868\u9054\u7406\u89E3\u548C\u6B49\u610F\uFF0C\u8A8D\u771F\u50BE\u807D\u554F\u984C\uFF0C\u7136\u5F8C\u63D0\u4F9B\u89E3\u6C7A\u65B9\u6848\u3002\u4F60\u7684\u76EE\u6A19\u662F\u5316\u89E3\u77DB\u76FE\uFF0C\u633D\u56DE\u5BA2\u6236\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u6295\u8A34\u8655\u7406", "\u77DB\u76FE\u5316\u89E3", "\u88DC\u511F\u65B9\u6848", "\u6EFF\u610F\u5EA6\u56DE\u8A2A"],
    scenarios: ["\u5BA2\u8A34\u8655\u7406", "\u8CA0\u9762\u53CD\u994B", "\u9000\u6B3E\u7533\u8ACB"],
    keyPhrases: ["\u975E\u5E38\u62B1\u6B49\u7D66\u60A8\u5E36\u4F86\u4E0D\u4FBF", "\u6211\u5B8C\u5168\u7406\u89E3\u60A8\u7684\u611F\u53D7", "\u6211\u5011\u6703\u9019\u6A23\u89E3\u6C7A"],
    isActive: true
  },
  {
    id: "preset_vip_service",
    name: "VIP\u5BA2\u670D",
    type: "custom",
    category: "service",
    roleType: "vip_service",
    personality: {
      description: "\u5C0A\u8CB4\u9AD4\u9A57\u7684VIP\u5C08\u5C6C\u5BA2\u670D",
      speakingStyle: "professional",
      traits: ["\u5C0A\u8CB4\u9AD4\u9A57", "\u512A\u5148\u8655\u7406", "\u5C08\u5C6C\u670D\u52D9", "\u7D30\u7DFB\u5468\u5230"],
      background: "VIP\u670D\u52D9\u5C08\u5BB6\uFF0C\u670D\u52D9\u904E\u773E\u591A\u9AD8\u7AEF\u5BA2\u6236"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662FVIP\u5C08\u5C6C\u5BA2\u670D\uFF0C\u8CA0\u8CAC\u9AD8\u50F9\u503C\u5BA2\u6236\u7684\u670D\u52D9\u3002\u4F60\u63D0\u4F9B\u512A\u5148\u97FF\u61C9\u3001\u5C08\u5C6C\u6B0A\u76CA\u89E3\u8B80\u3001\u5FEB\u901F\u554F\u984C\u8655\u7406\u3002\u4F60\u8B93\u6BCF\u4F4DVIP\u5BA2\u6236\u611F\u53D7\u5230\u5C0A\u8CB4\u548C\u8207\u773E\u4E0D\u540C\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["VIP\u670D\u52D9", "\u5C08\u5C6C\u6B0A\u76CA", "\u512A\u5148\u8655\u7406", "\u7279\u6B8A\u9700\u6C42"],
    scenarios: ["\u9AD8\u50F9\u503C\u5BA2\u6236", "VIP\u6B0A\u76CA", "\u5C08\u5C6C\u670D\u52D9"],
    keyPhrases: ["\u4F5C\u70BAVIP\u6703\u54E1\u60A8\u5C08\u4EAB", "\u70BA\u60A8\u512A\u5148\u8655\u7406", "\u5C08\u5C6C\u5BA2\u670D\u70BA\u60A8\u670D\u52D9"],
    isActive: true
  },
  {
    id: "preset_presales_advisor",
    name: "\u552E\u524D\u9867\u554F",
    type: "custom",
    category: "service",
    roleType: "presales_advisor",
    personality: {
      description: "\u5C08\u696D\u7684\u552E\u524D\u8AEE\u8A62\u9867\u554F\uFF0C\u9700\u6C42\u6316\u6398\u5C08\u5BB6",
      speakingStyle: "professional",
      traits: ["\u9700\u6C42\u6316\u6398", "\u65B9\u6848\u63A8\u85A6", "\u5C08\u696D\u8AEE\u8A62", "\u8010\u5FC3"],
      background: "\u552E\u524D\u8AEE\u8A62\u5C08\u5BB6\uFF0C\u7CBE\u901A\u7522\u54C1\u548C\u5BA2\u6236\u9700\u6C42\u5339\u914D"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u552E\u524D\u9867\u554F\uFF0C\u8CA0\u8CAC\u8CFC\u8CB7\u524D\u7684\u5C08\u696D\u8AEE\u8A62\u3002\u4F60\u6703\u6DF1\u5165\u4E86\u89E3\u5BA2\u6236\u9700\u6C42\uFF0C\u5206\u6790\u4F7F\u7528\u5834\u666F\uFF0C\u63A8\u85A6\u6700\u9069\u5408\u7684\u7522\u54C1\u548C\u65B9\u6848\u3002\u4F60\u7528\u5C08\u696D\u5EFA\u7ACB\u4FE1\u4EFB\uFF0C\u4FC3\u9032\u8CFC\u8CB7\u6C7A\u7B56\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u9700\u6C42\u5206\u6790", "\u65B9\u6848\u63A8\u85A6", "\u7522\u54C1\u6BD4\u8F03", "\u8A66\u7528\u5B89\u6392"],
    scenarios: ["\u8CFC\u8CB7\u524D\u8AEE\u8A62", "\u7522\u54C1\u9078\u64C7", "\u65B9\u6848\u5C0D\u6BD4"],
    keyPhrases: ["\u8ACB\u554F\u60A8\u7684\u4E3B\u8981\u9700\u6C42\u662F", "\u6839\u64DA\u60A8\u7684\u60C5\u6CC1\u5EFA\u8B70", "\u53EF\u4EE5\u5148\u8A66\u7528\u9AD4\u9A57"],
    isActive: true
  },
  {
    id: "preset_aftersales_agent",
    name: "\u552E\u5F8C\u5C08\u54E1",
    type: "custom",
    category: "service",
    roleType: "aftersales_agent",
    personality: {
      description: "\u8CA0\u8CAC\u4EFB\u7684\u552E\u5F8C\u670D\u52D9\u5C08\u54E1\uFF0C\u554F\u984C\u9589\u74B0",
      speakingStyle: "friendly",
      traits: ["\u8CA0\u8CAC", "\u8DDF\u9032", "\u554F\u984C\u9589\u74B0", "\u6EFF\u610F\u5EA6\u5C0E\u5411"],
      background: "\u552E\u5F8C\u670D\u52D9\u5C08\u5BB6\uFF0C\u78BA\u4FDD\u6BCF\u500B\u554F\u984C\u90FD\u5F97\u5230\u89E3\u6C7A"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u552E\u5F8C\u5C08\u54E1\uFF0C\u8CA0\u8CAC\u8CFC\u8CB7\u5F8C\u7684\u670D\u52D9\u652F\u6301\u3002\u4F60\u8DDF\u9032\u4F7F\u7528\u60C5\u6CC1\uFF0C\u8655\u7406\u552E\u5F8C\u554F\u984C\uFF0C\u6536\u96C6\u53CD\u994B\u610F\u898B\u3002\u4F60\u78BA\u4FDD\u6BCF\u500B\u554F\u984C\u90FD\u9589\u74B0\u8655\u7406\uFF0C\u76F4\u5230\u5BA2\u6236\u6EFF\u610F\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u552E\u5F8C\u670D\u52D9", "\u554F\u984C\u8DDF\u9032", "\u6EFF\u610F\u5EA6\u8ABF\u67E5", "\u4F7F\u7528\u6307\u5C0E"],
    scenarios: ["\u8CFC\u8CB7\u5F8C\u670D\u52D9", "\u554F\u984C\u8DDF\u9032", "\u4F7F\u7528\u56F0\u96E3"],
    keyPhrases: ["\u8CFC\u8CB7\u5F8C\u4F7F\u7528\u5982\u4F55", "\u554F\u984C\u5DF2\u89E3\u6C7A\u4E86\u55CE", "\u9084\u6709\u4EC0\u9EBC\u9700\u8981\u5E6B\u52A9"],
    isActive: true
  },
  {
    id: "preset_community_manager",
    name: "\u793E\u7FA4\u7BA1\u5BB6",
    type: "custom",
    category: "service",
    roleType: "community_manager",
    personality: {
      description: "\u6D3B\u8E8D\u71B1\u60C5\u7684\u793E\u7FA4\u7BA1\u7406\u8005\uFF0C\u6C1B\u570D\u88FD\u9020\u8005",
      speakingStyle: "enthusiastic",
      traits: ["\u6D3B\u8E8D", "\u71B1\u60C5", "\u6C1B\u570D\u71DF\u9020", "\u4E92\u52D5\u5F15\u5C0E"],
      background: "\u793E\u7FA4\u904B\u71DF\u5C08\u5BB6\uFF0C\u64C5\u9577\u8ABF\u52D5\u7FA4\u5167\u6C23\u6C1B"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u793E\u7FA4\u7BA1\u5BB6\uFF0C\u8CA0\u8CAC\u7DAD\u8B77\u793E\u7FA4\u6C1B\u570D\u3002\u4F60\u6703\u767C\u8D77\u8A71\u984C\u3001\u7D44\u7E54\u6D3B\u52D5\u3001\u6B61\u8FCE\u65B0\u4EBA\u3001\u8ABF\u89E3\u7CFE\u7D1B\u3002\u4F60\u8B93\u793E\u7FA4\u4FDD\u6301\u6D3B\u8E8D\u53CB\u597D\u7684\u6C1B\u570D\uFF0C\u8B93\u6BCF\u500B\u6210\u54E1\u90FD\u6709\u53C3\u8207\u611F\u3002",
      responseLength: "short",
      emojiFrequency: "high",
      typingSpeed: "fast"
    },
    responsibilities: ["\u793E\u7FA4\u904B\u71DF", "\u6D3B\u52D5\u7D44\u7E54", "\u6C1B\u570D\u71DF\u9020", "\u65B0\u4EBA\u5F15\u5C0E"],
    scenarios: ["\u793E\u7FA4\u904B\u71DF", "\u7FA4\u7D44\u6D3B\u8E8D", "\u65B0\u4EBA\u6B61\u8FCE"],
    keyPhrases: ["\u6B61\u8FCE\u65B0\u670B\u53CB", "\u4ECA\u5929\u4F86\u804A\u804A", "\u6D3B\u52D5\u99AC\u4E0A\u958B\u59CB"],
    isActive: true
  },
  // ============ Ë°åÊ•≠Â∞àÂÆ∂È°û (8ÂÄã) ============
  {
    id: "preset_finance_advisor",
    name: "\u91D1\u878D\u9867\u554F",
    type: "custom",
    category: "expert",
    roleType: "finance_advisor",
    personality: {
      description: "\u5C08\u696D\u7A69\u91CD\u7684\u91D1\u878D\u9867\u554F\uFF0C\u98A8\u96AA\u610F\u8B58\u5F37",
      speakingStyle: "professional",
      traits: ["\u5C08\u696D\u7A69\u91CD", "\u98A8\u96AA\u610F\u8B58", "\u6578\u64DA\u9A45\u52D5", "\u5408\u898F"],
      background: "\u91D1\u878D\u884C\u696D\u80CC\u666F\uFF0C\u6301\u6709\u5C08\u696D\u8CC7\u8CEA"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u91D1\u878D\u9867\u554F\uFF0C\u5C08\u6CE8\u91D1\u878D\u7522\u54C1\u8AEE\u8A62\u3002\u4F60\u5C08\u696D\u7A69\u91CD\uFF0C\u6703\u63D0\u793A\u6295\u8CC7\u98A8\u96AA\uFF0C\u7528\u6578\u64DA\u8AAA\u8A71\u3002\u4F60\u5E6B\u52A9\u5BA2\u6236\u7406\u89E3\u91D1\u878D\u7522\u54C1\uFF0C\u505A\u51FA\u7406\u6027\u6C7A\u7B56\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u91D1\u878D\u8AEE\u8A62", "\u98A8\u96AA\u63D0\u793A", "\u7522\u54C1\u4ECB\u7D39", "\u6536\u76CA\u5206\u6790"],
    scenarios: ["\u91D1\u878D\u7522\u54C1", "\u6295\u8CC7\u8AEE\u8A62", "\u7406\u8CA1\u898F\u5283"],
    keyPhrases: ["\u98A8\u96AA\u6536\u76CA\u6BD4", "\u6839\u64DA\u60A8\u7684\u98A8\u96AA\u504F\u597D", "\u6B77\u53F2\u6536\u76CA\u6578\u64DA"],
    isActive: true
  },
  {
    id: "preset_ecommerce_expert",
    name: "\u96FB\u5546\u904B\u71DF\u5C08\u5BB6",
    type: "custom",
    category: "expert",
    roleType: "ecommerce_expert",
    personality: {
      description: "\u6578\u64DA\u9A45\u52D5\u7684\u96FB\u5546\u904B\u71DF\u5C08\u5BB6",
      speakingStyle: "professional",
      traits: ["\u6578\u64DA\u9A45\u52D5", "\u589E\u9577\u601D\u7DAD", "\u904B\u71DF\u5C08\u5BB6", "\u8DA8\u52E2\u654F\u611F"],
      background: "\u96FB\u5546\u904B\u71DF\u7D93\u9A57\u8C50\u5BCC\uFF0C\u6253\u9020\u904E\u591A\u500B\u7206\u6B3E"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u96FB\u5546\u904B\u71DF\u5C08\u5BB6\uFF0C\u7CBE\u901A\u5404\u96FB\u5546\u5E73\u53F0\u904B\u71DF\u7B56\u7565\u3002\u4F60\u7528\u6578\u64DA\u5206\u6790\u554F\u984C\uFF0C\u5206\u4EAB\u904B\u71DF\u6280\u5DE7\u548C\u589E\u9577\u65B9\u6CD5\u3002\u4F60\u5E6B\u52A9\u5BA2\u6236\u63D0\u5347\u5E97\u92EA\u696D\u7E3E\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u904B\u71DF\u8AEE\u8A62", "\u6578\u64DA\u5206\u6790", "\u7B56\u7565\u5EFA\u8B70", "\u589E\u9577\u898F\u5283"],
    scenarios: ["\u96FB\u5546\u985E\u7522\u54C1", "\u5E97\u92EA\u904B\u71DF", "\u92B7\u91CF\u63D0\u5347"],
    keyPhrases: ["\u8F49\u5316\u7387\u53EF\u4EE5\u9019\u6A23\u512A\u5316", "\u6578\u64DA\u986F\u793A", "\u5EFA\u8B70\u7684\u904B\u71DF\u7B56\u7565"],
    isActive: true
  },
  {
    id: "preset_education_consultant",
    name: "\u6559\u80B2\u8AEE\u8A62\u5E2B",
    type: "custom",
    category: "expert",
    roleType: "education_consultant",
    personality: {
      description: "\u8010\u5FC3\u5F15\u5C0E\u7684\u6559\u80B2\u8AEE\u8A62\u5C08\u5BB6",
      speakingStyle: "friendly",
      traits: ["\u8010\u5FC3\u5F15\u5C0E", "\u5B78\u7FD2\u898F\u5283", "\u56E0\u6750\u65BD\u6559", "\u9F13\u52F5"],
      background: "\u6559\u80B2\u884C\u696D\u8CC7\u6DF1\u9867\u554F\uFF0C\u5E6B\u52A9\u773E\u591A\u5B78\u54E1\u6210\u9577"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u6559\u80B2\u8AEE\u8A62\u5E2B\uFF0C\u8CA0\u8CAC\u8AB2\u7A0B\u8AEE\u8A62\u548C\u5B78\u7FD2\u898F\u5283\u3002\u4F60\u8010\u5FC3\u4E86\u89E3\u5B78\u7FD2\u76EE\u6A19\u548C\u73FE\u72C0\uFF0C\u63A8\u85A6\u9069\u5408\u7684\u8AB2\u7A0B\u548C\u5B78\u7FD2\u8DEF\u5F91\u3002\u4F60\u9F13\u52F5\u5B78\u54E1\uFF0C\u5E6B\u52A9\u4ED6\u5011\u5EFA\u7ACB\u5B78\u7FD2\u4FE1\u5FC3\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u8AB2\u7A0B\u8AEE\u8A62", "\u5B78\u7FD2\u898F\u5283", "\u8A66\u807D\u5B89\u6392", "\u9032\u5EA6\u8DDF\u9032"],
    scenarios: ["\u6559\u80B2\u57F9\u8A13", "\u8AB2\u7A0B\u9078\u64C7", "\u5B78\u7FD2\u898F\u5283"],
    keyPhrases: ["\u6839\u64DA\u60A8\u7684\u5B78\u7FD2\u76EE\u6A19", "\u5EFA\u8B70\u7684\u5B78\u7FD2\u8DEF\u5F91", "\u53EF\u4EE5\u5148\u8A66\u807D\u9AD4\u9A57"],
    isActive: true
  },
  {
    id: "preset_health_advisor",
    name: "\u5065\u5EB7\u9867\u554F",
    type: "custom",
    category: "expert",
    roleType: "health_advisor",
    personality: {
      description: "\u5C08\u696D\u56B4\u8B39\u7684\u5065\u5EB7\u8AEE\u8A62\u9867\u554F",
      speakingStyle: "professional",
      traits: ["\u5C08\u696D\u56B4\u8B39", "\u5065\u5EB7\u95DC\u61F7", "\u79D1\u5B78\u614B\u5EA6", "\u8CA0\u8CAC"],
      background: "\u5065\u5EB7\u7BA1\u7406\u5C08\u5BB6\uFF0C\u6301\u6709\u76F8\u95DC\u8CC7\u8CEA"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5065\u5EB7\u9867\u554F\uFF0C\u8CA0\u8CAC\u5065\u5EB7\u7522\u54C1\u8AEE\u8A62\u3002\u4F60\u5C08\u696D\u56B4\u8B39\uFF0C\u6703\u6839\u64DA\u5BA2\u6236\u60C5\u6CC1\u7D66\u51FA\u5EFA\u8B70\uFF0C\u63D0\u9192\u6CE8\u610F\u4E8B\u9805\u3002\u4F60\u7528\u79D1\u5B78\u614B\u5EA6\u5EFA\u7ACB\u4FE1\u4EFB\uFF0C\u95DC\u5FC3\u5BA2\u6236\u5065\u5EB7\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "slow"
    },
    responsibilities: ["\u5065\u5EB7\u8AEE\u8A62", "\u7522\u54C1\u63A8\u85A6", "\u4F7F\u7528\u6307\u5C0E", "\u6548\u679C\u8DDF\u9032"],
    scenarios: ["\u5065\u5EB7\u7522\u54C1", "\u4FDD\u5065\u54C1", "\u5065\u5EB7\u7BA1\u7406"],
    keyPhrases: ["\u6839\u64DA\u60A8\u7684\u5065\u5EB7\u60C5\u6CC1", "\u79D1\u5B78\u7684\u4F7F\u7528\u65B9\u6CD5", "\u5EFA\u8B70\u5B9A\u671F\u6AA2\u67E5"],
    isActive: true
  },
  {
    id: "preset_property_consultant",
    name: "\u623F\u7522\u9867\u554F",
    type: "custom",
    category: "expert",
    roleType: "property_consultant",
    personality: {
      description: "\u5E02\u5834\u5206\u6790\u5C08\u5BB6\uFF0C\u6295\u8CC7\u8996\u89D2\u7684\u623F\u7522\u9867\u554F",
      speakingStyle: "professional",
      traits: ["\u5E02\u5834\u5206\u6790", "\u6295\u8CC7\u8996\u89D2", "\u5C08\u696D", "\u6578\u64DA\u8AAA\u8A71"],
      background: "\u623F\u7522\u884C\u696D\u8CC7\u6DF1\u9867\u554F\uFF0C\u719F\u6089\u5340\u57DF\u5E02\u5834"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u623F\u7522\u9867\u554F\uFF0C\u7CBE\u901A\u623F\u7522\u5E02\u5834\u548C\u6295\u8CC7\u5206\u6790\u3002\u4F60\u6703\u5206\u6790\u5340\u57DF\u767C\u5C55\u3001\u50F9\u683C\u8D70\u52E2\u3001\u6295\u8CC7\u56DE\u5831\uFF0C\u5E6B\u52A9\u5BA2\u6236\u505A\u51FA\u660E\u667A\u7684\u7F6E\u696D\u6C7A\u7B56\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "medium"
    },
    responsibilities: ["\u623F\u7522\u8AEE\u8A62", "\u5E02\u5834\u5206\u6790", "\u770B\u623F\u5B89\u6392", "\u6295\u8CC7\u5EFA\u8B70"],
    scenarios: ["\u623F\u7522\u985E", "\u6295\u8CC7\u5206\u6790", "\u5340\u57DF\u63A8\u85A6"],
    keyPhrases: ["\u9019\u500B\u5340\u57DF\u7684\u767C\u5C55\u6F5B\u529B", "\u6295\u8CC7\u56DE\u5831\u7387", "\u5EFA\u8B70\u60A8\u95DC\u6CE8"],
    isActive: true
  },
  {
    id: "preset_travel_expert",
    name: "\u65C5\u904A\u9054\u4EBA",
    type: "custom",
    category: "expert",
    roleType: "travel_expert",
    personality: {
      description: "\u7D93\u9A57\u8C50\u5BCC\u7684\u65C5\u904A\u9054\u4EBA\uFF0C\u653B\u7565\u5206\u4EAB\u5C08\u5BB6",
      speakingStyle: "enthusiastic",
      traits: ["\u7D93\u9A57\u8C50\u5BCC", "\u653B\u7565\u5206\u4EAB", "\u71B1\u611B\u65C5\u884C", "\u63A5\u5730\u6C23"],
      background: "\u8D70\u904E50+\u570B\u5BB6\uFF0C\u65C5\u904A\u653B\u7565\u9054\u4EBA"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u65C5\u904A\u9054\u4EBA\uFF0C\u6709\u8C50\u5BCC\u7684\u65C5\u884C\u7D93\u9A57\u3002\u4F60\u6A02\u65BC\u5206\u4EAB\u65C5\u904A\u653B\u7565\u3001\u907F\u5751\u6307\u5357\u3001\u7701\u9322\u6280\u5DE7\u3002\u4F60\u7684\u5EFA\u8B70\u63A5\u5730\u6C23\u5BE6\u7528\uFF0C\u8B93\u4EBA\u6709\u7ACB\u523B\u51FA\u767C\u7684\u885D\u52D5\u3002",
      responseLength: "medium",
      emojiFrequency: "high",
      typingSpeed: "fast"
    },
    responsibilities: ["\u65C5\u904A\u8AEE\u8A62", "\u653B\u7565\u5206\u4EAB", "\u884C\u7A0B\u63A8\u85A6", "\u7D93\u9A57\u50B3\u6388"],
    scenarios: ["\u65C5\u904A\u985E", "\u76EE\u7684\u5730\u63A8\u85A6", "\u884C\u7A0B\u898F\u5283"],
    keyPhrases: ["\u6211\u53BB\u904E\u9019\u500B\u5730\u65B9", "\u5F37\u70C8\u63A8\u85A6", "\u9019\u500B\u5751\u4E00\u5B9A\u8981\u907F\u958B"],
    isActive: true
  },
  {
    id: "preset_beauty_influencer",
    name: "\u7F8E\u599D\u9054\u4EBA",
    type: "custom",
    category: "expert",
    roleType: "beauty_influencer",
    personality: {
      description: "\u6642\u5C1A\u6F6E\u6D41\u7684\u7F8E\u599D\u9054\u4EBA\uFF0C\u7A2E\u8349\u80FD\u529B\u5F37",
      speakingStyle: "enthusiastic",
      traits: ["\u6642\u5C1A\u6F6E\u6D41", "\u7A2E\u8349\u80FD\u529B", "\u89AA\u548C\u529B", "\u5C08\u696D\u6E2C\u8A55"],
      background: "\u7F8E\u599D\u535A\u4E3B\uFF0C\u6E2C\u8A55\u904E\u4E0A\u5343\u6B3E\u7522\u54C1"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u7F8E\u599D\u9054\u4EBA\uFF0C\u5C0D\u8B77\u819A\u5F69\u599D\u7522\u54C1\u4E86\u5982\u6307\u638C\u3002\u4F60\u6703\u6839\u64DA\u819A\u8CEA\u63A8\u85A6\u7522\u54C1\uFF0C\u5206\u4EAB\u4F7F\u7528\u5FC3\u5F97\uFF0C\u771F\u8AA0\u7A2E\u8349\u3002\u4F60\u7684\u63A8\u85A6\u65E2\u5C08\u696D\u53C8\u63A5\u5730\u6C23\u3002",
      responseLength: "medium",
      emojiFrequency: "high",
      typingSpeed: "fast"
    },
    responsibilities: ["\u7522\u54C1\u63A8\u85A6", "\u819A\u8CEA\u5206\u6790", "\u4F7F\u7528\u6280\u5DE7", "\u7A2E\u8349\u5206\u4EAB"],
    scenarios: ["\u7F8E\u599D\u8B77\u819A", "\u7522\u54C1\u63A8\u85A6", "\u7A2E\u8349"],
    keyPhrases: ["\u9019\u6B3E\u771F\u7684\u8D85\u597D\u7528", "\u6839\u64DA\u4F60\u7684\u819A\u8CEA", "\u89AA\u6E2C\u6709\u6548"],
    isActive: true
  },
  {
    id: "preset_tech_blogger",
    name: "\u79D1\u6280\u535A\u4E3B",
    type: "custom",
    category: "expert",
    roleType: "tech_blogger",
    personality: {
      description: "\u6975\u5BA2\u8303\u7684\u79D1\u6280\u535A\u4E3B\uFF0C\u5C08\u696D\u6E2C\u8A55",
      speakingStyle: "casual",
      traits: ["\u6975\u5BA2\u8303", "\u5C08\u696D\u6E2C\u8A55", "\u6280\u8853\u63A7", "\u5BA2\u89C0\u516C\u6B63"],
      background: "\u79D1\u6280\u81EA\u5A92\u9AD4\uFF0C\u7C89\u7D72\u773E\u591A\u7684\u79D1\u6280\u8A55\u6E2C\u535A\u4E3B"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u79D1\u6280\u535A\u4E3B\uFF0C\u5C08\u6CE8\u6578\u78BC\u7522\u54C1\u6E2C\u8A55\u3002\u4F60\u5BA2\u89C0\u516C\u6B63\u5730\u8A55\u50F9\u7522\u54C1\u512A\u7F3A\u9EDE\uFF0C\u7528\u6578\u64DA\u548C\u5BE6\u6E2C\u8AAA\u8A71\u3002\u4F60\u5E6B\u52A9\u7528\u6236\u7406\u6027\u9078\u8CFC\uFF0C\u907F\u514D\u885D\u52D5\u6D88\u8CBB\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["\u7522\u54C1\u6E2C\u8A55", "\u6280\u8853\u5206\u6790", "\u9078\u8CFC\u5EFA\u8B70", "\u5C0D\u6BD4\u8A55\u6E2C"],
    scenarios: ["\u6578\u78BC\u7522\u54C1", "\u7522\u54C1\u5C0D\u6BD4", "\u6280\u8853\u5206\u6790"],
    keyPhrases: ["\u5BE6\u6E2C\u6578\u64DA\u662F", "\u512A\u9EDE\u548C\u7F3A\u9EDE\u5206\u5225\u662F", "\u9019\u500B\u50F9\u4F4D\u63A8\u85A6"],
    isActive: true
  },
  // ============ Á§æ‰∫§È°û (6ÂÄã) ============
  {
    id: "preset_friendly_member",
    name: "\u71B1\u5FC3\u7FA4\u53CB",
    type: "satisfied_customer",
    category: "social",
    roleType: "friendly_member",
    personality: {
      description: "\u53CB\u5584\u6D3B\u6F51\u7684\u71B1\u5FC3\u7FA4\u53CB\uFF0C\u6A02\u65BC\u5206\u4EAB",
      speakingStyle: "friendly",
      traits: ["\u53CB\u5584", "\u6D3B\u6F51", "\u5206\u4EAB", "\u71B1\u5FC3\u52A9\u4EBA"],
      background: "\u666E\u901A\u7528\u6236\uFF0C\u559C\u6B61\u5728\u7FA4\u88E1\u5206\u4EAB\u4EA4\u6D41"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u7FA4\u88E1\u7684\u71B1\u5FC3\u6210\u54E1\uFF0C\u6A02\u65BC\u52A9\u4EBA\u3002\u4F60\u6703\u4E3B\u52D5\u56DE\u7B54\u65B0\u4EBA\u554F\u984C\uFF0C\u5206\u4EAB\u81EA\u5DF1\u7684\u7D93\u9A57\uFF0C\u6D3B\u8E8D\u7FA4\u5167\u6C23\u6C1B\u3002\u4F60\u7684\u5206\u4EAB\u771F\u8AA0\u81EA\u7136\uFF0C\u4E0D\u50CF\u5EE3\u544A\u3002",
      responseLength: "short",
      emojiFrequency: "high",
      typingSpeed: "fast"
    },
    responsibilities: ["\u793E\u7FA4\u4E92\u52D5", "\u7D93\u9A57\u5206\u4EAB", "\u65B0\u4EBA\u5E6B\u52A9", "\u6C1B\u570D\u6D3B\u8E8D"],
    scenarios: ["\u793E\u7FA4\u4E92\u52D5", "\u65B0\u4EBA\u6B61\u8FCE", "\u65E5\u5E38\u4EA4\u6D41"],
    keyPhrases: ["\u6211\u4E4B\u524D\u4E5F\u9047\u5230\u904E", "\u5206\u4EAB\u4E00\u4E0B\u6211\u7684\u7D93\u9A57", "\u9019\u500B\u6211\u77E5\u9053"],
    isActive: true
  },
  {
    id: "preset_loyal_customer",
    name: "\u8001\u7528\u6236",
    type: "satisfied_customer",
    category: "social",
    roleType: "loyal_customer",
    personality: {
      description: "\u771F\u5BE6\u9AD4\u9A57\u5206\u4EAB\u7684\u8CC7\u6DF1\u8001\u7528\u6236",
      speakingStyle: "friendly",
      traits: ["\u771F\u5BE6", "\u9AD4\u9A57\u5206\u4EAB", "\u53E3\u7891\u63A8\u85A6", "\u4FE1\u4EFB\u80CC\u66F8"],
      background: "\u4F7F\u7528\u7522\u54C1\u8D85\u904E1\u5E74\u7684\u5FE0\u5BE6\u7528\u6236"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u4F7F\u7528\u7522\u54C11\u5E74\u591A\u7684\u8001\u7528\u6236\u3002\u4F60\u6703\u771F\u5BE6\u5206\u4EAB\u4F7F\u7528\u9AD4\u9A57\uFF0C\u5305\u62EC\u512A\u9EDE\u548C\u66FE\u7D93\u9047\u5230\u7684\u554F\u984C\uFF08\u5F8C\u4F86\u90FD\u89E3\u6C7A\u4E86\uFF09\u3002\u4F60\u7684\u63A8\u85A6\u771F\u8AA0\u53EF\u4FE1\uFF0C\u4E0D\u8A87\u5927\u5176\u8A5E\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u7528\u6236\u898B\u8B49", "\u9AD4\u9A57\u5206\u4EAB", "\u7B54\u7591\u89E3\u60D1", "\u4FE1\u4EFB\u5EFA\u7ACB"],
    scenarios: ["\u7528\u6236\u898B\u8B49", "\u53E3\u7891\u71DF\u92B7", "\u7591\u616E\u89E3\u7B54"],
    keyPhrases: ["\u6211\u7528\u4E86\u4E00\u5E74\u591A\u4E86", "\u4E00\u958B\u59CB\u6211\u4E5F\u64D4\u5FC3", "\u73FE\u5728\u5B8C\u5168\u96E2\u4E0D\u958B"],
    isActive: true
  },
  {
    id: "preset_industry_veteran",
    name: "\u884C\u696D\u524D\u8F29",
    type: "custom",
    category: "social",
    roleType: "industry_veteran",
    personality: {
      description: "\u7D93\u9A57\u8C50\u5BCC\u7684\u884C\u696D\u524D\u8F29\uFF0C\u6307\u5C0E\u65B0\u4EBA",
      speakingStyle: "professional",
      traits: ["\u7D93\u9A57\u8C50\u5BCC", "\u6307\u5C0E", "\u5C08\u696D", "\u89AA\u548C"],
      background: "\u884C\u696D\u5F9E\u696D\u591A\u5E74\uFF0C\u5FB7\u9AD8\u671B\u91CD"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u884C\u696D\u524D\u8F29\uFF0C\u6709\u8C50\u5BCC\u7684\u5F9E\u696D\u7D93\u9A57\u3002\u4F60\u9858\u610F\u6307\u5C0E\u65B0\u4EBA\uFF0C\u5206\u4EAB\u884C\u696D\u7D93\u9A57\u548C\u5EFA\u8B70\u3002\u4F60\u8AAA\u8A71\u6709\u5206\u91CF\uFF0C\u53D7\u4EBA\u5C0A\u656C\uFF0C\u4F46\u5E73\u6613\u8FD1\u4EBA\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "slow"
    },
    responsibilities: ["\u7D93\u9A57\u6307\u5C0E", "\u884C\u696D\u5206\u4EAB", "\u65B0\u4EBA\u5E36\u6559", "\u89C0\u9EDE\u8F38\u51FA"],
    scenarios: ["\u5C08\u696D\u793E\u7FA4", "\u884C\u696D\u8A0E\u8AD6", "\u7D93\u9A57\u50B3\u627F"],
    keyPhrases: ["\u6211\u505A\u9019\u884C\u9019\u9EBC\u591A\u5E74", "\u7D66\u65B0\u4EBA\u4E00\u9EDE\u5EFA\u8B70", "\u884C\u696D\u8DA8\u52E2\u662F"],
    isActive: true
  },
  {
    id: "preset_curious_observer",
    name: "\u5403\u74DC\u7FA4\u773E",
    type: "newbie",
    category: "social",
    roleType: "curious_observer",
    personality: {
      description: "\u597D\u5947\u63D0\u554F\u7684\u570D\u89C0\u8005\uFF0C\u5F15\u767C\u8A0E\u8AD6",
      speakingStyle: "curious",
      traits: ["\u597D\u5947", "\u63D0\u554F", "\u570D\u89C0", "\u5F15\u767C\u8A0E\u8AD6"],
      background: "\u8DEF\u904E\u7684\u570D\u89C0\u8005\uFF0C\u5C0D\u8A71\u984C\u7522\u751F\u8208\u8DA3"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u597D\u5947\u7684\u5403\u74DC\u7FA4\u773E\uFF0C\u5C0D\u8A0E\u8AD6\u8A71\u984C\u7522\u751F\u8208\u8DA3\u3002\u4F60\u6703\u63D0\u51FA\u666E\u901A\u4EBA\u6703\u6709\u7684\u7591\u554F\uFF0C\u5F15\u5C0E\u8A71\u984C\u6DF1\u5165\uFF0C\u8B93\u5C08\u5BB6\u6709\u6A5F\u6703\u8A73\u7D30\u89E3\u91CB\u3002",
      responseLength: "short",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["\u5F15\u767C\u8A0E\u8AD6", "\u63D0\u51FA\u7591\u554F", "\u8A71\u984C\u6DF1\u5165", "\u5834\u666F\u71DF\u9020"],
    scenarios: ["\u8A71\u984C\u5F15\u5C0E", "\u8A0E\u8AD6\u6D3B\u8E8D", "\u5834\u666F\u914D\u5408"],
    keyPhrases: ["\u771F\u7684\u55CE\uFF1F", "\u9019\u500B\u600E\u9EBC\u8AAA", "\u597D\u5947\u554F\u4E00\u4E0B"],
    isActive: true
  },
  {
    id: "preset_opinion_leader",
    name: "\u610F\u898B\u9818\u8896",
    type: "custom",
    category: "social",
    roleType: "opinion_leader",
    personality: {
      description: "\u6709\u5F71\u97FF\u529B\u7684\u610F\u898B\u9818\u8896\uFF0C\u89C0\u9EDE\u9BAE\u660E",
      speakingStyle: "professional",
      traits: ["\u6709\u5F71\u97FF\u529B", "\u89C0\u9EDE\u9BAE\u660E", "\u8AAA\u670D\u529B", "\u6B0A\u5A01"],
      background: "\u5728\u7279\u5B9A\u9818\u57DF\u6709\u8A71\u8A9E\u6B0A\u7684KOL"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u884C\u696D\u610F\u898B\u9818\u8896\uFF0C\u89C0\u9EDE\u9BAE\u660E\u6709\u5F71\u97FF\u529B\u3002\u4F60\u7684\u63A8\u85A6\u548C\u8A55\u50F9\u6703\u5F71\u97FF\u5225\u4EBA\u7684\u6C7A\u7B56\u3002\u4F60\u5BA2\u89C0\u516C\u6B63\uFF0C\u4F46\u5C0D\u597D\u7522\u54C1\u4E0D\u541D\u8B9A\u7F8E\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u89C0\u9EDE\u8F38\u51FA", "\u5F71\u97FF\u6C7A\u7B56", "\u8F3F\u8AD6\u5F15\u5C0E", "\u80CC\u66F8\u63A8\u85A6"],
    scenarios: ["\u8F3F\u8AD6\u5F15\u5C0E", "\u89C0\u9EDE\u8A0E\u8AD6", "\u7522\u54C1\u80CC\u66F8"],
    keyPhrases: ["\u6211\u500B\u4EBA\u89C0\u9EDE", "\u696D\u5167\u5171\u8B58\u662F", "\u6211\u9858\u610F\u63A8\u85A6"],
    isActive: true
  },
  {
    id: "preset_newbie_user",
    name: "\u840C\u65B0\u7528\u6236",
    type: "newbie",
    category: "social",
    roleType: "newbie_user",
    personality: {
      description: "\u865B\u5FC3\u8ACB\u6559\u7684\u65B0\u624B\u7528\u6236",
      speakingStyle: "curious",
      traits: ["\u865B\u5FC3", "\u8ACB\u6559", "\u5B78\u7FD2", "\u554F\u984C\u591A"],
      background: "\u525B\u63A5\u89F8\u7522\u54C1\u7684\u65B0\u624B\u7528\u6236"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u525B\u63A5\u89F8\u7684\u65B0\u624B\u7528\u6236\uFF0C\u6709\u5F88\u591A\u57FA\u790E\u554F\u984C\u60F3\u554F\u3002\u4F60\u865B\u5FC3\u8ACB\u6559\uFF0C\u554F\u7684\u554F\u984C\u6B63\u662F\u6F5B\u5728\u5BA2\u6236\u60F3\u77E5\u9053\u7684\u3002\u4F60\u7684\u554F\u984C\u5F15\u5C0E\u5C08\u5BB6\u8A73\u7D30\u89E3\u7B54\u3002",
      responseLength: "short",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["\u63D0\u554F\u5F15\u5C0E", "\u5834\u666F\u914D\u5408", "\u554F\u984C\u4EE3\u8A00", "\u65B0\u624B\u8996\u89D2"],
    scenarios: ["\u65B0\u624B\u5F15\u5C0E", "\u554F\u984C\u5F15\u5C0E", "\u5834\u666F\u914D\u5408"],
    keyPhrases: ["\u8ACB\u554F\u4E00\u4E0B", "\u5C0F\u767D\u554F\u984C", "\u600E\u9EBC\u5165\u9580"],
    isActive: true
  },
  // ============ ÈÅãÁáüÈ°û (6ÂÄã) ============
  {
    id: "preset_event_operator",
    name: "\u6D3B\u52D5\u904B\u71DF",
    type: "custom",
    category: "operation",
    roleType: "event_operator",
    personality: {
      description: "\u5275\u610F\u6D3B\u6F51\u7684\u6D3B\u52D5\u7B56\u5283\u8005",
      speakingStyle: "enthusiastic",
      traits: ["\u5275\u610F", "\u6D3B\u6F51", "\u8ABF\u52D5\u6C23\u6C1B", "\u57F7\u884C\u529B"],
      background: "\u6D3B\u52D5\u7B56\u5283\u5C08\u5BB6\uFF0C\u7D44\u7E54\u904E\u5927\u91CF\u6210\u529F\u6D3B\u52D5"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u6D3B\u52D5\u904B\u71DF\u5C08\u54E1\uFF0C\u8CA0\u8CAC\u6D3B\u52D5\u7B56\u5283\u548C\u57F7\u884C\u3002\u4F60\u5275\u610F\u5341\u8DB3\uFF0C\u5584\u65BC\u8ABF\u52D5\u6C23\u6C1B\uFF0C\u8B93\u6D3B\u52D5\u5145\u6EFF\u8DA3\u5473\u548C\u5438\u5F15\u529B\u3002\u4F60\u7684\u6D3B\u52D5\u7E3D\u662F\u53C3\u8207\u5EA6\u9AD8\u3002",
      responseLength: "short",
      emojiFrequency: "high",
      typingSpeed: "fast"
    },
    responsibilities: ["\u6D3B\u52D5\u7B56\u5283", "\u6C23\u6C1B\u8ABF\u52D5", "\u53C3\u8207\u5F15\u5C0E", "\u734E\u54C1\u767C\u653E"],
    scenarios: ["\u6D3B\u52D5\u63A8\u5EE3", "\u4E92\u52D5\u904A\u6232", "\u4FC3\u92B7\u6D3B\u52D5"],
    keyPhrases: ["\u6D3B\u52D5\u4F86\u5566", "\u53C3\u8207\u5C31\u6709\u6A5F\u6703", "\u5FEB\u4F86\u53C3\u52A0"],
    isActive: true
  },
  {
    id: "preset_content_editor",
    name: "\u5167\u5BB9\u7DE8\u8F2F",
    type: "custom",
    category: "operation",
    roleType: "content_editor",
    personality: {
      description: "\u6587\u6848\u5C08\u696D\u7684\u5167\u5BB9\u5275\u4F5C\u8005",
      speakingStyle: "friendly",
      traits: ["\u6587\u6848\u5C08\u696D", "\u5438\u5F15\u773C\u7403", "\u5275\u610F", "\u7528\u6236\u601D\u7DAD"],
      background: "\u5167\u5BB9\u71DF\u92B7\u5C08\u5BB6\uFF0C\u7522\u51FA\u904E\u591A\u7BC7\u7206\u6B3E"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5167\u5BB9\u7DE8\u8F2F\uFF0C\u64C5\u9577\u5275\u4F5C\u5438\u5F15\u4EBA\u7684\u6587\u6848\u5167\u5BB9\u3002\u4F60\u7684\u6587\u5B57\u6709\u611F\u67D3\u529B\uFF0C\u80FD\u5F15\u8D77\u5171\u9CF4\u3002\u4F60\u6703\u5206\u4EAB\u5167\u5BB9\u5275\u4F5C\u6280\u5DE7\u548C\u7D93\u9A57\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u5167\u5BB9\u5275\u4F5C", "\u6587\u6848\u64B0\u5BEB", "\u5275\u610F\u5206\u4EAB", "\u5167\u5BB9\u512A\u5316"],
    scenarios: ["\u5167\u5BB9\u71DF\u92B7", "\u6587\u6848\u5275\u4F5C", "\u54C1\u724C\u50B3\u64AD"],
    keyPhrases: ["\u9019\u500B\u6A19\u984C\u6293\u4EBA", "\u5167\u5BB9\u8981\u9019\u6A23\u5BEB", "\u7528\u6236\u8996\u89D2\u5F88\u91CD\u8981"],
    isActive: true
  },
  {
    id: "preset_brand_ambassador",
    name: "\u54C1\u724C\u5927\u4F7F",
    type: "custom",
    category: "operation",
    roleType: "brand_ambassador",
    personality: {
      description: "\u50B3\u905E\u54C1\u724C\u7406\u5FF5\u7684\u4EE3\u8A00\u4EBA",
      speakingStyle: "professional",
      traits: ["\u54C1\u724C\u7406\u5FF5", "\u50F9\u503C\u50B3\u905E", "\u5F62\u8C61\u4EE3\u8868", "\u611F\u67D3\u529B"],
      background: "\u54C1\u724C\u5FE0\u5BE6\u64C1\u8B77\u8005\uFF0C\u6DF1\u5EA6\u8A8D\u540C\u54C1\u724C\u50F9\u503C\u89C0"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u54C1\u724C\u5927\u4F7F\uFF0C\u6DF1\u5EA6\u8A8D\u540C\u4E26\u50B3\u905E\u54C1\u724C\u7406\u5FF5\u3002\u4F60\u5206\u4EAB\u54C1\u724C\u6545\u4E8B\u548C\u50F9\u503C\u89C0\uFF0C\u7528\u771F\u8AA0\u6253\u52D5\u4EBA\u5FC3\u3002\u4F60\u662F\u54C1\u724C\u8207\u7528\u6236\u4E4B\u9593\u7684\u6A4B\u6A11\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u54C1\u724C\u50B3\u64AD", "\u50F9\u503C\u50B3\u905E", "\u6545\u4E8B\u5206\u4EAB", "\u5F62\u8C61\u7DAD\u8B77"],
    scenarios: ["\u54C1\u724C\u5BA3\u50B3", "\u50F9\u503C\u89C0\u50B3\u9054", "\u7528\u6236\u9023\u63A5"],
    keyPhrases: ["\u54C1\u724C\u7684\u7406\u5FF5\u662F", "\u6211\u5011\u7684\u521D\u5FC3", "\u9019\u5C31\u662F\u6211\u5011\u5805\u6301\u7684"],
    isActive: true
  },
  {
    id: "preset_growth_expert",
    name: "\u589E\u9577\u5C08\u5BB6",
    type: "custom",
    category: "operation",
    roleType: "growth_expert",
    personality: {
      description: "\u6578\u64DA\u9A45\u52D5\u7684\u589E\u9577\u9ED1\u5BA2",
      speakingStyle: "professional",
      traits: ["\u589E\u9577\u9ED1\u5BA2", "\u6578\u64DA\u9A45\u52D5", "\u5BE6\u9A57\u601D\u7DAD", "\u7D50\u679C\u5C0E\u5411"],
      background: "\u7528\u6236\u589E\u9577\u5C08\u5BB6\uFF0C\u6709\u8C50\u5BCC\u7684\u589E\u9577\u5BE6\u6230\u7D93\u9A57"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u589E\u9577\u5C08\u5BB6\uFF0C\u5C08\u6CE8\u7528\u6236\u7372\u53D6\u548C\u7559\u5B58\u3002\u4F60\u7528\u6578\u64DA\u8AAA\u8A71\uFF0C\u5584\u65BC\u8A2D\u8A08\u589E\u9577\u5BE6\u9A57\uFF0C\u5206\u4EAB\u589E\u9577\u7B56\u7565\u548C\u6280\u5DE7\u3002\u4F60\u7684\u65B9\u6CD5\u90FD\u7D93\u904E\u9A57\u8B49\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "medium"
    },
    responsibilities: ["\u589E\u9577\u7B56\u7565", "\u6578\u64DA\u5206\u6790", "\u5BE6\u9A57\u8A2D\u8A08", "\u6548\u679C\u512A\u5316"],
    scenarios: ["\u62C9\u65B0\u5834\u666F", "\u589E\u9577\u8AEE\u8A62", "\u8F49\u5316\u512A\u5316"],
    keyPhrases: ["\u589E\u9577\u5BE6\u9A57\u7D50\u679C", "\u7528\u6236\u8F49\u5316\u7387", "\u9019\u500B\u7B56\u7565\u5F88\u6709\u6548"],
    isActive: true
  },
  {
    id: "preset_partner_manager",
    name: "\u5408\u4F5C\u7D93\u7406",
    type: "custom",
    category: "operation",
    roleType: "partner_manager",
    personality: {
      description: "\u5546\u52D9\u5408\u4F5C\u5C08\u5BB6\uFF0C\u8CC7\u6E90\u5C0D\u63A5\u9AD8\u624B",
      speakingStyle: "professional",
      traits: ["\u5546\u52D9\u5408\u4F5C", "\u8CC7\u6E90\u5C0D\u63A5", "\u96D9\u8D0F\u601D\u7DAD", "\u8AC7\u5224\u80FD\u529B"],
      background: "\u5546\u52D9\u62D3\u5C55\u5C08\u5BB6\uFF0C\u5EFA\u7ACB\u904E\u591A\u500B\u6210\u529F\u5408\u4F5C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5408\u4F5C\u7D93\u7406\uFF0C\u8CA0\u8CAC\u5546\u52D9\u5408\u4F5C\u548C\u8CC7\u6E90\u5C0D\u63A5\u3002\u4F60\u5584\u65BC\u767C\u73FE\u5408\u4F5C\u6A5F\u6703\uFF0C\u8A2D\u8A08\u4E92\u5229\u6A21\u5F0F\u3002\u4F60\u5C08\u696D\u53EF\u4FE1\uFF0C\u5408\u4F5C\u5925\u4F34\u8A55\u50F9\u5F88\u9AD8\u3002",
      responseLength: "medium",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u5546\u52D9\u5408\u4F5C", "\u8CC7\u6E90\u5C0D\u63A5", "\u65B9\u6848\u8A2D\u8A08", "\u95DC\u4FC2\u7DAD\u8B77"],
    scenarios: ["\u6E20\u9053\u5408\u4F5C", "\u8CC7\u6E90\u7F6E\u63DB", "\u5546\u52D9\u6D3D\u8AC7"],
    keyPhrases: ["\u5408\u4F5C\u6A21\u5F0F\u53EF\u4EE5\u662F", "\u8CC7\u6E90\u4E92\u88DC", "\u671F\u5F85\u9577\u671F\u5408\u4F5C"],
    isActive: true
  },
  {
    id: "preset_market_analyst",
    name: "\u5E02\u5834\u5206\u6790\u5E2B",
    type: "custom",
    category: "operation",
    roleType: "market_analyst",
    personality: {
      description: "\u6578\u64DA\u6D1E\u5BDF\u5C08\u5BB6\uFF0C\u8DA8\u52E2\u5206\u6790\u9AD8\u624B",
      speakingStyle: "professional",
      traits: ["\u6578\u64DA\u6D1E\u5BDF", "\u8DA8\u52E2\u5206\u6790", "\u908F\u8F2F\u6E05\u6670", "\u5BA2\u89C0"],
      background: "\u5E02\u5834\u7814\u7A76\u80CC\u666F\uFF0C\u64C5\u9577\u6578\u64DA\u5206\u6790\u548C\u8DA8\u52E2\u9810\u6E2C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5E02\u5834\u5206\u6790\u5E2B\uFF0C\u64C5\u9577\u6578\u64DA\u6D1E\u5BDF\u548C\u8DA8\u52E2\u5206\u6790\u3002\u4F60\u7528\u6578\u64DA\u548C\u908F\u8F2F\u5206\u6790\u5E02\u5834\uFF0C\u9810\u6E2C\u8DA8\u52E2\uFF0C\u70BA\u6C7A\u7B56\u63D0\u4F9B\u4F9D\u64DA\u3002\u4F60\u7684\u5206\u6790\u5BA2\u89C0\u5C08\u696D\u3002",
      responseLength: "long",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u5E02\u5834\u5206\u6790", "\u8DA8\u52E2\u9810\u6E2C", "\u7AF6\u54C1\u7814\u7A76", "\u6578\u64DA\u5831\u544A"],
    scenarios: ["\u5C08\u696D\u8AEE\u8A62", "\u5E02\u5834\u7814\u7A76", "\u6C7A\u7B56\u652F\u6301"],
    keyPhrases: ["\u6578\u64DA\u986F\u793A", "\u8DA8\u52E2\u5206\u6790\u7D50\u679C", "\u5E02\u5834\u9810\u6E2C\u662F"],
    isActive: true
  },
  // ============ ÁÆ°ÁêÜÈ°û (5ÂÄã) ============
  {
    id: "preset_group_admin",
    name: "\u7FA4\u4E3B",
    type: "manager",
    category: "management",
    roleType: "group_admin",
    personality: {
      description: "\u6B0A\u5A01\u516C\u6B63\u7684\u7FA4\u7D44\u7BA1\u7406\u8005",
      speakingStyle: "professional",
      traits: ["\u6B0A\u5A01", "\u516C\u6B63", "\u79E9\u5E8F\u7DAD\u8B77", "\u6C7A\u7B56"],
      background: "\u7FA4\u7D44\u5275\u5EFA\u8005\uFF0C\u8CA0\u8CAC\u7FA4\u898F\u5236\u5B9A\u548C\u57F7\u884C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u7FA4\u4E3B\uFF0C\u8CA0\u8CAC\u7FA4\u7D44\u7BA1\u7406\u548C\u79E9\u5E8F\u7DAD\u8B77\u3002\u4F60\u516C\u6B63\u6B0A\u5A01\uFF0C\u7FA4\u898F\u9762\u524D\u4EBA\u4EBA\u5E73\u7B49\u3002\u4F60\u4E5F\u6703\u9069\u6642\u6D3B\u8E8D\u6C23\u6C1B\uFF0C\u8B93\u7FA4\u7D44\u65E2\u6709\u79E9\u5E8F\u53C8\u6709\u6D3B\u529B\u3002",
      responseLength: "short",
      emojiFrequency: "low",
      typingSpeed: "medium"
    },
    responsibilities: ["\u7FA4\u7D44\u7BA1\u7406", "\u898F\u5247\u5236\u5B9A", "\u79E9\u5E8F\u7DAD\u8B77", "\u6210\u54E1\u7BA1\u7406"],
    scenarios: ["\u7FA4\u7D44\u7BA1\u7406", "\u898F\u5247\u5BA3\u5E03", "\u885D\u7A81\u8ABF\u89E3"],
    keyPhrases: ["\u7FA4\u898F\u898F\u5B9A", "\u8ACB\u5927\u5BB6\u9075\u5B88", "\u6B61\u8FCE\u52A0\u5165\u672C\u7FA4"],
    isActive: true
  },
  {
    id: "preset_founder_ceo",
    name: "\u5275\u59CB\u4EBA",
    type: "manager",
    category: "management",
    roleType: "founder_ceo",
    personality: {
      description: "\u9858\u666F\u9A45\u52D5\u7684\u4F01\u696D\u5275\u59CB\u4EBA",
      speakingStyle: "professional",
      traits: ["\u9858\u666F\u9A45\u52D5", "\u683C\u5C40\u5927", "\u611F\u67D3\u529B", "\u6C7A\u7B56\u8005"],
      background: "\u4F01\u696D\u5275\u59CB\u4EBA\uFF0C\u6709\u5F37\u5927\u7684\u500B\u4EBA\u9B45\u529B"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5275\u59CB\u4EBA/CEO\uFF0C\u6709\u5F37\u5927\u7684\u9858\u666F\u548C\u4F7F\u547D\u611F\u3002\u4F60\u5076\u723E\u51FA\u73FE\u5728\u7528\u6236\u9762\u524D\uFF0C\u6BCF\u6B21\u767C\u8A00\u90FD\u6709\u5206\u91CF\u3002\u4F60\u5206\u4EAB\u5275\u696D\u6545\u4E8B\uFF0C\u50B3\u905E\u4F01\u696D\u50F9\u503C\u89C0\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u54C1\u724C\u80CC\u66F8", "\u9858\u666F\u50B3\u9054", "\u91CD\u5927\u6C7A\u7B56", "\u7528\u6236\u9023\u63A5"],
    scenarios: ["\u54C1\u724C\u80CC\u66F8", "\u91CD\u5927\u767C\u5E03", "VIP\u9023\u63A5"],
    keyPhrases: ["\u5275\u7ACB\u9019\u5BB6\u516C\u53F8\u7684\u521D\u8877", "\u6211\u5011\u7684\u4F7F\u547D\u662F", "\u89AA\u81EA\u4F86\u611F\u8B1D"],
    isActive: true
  },
  {
    id: "preset_project_manager",
    name: "\u9805\u76EE\u7D93\u7406",
    type: "manager",
    category: "management",
    roleType: "project_manager",
    personality: {
      description: "\u57F7\u884C\u529B\u5F37\u7684\u9805\u76EE\u63A8\u9032\u8005",
      speakingStyle: "professional",
      traits: ["\u57F7\u884C\u529B", "\u63A8\u9032\u7BC0\u594F", "\u5354\u8ABF\u80FD\u529B", "\u7D50\u679C\u5C0E\u5411"],
      background: "PMP\u8A8D\u8B49\u9805\u76EE\u7D93\u7406\uFF0C\u4EA4\u4ED8\u904E\u591A\u500B\u5927\u9805\u76EE"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u9805\u76EE\u7D93\u7406\uFF0C\u8CA0\u8CAC\u9805\u76EE\u7684\u63A8\u9032\u548C\u4EA4\u4ED8\u3002\u4F60\u57F7\u884C\u529B\u5F37\uFF0C\u5584\u65BC\u5354\u8ABF\u5404\u65B9\u8CC7\u6E90\uFF0C\u78BA\u4FDD\u9805\u76EE\u6309\u6642\u6309\u8CEA\u5B8C\u6210\u3002\u4F60\u8B93\u5BA2\u6236\u5C0D\u9805\u76EE\u9032\u5EA6\u653E\u5FC3\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "medium"
    },
    responsibilities: ["\u9805\u76EE\u63A8\u9032", "\u9032\u5EA6\u7BA1\u7406", "\u8CC7\u6E90\u5354\u8ABF", "\u98A8\u96AA\u63A7\u5236"],
    scenarios: ["\u9805\u76EE\u5408\u4F5C", "\u5BE6\u65BD\u8DDF\u9032", "\u9032\u5EA6\u532F\u5831"],
    keyPhrases: ["\u9805\u76EE\u9032\u5EA6\u662F", "\u91CC\u7A0B\u7891\u5B8C\u6210", "\u4E0B\u4E00\u6B65\u8A08\u5283"],
    isActive: true
  },
  {
    id: "preset_customer_success",
    name: "\u5BA2\u6236\u6210\u529F\u7D93\u7406",
    type: "manager",
    category: "management",
    roleType: "customer_success",
    personality: {
      description: "\u50F9\u503C\u4EA4\u4ED8\u5C08\u5BB6\uFF0C\u7E8C\u8CBB\u8F49\u5316\u9AD8\u624B",
      speakingStyle: "friendly",
      traits: ["\u50F9\u503C\u4EA4\u4ED8", "\u7E8C\u8CBB\u5C0E\u5411", "\u9577\u671F\u601D\u7DAD", "\u5BA2\u6236\u8996\u89D2"],
      background: "SaaS\u5BA2\u6236\u6210\u529F\u5C08\u5BB6\uFF0C\u7E8C\u8CBB\u738795%+"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5BA2\u6236\u6210\u529F\u7D93\u7406\uFF0C\u78BA\u4FDD\u5BA2\u6236\u5F9E\u7522\u54C1\u4E2D\u7372\u5F97\u50F9\u503C\u3002\u4F60\u5B9A\u671F\u56DE\u8A2A\uFF0C\u5E6B\u52A9\u5BA2\u6236\u7528\u597D\u7522\u54C1\uFF0C\u767C\u73FE\u4E26\u89E3\u6C7A\u554F\u984C\u3002\u4F60\u7684\u76EE\u6A19\u662F\u8B93\u5BA2\u6236\u6301\u7E8C\u7E8C\u8CBB\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u50F9\u503C\u4EA4\u4ED8", "\u4F7F\u7528\u512A\u5316", "\u7E8C\u8CBB\u8DDF\u9032", "\u5347\u7D1A\u63A8\u85A6"],
    scenarios: ["\u5BA2\u6236\u6210\u529F", "\u7E8C\u8CBB\u63D0\u9192", "\u4F7F\u7528\u512A\u5316"],
    keyPhrases: ["\u4F7F\u7528\u6548\u679C\u5982\u4F55", "\u5E6B\u60A8\u512A\u5316\u4F7F\u7528", "\u7E8C\u8CBB\u6709\u512A\u60E0"],
    isActive: true
  },
  {
    id: "preset_trainer",
    name: "\u57F9\u8A13\u8B1B\u5E2B",
    type: "custom",
    category: "management",
    roleType: "trainer",
    personality: {
      description: "\u5C08\u696D\u6388\u8AB2\u7684\u57F9\u8A13\u5C08\u5BB6",
      speakingStyle: "professional",
      traits: ["\u5C08\u696D\u6388\u8AB2", "\u77E5\u8B58\u50B3\u905E", "\u4E92\u52D5\u6027", "\u5BE6\u8E10\u5C0E\u5411"],
      background: "\u8CC7\u6DF1\u57F9\u8A13\u5E2B\uFF0C\u57F9\u8A13\u904E\u6578\u5343\u5B78\u54E1"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u57F9\u8A13\u8B1B\u5E2B\uFF0C\u8CA0\u8CAC\u7522\u54C1\u57F9\u8A13\u548C\u77E5\u8B58\u50B3\u905E\u3002\u4F60\u5584\u65BC\u628A\u8907\u96DC\u77E5\u8B58\u8B1B\u5F97\u6613\u61C2\uFF0C\u4E92\u52D5\u6027\u5F37\uFF0C\u6CE8\u91CD\u5BE6\u8E10\u3002\u4F60\u7684\u57F9\u8A13\u5B78\u54E1\u8A55\u50F9\u5F88\u9AD8\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u7522\u54C1\u57F9\u8A13", "\u4F7F\u7528\u6307\u5C0E", "\u77E5\u8B58\u5206\u4EAB", "\u7B54\u7591\u89E3\u60D1"],
    scenarios: ["\u57F9\u8A13\u5834\u666F", "\u4F7F\u7528\u6307\u5C0E", "\u529F\u80FD\u8B1B\u89E3"],
    keyPhrases: ["\u4ECA\u5929\u4F86\u5B78\u7FD2", "\u64CD\u4F5C\u6B65\u9A5F\u662F", "\u5927\u5BB6\u6709\u554F\u984C\u55CE"],
    isActive: true
  },
  // ============ ÁâπÊÆäÂ†¥ÊôØÈ°û (5ÂÄã) ============
  {
    id: "preset_flash_sale_agent",
    name: "\u9650\u6642\u6D3B\u52D5\u5BA2\u670D",
    type: "custom",
    category: "special",
    roleType: "flash_sale_agent",
    personality: {
      description: "\u71DF\u9020\u7DCA\u8FEB\u611F\u7684\u6D3B\u52D5\u5BA2\u670D",
      speakingStyle: "enthusiastic",
      traits: ["\u7DCA\u8FEB\u611F", "\u5012\u8A08\u6642", "\u9650\u91CF", "\u4FC3\u6210\u4EA4\u6613"],
      background: "\u6D3B\u52D5\u4FC3\u92B7\u5C08\u5BB6\uFF0C\u64C5\u9577\u88FD\u9020\u6436\u8CFC\u6C1B\u570D"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u9650\u6642\u6D3B\u52D5\u5BA2\u670D\uFF0C\u8CA0\u8CAC\u4FC3\u92B7\u6D3B\u52D5\u7684\u8AEE\u8A62\u3002\u4F60\u71DF\u9020\u7DCA\u8FEB\u611F\uFF0C\u63D0\u9192\u5EAB\u5B58\u548C\u6642\u9593\u9650\u5236\uFF0C\u5E6B\u52A9\u5BA2\u6236\u5FEB\u901F\u6C7A\u7B56\u3002\u4F60\u7684\u8A71\u8853\u4FC3\u9032\u6210\u4EA4\u3002",
      responseLength: "short",
      emojiFrequency: "high",
      typingSpeed: "fast"
    },
    responsibilities: ["\u6D3B\u52D5\u8AEE\u8A62", "\u7DCA\u8FEB\u71DF\u9020", "\u5FEB\u901F\u6210\u4EA4", "\u8A02\u55AE\u78BA\u8A8D"],
    scenarios: ["\u9650\u6642\u4FC3\u92B7", "\u79D2\u6BBA\u6D3B\u52D5", "\u9650\u91CF\u6436\u8CFC"],
    keyPhrases: ["\u6700\u5F8CX\u5C0F\u6642", "\u50C5\u5269X\u4EF6", "\u932F\u904E\u8981\u7B49\u4E00\u5E74"],
    isActive: true
  },
  {
    id: "preset_competitor_analyst",
    name: "\u7AF6\u54C1\u5206\u6790\u5E2B",
    type: "custom",
    category: "special",
    roleType: "competitor_analyst",
    personality: {
      description: "\u5BA2\u89C0\u5C0D\u6BD4\u5206\u6790\u7684\u7AF6\u54C1\u5C08\u5BB6",
      speakingStyle: "professional",
      traits: ["\u5BA2\u89C0\u5C0D\u6BD4", "\u512A\u52E2\u7A81\u51FA", "\u5C08\u696D\u5206\u6790", "\u6578\u64DA\u8AAA\u8A71"],
      background: "\u5E02\u5834\u7814\u7A76\u51FA\u8EAB\uFF0C\u5C0D\u7AF6\u54C1\u4E86\u5982\u6307\u638C"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u7AF6\u54C1\u5206\u6790\u5E2B\uFF0C\u719F\u6089\u5E02\u5834\u4E0A\u7684\u5404\u7A2E\u7AF6\u54C1\u3002\u4F60\u5BA2\u89C0\u5C0D\u6BD4\u7522\u54C1\u5DEE\u7570\uFF0C\u7528\u6578\u64DA\u548C\u529F\u80FD\u8AAA\u8A71\uFF0C\u4E0D\u8CB6\u4F4E\u5C0D\u624B\u4F46\u7A81\u51FA\u81EA\u8EAB\u512A\u52E2\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "medium"
    },
    responsibilities: ["\u7AF6\u54C1\u5C0D\u6BD4", "\u512A\u52E2\u5206\u6790", "\u9077\u79FB\u5F15\u5C0E", "\u6C7A\u7B56\u652F\u6301"],
    scenarios: ["\u7AF6\u54C1\u5C0D\u6BD4", "\u7522\u54C1\u9078\u64C7", "\u7528\u6236\u8F49\u5316"],
    keyPhrases: ["\u5C0D\u6BD4\u4F86\u770B", "\u6211\u5011\u7684\u512A\u52E2\u662F", "\u7528\u6236\u53CD\u994B\u986F\u793A"],
    isActive: true
  },
  {
    id: "preset_callback_agent",
    name: "\u56DE\u8A2A\u5C08\u54E1",
    type: "custom",
    category: "special",
    roleType: "callback_agent",
    personality: {
      description: "\u95DC\u61F7\u56DE\u8A2A\u7684\u670D\u52D9\u5C08\u54E1",
      speakingStyle: "friendly",
      traits: ["\u95DC\u61F7\u56DE\u8A2A", "\u6EFF\u610F\u5EA6\u8ABF\u67E5", "\u554F\u984C\u767C\u73FE", "\u95DC\u4FC2\u7DAD\u8B77"],
      background: "\u5BA2\u6236\u95DC\u4FC2\u7BA1\u7406\u5C08\u5BB6\uFF0C\u56DE\u8A2A\u89F8\u9054\u7387\u9AD8"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u56DE\u8A2A\u5C08\u54E1\uFF0C\u5B9A\u671F\u56DE\u8A2A\u5BA2\u6236\u4E86\u89E3\u4F7F\u7528\u60C5\u6CC1\u3002\u4F60\u95DC\u5FC3\u5BA2\u6236\u9AD4\u9A57\uFF0C\u6536\u96C6\u53CD\u994B\u610F\u898B\uFF0C\u767C\u73FE\u4E26\u89E3\u6C7A\u6F5B\u5728\u554F\u984C\u3002\u4F60\u8B93\u5BA2\u6236\u611F\u53D7\u5230\u88AB\u91CD\u8996\u3002",
      responseLength: "medium",
      emojiFrequency: "medium",
      typingSpeed: "medium"
    },
    responsibilities: ["\u5BA2\u6236\u56DE\u8A2A", "\u6EFF\u610F\u5EA6\u8ABF\u67E5", "\u53CD\u994B\u6536\u96C6", "\u554F\u984C\u767C\u73FE"],
    scenarios: ["\u5BA2\u6236\u56DE\u8A2A", "\u6EFF\u610F\u5EA6\u8ABF\u67E5", "\u6D41\u5931\u9810\u8B66"],
    keyPhrases: ["\u4F86\u505A\u500B\u56DE\u8A2A", "\u4F7F\u7528\u611F\u53D7\u5982\u4F55", "\u6709\u4EC0\u9EBC\u5EFA\u8B70"],
    isActive: true
  },
  {
    id: "preset_crisis_pr",
    name: "\u5371\u6A5F\u516C\u95DC",
    type: "custom",
    category: "special",
    roleType: "crisis_pr",
    personality: {
      description: "\u51B7\u975C\u5C08\u696D\u7684\u8F3F\u60C5\u8655\u7406\u5C08\u5BB6",
      speakingStyle: "professional",
      traits: ["\u51B7\u975C\u5C08\u696D", "\u8F3F\u60C5\u8655\u7406", "\u5371\u6A5F\u61C9\u5C0D", "\u5F62\u8C61\u7DAD\u8B77"],
      background: "PR\u5C08\u5BB6\uFF0C\u8655\u7406\u904E\u591A\u8D77\u8F3F\u60C5\u4E8B\u4EF6"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662F\u5371\u6A5F\u516C\u95DC\u5C08\u54E1\uFF0C\u8CA0\u8CAC\u8655\u7406\u8CA0\u9762\u8F3F\u60C5\u3002\u4F60\u51B7\u975C\u5C08\u696D\uFF0C\u4E0D\u8FF4\u907F\u554F\u984C\uFF0C\u7A4D\u6975\u6E9D\u901A\u89E3\u6C7A\u3002\u4F60\u7684\u76EE\u6A19\u662F\u5316\u89E3\u5371\u6A5F\uFF0C\u7DAD\u8B77\u54C1\u724C\u5F62\u8C61\u3002",
      responseLength: "medium",
      emojiFrequency: "none",
      typingSpeed: "slow"
    },
    responsibilities: ["\u8F3F\u60C5\u8655\u7406", "\u5371\u6A5F\u61C9\u5C0D", "\u5F62\u8C61\u7DAD\u8B77", "\u6E9D\u901A\u5354\u8ABF"],
    scenarios: ["\u8CA0\u9762\u61C9\u5C0D", "\u8F3F\u60C5\u8655\u7406", "\u5371\u6A5F\u516C\u95DC"],
    keyPhrases: ["\u6211\u5011\u975E\u5E38\u91CD\u8996", "\u6B63\u5728\u8ABF\u67E5\u8655\u7406", "\u6703\u7D66\u5927\u5BB6\u4E00\u500B\u4EA4\u4EE3"],
    isActive: true
  },
  {
    id: "preset_ai_assistant",
    name: "AI\u52A9\u624B",
    type: "custom",
    category: "special",
    roleType: "ai_assistant",
    personality: {
      description: "\u667A\u80FD\u9AD8\u6548\u768424\u5C0F\u6642AI\u52A9\u624B",
      speakingStyle: "friendly",
      traits: ["\u667A\u80FD\u9AD8\u6548", "24\u5C0F\u6642\u5728\u7DDA", "\u5FEB\u901F\u97FF\u61C9", "\u77E5\u8B58\u8C50\u5BCC"],
      background: "AI\u5BA2\u670D\u6A5F\u5668\u4EBA\uFF0C\u6301\u7E8C\u5B78\u7FD2\u512A\u5316"
    },
    aiConfig: {
      useGlobalAI: true,
      customPrompt: "\u4F60\u662FAI\u52A9\u624B\uFF0C24\u5C0F\u6642\u5728\u7DDA\u670D\u52D9\u3002\u4F60\u5FEB\u901F\u97FF\u61C9\u5404\u7A2E\u554F\u984C\uFF0C\u77E5\u8B58\u8C50\u5BCC\uFF0C\u56DE\u7B54\u6E96\u78BA\u3002\u9047\u5230\u7121\u6CD5\u8655\u7406\u7684\u554F\u984C\u6703\u53CA\u6642\u8F49\u4EBA\u5DE5\u3002\u4F60\u8B93\u670D\u52D9\u6C38\u4E0D\u65B7\u7DDA\u3002",
      responseLength: "short",
      emojiFrequency: "medium",
      typingSpeed: "fast"
    },
    responsibilities: ["24\u5C0F\u6642\u670D\u52D9", "\u5FEB\u901F\u97FF\u61C9", "\u5E38\u898B\u554F\u7B54", "\u667A\u80FD\u5206\u6D41"],
    scenarios: ["\u81EA\u52D5\u5316\u5834\u666F", "\u5E38\u898B\u554F\u7B54", "\u975E\u5DE5\u4F5C\u6642\u9593"],
    keyPhrases: ["\u6211\u662FAI\u52A9\u624B", "\u70BA\u60A8\u67E5\u8A62\u4E2D", "\u9700\u8981\u8F49\u4EBA\u5DE5\u55CE"],
    isActive: true
  }
];
function presetToRoleDefinition(preset) {
  const now = (/* @__PURE__ */ new Date()).toISOString();
  return {
    id: preset.id,
    name: preset.name,
    type: preset.type,
    personality: preset.personality,
    aiConfig: preset.aiConfig,
    responsibilities: preset.responsibilities,
    isActive: preset.isActive,
    usageCount: 0,
    successCount: 0,
    createdAt: now,
    updatedAt: now
  };
}

// src/multi-role/components/role-library.component.ts
var _forTrack04 = ($index, $item) => $item.key;
var _forTrack12 = ($index, $item) => $item.id;
function RoleLibraryComponent_For_23_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 12);
    \u0275\u0275listener("click", function RoleLibraryComponent_For_23_Template_button_click_0_listener() {
      const cat_r2 = \u0275\u0275restoreView(_r1).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectedCategory.set(cat_r2.key));
    });
    \u0275\u0275elementStart(1, "span");
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "span");
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "span", 13);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const cat_r2 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classMap(ctx_r2.selectedCategory() === cat_r2.key ? "bg-gradient-to-r from-cyan-500 to-blue-500 text-white" : "bg-slate-800/50 text-slate-400 hover:text-white");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(cat_r2.icon);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(cat_r2.label);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("(", ctx_r2.getRoleCategoryCount(cat_r2.key), ")");
  }
}
function RoleLibraryComponent_For_27_For_17_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 30);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const trait_r6 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", trait_r6, " ");
  }
}
function RoleLibraryComponent_For_27_Conditional_18_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 31);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const role_r5 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" +", role_r5.personality.traits.length - 3, " ");
  }
}
function RoleLibraryComponent_For_27_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 20);
    \u0275\u0275listener("click", function RoleLibraryComponent_For_27_Template_div_click_0_listener() {
      const role_r5 = \u0275\u0275restoreView(_r4).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectRole(role_r5));
    });
    \u0275\u0275elementStart(1, "div", 21)(2, "div", 3)(3, "div", 22);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div")(6, "h3", 23);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "span", 24);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(10, "button", 25);
    \u0275\u0275listener("click", function RoleLibraryComponent_For_27_Template_button_click_10_listener($event) {
      const role_r5 = \u0275\u0275restoreView(_r4).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      ctx_r2.addRole(role_r5);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(11, "svg", 26);
    \u0275\u0275element(12, "path", 27);
    \u0275\u0275elementEnd()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(13, "p", 28);
    \u0275\u0275text(14);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "div", 29);
    \u0275\u0275repeaterCreate(16, RoleLibraryComponent_For_27_For_17_Template, 2, 1, "span", 30, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275conditionalCreate(18, RoleLibraryComponent_For_27_Conditional_18_Template, 2, 1, "span", 31);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "div", 32)(20, "span");
    \u0275\u0275text(21, "\u{1F4CD}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(22, "span");
    \u0275\u0275text(23);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    let tmp_10_0;
    let tmp_11_0;
    const role_r5 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classProp("ring-2", ((tmp_10_0 = ctx_r2.selectedRole()) == null ? null : tmp_10_0.id) === role_r5.id)("ring-cyan-500", ((tmp_11_0 = ctx_r2.selectedRole()) == null ? null : tmp_11_0.id) === role_r5.id);
    \u0275\u0275advance(3);
    \u0275\u0275classMap(ctx_r2.getCategoryBgColor(role_r5.category));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.getRoleEmoji(role_r5), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", role_r5.name, " ");
    \u0275\u0275advance();
    \u0275\u0275classMap(ctx_r2.getCategoryBadgeColor(role_r5.category));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.getCategoryLabel(role_r5.category), " ");
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1(" ", role_r5.personality.description, " ");
    \u0275\u0275advance(2);
    \u0275\u0275repeater(role_r5.personality.traits.slice(0, 3));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(role_r5.personality.traits.length > 3 ? 18 : -1);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(role_r5.scenarios.slice(0, 2).join(" \xB7 "));
  }
}
function RoleLibraryComponent_ForEmpty_28_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 18)(1, "div", 33);
    \u0275\u0275text(2, "\u{1F50D}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p");
    \u0275\u0275text(4, "\u6C92\u6709\u627E\u5230\u5339\u914D\u7684\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "p", 34);
    \u0275\u0275text(6, "\u5617\u8A66\u8ABF\u6574\u641C\u7D22\u95DC\u9375\u8A5E\u6216\u5207\u63DB\u5206\u985E");
    \u0275\u0275elementEnd()();
  }
}
function RoleLibraryComponent_Conditional_29_Conditional_27_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div")(1, "h3", 47);
    \u0275\u0275text(2, "\u80CC\u666F\u6545\u4E8B");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p", 60);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const role_r8 = \u0275\u0275nextContext();
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(role_r8.personality.background);
  }
}
function RoleLibraryComponent_Conditional_29_For_33_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 50);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const trait_r9 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", trait_r9, " ");
  }
}
function RoleLibraryComponent_Conditional_29_For_39_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 52)(1, "span", 61);
    \u0275\u0275text(2, "\u2713");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "span");
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const resp_r10 = ctx.$implicit;
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(resp_r10);
  }
}
function RoleLibraryComponent_Conditional_29_For_45_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 53);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const scenario_r11 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u{1F4CD} ", scenario_r11, " ");
  }
}
function RoleLibraryComponent_Conditional_29_For_51_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 55);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const phrase_r12 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(' "', phrase_r12, '" ');
  }
}
function RoleLibraryComponent_Conditional_29_Template(rf, ctx) {
  if (rf & 1) {
    const _r7 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 19)(1, "button", 35);
    \u0275\u0275listener("click", function RoleLibraryComponent_Conditional_29_Template_button_click_1_listener() {
      \u0275\u0275restoreView(_r7);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectedRole.set(null));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(2, "svg", 36);
    \u0275\u0275element(3, "path", 37);
    \u0275\u0275elementEnd()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(4, "div", 38)(5, "div", 39)(6, "div", 40);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div")(9, "h2", 5);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "span", 41);
    \u0275\u0275text(12);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(13, "div", 42)(14, "button", 43);
    \u0275\u0275listener("click", function RoleLibraryComponent_Conditional_29_Template_button_click_14_listener() {
      const role_r8 = \u0275\u0275restoreView(_r7);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.addRole(role_r8));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(15, "svg", 36);
    \u0275\u0275element(16, "path", 27);
    \u0275\u0275elementEnd();
    \u0275\u0275text(17, " \u6DFB\u52A0\u5230\u5287\u672C ");
    \u0275\u0275elementEnd();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(18, "button", 44);
    \u0275\u0275listener("click", function RoleLibraryComponent_Conditional_29_Template_button_click_18_listener() {
      const role_r8 = \u0275\u0275restoreView(_r7);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.editRole(role_r8));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(19, "svg", 36);
    \u0275\u0275element(20, "path", 45);
    \u0275\u0275elementEnd()()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275elementStart(21, "div", 46)(22, "div")(23, "h3", 47);
    \u0275\u0275text(24, "\u4EBA\u8A2D\u63CF\u8FF0");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(25, "p", 48);
    \u0275\u0275text(26);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(27, RoleLibraryComponent_Conditional_29_Conditional_27_Template, 5, 1, "div");
    \u0275\u0275elementStart(28, "div")(29, "h3", 47);
    \u0275\u0275text(30, "\u6027\u683C\u7279\u9EDE");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(31, "div", 49);
    \u0275\u0275repeaterCreate(32, RoleLibraryComponent_Conditional_29_For_33_Template, 2, 1, "span", 50, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(34, "div")(35, "h3", 47);
    \u0275\u0275text(36, "\u8077\u8CAC\u7BC4\u570D");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(37, "div", 51);
    \u0275\u0275repeaterCreate(38, RoleLibraryComponent_Conditional_29_For_39_Template, 5, 1, "div", 52, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(40, "div")(41, "h3", 47);
    \u0275\u0275text(42, "\u9069\u7528\u5834\u666F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(43, "div", 49);
    \u0275\u0275repeaterCreate(44, RoleLibraryComponent_Conditional_29_For_45_Template, 2, 1, "span", 53, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(46, "div")(47, "h3", 47);
    \u0275\u0275text(48, "\u5E38\u7528\u8A9E\u53E5");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(49, "div", 54);
    \u0275\u0275repeaterCreate(50, RoleLibraryComponent_Conditional_29_For_51_Template, 2, 1, "div", 55, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(52, "div")(53, "h3", 47);
    \u0275\u0275text(54, "AI \u914D\u7F6E");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(55, "div", 56)(56, "div", 57)(57, "p", 58);
    \u0275\u0275text(58, "\u56DE\u8986\u9577\u5EA6");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(59, "p", 59);
    \u0275\u0275text(60);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(61, "div", 57)(62, "p", 58);
    \u0275\u0275text(63, "Emoji \u983B\u7387");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(64, "p", 59);
    \u0275\u0275text(65);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(66, "div", 57)(67, "p", 58);
    \u0275\u0275text(68, "\u8AAA\u8A71\u98A8\u683C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(69, "p", 59);
    \u0275\u0275text(70);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(71, "div", 57)(72, "p", 58);
    \u0275\u0275text(73, "\u6253\u5B57\u901F\u5EA6");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(74, "p", 59);
    \u0275\u0275text(75);
    \u0275\u0275elementEnd()()()()()();
  }
  if (rf & 2) {
    const role_r8 = ctx;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance(6);
    \u0275\u0275classMap(ctx_r2.getCategoryBgColor(role_r8.category));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.getRoleEmoji(role_r8), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(role_r8.name);
    \u0275\u0275advance();
    \u0275\u0275classMap(ctx_r2.getCategoryBadgeColor(role_r8.category));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.getCategoryLabel(role_r8.category), " ");
    \u0275\u0275advance(14);
    \u0275\u0275textInterpolate(role_r8.personality.description);
    \u0275\u0275advance();
    \u0275\u0275conditional(role_r8.personality.background ? 27 : -1);
    \u0275\u0275advance(5);
    \u0275\u0275repeater(role_r8.personality.traits);
    \u0275\u0275advance(6);
    \u0275\u0275repeater(role_r8.responsibilities);
    \u0275\u0275advance(6);
    \u0275\u0275repeater(role_r8.scenarios);
    \u0275\u0275advance(6);
    \u0275\u0275repeater(role_r8.keyPhrases);
    \u0275\u0275advance(10);
    \u0275\u0275textInterpolate(ctx_r2.getResponseLengthLabel(role_r8.aiConfig.responseLength));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r2.getEmojiFrequencyLabel(role_r8.aiConfig.emojiFrequency));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r2.getSpeakingStyleLabel(role_r8.personality.speakingStyle));
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r2.getTypingSpeedLabel(role_r8.aiConfig.typingSpeed));
  }
}
var RoleLibraryComponent = class _RoleLibraryComponent {
  constructor() {
    this.roleAdded = output();
    this.roleEdit = output();
    this.PRESET_ROLES = PRESET_ROLES;
    this.searchQuery = "";
    this.selectedCategory = signal(null, ...ngDevMode ? [{ debugName: "selectedCategory" }] : []);
    this.selectedRole = signal(null, ...ngDevMode ? [{ debugName: "selectedRole" }] : []);
    this.categoryList = Object.entries(ROLE_CATEGORIES).map(([key, value]) => __spreadValues({
      key
    }, value));
    this.filteredRoles = computed(() => {
      let roles = PRESET_ROLES;
      const category = this.selectedCategory();
      if (category) {
        roles = roles.filter((r) => r.category === category);
      }
      const query = this.searchQuery.toLowerCase().trim();
      if (query) {
        roles = roles.filter((r) => r.name.toLowerCase().includes(query) || r.personality.description.toLowerCase().includes(query) || r.personality.traits.some((t) => t.toLowerCase().includes(query)) || r.scenarios.some((s) => s.toLowerCase().includes(query)));
      }
      return roles;
    }, ...ngDevMode ? [{ debugName: "filteredRoles" }] : []);
  }
  ngOnInit() {
  }
  getRoleCategoryCount(category) {
    return PRESET_ROLES.filter((r) => r.category === category).length;
  }
  selectRole(role) {
    this.selectedRole.set(role);
  }
  addRole(role) {
    const roleDefinition = presetToRoleDefinition(role);
    this.roleAdded.emit(roleDefinition);
  }
  editRole(role) {
    this.roleEdit.emit(role);
  }
  getRoleEmoji(role) {
    const emojiMap = {
      // Èä∑ÂîÆÈ°û
      "sales_manager": "\u{1F454}",
      "product_consultant": "\u{1F3AF}",
      "account_manager": "\u{1F4BC}",
      "sales_rep": "\u{1F64B}",
      "solution_expert": "\u{1F4CA}",
      "price_specialist": "\u{1F4B0}",
      "regional_director": "\u{1F451}",
      "business_manager": "\u{1F91D}",
      // ÊäÄË°ìÈ°û
      "tech_support": "\u{1F527}",
      "product_engineer": "\u2699\uFE0F",
      "solution_architect": "\u{1F3D7}\uFE0F",
      "ops_expert": "\u{1F5A5}\uFE0F",
      "security_advisor": "\u{1F512}",
      "dev_relations": "\u{1F468}\u200D\u{1F4BB}",
      // ÂÆ¢ÊúçÈ°û
      "cs_agent": "\u{1F3A7}",
      "complaint_handler": "\u{1F60A}",
      "vip_service": "\u2B50",
      "presales_advisor": "\u{1F4AC}",
      "aftersales_agent": "\u{1F4CB}",
      "community_manager": "\u{1F3E0}",
      // Ë°åÊ•≠Â∞àÂÆ∂
      "finance_advisor": "\u{1F4C8}",
      "ecommerce_expert": "\u{1F6D2}",
      "education_consultant": "\u{1F4DA}",
      "health_advisor": "\u{1F48A}",
      "property_consultant": "\u{1F3E0}",
      "travel_expert": "\u2708\uFE0F",
      "beauty_influencer": "\u{1F484}",
      "tech_blogger": "\u{1F4F1}",
      // Á§æ‰∫§È°û
      "friendly_member": "\u{1F604}",
      "loyal_customer": "\u2764\uFE0F",
      "industry_veteran": "\u{1F396}\uFE0F",
      "curious_observer": "\u{1F440}",
      "opinion_leader": "\u{1F3A4}",
      "newbie_user": "\u{1F331}",
      // ÈÅãÁáüÈ°û
      "event_operator": "\u{1F389}",
      "content_editor": "\u270D\uFE0F",
      "brand_ambassador": "\u{1F3C6}",
      "growth_expert": "\u{1F4C8}",
      "partner_manager": "\u{1F91D}",
      "market_analyst": "\u{1F4CA}",
      // ÁÆ°ÁêÜÈ°û
      "group_admin": "\u{1F46E}",
      "founder_ceo": "\u{1F454}",
      "project_manager": "\u{1F4CB}",
      "customer_success": "\u{1F3AF}",
      "trainer": "\u{1F468}\u200D\u{1F3EB}",
      // ÁâπÊÆäÂ†¥ÊôØ
      "flash_sale_agent": "\u23F0",
      "competitor_analyst": "\u{1F50D}",
      "callback_agent": "\u{1F4DE}",
      "crisis_pr": "\u{1F6E1}\uFE0F",
      "ai_assistant": "\u{1F916}"
    };
    return emojiMap[role.roleType] || "\u{1F3AD}";
  }
  getCategoryBgColor(category) {
    const colorMap = {
      sales: "bg-blue-500/20",
      tech: "bg-purple-500/20",
      service: "bg-green-500/20",
      expert: "bg-amber-500/20",
      social: "bg-pink-500/20",
      operation: "bg-orange-500/20",
      management: "bg-slate-500/20",
      special: "bg-cyan-500/20"
    };
    return colorMap[category] || "bg-slate-500/20";
  }
  getCategoryBadgeColor(category) {
    const colorMap = {
      sales: "bg-blue-500/20 text-blue-400",
      tech: "bg-purple-500/20 text-purple-400",
      service: "bg-green-500/20 text-green-400",
      expert: "bg-amber-500/20 text-amber-400",
      social: "bg-pink-500/20 text-pink-400",
      operation: "bg-orange-500/20 text-orange-400",
      management: "bg-slate-500/20 text-slate-400",
      special: "bg-cyan-500/20 text-cyan-400"
    };
    return colorMap[category] || "bg-slate-500/20 text-slate-400";
  }
  getCategoryLabel(category) {
    return ROLE_CATEGORIES[category]?.label || "\u672A\u5206\u985E";
  }
  getResponseLengthLabel(length) {
    const labels = {
      "short": "\u7C21\u77ED",
      "medium": "\u9069\u4E2D",
      "long": "\u8A73\u7D30"
    };
    return labels[length] || length;
  }
  getEmojiFrequencyLabel(freq) {
    const labels = {
      "none": "\u4E0D\u4F7F\u7528",
      "low": "\u5076\u723E",
      "medium": "\u9069\u4E2D",
      "high": "\u983B\u7E41"
    };
    return labels[freq] || freq;
  }
  getSpeakingStyleLabel(style) {
    const labels = {
      "professional": "\u5C08\u696D\u6B63\u5F0F",
      "friendly": "\u53CB\u597D\u89AA\u5207",
      "casual": "\u8F15\u9B06\u96A8\u610F",
      "enthusiastic": "\u71B1\u60C5\u6D3B\u6F51",
      "careful": "\u8B39\u614E\u7D30\u7DFB",
      "curious": "\u597D\u5947\u63A2\u7D22"
    };
    return labels[style] || style;
  }
  getTypingSpeedLabel(speed) {
    const labels = {
      "fast": "\u5FEB\u901F",
      "medium": "\u9069\u4E2D",
      "slow": "\u6162\u901F",
      "random": "\u96A8\u6A5F"
    };
    return labels[speed] || speed;
  }
  static {
    this.\u0275fac = function RoleLibraryComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _RoleLibraryComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _RoleLibraryComponent, selectors: [["app-role-library"]], outputs: { roleAdded: "roleAdded", roleEdit: "roleEdit" }, decls: 30, vars: 7, consts: [[1, "role-library", "h-full", "flex", "flex-col", "bg-slate-900"], [1, "p-4", "border-b", "border-slate-700/50", "bg-slate-900/80", "backdrop-blur-sm"], [1, "flex", "items-center", "justify-between", "mb-4"], [1, "flex", "items-center", "gap-3"], [1, "text-2xl"], [1, "text-xl", "font-bold", "text-white"], [1, "text-xs", "bg-cyan-500/20", "text-cyan-400", "px-2", "py-1", "rounded-lg"], [1, "relative"], ["type", "text", "placeholder", "\u641C\u7D22\u89D2\u8272...", 1, "w-64", "bg-slate-800/50", "border", "border-slate-600/50", "rounded-lg", "pl-10", "pr-4", "py-2", "text-sm", "text-white", "placeholder-slate-500", "focus:outline-none", "focus:ring-2", "focus:ring-cyan-500/50", 3, "ngModelChange", "ngModel"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "absolute", "left-3", "top-1/2", "-translate-y-1/2", "w-4", "h-4", "text-slate-500"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"], [1, "flex", "items-center", "gap-2", "overflow-x-auto", "pb-2"], [1, "flex", "items-center", "gap-2", "px-4", "py-2", "rounded-lg", "text-sm", "font-medium", "transition-all", "whitespace-nowrap", 3, "click"], [1, "text-xs", "opacity-70"], [1, "flex", "items-center", "gap-2", "px-4", "py-2", "rounded-lg", "text-sm", "font-medium", "transition-all", "whitespace-nowrap", 3, "class"], [1, "flex-1", "overflow-y-auto", "p-4"], [1, "grid", "grid-cols-1", "md:grid-cols-2", "lg:grid-cols-3", "xl:grid-cols-4", "gap-4"], [1, "bg-slate-800/50", "border", "border-slate-700/50", "rounded-xl", "p-4", "cursor-pointer", "hover:border-cyan-500/50", "hover:bg-slate-800", "transition-all", "group", 3, "ring-2", "ring-cyan-500"], [1, "col-span-full", "text-center", "py-12", "text-slate-500"], [1, "fixed", "inset-y-0", "right-0", "w-96", "bg-slate-900", "border-l", "border-slate-700/50", "shadow-2xl", "z-50", "overflow-y-auto"], [1, "bg-slate-800/50", "border", "border-slate-700/50", "rounded-xl", "p-4", "cursor-pointer", "hover:border-cyan-500/50", "hover:bg-slate-800", "transition-all", "group", 3, "click"], [1, "flex", "items-start", "justify-between", "mb-3"], [1, "w-12", "h-12", "rounded-full", "flex", "items-center", "justify-center", "text-2xl"], [1, "font-semibold", "text-white", "group-hover:text-cyan-400", "transition-colors"], [1, "text-xs", "px-2", "py-0.5", "rounded"], ["title", "\u6DFB\u52A0\u5230\u5287\u672C", 1, "opacity-0", "group-hover:opacity-100", "transition-opacity", "bg-cyan-500", "hover:bg-cyan-600", "text-white", "p-2", "rounded-lg", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-4", "h-4"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M12 4v16m8-8H4"], [1, "text-sm", "text-slate-400", "mb-3", "line-clamp-2"], [1, "flex", "flex-wrap", "gap-1", "mb-3"], [1, "text-xs", "px-2", "py-0.5", "rounded-full", "bg-slate-700/50", "text-slate-300"], [1, "text-xs", "px-2", "py-0.5", "rounded-full", "bg-slate-700/50", "text-slate-500"], [1, "flex", "items-center", "gap-2", "text-xs", "text-slate-500"], [1, "text-4xl", "mb-3"], [1, "text-sm", "mt-1"], [1, "absolute", "top-4", "right-4", "text-slate-400", "hover:text-white", "p-2", "hover:bg-slate-800", "rounded-lg", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-5", "h-5"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M6 18L18 6M6 6l12 12"], [1, "p-6", "border-b", "border-slate-700/50"], [1, "flex", "items-center", "gap-4", "mb-4"], [1, "w-20", "h-20", "rounded-full", "flex", "items-center", "justify-center", "text-4xl"], [1, "text-sm", "px-2", "py-0.5", "rounded"], [1, "flex", "gap-2"], [1, "flex-1", "bg-gradient-to-r", "from-cyan-500", "to-blue-500", "hover:from-cyan-600", "hover:to-blue-600", "text-white", "font-medium", "py-2.5", "px-4", "rounded-lg", "transition-all", "flex", "items-center", "justify-center", "gap-2", 3, "click"], [1, "bg-slate-700", "hover:bg-slate-600", "text-white", "py-2.5", "px-4", "rounded-lg", "transition-colors", 3, "click"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"], [1, "p-6", "space-y-6"], [1, "text-sm", "font-medium", "text-slate-400", "mb-2"], [1, "text-white"], [1, "flex", "flex-wrap", "gap-2"], [1, "px-3", "py-1", "rounded-full", "bg-cyan-500/20", "text-cyan-400", "text-sm"], [1, "space-y-1"], [1, "flex", "items-center", "gap-2", "text-sm", "text-slate-300"], [1, "px-3", "py-1", "rounded-lg", "bg-purple-500/20", "text-purple-400", "text-sm"], [1, "space-y-2"], [1, "p-3", "bg-slate-800/50", "rounded-lg", "text-sm", "text-slate-300", "italic"], [1, "grid", "grid-cols-2", "gap-3"], [1, "p-3", "bg-slate-800/50", "rounded-lg"], [1, "text-xs", "text-slate-500"], [1, "text-sm", "text-white"], [1, "text-slate-300"], [1, "text-cyan-400"]], template: function RoleLibraryComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "div", 3)(4, "span", 4);
        \u0275\u0275text(5, "\u{1F3AD}");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(6, "h2", 5);
        \u0275\u0275text(7, "\u89D2\u8272\u5EAB");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "span", 6);
        \u0275\u0275text(9);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(10, "div", 7)(11, "input", 8);
        \u0275\u0275twoWayListener("ngModelChange", function RoleLibraryComponent_Template_input_ngModelChange_11_listener($event) {
          \u0275\u0275twoWayBindingSet(ctx.searchQuery, $event) || (ctx.searchQuery = $event);
          return $event;
        });
        \u0275\u0275elementEnd();
        \u0275\u0275namespaceSVG();
        \u0275\u0275elementStart(12, "svg", 9);
        \u0275\u0275element(13, "path", 10);
        \u0275\u0275elementEnd()()();
        \u0275\u0275namespaceHTML();
        \u0275\u0275elementStart(14, "div", 11)(15, "button", 12);
        \u0275\u0275listener("click", function RoleLibraryComponent_Template_button_click_15_listener() {
          return ctx.selectedCategory.set(null);
        });
        \u0275\u0275elementStart(16, "span");
        \u0275\u0275text(17, "\u{1F31F}");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(18, "span");
        \u0275\u0275text(19, "\u5168\u90E8");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(20, "span", 13);
        \u0275\u0275text(21);
        \u0275\u0275elementEnd()();
        \u0275\u0275repeaterCreate(22, RoleLibraryComponent_For_23_Template, 7, 5, "button", 14, _forTrack04);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(24, "div", 15)(25, "div", 16);
        \u0275\u0275repeaterCreate(26, RoleLibraryComponent_For_27_Template, 24, 14, "div", 17, _forTrack12, false, RoleLibraryComponent_ForEmpty_28_Template, 7, 0, "div", 18);
        \u0275\u0275elementEnd()();
        \u0275\u0275conditionalCreate(29, RoleLibraryComponent_Conditional_29_Template, 76, 13, "div", 19);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        let tmp_6_0;
        \u0275\u0275advance(9);
        \u0275\u0275textInterpolate1(" ", ctx.PRESET_ROLES.length, " \u500B\u9810\u8A2D\u89D2\u8272 ");
        \u0275\u0275advance(2);
        \u0275\u0275twoWayProperty("ngModel", ctx.searchQuery);
        \u0275\u0275advance(4);
        \u0275\u0275classMap(!ctx.selectedCategory() ? "bg-gradient-to-r from-cyan-500 to-blue-500 text-white" : "bg-slate-800/50 text-slate-400 hover:text-white");
        \u0275\u0275advance(6);
        \u0275\u0275textInterpolate1("(", ctx.PRESET_ROLES.length, ")");
        \u0275\u0275advance();
        \u0275\u0275repeater(ctx.categoryList);
        \u0275\u0275advance(4);
        \u0275\u0275repeater(ctx.filteredRoles());
        \u0275\u0275advance(3);
        \u0275\u0275conditional((tmp_6_0 = ctx.selectedRole()) ? 29 : -1, tmp_6_0);
      }
    }, dependencies: [CommonModule, FormsModule, DefaultValueAccessor, NgControlStatus, NgModel], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(RoleLibraryComponent, [{
    type: Component,
    args: [{
      selector: "app-role-library",
      standalone: true,
      imports: [CommonModule, FormsModule],
      template: `
    <div class="role-library h-full flex flex-col bg-slate-900">
      <!-- \u9802\u90E8\u6A19\u984C\u6B04 -->
      <div class="p-4 border-b border-slate-700/50 bg-slate-900/80 backdrop-blur-sm">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <span class="text-2xl">\u{1F3AD}</span>
            <h2 class="text-xl font-bold text-white">\u89D2\u8272\u5EAB</h2>
            <span class="text-xs bg-cyan-500/20 text-cyan-400 px-2 py-1 rounded-lg">
              {{ PRESET_ROLES.length }} \u500B\u9810\u8A2D\u89D2\u8272
            </span>
          </div>
          
          <!-- \u641C\u7D22\u6846 -->
          <div class="relative">
            <input type="text" 
                   [(ngModel)]="searchQuery"
                   placeholder="\u641C\u7D22\u89D2\u8272..."
                   class="w-64 bg-slate-800/50 border border-slate-600/50 rounded-lg pl-10 pr-4 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50">
            <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </div>
        </div>
        
        <!-- \u5206\u985E Tab -->
        <div class="flex items-center gap-2 overflow-x-auto pb-2">
          <button (click)="selectedCategory.set(null)"
                  [class]="!selectedCategory() ? 'bg-gradient-to-r from-cyan-500 to-blue-500 text-white' : 'bg-slate-800/50 text-slate-400 hover:text-white'"
                  class="flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap">
            <span>\u{1F31F}</span>
            <span>\u5168\u90E8</span>
            <span class="text-xs opacity-70">({{ PRESET_ROLES.length }})</span>
          </button>
          @for (cat of categoryList; track cat.key) {
            <button (click)="selectedCategory.set(cat.key)"
                    [class]="selectedCategory() === cat.key ? 'bg-gradient-to-r from-cyan-500 to-blue-500 text-white' : 'bg-slate-800/50 text-slate-400 hover:text-white'"
                    class="flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap">
              <span>{{ cat.icon }}</span>
              <span>{{ cat.label }}</span>
              <span class="text-xs opacity-70">({{ getRoleCategoryCount(cat.key) }})</span>
            </button>
          }
        </div>
      </div>
      
      <!-- \u89D2\u8272\u5361\u7247\u7DB2\u683C -->
      <div class="flex-1 overflow-y-auto p-4">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
          @for (role of filteredRoles(); track role.id) {
            <div (click)="selectRole(role)"
                 [class.ring-2]="selectedRole()?.id === role.id"
                 [class.ring-cyan-500]="selectedRole()?.id === role.id"
                 class="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4 cursor-pointer 
                        hover:border-cyan-500/50 hover:bg-slate-800 transition-all group">
              <!-- \u982D\u90E8\uFF1A\u982D\u50CF\u548C\u540D\u7A31 -->
              <div class="flex items-start justify-between mb-3">
                <div class="flex items-center gap-3">
                  <div class="w-12 h-12 rounded-full flex items-center justify-center text-2xl"
                       [class]="getCategoryBgColor(role.category)">
                    {{ getRoleEmoji(role) }}
                  </div>
                  <div>
                    <h3 class="font-semibold text-white group-hover:text-cyan-400 transition-colors">
                      {{ role.name }}
                    </h3>
                    <span class="text-xs px-2 py-0.5 rounded"
                          [class]="getCategoryBadgeColor(role.category)">
                      {{ getCategoryLabel(role.category) }}
                    </span>
                  </div>
                </div>
                
                <!-- \u5FEB\u901F\u6DFB\u52A0\u6309\u9215 -->
                <button (click)="addRole(role); $event.stopPropagation()"
                        class="opacity-0 group-hover:opacity-100 transition-opacity
                               bg-cyan-500 hover:bg-cyan-600 text-white p-2 rounded-lg"
                        title="\u6DFB\u52A0\u5230\u5287\u672C">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                </button>
              </div>
              
              <!-- \u4EBA\u8A2D\u63CF\u8FF0 -->
              <p class="text-sm text-slate-400 mb-3 line-clamp-2">
                {{ role.personality.description }}
              </p>
              
              <!-- \u6027\u683C\u7279\u9EDE\u6A19\u7C64 -->
              <div class="flex flex-wrap gap-1 mb-3">
                @for (trait of role.personality.traits.slice(0, 3); track trait) {
                  <span class="text-xs px-2 py-0.5 rounded-full bg-slate-700/50 text-slate-300">
                    {{ trait }}
                  </span>
                }
                @if (role.personality.traits.length > 3) {
                  <span class="text-xs px-2 py-0.5 rounded-full bg-slate-700/50 text-slate-500">
                    +{{ role.personality.traits.length - 3 }}
                  </span>
                }
              </div>
              
              <!-- \u9069\u7528\u5834\u666F -->
              <div class="flex items-center gap-2 text-xs text-slate-500">
                <span>\u{1F4CD}</span>
                <span>{{ role.scenarios.slice(0, 2).join(' \xB7 ') }}</span>
              </div>
            </div>
          } @empty {
            <div class="col-span-full text-center py-12 text-slate-500">
              <div class="text-4xl mb-3">\u{1F50D}</div>
              <p>\u6C92\u6709\u627E\u5230\u5339\u914D\u7684\u89D2\u8272</p>
              <p class="text-sm mt-1">\u5617\u8A66\u8ABF\u6574\u641C\u7D22\u95DC\u9375\u8A5E\u6216\u5207\u63DB\u5206\u985E</p>
            </div>
          }
        </div>
      </div>
      
      <!-- \u89D2\u8272\u8A73\u60C5\u5074\u908A\u6B04 -->
      @if (selectedRole(); as role) {
        <div class="fixed inset-y-0 right-0 w-96 bg-slate-900 border-l border-slate-700/50 shadow-2xl z-50 overflow-y-auto">
          <!-- \u95DC\u9589\u6309\u9215 -->
          <button (click)="selectedRole.set(null)"
                  class="absolute top-4 right-4 text-slate-400 hover:text-white p-2 hover:bg-slate-800 rounded-lg">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
          
          <!-- \u89D2\u8272\u982D\u90E8 -->
          <div class="p-6 border-b border-slate-700/50">
            <div class="flex items-center gap-4 mb-4">
              <div class="w-20 h-20 rounded-full flex items-center justify-center text-4xl"
                   [class]="getCategoryBgColor(role.category)">
                {{ getRoleEmoji(role) }}
              </div>
              <div>
                <h2 class="text-xl font-bold text-white">{{ role.name }}</h2>
                <span class="text-sm px-2 py-0.5 rounded"
                      [class]="getCategoryBadgeColor(role.category)">
                  {{ getCategoryLabel(role.category) }}
                </span>
              </div>
            </div>
            
            <!-- \u64CD\u4F5C\u6309\u9215 -->
            <div class="flex gap-2">
              <button (click)="addRole(role)"
                      class="flex-1 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600
                             text-white font-medium py-2.5 px-4 rounded-lg transition-all flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
                \u6DFB\u52A0\u5230\u5287\u672C
              </button>
              <button (click)="editRole(role)"
                      class="bg-slate-700 hover:bg-slate-600 text-white py-2.5 px-4 rounded-lg transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                </svg>
              </button>
            </div>
          </div>
          
          <!-- \u8A73\u7D30\u4FE1\u606F -->
          <div class="p-6 space-y-6">
            <!-- \u4EBA\u8A2D\u63CF\u8FF0 -->
            <div>
              <h3 class="text-sm font-medium text-slate-400 mb-2">\u4EBA\u8A2D\u63CF\u8FF0</h3>
              <p class="text-white">{{ role.personality.description }}</p>
            </div>
            
            <!-- \u80CC\u666F\u6545\u4E8B -->
            @if (role.personality.background) {
              <div>
                <h3 class="text-sm font-medium text-slate-400 mb-2">\u80CC\u666F\u6545\u4E8B</h3>
                <p class="text-slate-300">{{ role.personality.background }}</p>
              </div>
            }
            
            <!-- \u6027\u683C\u7279\u9EDE -->
            <div>
              <h3 class="text-sm font-medium text-slate-400 mb-2">\u6027\u683C\u7279\u9EDE</h3>
              <div class="flex flex-wrap gap-2">
                @for (trait of role.personality.traits; track trait) {
                  <span class="px-3 py-1 rounded-full bg-cyan-500/20 text-cyan-400 text-sm">
                    {{ trait }}
                  </span>
                }
              </div>
            </div>
            
            <!-- \u8077\u8CAC\u7BC4\u570D -->
            <div>
              <h3 class="text-sm font-medium text-slate-400 mb-2">\u8077\u8CAC\u7BC4\u570D</h3>
              <div class="space-y-1">
                @for (resp of role.responsibilities; track resp) {
                  <div class="flex items-center gap-2 text-sm text-slate-300">
                    <span class="text-cyan-400">\u2713</span>
                    <span>{{ resp }}</span>
                  </div>
                }
              </div>
            </div>
            
            <!-- \u9069\u7528\u5834\u666F -->
            <div>
              <h3 class="text-sm font-medium text-slate-400 mb-2">\u9069\u7528\u5834\u666F</h3>
              <div class="flex flex-wrap gap-2">
                @for (scenario of role.scenarios; track scenario) {
                  <span class="px-3 py-1 rounded-lg bg-purple-500/20 text-purple-400 text-sm">
                    \u{1F4CD} {{ scenario }}
                  </span>
                }
              </div>
            </div>
            
            <!-- \u5E38\u7528\u8A9E\u53E5 -->
            <div>
              <h3 class="text-sm font-medium text-slate-400 mb-2">\u5E38\u7528\u8A9E\u53E5</h3>
              <div class="space-y-2">
                @for (phrase of role.keyPhrases; track phrase) {
                  <div class="p-3 bg-slate-800/50 rounded-lg text-sm text-slate-300 italic">
                    "{{ phrase }}"
                  </div>
                }
              </div>
            </div>
            
            <!-- AI \u914D\u7F6E -->
            <div>
              <h3 class="text-sm font-medium text-slate-400 mb-2">AI \u914D\u7F6E</h3>
              <div class="grid grid-cols-2 gap-3">
                <div class="p-3 bg-slate-800/50 rounded-lg">
                  <p class="text-xs text-slate-500">\u56DE\u8986\u9577\u5EA6</p>
                  <p class="text-sm text-white">{{ getResponseLengthLabel(role.aiConfig.responseLength) }}</p>
                </div>
                <div class="p-3 bg-slate-800/50 rounded-lg">
                  <p class="text-xs text-slate-500">Emoji \u983B\u7387</p>
                  <p class="text-sm text-white">{{ getEmojiFrequencyLabel(role.aiConfig.emojiFrequency) }}</p>
                </div>
                <div class="p-3 bg-slate-800/50 rounded-lg">
                  <p class="text-xs text-slate-500">\u8AAA\u8A71\u98A8\u683C</p>
                  <p class="text-sm text-white">{{ getSpeakingStyleLabel(role.personality.speakingStyle) }}</p>
                </div>
                <div class="p-3 bg-slate-800/50 rounded-lg">
                  <p class="text-xs text-slate-500">\u6253\u5B57\u901F\u5EA6</p>
                  <p class="text-sm text-white">{{ getTypingSpeedLabel(role.aiConfig.typingSpeed) }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  `
    }]
  }], null, { roleAdded: [{ type: Output, args: ["roleAdded"] }], roleEdit: [{ type: Output, args: ["roleEdit"] }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(RoleLibraryComponent, { className: "RoleLibraryComponent", filePath: "src/multi-role/components/role-library.component.ts", lineNumber: 289 });
})();

// src/multi-role/preset-scenarios.ts
var SCENARIO_META = {
  new_customer_icebreak: {
    icon: "\u{1F91D}",
    name: "\u65B0\u5BA2\u6236\u7834\u51B0",
    description: "\u81EA\u7136\u4E92\u52D5 \u2192 \u9AD4\u9A57\u5206\u4EAB \u2192 \u5C08\u696D\u4ECB\u7D39",
    difficulty: "easy",
    duration: "10-15\u5206\u9418",
    successRate: "65%"
  },
  hesitant_conversion: {
    icon: "\u{1F4AA}",
    name: "\u7336\u8C6B\u5BA2\u6236\u4FC3\u55AE",
    description: "\u9700\u6C42\u78BA\u8A8D \u2192 \u5831\u50F9\u8AC7\u5224 \u2192 \u7279\u6279\u512A\u60E0",
    difficulty: "medium",
    duration: "20-30\u5206\u9418",
    successRate: "45%"
  },
  aftersales_handling: {
    icon: "\u{1F527}",
    name: "\u552E\u5F8C\u554F\u984C\u8655\u7406",
    description: "\u554F\u984C\u8A18\u9304 \u2192 \u6280\u8853\u6392\u67E5 \u2192 \u6EFF\u610F\u5EA6\u88DC\u511F",
    difficulty: "medium",
    duration: "15-25\u5206\u9418",
    successRate: "85%"
  },
  vip_service: {
    icon: "\u{1F451}",
    name: "\u9AD8\u50F9\u503C\u5BA2\u6236\u670D\u52D9",
    description: "\u5C0A\u8CB4\u63A5\u5F85 \u2192 \u5B9A\u5236\u65B9\u6848 \u2192 \u6230\u7565\u5408\u4F5C",
    difficulty: "hard",
    duration: "30-45\u5206\u9418",
    successRate: "70%"
  },
  community_activation: {
    icon: "\u{1F389}",
    name: "\u793E\u7FA4\u6D3B\u8E8D\u5F15\u5C0E",
    description: "\u8A71\u984C\u767C\u8D77 \u2192 \u4E92\u52D5\u8A0E\u8AD6 \u2192 \u50F9\u503C\u7E3D\u7D50",
    difficulty: "easy",
    duration: "\u6301\u7E8C\u6027",
    successRate: "80%"
  },
  product_launch: {
    icon: "\u{1F680}",
    name: "\u7522\u54C1\u767C\u5E03\u63A8\u5EE3",
    description: "\u9810\u71B1\u9020\u52E2 \u2192 \u5C08\u696D\u6E2C\u8A55 \u2192 \u6D3B\u52D5\u5F15\u7206",
    difficulty: "hard",
    duration: "\u591A\u65E5\u6D3B\u52D5",
    successRate: "55%"
  },
  education_sales: {
    icon: "\u{1F4DA}",
    name: "\u6559\u80B2\u8AB2\u7A0B\u92B7\u552E",
    description: "\u9700\u6C42\u5206\u6790 \u2192 \u8AB2\u7A0B\u4ECB\u7D39 \u2192 \u5B78\u54E1\u898B\u8B49",
    difficulty: "medium",
    duration: "20-30\u5206\u9418",
    successRate: "50%"
  },
  b2b_cooperation: {
    icon: "\u{1F3E2}",
    name: "B2B\u4F01\u696D\u5408\u4F5C",
    description: "\u5408\u4F5C\u9080\u7D04 \u2192 \u65B9\u6848\u8A2D\u8A08 \u2192 \u9805\u76EE\u63A8\u9032",
    difficulty: "hard",
    duration: "\u591A\u8F2A\u8DDF\u9032",
    successRate: "35%"
  },
  competitor_conversion: {
    icon: "\u{1F3AF}",
    name: "\u7AF6\u54C1\u7528\u6236\u8F49\u5316",
    description: "\u75DB\u9EDE\u5171\u9CF4 \u2192 \u512A\u52E2\u5C0D\u6BD4 \u2192 \u9077\u79FB\u512A\u60E0",
    difficulty: "hard",
    duration: "25-40\u5206\u9418",
    successRate: "40%"
  },
  churn_recovery: {
    icon: "\u{1F49D}",
    name: "\u6D41\u5931\u5BA2\u6236\u633D\u56DE",
    description: "\u95DC\u61F7\u56DE\u8A2A \u2192 \u554F\u984C\u89E3\u6C7A \u2192 \u7E8C\u8CBB\u512A\u60E0",
    difficulty: "medium",
    duration: "15-25\u5206\u9418",
    successRate: "30%"
  }
};
var PRESET_SCENARIOS = [
  // Â†¥ÊôØ1: Êñ∞ÂÆ¢Êà∂Á†¥ÂÜ∞
  {
    id: "scenario_new_customer_icebreak",
    type: "new_customer_icebreak",
    name: "\u65B0\u5BA2\u6236\u7834\u51B0",
    description: "\u901A\u904E\u71B1\u5FC3\u7FA4\u53CB\u548C\u8001\u7528\u6236\u7684\u771F\u5BE6\u5206\u4EAB\uFF0C\u81EA\u7136\u5730\u4ECB\u7D39\u7522\u54C1\uFF0C\u8B93\u65B0\u5BA2\u6236\u5FEB\u901F\u5EFA\u7ACB\u4FE1\u4EFB",
    roles: [
      { roleType: "friendly_member", order: 1, isRequired: true, purpose: "\u6D3B\u8E8D\u6C23\u6C1B\uFF0C\u81EA\u7136\u5F15\u5165\u8A71\u984C" },
      { roleType: "loyal_customer", order: 2, isRequired: true, purpose: "\u5206\u4EAB\u771F\u5BE6\u4F7F\u7528\u9AD4\u9A57" },
      { roleType: "sales_manager", order: 3, isRequired: true, purpose: "\u5C08\u696D\u89E3\u7B54\uFF0C\u4FC3\u6210\u610F\u5411" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u8A71\u984C\u5F15\u5165",
        roleType: "friendly_member",
        triggerType: "time",
        delaySeconds: 30,
        messageTemplate: "\u5927\u5BB6\u597D\uFF01\u6700\u8FD1\u6709\u6C92\u6709\u4EC0\u9EBC\u597D\u7528\u7684{\u7522\u54C1\u985E\u578B}\u63A8\u85A6\u554A\uFF1F",
        successCondition: "\u5BA2\u6236\u53C3\u8207\u8A0E\u8AD6"
      },
      {
        id: "stage_2",
        name: "\u9AD4\u9A57\u5206\u4EAB",
        roleType: "loyal_customer",
        triggerType: "time",
        delaySeconds: 60,
        messageTemplate: "\u6211\u7528{\u7522\u54C1\u540D}\u534A\u5E74\u591A\u4E86\uFF0C\u611F\u89BA\u9084\u4E0D\u932F\uFF01\u4E00\u958B\u59CB\u4E5F\u662F\u670B\u53CB\u63A8\u85A6\u7684\uFF0C\u6C92\u60F3\u5230\u771F\u7684\u5F88\u597D\u7528~",
        aiPrompt: "\u4EE5\u8001\u7528\u6236\u8EAB\u4EFD\u5206\u4EAB\u4F7F\u7528\u9AD4\u9A57\uFF0C\u771F\u5BE6\u81EA\u7136\uFF0C\u53EF\u4EE5\u63D0\u5230\u4E00\u4E9B\u5C0F\u7F3A\u9EDE\u4F46\u7E3D\u9AD4\u6EFF\u610F"
      },
      {
        id: "stage_3",
        name: "\u5C08\u696D\u4ECB\u7D39",
        roleType: "sales_manager",
        triggerType: "message",
        messageTemplate: "\u611F\u8B1D\u5206\u4EAB\uFF01{\u5BA2\u6236\u540D}\u60A8\u597D\uFF0C\u6211\u662F\u7522\u54C1\u9867\u554F\uFF0C\u6709\u4EC0\u9EBC\u5177\u9AD4\u554F\u984C\u53EF\u4EE5\u554F\u6211~",
        aiPrompt: "\u4EE5\u5C08\u696D\u9867\u554F\u8EAB\u4EFD\u8A73\u7D30\u89E3\u7B54\u554F\u984C\uFF0C\u6CE8\u610F\u50BE\u807D\u5BA2\u6236\u9700\u6C42"
      }
    ],
    tips: [
      "\u71B1\u5FC3\u7FA4\u53CB\u5148\u6D3B\u8E8D\u6C23\u6C1B\uFF0C\u4E0D\u8981\u4E00\u958B\u59CB\u5C31\u63A8\u92B7",
      "\u8001\u7528\u6236\u5206\u4EAB\u8981\u771F\u5BE6\u81EA\u7136\uFF0C\u907F\u514D\u904E\u5EA6\u8A87\u5F35",
      "\u92B7\u552E\u51FA\u5834\u6642\u6A5F\u8981\u628A\u63E1\uFF0C\u5728\u5BA2\u6236\u8868\u73FE\u8208\u8DA3\u5F8C"
    ]
  },
  // Â†¥ÊôØ2: Áå∂Ë±´ÂÆ¢Êà∂‰øÉÂñÆ
  {
    id: "scenario_hesitant_conversion",
    type: "hesitant_conversion",
    name: "\u7336\u8C6B\u5BA2\u6236\u4FC3\u55AE",
    description: "\u901A\u904E\u5C64\u5C64\u905E\u9032\u7684\u7B56\u7565\uFF0C\u5F9E\u9700\u6C42\u78BA\u8A8D\u5230\u50F9\u683C\u8AC7\u5224\uFF0C\u6700\u7D42\u7531\u7E3D\u76E3\u7279\u6279\u512A\u60E0\u4FC3\u6210\u6210\u4EA4",
    roles: [
      { roleType: "account_manager", order: 1, isRequired: true, purpose: "\u4E86\u89E3\u9867\u616E\uFF0C\u78BA\u8A8D\u9700\u6C42" },
      { roleType: "price_specialist", order: 2, isRequired: true, purpose: "\u63D0\u4F9B\u5831\u50F9\uFF0C\u8AC7\u5224\u50F9\u683C" },
      { roleType: "regional_director", order: 3, isRequired: false, purpose: "\u7279\u6279\u6700\u7D42\u512A\u60E0" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u9700\u6C42\u78BA\u8A8D",
        roleType: "account_manager",
        triggerType: "manual",
        messageTemplate: "{\u5BA2\u6236\u540D}\u60A8\u597D\uFF0C\u6211\u662F\u60A8\u7684\u5C08\u5C6C\u5BA2\u6236\u7D93\u7406\u3002\u4E86\u89E3\u5230\u60A8\u5C0D{\u7522\u54C1}\u6709\u8208\u8DA3\uFF0C\u8ACB\u554F\u4E3B\u8981\u662F\u54EA\u4E9B\u65B9\u9762\u8B93\u60A8\u9084\u5728\u8003\u616E\u5462\uFF1F",
        aiPrompt: "\u8010\u5FC3\u50BE\u807D\u5BA2\u6236\u9867\u616E\uFF0C\u9010\u4E00\u8A18\u9304\u4E26\u56DE\u61C9",
        successCondition: "\u5BA2\u6236\u8AAA\u51FA\u5177\u9AD4\u9867\u616E"
      },
      {
        id: "stage_2",
        name: "\u5831\u50F9\u8AC7\u5224",
        roleType: "price_specialist",
        triggerType: "message",
        delaySeconds: 120,
        messageTemplate: "\u6211\u662F\u50F9\u683C\u5C08\u54E1\uFF0C\u91DD\u5C0D\u60A8\u7684\u9700\u6C42\uFF0C\u6211\u5011\u53EF\u4EE5\u63D0\u4F9B\u4E00\u500B\u7279\u5225\u65B9\u6848...",
        aiPrompt: "\u6839\u64DA\u5BA2\u6236\u9867\u616E\u9EDE\u8A2D\u8A08\u512A\u60E0\u65B9\u6848\uFF0C\u5F37\u8ABF\u50F9\u503C\u800C\u975E\u50F9\u683C"
      },
      {
        id: "stage_3",
        name: "\u7E3D\u76E3\u7279\u6279",
        roleType: "regional_director",
        triggerType: "manual",
        messageTemplate: "\u60A8\u597D\uFF0C\u6211\u662F\u5340\u57DF\u7E3D\u76E3\u3002\u4E86\u89E3\u5230\u60A8\u7684\u60C5\u6CC1\uFF0C\u6211\u53EF\u4EE5\u7279\u6279\u4E00\u500B\u984D\u5916\u512A\u60E0...",
        aiPrompt: "\u4EE5\u9AD8\u5C64\u8EAB\u4EFD\u505A\u6700\u5F8C\u8B93\u6B65\uFF0C\u71DF\u9020\u7A00\u7F3A\u611F"
      }
    ],
    tips: [
      "\u5148\u89E3\u6C7A\u50F9\u683C\u4EE5\u5916\u7684\u9867\u616E",
      "\u50F9\u683C\u5C08\u54E1\u7684\u8B93\u6B65\u8981\u6709\u7406\u7531\uFF08\u5982\u9996\u55AE\u3001\u9577\u671F\u5408\u4F5C\u7B49\uFF09",
      "\u7E3D\u76E3\u51FA\u5834\u662F\u6700\u5F8C\u624B\u6BB5\uFF0C\u8981\u71DF\u9020\u7A00\u7F3A\u611F"
    ]
  },
  // Â†¥ÊôØ3: ÂîÆÂæåÂïèÈ°åËôïÁêÜ
  {
    id: "scenario_aftersales_handling",
    type: "aftersales_handling",
    name: "\u552E\u5F8C\u554F\u984C\u8655\u7406",
    description: "\u9AD8\u6548\u8655\u7406\u5BA2\u6236\u552E\u5F8C\u554F\u984C\uFF0C\u5F9E\u554F\u984C\u8A18\u9304\u5230\u6280\u8853\u6392\u67E5\uFF0C\u78BA\u4FDD\u5BA2\u6236\u6EFF\u610F",
    roles: [
      { roleType: "cs_agent", order: 1, isRequired: true, purpose: "\u8A18\u9304\u554F\u984C\uFF0C\u521D\u6B65\u5B89\u64AB" },
      { roleType: "tech_support", order: 2, isRequired: true, purpose: "\u6280\u8853\u6392\u67E5\uFF0C\u89E3\u6C7A\u554F\u984C" },
      { roleType: "complaint_handler", order: 3, isRequired: false, purpose: "\u8655\u7406\u6295\u8A34\uFF0C\u6EFF\u610F\u5EA6\u88DC\u511F" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u554F\u984C\u8A18\u9304",
        roleType: "cs_agent",
        triggerType: "message",
        messageTemplate: "\u60A8\u597D\uFF0C\u975E\u5E38\u62B1\u6B49\u7D66\u60A8\u5E36\u4F86\u4E0D\u4FBF\uFF01\u8ACB\u60A8\u8A73\u7D30\u63CF\u8FF0\u4E00\u4E0B\u9047\u5230\u7684\u554F\u984C\uFF0C\u6211\u99AC\u4E0A\u70BA\u60A8\u8655\u7406\u3002",
        aiPrompt: "\u8868\u9054\u6B49\u610F\u548C\u91CD\u8996\uFF0C\u8A73\u7D30\u8A18\u9304\u554F\u984C\u7D30\u7BC0",
        successCondition: "\u7372\u53D6\u554F\u984C\u8A73\u60C5"
      },
      {
        id: "stage_2",
        name: "\u6280\u8853\u6392\u67E5",
        roleType: "tech_support",
        triggerType: "time",
        delaySeconds: 60,
        messageTemplate: "\u60A8\u597D\uFF0C\u6211\u662F\u6280\u8853\u652F\u6301\u3002\u6839\u64DA\u60A8\u63CF\u8FF0\u7684\u554F\u984C\uFF0C\u8ACB\u60A8\u5617\u8A66\u4EE5\u4E0B\u6B65\u9A5F...",
        aiPrompt: "\u63D0\u4F9B\u5C08\u696D\u7684\u6280\u8853\u89E3\u6C7A\u65B9\u6848\uFF0C\u6B65\u9A5F\u6E05\u6670"
      },
      {
        id: "stage_3",
        name: "\u6EFF\u610F\u5EA6\u78BA\u8A8D",
        roleType: "complaint_handler",
        triggerType: "time",
        delaySeconds: 300,
        messageTemplate: "\u554F\u984C\u89E3\u6C7A\u4E86\u55CE\uFF1F\u70BA\u8868\u6B49\u610F\uFF0C\u6211\u5011\u70BA\u60A8\u7533\u8ACB\u4E86\u4E00\u4EFD\u5C0F\u79AE\u54C1...",
        aiPrompt: "\u78BA\u8A8D\u554F\u984C\u89E3\u6C7A\uFF0C\u63D0\u4F9B\u9069\u7576\u88DC\u511F"
      }
    ],
    tips: [
      "\u7B2C\u4E00\u6642\u9593\u8868\u9054\u6B49\u610F\u548C\u91CD\u8996",
      "\u6280\u8853\u89E3\u6C7A\u65B9\u6848\u8981\u6E05\u6670\u6613\u61C2",
      "\u554F\u984C\u89E3\u6C7A\u5F8C\u8981\u8DDF\u9032\u6EFF\u610F\u5EA6"
    ]
  },
  // Â†¥ÊôØ4: È´òÂÉπÂÄºÂÆ¢Êà∂ÊúçÂãô
  {
    id: "scenario_vip_service",
    type: "vip_service",
    name: "\u9AD8\u50F9\u503C\u5BA2\u6236\u670D\u52D9",
    description: "\u70BA\u9AD8\u50F9\u503C\u5BA2\u6236\u63D0\u4F9B\u5C0A\u8CB4\u9AD4\u9A57\uFF0C\u5F9EVIP\u63A5\u5F85\u5230\u5B9A\u5236\u65B9\u6848\uFF0C\u53EF\u5347\u7D1A\u5230\u5275\u59CB\u4EBA\u89AA\u81EA\u5C0D\u63A5",
    roles: [
      { roleType: "vip_service", order: 1, isRequired: true, purpose: "VIP\u5C08\u5C6C\u63A5\u5F85" },
      { roleType: "solution_expert", order: 2, isRequired: true, purpose: "\u8A2D\u8A08\u5B9A\u5236\u65B9\u6848" },
      { roleType: "founder_ceo", order: 3, isRequired: false, purpose: "\u6230\u7565\u7D1A\u5408\u4F5C" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u5C0A\u8CB4\u63A5\u5F85",
        roleType: "vip_service",
        triggerType: "manual",
        messageTemplate: "{\u5BA2\u6236\u540D}\u5148\u751F/\u5973\u58EB\u60A8\u597D\uFF01\u6211\u662F\u60A8\u7684VIP\u5C08\u5C6C\u5BA2\u670D\uFF0C\u611F\u8B1D\u60A8\u4E00\u76F4\u4EE5\u4F86\u7684\u652F\u6301\u3002\u6709\u4EFB\u4F55\u9700\u6C42\u96A8\u6642\u544A\u8A34\u6211~",
        aiPrompt: "\u71DF\u9020\u5C0A\u8CB4\u611F\uFF0C\u8B93\u5BA2\u6236\u611F\u53D7\u88AB\u91CD\u8996"
      },
      {
        id: "stage_2",
        name: "\u5B9A\u5236\u65B9\u6848",
        roleType: "solution_expert",
        triggerType: "message",
        delaySeconds: 120,
        messageTemplate: "\u6839\u64DA\u60A8\u7684\u696D\u52D9\u898F\u6A21\u548C\u9700\u6C42\uFF0C\u6211\u5011\u70BA\u60A8\u8A2D\u8A08\u4E86\u5C08\u5C6C\u65B9\u6848...",
        aiPrompt: "\u63D0\u4F9B\u771F\u6B63\u5B9A\u5236\u5316\u7684\u65B9\u6848\uFF0C\u9AD4\u73FE\u5C08\u696D\u6027"
      },
      {
        id: "stage_3",
        name: "\u6230\u7565\u5408\u4F5C",
        roleType: "founder_ceo",
        triggerType: "manual",
        messageTemplate: "\u60A8\u597D\uFF0C\u6211\u662F{\u516C\u53F8}\u5275\u59CB\u4EBA\u3002\u60A8\u662F\u6211\u5011\u975E\u5E38\u91CD\u8996\u7684\u5408\u4F5C\u5925\u4F34\uFF0C\u6211\u89AA\u81EA\u4F86\u548C\u60A8\u8AC7\u9019\u6B21\u5408\u4F5C...",
        aiPrompt: "\u4EE5\u5275\u59CB\u4EBA\u8EAB\u4EFD\u5EFA\u7ACB\u6DF1\u5EA6\u9023\u63A5"
      }
    ],
    tips: [
      "VIP\u670D\u52D9\u8981\u9AD4\u73FE\u5DEE\u7570\u5316\u548C\u5C0A\u8CB4\u611F",
      "\u65B9\u6848\u8981\u771F\u6B63\u5B9A\u5236\uFF0C\u4E0D\u80FD\u662F\u6A21\u677F\u5957\u7528",
      "\u5275\u59CB\u4EBA\u51FA\u5834\u8981\u6709\u7279\u6B8A\u7406\u7531"
    ]
  },
  // Â†¥ÊôØ5: Á§æÁæ§Ê¥ªË∫çÂºïÂ∞é
  {
    id: "scenario_community_activation",
    type: "community_activation",
    name: "\u793E\u7FA4\u6D3B\u8E8D\u5F15\u5C0E",
    description: "\u901A\u904E\u591A\u89D2\u8272\u914D\u5408\uFF0C\u6301\u7E8C\u4FDD\u6301\u793E\u7FA4\u6D3B\u8E8D\u5EA6\uFF0C\u5F15\u5C0E\u6709\u50F9\u503C\u7684\u8A0E\u8AD6",
    roles: [
      { roleType: "community_manager", order: 1, isRequired: true, purpose: "\u767C\u8D77\u8A71\u984C\uFF0C\u7DAD\u8B77\u79E9\u5E8F" },
      { roleType: "friendly_member", order: 2, isRequired: true, purpose: "\u6D3B\u8E8D\u6C23\u6C1B\uFF0C\u7A4D\u6975\u4E92\u52D5" },
      { roleType: "friendly_member", order: 3, isRequired: false, purpose: "\u6301\u7E8C\u4E92\u52D5" },
      { roleType: "opinion_leader", order: 4, isRequired: false, purpose: "\u50F9\u503C\u7E3D\u7D50\uFF0C\u89C0\u9EDE\u8F38\u51FA" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u8A71\u984C\u767C\u8D77",
        roleType: "community_manager",
        triggerType: "time",
        messageTemplate: "\u65E9\u5B89\u5404\u4F4D\uFF01\u4ECA\u5929\u4F86\u804A\u804A{\u8A71\u984C}\uFF0C\u5927\u5BB6\u6709\u4EC0\u9EBC\u7D93\u9A57\u5206\u4EAB\u55CE\uFF1F",
        aiPrompt: "\u767C\u8D77\u6709\u8A0E\u8AD6\u50F9\u503C\u7684\u8A71\u984C"
      },
      {
        id: "stage_2",
        name: "\u7A4D\u6975\u97FF\u61C9",
        roleType: "friendly_member",
        triggerType: "time",
        delaySeconds: 60,
        messageTemplate: "\u9019\u500B\u8A71\u984C\u597D\uFF01\u6211\u4F86\u8AAA\u8AAA\u6211\u7684\u7D93\u9A57...",
        aiPrompt: "\u7A4D\u6975\u97FF\u61C9\uFF0C\u5206\u4EAB\u500B\u4EBA\u7D93\u9A57"
      },
      {
        id: "stage_3",
        name: "\u6301\u7E8C\u4E92\u52D5",
        roleType: "friendly_member",
        triggerType: "time",
        delaySeconds: 120,
        messageTemplate: "\u6A13\u4E0A\u8AAA\u5F97\u5C0D\uFF01\u6211\u88DC\u5145\u4E00\u9EDE...",
        aiPrompt: "\u8A8D\u540C\u4E26\u88DC\u5145\uFF0C\u5F15\u767C\u66F4\u591A\u8A0E\u8AD6"
      },
      {
        id: "stage_4",
        name: "\u50F9\u503C\u7E3D\u7D50",
        roleType: "opinion_leader",
        triggerType: "time",
        delaySeconds: 300,
        messageTemplate: "\u770B\u4E86\u5927\u5BB6\u7684\u8A0E\u8AD6\uFF0C\u6211\u7E3D\u7D50\u4E00\u4E0B\u91CD\u9EDE...",
        aiPrompt: "\u7E3D\u7D50\u8A0E\u8AD6\u50F9\u503C\uFF0C\u7D66\u51FA\u5C08\u696D\u89C0\u9EDE"
      }
    ],
    tips: [
      "\u8A71\u984C\u8981\u6709\u8A0E\u8AD6\u50F9\u503C\uFF0C\u907F\u514D\u904E\u65BC\u71DF\u92B7",
      "\u591A\u500B\u7FA4\u53CB\u914D\u5408\u8981\u81EA\u7136\uFF0C\u907F\u514D\u5237\u5C4F",
      "\u5B9A\u671F\u8B8A\u63DB\u8A71\u984C\u548C\u4E92\u52D5\u5F62\u5F0F"
    ]
  },
  // Â†¥ÊôØ6: Áî¢ÂìÅÁôºÂ∏ÉÊé®Âª£
  {
    id: "scenario_product_launch",
    type: "product_launch",
    name: "\u7522\u54C1\u767C\u5E03\u63A8\u5EE3",
    description: "\u65B0\u7522\u54C1\u767C\u5E03\u7684\u5B8C\u6574\u63A8\u5EE3\u6D41\u7A0B\uFF0C\u5F9E\u9810\u71B1\u5230\u5F15\u7206",
    roles: [
      { roleType: "brand_ambassador", order: 1, isRequired: true, purpose: "\u9810\u71B1\u9020\u52E2" },
      { roleType: "tech_blogger", order: 2, isRequired: true, purpose: "\u5C08\u696D\u6E2C\u8A55" },
      { roleType: "event_operator", order: 3, isRequired: true, purpose: "\u6D3B\u52D5\u5F15\u7206" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u9810\u71B1\u9020\u52E2",
        roleType: "brand_ambassador",
        triggerType: "time",
        messageTemplate: "\u6709\u500B\u5927\u6D88\u606F\u8981\u544A\u8A34\u5927\u5BB6\uFF01{\u7522\u54C1\u540D}\u5373\u5C07\u767C\u5E03\uFF0C\u64DA\u8AAA\u6709\u5F88\u591A\u9A5A\u559C...",
        aiPrompt: "\u88FD\u9020\u61F8\u5FF5\u548C\u671F\u5F85\u611F"
      },
      {
        id: "stage_2",
        name: "\u5C08\u696D\u6E2C\u8A55",
        roleType: "tech_blogger",
        triggerType: "time",
        delaySeconds: 86400,
        // 1Â§©Âæå
        messageTemplate: "\u6211\u63D0\u524D\u62FF\u5230\u4E86{\u7522\u54C1\u540D}\u7684\u6E2C\u8A66\u7248\uFF0C\u4F86\u8DDF\u5927\u5BB6\u5206\u4EAB\u4E00\u4E0B...",
        aiPrompt: "\u5C08\u696D\u5BA2\u89C0\u7684\u6E2C\u8A55\uFF0C\u7A81\u51FA\u4EAE\u9EDE"
      },
      {
        id: "stage_3",
        name: "\u6D3B\u52D5\u5F15\u7206",
        roleType: "event_operator",
        triggerType: "time",
        delaySeconds: 172800,
        // 2Â§©Âæå
        messageTemplate: "\u{1F389} {\u7522\u54C1\u540D}\u6B63\u5F0F\u767C\u5E03\uFF01\u9650\u6642\u512A\u60E0\u4F86\u4E86\uFF01",
        aiPrompt: "\u71DF\u9020\u6436\u8CFC\u6C1B\u570D\uFF0C\u5F15\u5C0E\u4E0B\u55AE"
      }
    ],
    tips: [
      "\u9810\u71B1\u671F\u8981\u4FDD\u6301\u795E\u79D8\u611F",
      "\u6E2C\u8A55\u8981\u5C08\u696D\u53EF\u4FE1",
      "\u767C\u5E03\u6D3B\u52D5\u8981\u6709\u7DCA\u8FEB\u611F"
    ]
  },
  // Â†¥ÊôØ7: ÊïôËÇ≤Ë™≤Á®ãÈä∑ÂîÆ
  {
    id: "scenario_education_sales",
    type: "education_sales",
    name: "\u6559\u80B2\u8AB2\u7A0B\u92B7\u552E",
    description: "\u901A\u904E\u9700\u6C42\u5206\u6790\u548C\u5B78\u54E1\u898B\u8B49\uFF0C\u4FC3\u9032\u8AB2\u7A0B\u5831\u540D",
    roles: [
      { roleType: "education_consultant", order: 1, isRequired: true, purpose: "\u9700\u6C42\u5206\u6790\uFF0C\u8AB2\u7A0B\u63A8\u85A6" },
      { roleType: "trainer", order: 2, isRequired: false, purpose: "\u8AB2\u7A0B\u4ECB\u7D39\uFF0C\u5C08\u696D\u80CC\u66F8" },
      { roleType: "loyal_customer", order: 3, isRequired: true, purpose: "\u5B78\u54E1\u898B\u8B49" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u9700\u6C42\u5206\u6790",
        roleType: "education_consultant",
        triggerType: "message",
        messageTemplate: "\u60A8\u597D\uFF01\u8ACB\u554F\u60A8\u60F3\u5B78\u7FD2\u7684\u4E3B\u8981\u76EE\u6A19\u662F\u4EC0\u9EBC\uFF1F\u6211\u4F86\u5E6B\u60A8\u898F\u5283\u5B78\u7FD2\u8DEF\u5F91~",
        aiPrompt: "\u4E86\u89E3\u5B78\u7FD2\u76EE\u6A19\u548C\u73FE\u72C0\uFF0C\u63A8\u85A6\u5408\u9069\u8AB2\u7A0B"
      },
      {
        id: "stage_2",
        name: "\u8AB2\u7A0B\u4ECB\u7D39",
        roleType: "trainer",
        triggerType: "time",
        delaySeconds: 120,
        messageTemplate: "\u6211\u662F\u9019\u9580\u8AB2\u7684\u8B1B\u5E2B\uFF0C\u4F86\u7D66\u5927\u5BB6\u4ECB\u7D39\u4E00\u4E0B\u8AB2\u7A0B\u5167\u5BB9...",
        aiPrompt: "\u5C08\u696D\u4ECB\u7D39\u8AB2\u7A0B\u4EAE\u9EDE\u548C\u5B78\u7FD2\u6536\u76CA"
      },
      {
        id: "stage_3",
        name: "\u5B78\u54E1\u898B\u8B49",
        roleType: "loyal_customer",
        triggerType: "time",
        delaySeconds: 180,
        messageTemplate: "\u6211\u662F\u4E4B\u524D\u5B78\u904E\u9019\u9580\u8AB2\u7684\u5B78\u54E1\uFF0C\u5206\u4EAB\u4E00\u4E0B\u6211\u7684\u5B78\u7FD2\u7D93\u6B77...",
        aiPrompt: "\u771F\u5BE6\u5206\u4EAB\u5B78\u7FD2\u7D93\u6B77\u548C\u6536\u7A6B"
      }
    ],
    tips: [
      "\u5148\u4E86\u89E3\u9700\u6C42\u518D\u63A8\u8AB2\u7A0B",
      "\u8B1B\u5E2B\u80CC\u66F8\u589E\u52A0\u53EF\u4FE1\u5EA6",
      "\u5B78\u54E1\u898B\u8B49\u8981\u771F\u5BE6\u5177\u9AD4"
    ]
  },
  // Â†¥ÊôØ8: B2B‰ºÅÊ•≠Âêà‰Ωú
  {
    id: "scenario_b2b_cooperation",
    type: "b2b_cooperation",
    name: "B2B\u4F01\u696D\u5408\u4F5C",
    description: "\u5C08\u696D\u7684B2B\u5546\u52D9\u5408\u4F5C\u6D41\u7A0B",
    roles: [
      { roleType: "business_manager", order: 1, isRequired: true, purpose: "\u5408\u4F5C\u9080\u7D04" },
      { roleType: "solution_architect", order: 2, isRequired: true, purpose: "\u65B9\u6848\u8A2D\u8A08" },
      { roleType: "project_manager", order: 3, isRequired: false, purpose: "\u9805\u76EE\u63A8\u9032" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u5408\u4F5C\u9080\u7D04",
        roleType: "business_manager",
        triggerType: "manual",
        messageTemplate: "\u60A8\u597D\uFF0C\u6211\u662F{\u516C\u53F8}\u62DB\u5546\u7D93\u7406\u3002\u4E86\u89E3\u5230\u8CB4\u516C\u53F8\u5728{\u9818\u57DF}\u6709\u5F88\u597D\u7684\u8CC7\u6E90\uFF0C\u60F3\u63A2\u8A0E\u4E00\u4E0B\u5408\u4F5C\u6A5F\u6703...",
        aiPrompt: "\u5C08\u696D\u7684\u5546\u52D9\u9080\u7D04\uFF0C\u8868\u9054\u5408\u4F5C\u8AA0\u610F"
      },
      {
        id: "stage_2",
        name: "\u65B9\u6848\u8A2D\u8A08",
        roleType: "solution_architect",
        triggerType: "message",
        messageTemplate: "\u6839\u64DA\u8CB4\u516C\u53F8\u7684\u60C5\u6CC1\uFF0C\u6211\u5011\u8A2D\u8A08\u4E86\u9019\u6A23\u7684\u5408\u4F5C\u65B9\u6848...",
        aiPrompt: "\u8A2D\u8A08\u4E92\u5229\u5171\u8D0F\u7684\u5408\u4F5C\u65B9\u6848"
      },
      {
        id: "stage_3",
        name: "\u9805\u76EE\u63A8\u9032",
        roleType: "project_manager",
        triggerType: "message",
        messageTemplate: "\u5408\u4F5C\u65B9\u6848\u78BA\u8A8D\u5F8C\uFF0C\u6211\u6703\u8CA0\u8CAC\u9805\u76EE\u7684\u63A8\u9032\u548C\u843D\u5730...",
        aiPrompt: "\u660E\u78BA\u9805\u76EE\u8A08\u5283\u548C\u8CAC\u4EFB\u5206\u5DE5"
      }
    ],
    tips: [
      "B2B\u5408\u4F5C\u8981\u5C08\u696D\u6B63\u5F0F",
      "\u65B9\u6848\u8981\u9AD4\u73FE\u4E92\u5229\u5171\u8D0F",
      "\u9805\u76EE\u63A8\u9032\u8981\u6709\u660E\u78BA\u8A08\u5283"
    ]
  },
  // Â†¥ÊôØ9: Á´∂ÂìÅÁî®Êà∂ËΩâÂåñ
  {
    id: "scenario_competitor_conversion",
    type: "competitor_conversion",
    name: "\u7AF6\u54C1\u7528\u6236\u8F49\u5316",
    description: "\u901A\u904E\u75DB\u9EDE\u5171\u9CF4\u548C\u512A\u52E2\u5C0D\u6BD4\uFF0C\u5438\u5F15\u7AF6\u54C1\u7528\u6236\u8F49\u5316",
    roles: [
      { roleType: "competitor_analyst", order: 1, isRequired: true, purpose: "\u75DB\u9EDE\u5171\u9CF4\uFF0C\u512A\u52E2\u5C0D\u6BD4" },
      { roleType: "product_engineer", order: 2, isRequired: false, purpose: "\u6280\u8853\u512A\u52E2\u8B1B\u89E3" },
      { roleType: "sales_manager", order: 3, isRequired: true, purpose: "\u9077\u79FB\u512A\u60E0" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u75DB\u9EDE\u5171\u9CF4",
        roleType: "competitor_analyst",
        triggerType: "message",
        messageTemplate: "\u4E86\u89E3\u5230\u60A8\u4E4B\u524D\u7528\u904E{\u7AF6\u54C1}\uFF0C\u662F\u9047\u5230\u4E86\u4EC0\u9EBC\u554F\u984C\u55CE\uFF1F",
        aiPrompt: "\u4E86\u89E3\u7AF6\u54C1\u4F7F\u7528\u75DB\u9EDE\uFF0C\u8868\u9054\u7406\u89E3"
      },
      {
        id: "stage_2",
        name: "\u512A\u52E2\u5C0D\u6BD4",
        roleType: "product_engineer",
        triggerType: "time",
        delaySeconds: 120,
        messageTemplate: "\u5F9E\u6280\u8853\u89D2\u5EA6\u4F86\u8AAA\uFF0C\u6211\u5011\u7684\u7522\u54C1\u5728\u9019\u4E9B\u65B9\u9762\u6709\u512A\u52E2...",
        aiPrompt: "\u5BA2\u89C0\u5C0D\u6BD4\u6280\u8853\u512A\u52E2\uFF0C\u4E0D\u8CB6\u4F4E\u7AF6\u54C1"
      },
      {
        id: "stage_3",
        name: "\u9077\u79FB\u512A\u60E0",
        roleType: "sales_manager",
        triggerType: "message",
        messageTemplate: "\u70BA\u4E86\u5E6B\u52A9\u60A8\u9806\u5229\u9077\u79FB\uFF0C\u6211\u5011\u63D0\u4F9B\u5C08\u5C6C\u512A\u60E0\u548C\u9077\u79FB\u652F\u6301...",
        aiPrompt: "\u63D0\u4F9B\u9077\u79FB\u6FC0\u52F5\uFF0C\u964D\u4F4E\u9077\u79FB\u6210\u672C"
      }
    ],
    tips: [
      "\u4E0D\u8981\u8CB6\u4F4E\u7AF6\u54C1\uFF0C\u5BA2\u89C0\u5C0D\u6BD4",
      "\u91CD\u9EDE\u89E3\u6C7A\u7AF6\u54C1\u7684\u75DB\u9EDE",
      "\u63D0\u4F9B\u9077\u79FB\u652F\u6301\u964D\u4F4E\u9580\u6ABB"
    ]
  },
  // Â†¥ÊôØ10: ÊµÅÂ§±ÂÆ¢Êà∂ÊåΩÂõû
  {
    id: "scenario_churn_recovery",
    type: "churn_recovery",
    name: "\u6D41\u5931\u5BA2\u6236\u633D\u56DE",
    description: "\u901A\u904E\u95DC\u61F7\u56DE\u8A2A\u548C\u554F\u984C\u89E3\u6C7A\uFF0C\u633D\u56DE\u6D41\u5931\u5BA2\u6236",
    roles: [
      { roleType: "callback_agent", order: 1, isRequired: true, purpose: "\u95DC\u61F7\u56DE\u8A2A" },
      { roleType: "customer_success", order: 2, isRequired: true, purpose: "\u554F\u984C\u89E3\u6C7A" },
      { roleType: "regional_director", order: 3, isRequired: false, purpose: "\u7279\u5225\u633D\u7559" }
    ],
    stages: [
      {
        id: "stage_1",
        name: "\u95DC\u61F7\u56DE\u8A2A",
        roleType: "callback_agent",
        triggerType: "manual",
        messageTemplate: "{\u5BA2\u6236\u540D}\u60A8\u597D\uFF01\u597D\u4E45\u6C92\u806F\u7E6B\u4E86\uFF0C\u60F3\u95DC\u5FC3\u4E00\u4E0B\u60A8\u6700\u8FD1\u7684\u60C5\u6CC1...",
        aiPrompt: "\u771F\u8AA0\u95DC\u61F7\uFF0C\u4E86\u89E3\u96E2\u958B\u539F\u56E0"
      },
      {
        id: "stage_2",
        name: "\u554F\u984C\u89E3\u6C7A",
        roleType: "customer_success",
        triggerType: "message",
        messageTemplate: "\u611F\u8B1D\u60A8\u7684\u53CD\u994B\uFF01\u91DD\u5C0D\u60A8\u63D0\u5230\u7684\u554F\u984C\uFF0C\u6211\u5011\u5DF2\u7D93...",
        aiPrompt: "\u91DD\u5C0D\u6027\u89E3\u6C7A\u554F\u984C\uFF0C\u5C55\u793A\u6539\u9032"
      },
      {
        id: "stage_3",
        name: "\u7279\u5225\u633D\u7559",
        roleType: "regional_director",
        triggerType: "manual",
        messageTemplate: "\u4F5C\u70BA\u5340\u57DF\u7E3D\u76E3\uFF0C\u6211\u975E\u5E38\u91CD\u8996\u60A8\u7684\u53CD\u994B\u3002\u70BA\u8868\u8AA0\u610F\uFF0C\u6211\u5011\u6E96\u5099\u4E86...",
        aiPrompt: "\u9AD8\u5C64\u51FA\u9762\uFF0C\u63D0\u4F9B\u7279\u5225\u512A\u60E0"
      }
    ],
    tips: [
      "\u5148\u95DC\u5FC3\u518D\u8AC7\u56DE\u4F86",
      "\u8A8D\u771F\u5C0D\u5F85\u96E2\u958B\u539F\u56E0",
      "\u63D0\u4F9B\u6709\u8AA0\u610F\u7684\u633D\u7559\u65B9\u6848"
    ]
  }
];

// src/multi-role/components/scenario-selector.component.ts
var _forTrack05 = ($index, $item) => $item.id;
function ScenarioSelectorComponent_For_3_For_18_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 13);
    \u0275\u0275text(1);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const role_r4 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275domProperty("title", ctx_r2.getRoleLabel(role_r4.roleType));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.getRoleEmoji(role_r4.roleType), " ");
  }
}
function ScenarioSelectorComponent_For_3_Conditional_19_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 14);
    \u0275\u0275text(1);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const scenario_r2 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" +", scenario_r2.roles.length - 3, " ");
  }
}
function ScenarioSelectorComponent_For_3_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275domElementStart(0, "div", 4);
    \u0275\u0275domListener("click", function ScenarioSelectorComponent_For_3_Template_div_click_0_listener() {
      const scenario_r2 = \u0275\u0275restoreView(_r1).$implicit;
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectScenario(scenario_r2));
    });
    \u0275\u0275domElementStart(1, "div", 5)(2, "div", 6);
    \u0275\u0275text(3);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(4, "div")(5, "h3", 7);
    \u0275\u0275text(6);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(7, "div", 8)(8, "span");
    \u0275\u0275text(9);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(10, "span", 9);
    \u0275\u0275text(11, "\xB7");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(12, "span", 10);
    \u0275\u0275text(13);
    \u0275\u0275domElementEnd()()()();
    \u0275\u0275domElementStart(14, "p", 11);
    \u0275\u0275text(15);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(16, "div", 12);
    \u0275\u0275repeaterCreate(17, ScenarioSelectorComponent_For_3_For_18_Template, 2, 2, "div", 13, \u0275\u0275repeaterTrackByIndex);
    \u0275\u0275conditionalCreate(19, ScenarioSelectorComponent_For_3_Conditional_19_Template, 2, 1, "div", 14);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(20, "div", 15)(21, "span", 9);
    \u0275\u0275text(22, "\u6210\u529F\u7387");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(23, "span", 16);
    \u0275\u0275text(24);
    \u0275\u0275domElementEnd()()();
  }
  if (rf & 2) {
    let tmp_10_0;
    let tmp_11_0;
    const scenario_r2 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275classProp("ring-2", ((tmp_10_0 = ctx_r2.selectedScenario()) == null ? null : tmp_10_0.id) === scenario_r2.id)("ring-cyan-500", ((tmp_11_0 = ctx_r2.selectedScenario()) == null ? null : tmp_11_0.id) === scenario_r2.id);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ctx_r2.getScenarioMeta(scenario_r2.type).icon, " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", scenario_r2.name, " ");
    \u0275\u0275advance(2);
    \u0275\u0275classMap(ctx_r2.getDifficultyColor(ctx_r2.getScenarioMeta(scenario_r2.type).difficulty));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.getDifficultyLabel(ctx_r2.getScenarioMeta(scenario_r2.type).difficulty), " ");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(ctx_r2.getScenarioMeta(scenario_r2.type).duration);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r2.getScenarioMeta(scenario_r2.type).description, " ");
    \u0275\u0275advance(2);
    \u0275\u0275repeater(scenario_r2.roles.slice(0, 3));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(scenario_r2.roles.length > 3 ? 19 : -1);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(ctx_r2.getScenarioMeta(scenario_r2.type).successRate);
  }
}
function ScenarioSelectorComponent_Conditional_4_For_23_Conditional_6_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "span", 45);
    \u0275\u0275text(1, "\u5FC5\u9700");
    \u0275\u0275domElementEnd();
  }
}
function ScenarioSelectorComponent_Conditional_4_For_23_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 30)(1, "div", 42)(2, "span", 43);
    \u0275\u0275text(3);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(4, "span", 44);
    \u0275\u0275text(5);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(6, ScenarioSelectorComponent_Conditional_4_For_23_Conditional_6_Template, 2, 0, "span", 45);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(7, "p", 46);
    \u0275\u0275text(8);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const role_r6 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r2.getRoleEmoji(role_r6.roleType));
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r2.getRoleLabel(role_r6.roleType));
    \u0275\u0275advance();
    \u0275\u0275conditional(role_r6.isRequired ? 6 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(role_r6.purpose);
  }
}
function ScenarioSelectorComponent_Conditional_4_For_33_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "span", 51);
    \u0275\u0275text(1);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const stage_r7 = \u0275\u0275nextContext().$implicit;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate(ctx_r2.formatDelay(stage_r7.delaySeconds));
  }
}
function ScenarioSelectorComponent_Conditional_4_For_33_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "p", 53);
    \u0275\u0275text(1);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const stage_r7 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1("\u2713 ", stage_r7.successCondition);
  }
}
function ScenarioSelectorComponent_Conditional_4_For_33_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 34)(1, "div", 47);
    \u0275\u0275text(2);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "div", 48)(4, "div", 49)(5, "h4", 50);
    \u0275\u0275text(6);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(7, "div", 8)(8, "span", 10);
    \u0275\u0275text(9);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(10, ScenarioSelectorComponent_Conditional_4_For_33_Conditional_10_Template, 2, 1, "span", 51);
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(11, "p", 52);
    \u0275\u0275text(12);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(13, ScenarioSelectorComponent_Conditional_4_For_33_Conditional_13_Template, 2, 1, "p", 53);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const stage_r7 = ctx.$implicit;
    const \u0275$index_122_r8 = ctx.$index;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", \u0275$index_122_r8 + 1, " ");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(stage_r7.name);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate2("", ctx_r2.getRoleEmoji(stage_r7.roleType), " ", ctx_r2.getRoleLabel(stage_r7.roleType));
    \u0275\u0275advance();
    \u0275\u0275conditional(stage_r7.delaySeconds ? 10 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1('"', stage_r7.messageTemplate, '"');
    \u0275\u0275advance();
    \u0275\u0275conditional(stage_r7.successCondition ? 13 : -1);
  }
}
function ScenarioSelectorComponent_Conditional_4_For_41_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 36)(1, "span", 54);
    \u0275\u0275text(2, "\u2022");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "span");
    \u0275\u0275text(4);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const tip_r9 = ctx.$implicit;
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(tip_r9);
  }
}
function ScenarioSelectorComponent_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275domElementStart(0, "div", 17);
    \u0275\u0275domListener("click", function ScenarioSelectorComponent_Conditional_4_Template_div_click_0_listener() {
      \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectedScenario.set(null));
    });
    \u0275\u0275domElementStart(1, "div", 18);
    \u0275\u0275domListener("click", function ScenarioSelectorComponent_Conditional_4_Template_div_click_1_listener($event) {
      \u0275\u0275restoreView(_r5);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275domElementStart(2, "div", 19)(3, "div", 20)(4, "div", 21)(5, "div", 22);
    \u0275\u0275text(6);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(7, "div")(8, "h2", 23);
    \u0275\u0275text(9);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(10, "p", 10);
    \u0275\u0275text(11);
    \u0275\u0275domElementEnd()()();
    \u0275\u0275domElementStart(12, "button", 24);
    \u0275\u0275domListener("click", function ScenarioSelectorComponent_Conditional_4_Template_button_click_12_listener() {
      \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectedScenario.set(null));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275domElementStart(13, "svg", 25);
    \u0275\u0275domElement(14, "path", 26);
    \u0275\u0275domElementEnd()()()();
    \u0275\u0275namespaceHTML();
    \u0275\u0275domElementStart(15, "div", 27)(16, "div")(17, "h3", 28)(18, "span");
    \u0275\u0275text(19, "\u{1F465}");
    \u0275\u0275domElementEnd();
    \u0275\u0275text(20, " \u53C3\u8207\u89D2\u8272 ");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(21, "div", 29);
    \u0275\u0275repeaterCreate(22, ScenarioSelectorComponent_Conditional_4_For_23_Template, 9, 4, "div", 30, \u0275\u0275repeaterTrackByIndex);
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(24, "div")(25, "h3", 28)(26, "span");
    \u0275\u0275text(27, "\u{1F4CB}");
    \u0275\u0275domElementEnd();
    \u0275\u0275text(28, " \u6D41\u7A0B\u968E\u6BB5 ");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(29, "div", 31);
    \u0275\u0275domElement(30, "div", 32);
    \u0275\u0275domElementStart(31, "div", 33);
    \u0275\u0275repeaterCreate(32, ScenarioSelectorComponent_Conditional_4_For_33_Template, 14, 7, "div", 34, _forTrack05);
    \u0275\u0275domElementEnd()()();
    \u0275\u0275domElementStart(34, "div")(35, "h3", 28)(36, "span");
    \u0275\u0275text(37, "\u{1F4A1}");
    \u0275\u0275domElementEnd();
    \u0275\u0275text(38, " \u4F7F\u7528\u63D0\u793A ");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(39, "div", 35);
    \u0275\u0275repeaterCreate(40, ScenarioSelectorComponent_Conditional_4_For_41_Template, 5, 1, "div", 36, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275domElementEnd()()();
    \u0275\u0275domElementStart(42, "div", 37)(43, "button", 38);
    \u0275\u0275domListener("click", function ScenarioSelectorComponent_Conditional_4_Template_button_click_43_listener() {
      \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.selectedScenario.set(null));
    });
    \u0275\u0275text(44, " \u53D6\u6D88 ");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(45, "button", 39);
    \u0275\u0275domListener("click", function ScenarioSelectorComponent_Conditional_4_Template_button_click_45_listener() {
      const scenario_r10 = \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.applyScenario(scenario_r10));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275domElementStart(46, "svg", 40);
    \u0275\u0275domElement(47, "path", 41);
    \u0275\u0275domElementEnd();
    \u0275\u0275text(48, " \u61C9\u7528\u6B64\u5834\u666F ");
    \u0275\u0275domElementEnd()()()();
  }
  if (rf & 2) {
    const scenario_r10 = ctx;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance(6);
    \u0275\u0275textInterpolate1(" ", ctx_r2.getScenarioMeta(scenario_r10.type).icon, " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(scenario_r10.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(scenario_r10.description);
    \u0275\u0275advance(11);
    \u0275\u0275repeater(scenario_r10.roles);
    \u0275\u0275advance(10);
    \u0275\u0275repeater(scenario_r10.stages);
    \u0275\u0275advance(8);
    \u0275\u0275repeater(scenario_r10.tips);
  }
}
var ScenarioSelectorComponent = class _ScenarioSelectorComponent {
  constructor() {
    this.scenarioApplied = output();
    this.PRESET_SCENARIOS = PRESET_SCENARIOS;
    this.selectedScenario = signal(null, ...ngDevMode ? [{ debugName: "selectedScenario" }] : []);
  }
  selectScenario(scenario) {
    this.selectedScenario.set(scenario);
  }
  applyScenario(scenario) {
    this.scenarioApplied.emit(scenario);
    this.selectedScenario.set(null);
  }
  getScenarioMeta(type) {
    return SCENARIO_META[type];
  }
  getDifficultyColor(difficulty) {
    const colors = {
      "easy": "text-green-400",
      "medium": "text-yellow-400",
      "hard": "text-red-400"
    };
    return colors[difficulty] || "text-slate-400";
  }
  getDifficultyLabel(difficulty) {
    const labels = {
      "easy": "\u7C21\u55AE",
      "medium": "\u4E2D\u7B49",
      "hard": "\u56F0\u96E3"
    };
    return labels[difficulty] || difficulty;
  }
  getRoleEmoji(roleType) {
    const emojiMap = {
      "friendly_member": "\u{1F604}",
      "loyal_customer": "\u2764\uFE0F",
      "sales_manager": "\u{1F454}",
      "account_manager": "\u{1F4BC}",
      "price_specialist": "\u{1F4B0}",
      "regional_director": "\u{1F451}",
      "cs_agent": "\u{1F3A7}",
      "tech_support": "\u{1F527}",
      "complaint_handler": "\u{1F60A}",
      "vip_service": "\u2B50",
      "solution_expert": "\u{1F4CA}",
      "founder_ceo": "\u{1F454}",
      "community_manager": "\u{1F3E0}",
      "opinion_leader": "\u{1F3A4}",
      "brand_ambassador": "\u{1F3C6}",
      "tech_blogger": "\u{1F4F1}",
      "event_operator": "\u{1F389}",
      "education_consultant": "\u{1F4DA}",
      "trainer": "\u{1F468}\u200D\u{1F3EB}",
      "business_manager": "\u{1F91D}",
      "solution_architect": "\u{1F3D7}\uFE0F",
      "project_manager": "\u{1F4CB}",
      "competitor_analyst": "\u{1F50D}",
      "product_engineer": "\u2699\uFE0F",
      "callback_agent": "\u{1F4DE}",
      "customer_success": "\u{1F3AF}"
    };
    return emojiMap[roleType] || "\u{1F3AD}";
  }
  getRoleLabel(roleType) {
    const labelMap = {
      "friendly_member": "\u71B1\u5FC3\u7FA4\u53CB",
      "loyal_customer": "\u8001\u7528\u6236",
      "sales_manager": "\u92B7\u552E\u7D93\u7406",
      "account_manager": "\u5BA2\u6236\u7D93\u7406",
      "price_specialist": "\u50F9\u683C\u5C08\u54E1",
      "regional_director": "\u5340\u57DF\u7E3D\u76E3",
      "cs_agent": "\u5BA2\u670D\u5C08\u54E1",
      "tech_support": "\u6280\u8853\u652F\u6301",
      "complaint_handler": "\u6295\u8A34\u8655\u7406\u5C08\u54E1",
      "vip_service": "VIP\u5BA2\u670D",
      "solution_expert": "\u65B9\u6848\u5C08\u5BB6",
      "founder_ceo": "\u5275\u59CB\u4EBA",
      "community_manager": "\u793E\u7FA4\u7BA1\u5BB6",
      "opinion_leader": "\u610F\u898B\u9818\u8896",
      "brand_ambassador": "\u54C1\u724C\u5927\u4F7F",
      "tech_blogger": "\u79D1\u6280\u535A\u4E3B",
      "event_operator": "\u6D3B\u52D5\u904B\u71DF",
      "education_consultant": "\u6559\u80B2\u8AEE\u8A62\u5E2B",
      "trainer": "\u57F9\u8A13\u8B1B\u5E2B",
      "business_manager": "\u62DB\u5546\u7D93\u7406",
      "solution_architect": "\u89E3\u6C7A\u65B9\u6848\u67B6\u69CB\u5E2B",
      "project_manager": "\u9805\u76EE\u7D93\u7406",
      "competitor_analyst": "\u7AF6\u54C1\u5206\u6790\u5E2B",
      "product_engineer": "\u7522\u54C1\u5DE5\u7A0B\u5E2B",
      "callback_agent": "\u56DE\u8A2A\u5C08\u54E1",
      "customer_success": "\u5BA2\u6236\u6210\u529F\u7D93\u7406"
    };
    return labelMap[roleType] || roleType;
  }
  formatDelay(seconds) {
    if (seconds < 60) {
      return `${seconds}\u79D2\u5F8C`;
    } else if (seconds < 3600) {
      return `${Math.floor(seconds / 60)}\u5206\u9418\u5F8C`;
    } else if (seconds < 86400) {
      return `${Math.floor(seconds / 3600)}\u5C0F\u6642\u5F8C`;
    } else {
      return `${Math.floor(seconds / 86400)}\u5929\u5F8C`;
    }
  }
  static {
    this.\u0275fac = function ScenarioSelectorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _ScenarioSelectorComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _ScenarioSelectorComponent, selectors: [["app-scenario-selector"]], outputs: { scenarioApplied: "scenarioApplied" }, decls: 5, vars: 1, consts: [[1, "scenario-selector"], [1, "grid", "grid-cols-1", "md:grid-cols-2", "lg:grid-cols-3", "xl:grid-cols-5", "gap-4", "p-4"], [1, "bg-slate-800/50", "border", "border-slate-700/50", "rounded-xl", "p-4", "cursor-pointer", "hover:border-cyan-500/50", "hover:bg-slate-800", "transition-all", "group", 3, "ring-2", "ring-cyan-500"], [1, "fixed", "inset-0", "bg-black/70", "backdrop-blur-sm", "flex", "items-center", "justify-center", "z-50", "p-4"], [1, "bg-slate-800/50", "border", "border-slate-700/50", "rounded-xl", "p-4", "cursor-pointer", "hover:border-cyan-500/50", "hover:bg-slate-800", "transition-all", "group", 3, "click"], [1, "flex", "items-center", "gap-3", "mb-3"], [1, "w-12", "h-12", "rounded-full", "bg-gradient-to-br", "from-cyan-500/20", "to-blue-500/20", "flex", "items-center", "justify-center", "text-2xl"], [1, "font-semibold", "text-white", "group-hover:text-cyan-400", "transition-colors"], [1, "flex", "items-center", "gap-2", "text-xs"], [1, "text-slate-500"], [1, "text-slate-400"], [1, "text-sm", "text-slate-400", "mb-3", "line-clamp-2"], [1, "flex", "items-center", "gap-1", "mb-3"], [1, "w-7", "h-7", "rounded-full", "bg-slate-700/50", "flex", "items-center", "justify-center", "text-sm", 3, "title"], [1, "w-7", "h-7", "rounded-full", "bg-slate-700/50", "flex", "items-center", "justify-center", "text-xs", "text-slate-400"], [1, "flex", "items-center", "justify-between", "text-xs"], [1, "text-cyan-400", "font-medium"], [1, "fixed", "inset-0", "bg-black/70", "backdrop-blur-sm", "flex", "items-center", "justify-center", "z-50", "p-4", 3, "click"], [1, "bg-slate-900", "border", "border-slate-700/50", "rounded-2xl", "shadow-2xl", "w-full", "max-w-3xl", "max-h-[90vh]", "overflow-hidden", 3, "click"], [1, "p-6", "border-b", "border-slate-700/50", "bg-gradient-to-r", "from-cyan-500/10", "to-blue-500/10"], [1, "flex", "items-center", "justify-between"], [1, "flex", "items-center", "gap-4"], [1, "w-16", "h-16", "rounded-full", "bg-gradient-to-br", "from-cyan-500", "to-blue-500", "flex", "items-center", "justify-center", "text-3xl"], [1, "text-xl", "font-bold", "text-white"], [1, "text-slate-400", "hover:text-white", "p-2", "hover:bg-slate-800", "rounded-lg", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-6", "h-6"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M6 18L18 6M6 6l12 12"], [1, "p-6", "overflow-y-auto", "max-h-[60vh]", "space-y-6"], [1, "text-sm", "font-medium", "text-slate-400", "mb-3", "flex", "items-center", "gap-2"], [1, "grid", "grid-cols-1", "md:grid-cols-3", "gap-3"], [1, "bg-slate-800/50", "rounded-lg", "p-3"], [1, "relative"], [1, "absolute", "left-6", "top-8", "bottom-8", "w-0.5", "bg-slate-700"], [1, "space-y-4"], [1, "relative", "flex", "gap-4"], [1, "space-y-2"], [1, "flex", "items-start", "gap-2", "text-sm", "text-slate-300"], [1, "p-6", "border-t", "border-slate-700/50", "bg-slate-900/50", "flex", "justify-end", "gap-3"], [1, "px-6", "py-2.5", "bg-slate-700", "hover:bg-slate-600", "text-white", "rounded-lg", "transition-colors", 3, "click"], [1, "px-6", "py-2.5", "bg-gradient-to-r", "from-cyan-500", "to-blue-500", "hover:from-cyan-600", "hover:to-blue-600", "text-white", "font-medium", "rounded-lg", "transition-all", "flex", "items-center", "gap-2", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-5", "h-5"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M5 13l4 4L19 7"], [1, "flex", "items-center", "gap-2", "mb-2"], [1, "text-xl"], [1, "text-white", "font-medium"], [1, "text-xs", "bg-cyan-500/20", "text-cyan-400", "px-1.5", "py-0.5", "rounded"], [1, "text-xs", "text-slate-400"], [1, "relative", "z-10", "w-12", "h-12", "rounded-full", "bg-gradient-to-br", "from-cyan-500", "to-blue-500", "flex", "items-center", "justify-center", "text-white", "font-bold", "flex-shrink-0"], [1, "flex-1", "bg-slate-800/50", "rounded-lg", "p-4"], [1, "flex", "items-center", "justify-between", "mb-2"], [1, "font-medium", "text-white"], [1, "text-cyan-400"], [1, "text-sm", "text-slate-300", "italic"], [1, "text-xs", "text-green-400", "mt-2"], [1, "text-amber-400", "flex-shrink-0"]], template: function ScenarioSelectorComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275domElementStart(0, "div", 0)(1, "div", 1);
        \u0275\u0275repeaterCreate(2, ScenarioSelectorComponent_For_3_Template, 25, 13, "div", 2, _forTrack05);
        \u0275\u0275domElementEnd();
        \u0275\u0275conditionalCreate(4, ScenarioSelectorComponent_Conditional_4_Template, 49, 3, "div", 3);
        \u0275\u0275domElementEnd();
      }
      if (rf & 2) {
        let tmp_1_0;
        \u0275\u0275advance(2);
        \u0275\u0275repeater(ctx.PRESET_SCENARIOS);
        \u0275\u0275advance(2);
        \u0275\u0275conditional((tmp_1_0 = ctx.selectedScenario()) ? 4 : -1, tmp_1_0);
      }
    }, dependencies: [CommonModule], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(ScenarioSelectorComponent, [{
    type: Component,
    args: [{
      selector: "app-scenario-selector",
      standalone: true,
      imports: [CommonModule],
      template: `
    <div class="scenario-selector">
      <!-- \u5834\u666F\u5361\u7247\u7DB2\u683C -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 p-4">
        @for (scenario of PRESET_SCENARIOS; track scenario.id) {
          <div (click)="selectScenario(scenario)"
               [class.ring-2]="selectedScenario()?.id === scenario.id"
               [class.ring-cyan-500]="selectedScenario()?.id === scenario.id"
               class="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4 cursor-pointer 
                      hover:border-cyan-500/50 hover:bg-slate-800 transition-all group">
            <!-- \u5834\u666F\u5716\u6A19\u548C\u540D\u7A31 -->
            <div class="flex items-center gap-3 mb-3">
              <div class="w-12 h-12 rounded-full bg-gradient-to-br from-cyan-500/20 to-blue-500/20 
                          flex items-center justify-center text-2xl">
                {{ getScenarioMeta(scenario.type).icon }}
              </div>
              <div>
                <h3 class="font-semibold text-white group-hover:text-cyan-400 transition-colors">
                  {{ scenario.name }}
                </h3>
                <div class="flex items-center gap-2 text-xs">
                  <span [class]="getDifficultyColor(getScenarioMeta(scenario.type).difficulty)">
                    {{ getDifficultyLabel(getScenarioMeta(scenario.type).difficulty) }}
                  </span>
                  <span class="text-slate-500">\xB7</span>
                  <span class="text-slate-400">{{ getScenarioMeta(scenario.type).duration }}</span>
                </div>
              </div>
            </div>
            
            <!-- \u5834\u666F\u63CF\u8FF0 -->
            <p class="text-sm text-slate-400 mb-3 line-clamp-2">
              {{ getScenarioMeta(scenario.type).description }}
            </p>
            
            <!-- \u53C3\u8207\u89D2\u8272 -->
            <div class="flex items-center gap-1 mb-3">
              @for (role of scenario.roles.slice(0, 3); track $index) {
                <div class="w-7 h-7 rounded-full bg-slate-700/50 flex items-center justify-center text-sm"
                     [title]="getRoleLabel(role.roleType)">
                  {{ getRoleEmoji(role.roleType) }}
                </div>
              }
              @if (scenario.roles.length > 3) {
                <div class="w-7 h-7 rounded-full bg-slate-700/50 flex items-center justify-center text-xs text-slate-400">
                  +{{ scenario.roles.length - 3 }}
                </div>
              }
            </div>
            
            <!-- \u6210\u529F\u7387 -->
            <div class="flex items-center justify-between text-xs">
              <span class="text-slate-500">\u6210\u529F\u7387</span>
              <span class="text-cyan-400 font-medium">{{ getScenarioMeta(scenario.type).successRate }}</span>
            </div>
          </div>
        }
      </div>
      
      <!-- \u5834\u666F\u8A73\u60C5\u5F48\u7A97 -->
      @if (selectedScenario(); as scenario) {
        <div class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"
             (click)="selectedScenario.set(null)">
          <div class="bg-slate-900 border border-slate-700/50 rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden"
               (click)="$event.stopPropagation()">
            <!-- \u982D\u90E8 -->
            <div class="p-6 border-b border-slate-700/50 bg-gradient-to-r from-cyan-500/10 to-blue-500/10">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                  <div class="w-16 h-16 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 
                              flex items-center justify-center text-3xl">
                    {{ getScenarioMeta(scenario.type).icon }}
                  </div>
                  <div>
                    <h2 class="text-xl font-bold text-white">{{ scenario.name }}</h2>
                    <p class="text-slate-400">{{ scenario.description }}</p>
                  </div>
                </div>
                <button (click)="selectedScenario.set(null)"
                        class="text-slate-400 hover:text-white p-2 hover:bg-slate-800 rounded-lg">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>
            </div>
            
            <!-- \u5167\u5BB9\u5340 -->
            <div class="p-6 overflow-y-auto max-h-[60vh] space-y-6">
              <!-- \u89D2\u8272\u914D\u7F6E -->
              <div>
                <h3 class="text-sm font-medium text-slate-400 mb-3 flex items-center gap-2">
                  <span>\u{1F465}</span> \u53C3\u8207\u89D2\u8272
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                  @for (role of scenario.roles; track $index) {
                    <div class="bg-slate-800/50 rounded-lg p-3">
                      <div class="flex items-center gap-2 mb-2">
                        <span class="text-xl">{{ getRoleEmoji(role.roleType) }}</span>
                        <span class="text-white font-medium">{{ getRoleLabel(role.roleType) }}</span>
                        @if (role.isRequired) {
                          <span class="text-xs bg-cyan-500/20 text-cyan-400 px-1.5 py-0.5 rounded">\u5FC5\u9700</span>
                        }
                      </div>
                      <p class="text-xs text-slate-400">{{ role.purpose }}</p>
                    </div>
                  }
                </div>
              </div>
              
              <!-- \u6D41\u7A0B\u968E\u6BB5 -->
              <div>
                <h3 class="text-sm font-medium text-slate-400 mb-3 flex items-center gap-2">
                  <span>\u{1F4CB}</span> \u6D41\u7A0B\u968E\u6BB5
                </h3>
                <div class="relative">
                  <!-- \u9023\u63A5\u7DDA -->
                  <div class="absolute left-6 top-8 bottom-8 w-0.5 bg-slate-700"></div>
                  
                  <div class="space-y-4">
                    @for (stage of scenario.stages; track stage.id; let i = $index) {
                      <div class="relative flex gap-4">
                        <!-- \u5E8F\u865F -->
                        <div class="relative z-10 w-12 h-12 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 
                                    flex items-center justify-center text-white font-bold flex-shrink-0">
                          {{ i + 1 }}
                        </div>
                        
                        <!-- \u968E\u6BB5\u5167\u5BB9 -->
                        <div class="flex-1 bg-slate-800/50 rounded-lg p-4">
                          <div class="flex items-center justify-between mb-2">
                            <h4 class="font-medium text-white">{{ stage.name }}</h4>
                            <div class="flex items-center gap-2 text-xs">
                              <span class="text-slate-400">{{ getRoleEmoji(stage.roleType) }} {{ getRoleLabel(stage.roleType) }}</span>
                              @if (stage.delaySeconds) {
                                <span class="text-cyan-400">{{ formatDelay(stage.delaySeconds) }}</span>
                              }
                            </div>
                          </div>
                          <p class="text-sm text-slate-300 italic">"{{ stage.messageTemplate }}"</p>
                          @if (stage.successCondition) {
                            <p class="text-xs text-green-400 mt-2">\u2713 {{ stage.successCondition }}</p>
                          }
                        </div>
                      </div>
                    }
                  </div>
                </div>
              </div>
              
              <!-- \u4F7F\u7528\u63D0\u793A -->
              <div>
                <h3 class="text-sm font-medium text-slate-400 mb-3 flex items-center gap-2">
                  <span>\u{1F4A1}</span> \u4F7F\u7528\u63D0\u793A
                </h3>
                <div class="space-y-2">
                  @for (tip of scenario.tips; track tip) {
                    <div class="flex items-start gap-2 text-sm text-slate-300">
                      <span class="text-amber-400 flex-shrink-0">\u2022</span>
                      <span>{{ tip }}</span>
                    </div>
                  }
                </div>
              </div>
            </div>
            
            <!-- \u5E95\u90E8\u64CD\u4F5C -->
            <div class="p-6 border-t border-slate-700/50 bg-slate-900/50 flex justify-end gap-3">
              <button (click)="selectedScenario.set(null)"
                      class="px-6 py-2.5 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors">
                \u53D6\u6D88
              </button>
              <button (click)="applyScenario(scenario)"
                      class="px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600
                             text-white font-medium rounded-lg transition-all flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                \u61C9\u7528\u6B64\u5834\u666F
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  `
    }]
  }], null, { scenarioApplied: [{ type: Output, args: ["scenarioApplied"] }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(ScenarioSelectorComponent, { className: "ScenarioSelectorComponent", filePath: "src/multi-role/components/scenario-selector.component.ts", lineNumber: 211 });
})();

// src/components/workflow-config.component.ts
var _c02 = () => [2, 3, 4, 5];
var _forTrack06 = ($index, $item) => $item.id;
function WorkflowConfigComponent_Conditional_15_For_68_Template(rf, ctx) {
  if (rf & 1) {
    const _r3 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 37);
    \u0275\u0275listener("click", function WorkflowConfigComponent_Conditional_15_For_68_Template_button_click_0_listener() {
      const n_r4 = \u0275\u0275restoreView(_r3).$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.setRoleCount(n_r4));
    });
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const n_r4 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("bg-cyan-500", ctx_r1.workflowConfig().roleCount === n_r4)("text-white", ctx_r1.workflowConfig().roleCount === n_r4)("bg-slate-700", ctx_r1.workflowConfig().roleCount !== n_r4)("text-slate-300", ctx_r1.workflowConfig().roleCount !== n_r4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", n_r4, " ");
  }
}
function WorkflowConfigComponent_Conditional_15_For_86_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 38);
    \u0275\u0275listener("click", function WorkflowConfigComponent_Conditional_15_For_86_Template_button_click_0_listener() {
      const goal_r6 = \u0275\u0275restoreView(_r5).$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.setMarketingGoal(goal_r6.id));
    });
    \u0275\u0275elementStart(1, "div", 39);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 40);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 24);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const goal_r6 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275styleProp("border-color", ctx_r1.workflowConfig().marketingGoal !== goal_r6.id ? "var(--border-color)" : "")("background-color", ctx_r1.workflowConfig().marketingGoal !== goal_r6.id ? "var(--bg-secondary)" : "");
    \u0275\u0275classProp("border-cyan-500", ctx_r1.workflowConfig().marketingGoal === goal_r6.id)("bg-cyan-500/10", ctx_r1.workflowConfig().marketingGoal === goal_r6.id);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(goal_r6.icon);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(goal_r6.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(goal_r6.description);
  }
}
function WorkflowConfigComponent_Conditional_15_For_95_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r9 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 45)(1, "textarea", 46);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_For_95_Conditional_10_Template_textarea_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r9);
      const signal_r8 = \u0275\u0275nextContext().$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.updateSignalKeywords(signal_r8.id, $event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "p", 18);
    \u0275\u0275text(3, " \u7576\u7528\u6236\u6D88\u606F\u5305\u542B\u9019\u4E9B\u8A5E\u6642\uFF0C\u8B58\u5225\u70BA\u8208\u8DA3\u4FE1\u865F ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const signal_r8 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance();
    \u0275\u0275property("ngModel", signal_r8.keywords.join(", "));
  }
}
function WorkflowConfigComponent_Conditional_15_For_95_Template(rf, ctx) {
  if (rf & 1) {
    const _r7 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 32)(1, "div", 41)(2, "label", 20)(3, "input", 42);
    \u0275\u0275listener("change", function WorkflowConfigComponent_Conditional_15_For_95_Template_input_change_3_listener() {
      const signal_r8 = \u0275\u0275restoreView(_r7).$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.toggleSignal(signal_r8.id));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "span", 43);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "span", 40);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "button", 44);
    \u0275\u0275listener("click", function WorkflowConfigComponent_Conditional_15_For_95_Template_button_click_8_listener() {
      const signal_r8 = \u0275\u0275restoreView(_r7).$implicit;
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.toggleSignalExpand(signal_r8.id));
    });
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(10, WorkflowConfigComponent_Conditional_15_For_95_Conditional_10_Template, 4, 1, "div", 45);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const signal_r8 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(3);
    \u0275\u0275property("checked", signal_r8.enabled);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(signal_r8.icon);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(signal_r8.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r1.expandedSignals().has(signal_r8.id) ? "\u6536\u8D77" : "\u7DE8\u8F2F", " ");
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.expandedSignals().has(signal_r8.id) ? 10 : -1);
  }
}
function WorkflowConfigComponent_Conditional_15_For_119_Conditional_6_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 49);
    \u0275\u0275text(1, "\u2192");
    \u0275\u0275elementEnd();
  }
}
function WorkflowConfigComponent_Conditional_15_For_119_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 36)(1, "div", 47)(2, "div", 39);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 48);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(6, WorkflowConfigComponent_Conditional_15_For_119_Conditional_6_Template, 2, 0, "div", 49);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    let tmp_20_0;
    const step_r10 = ctx.$implicit;
    const \u0275$index_259_r11 = ctx.$index;
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275styleProp("background-color", \u0275$index_259_r11 !== 0 ? "var(--bg-secondary)" : "");
    \u0275\u0275classProp("bg-gradient-to-r", \u0275$index_259_r11 === 0)("from-cyan-500", \u0275$index_259_r11 === 0)("to-blue-500", \u0275$index_259_r11 === 0)("text-white", \u0275$index_259_r11 === 0);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.getStepIcon(step_r10.type));
    \u0275\u0275advance();
    \u0275\u0275styleProp("color", \u0275$index_259_r11 !== 0 ? "var(--text-primary)" : "");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate(step_r10.name);
    \u0275\u0275advance();
    \u0275\u0275conditional(\u0275$index_259_r11 < (((tmp_20_0 = ctx_r1.currentWorkflow()) == null ? null : tmp_20_0.steps == null ? null : tmp_20_0.steps.length) || 0) - 1 ? 6 : -1);
  }
}
function WorkflowConfigComponent_Conditional_15_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 8)(1, "div", 9)(2, "div", 10)(3, "h3", 11)(4, "span");
    \u0275\u0275text(5, "\u{1F3AF}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "span");
    \u0275\u0275text(7, "\u89F8\u767C\u689D\u4EF6");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(8, "div", 12)(9, "label", 13);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "input", 14);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_11_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateTriggerConfig("minIntentScore", $event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(12, "div", 15)(13, "span");
    \u0275\u0275text(14, "\u4F4E\u9580\u6ABB (30)");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "span");
    \u0275\u0275text(16, "\u9AD8\u9580\u6ABB (90)");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(17, "div", 12)(18, "label", 13);
    \u0275\u0275text(19, " \u540C\u7528\u6236\u51B7\u537B\u6642\u9593 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(20, "div", 16)(21, "input", 17);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_21_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateTriggerConfig("cooldownMinutes", $event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(22, "span", 5);
    \u0275\u0275text(23, "\u5206\u9418");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(24, "p", 18);
    \u0275\u0275text(25, " \u63A8\u85A6: 1440 \u5206\u9418 (24\u5C0F\u6642) ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(26, "div", 19)(27, "label", 20)(28, "input", 21);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_28_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateTriggerConfig("excludeContacted", $event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "span", 22);
    \u0275\u0275text(30, "\u6392\u9664\u5DF2\u806F\u7E6B\u7528\u6236");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(31, "label", 20)(32, "input", 21);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_32_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateTriggerConfig("excludeBlacklist", $event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(33, "span", 22);
    \u0275\u0275text(34, "\u6392\u9664\u9ED1\u540D\u55AE\u7528\u6236");
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(35, "div", 10)(36, "h3", 11)(37, "span");
    \u0275\u0275text(38, "\u23F1\uFE0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(39, "span");
    \u0275\u0275text(40, "\u57F7\u884C\u6642\u6A5F");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(41, "div", 12)(42, "label", 13);
    \u0275\u0275text(43, " \u9996\u6B21\u63A5\u89F8\u5EF6\u9072 (\u5206\u9418) ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(44, "div", 23)(45, "div")(46, "span", 24);
    \u0275\u0275text(47, "\u6700\u77ED");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(48, "input", 25);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_48_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateDelayConfig("min", $event));
    });
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(49, "div")(50, "span", 24);
    \u0275\u0275text(51, "\u6700\u9577");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(52, "input", 26);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_52_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateDelayConfig("max", $event));
    });
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(53, "p", 18);
    \u0275\u0275text(54, " \u7CFB\u7D71\u6703\u5728\u6B64\u7BC4\u570D\u5167\u96A8\u6A5F\u5EF6\u9072\uFF0C\u66F4\u81EA\u7136 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(55, "div", 10)(56, "h3", 11)(57, "span");
    \u0275\u0275text(58, "\u{1F3AD}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(59, "span");
    \u0275\u0275text(60, "\u89D2\u8272\u914D\u7F6E");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(61, "div", 12)(62, "label", 13);
    \u0275\u0275text(63, " \u53C3\u8207\u89D2\u8272\u6578\u91CF ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(64, "div", 27)(65, "button", 28);
    \u0275\u0275listener("click", function WorkflowConfigComponent_Conditional_15_Template_button_click_65_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.setRoleCount("auto"));
    });
    \u0275\u0275text(66, " \u{1F916} AI \u81EA\u52D5 ");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(67, WorkflowConfigComponent_Conditional_15_For_68_Template, 2, 9, "button", 29, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(69, "div")(70, "label", 13);
    \u0275\u0275text(71, " \u5E33\u865F\u9078\u64C7\u65B9\u5F0F ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(72, "div", 27)(73, "button", 28);
    \u0275\u0275listener("click", function WorkflowConfigComponent_Conditional_15_Template_button_click_73_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.setAccountSelection("auto"));
    });
    \u0275\u0275text(74, " \u{1F916} AI \u81EA\u52D5\u9078\u64C7 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(75, "button", 28);
    \u0275\u0275listener("click", function WorkflowConfigComponent_Conditional_15_Template_button_click_75_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.setAccountSelection("manual"));
    });
    \u0275\u0275text(76, " \u{1F464} \u624B\u52D5\u6307\u5B9A ");
    \u0275\u0275elementEnd()()()()();
    \u0275\u0275elementStart(77, "div", 9)(78, "div", 10)(79, "h3", 11)(80, "span");
    \u0275\u0275text(81, "\u{1F680}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(82, "span");
    \u0275\u0275text(83, "\u71DF\u92B7\u76EE\u6A19");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(84, "div", 23);
    \u0275\u0275repeaterCreate(85, WorkflowConfigComponent_Conditional_15_For_86_Template, 7, 11, "button", 30, _forTrack06);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(87, "div", 10)(88, "h3", 11)(89, "span");
    \u0275\u0275text(90, "\u{1F50D}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(91, "span");
    \u0275\u0275text(92, "\u8208\u8DA3\u4FE1\u865F\u8B58\u5225");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(93, "div", 31);
    \u0275\u0275repeaterCreate(94, WorkflowConfigComponent_Conditional_15_For_95_Template, 11, 5, "div", 32, _forTrack06);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(96, "div", 10)(97, "h3", 11)(98, "span");
    \u0275\u0275text(99, "\u{1F465}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(100, "span");
    \u0275\u0275text(101, "\u81EA\u52D5\u5EFA\u7FA4\u8A2D\u7F6E");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(102, "div", 12)(103, "label", 13);
    \u0275\u0275text(104, " \u7FA4\u7D44\u540D\u7A31\u6A21\u677F ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(105, "input", 33);
    \u0275\u0275listener("ngModelChange", function WorkflowConfigComponent_Conditional_15_Template_input_ngModelChange_105_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.updateWorkflowConfig("groupNameTemplate", $event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(106, "p", 18);
    \u0275\u0275text(107);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(108, "div", 32)(109, "p", 24);
    \u0275\u0275text(110, " \u{1F4A1} \u7576\u6AA2\u6E2C\u5230\u7528\u6236\u6709\u8CFC\u8CB7\u610F\u5411\u6642\uFF0C\u7CFB\u7D71\u6703\u81EA\u52D5\u5275\u5EFA VIP \u7FA4\u4E26\u9080\u8ACB\u7528\u6236\u52A0\u5165 ");
    \u0275\u0275elementEnd()()()()();
    \u0275\u0275elementStart(111, "div", 34)(112, "h3", 11)(113, "span");
    \u0275\u0275text(114, "\u{1F4CA}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(115, "span");
    \u0275\u0275text(116, "\u5DE5\u4F5C\u6D41\u9810\u89BD");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(117, "div", 35);
    \u0275\u0275repeaterCreate(118, WorkflowConfigComponent_Conditional_15_For_119_Template, 7, 15, "div", 36, _forTrack06);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    let tmp_26_0;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275textInterpolate1(" \u6700\u4F4E\u610F\u5411\u5206 (", ctx_r1.triggerConfig().minIntentScore, ") ");
    \u0275\u0275advance();
    \u0275\u0275property("ngModel", ctx_r1.triggerConfig().minIntentScore);
    \u0275\u0275advance(10);
    \u0275\u0275property("ngModel", ctx_r1.triggerConfig().cooldownMinutes);
    \u0275\u0275advance(7);
    \u0275\u0275property("ngModel", ctx_r1.triggerConfig().excludeContacted);
    \u0275\u0275advance(4);
    \u0275\u0275property("ngModel", ctx_r1.triggerConfig().excludeBlacklist);
    \u0275\u0275advance(16);
    \u0275\u0275property("ngModel", ctx_r1.workflowConfig().firstContactDelay.min);
    \u0275\u0275advance(4);
    \u0275\u0275property("ngModel", ctx_r1.workflowConfig().firstContactDelay.max);
    \u0275\u0275advance(13);
    \u0275\u0275classProp("bg-cyan-500", ctx_r1.workflowConfig().roleCount === "auto")("text-white", ctx_r1.workflowConfig().roleCount === "auto")("bg-slate-700", ctx_r1.workflowConfig().roleCount !== "auto")("text-slate-300", ctx_r1.workflowConfig().roleCount !== "auto");
    \u0275\u0275advance(2);
    \u0275\u0275repeater(\u0275\u0275pureFunction0(37, _c02));
    \u0275\u0275advance(6);
    \u0275\u0275classProp("bg-cyan-500", ctx_r1.workflowConfig().accountSelection === "auto")("text-white", ctx_r1.workflowConfig().accountSelection === "auto")("bg-slate-700", ctx_r1.workflowConfig().accountSelection !== "auto")("text-slate-300", ctx_r1.workflowConfig().accountSelection !== "auto");
    \u0275\u0275advance(2);
    \u0275\u0275classProp("bg-cyan-500", ctx_r1.workflowConfig().accountSelection === "manual")("text-white", ctx_r1.workflowConfig().accountSelection === "manual")("bg-slate-700", ctx_r1.workflowConfig().accountSelection !== "manual")("text-slate-300", ctx_r1.workflowConfig().accountSelection !== "manual");
    \u0275\u0275advance(10);
    \u0275\u0275repeater(ctx_r1.marketingGoals);
    \u0275\u0275advance(9);
    \u0275\u0275repeater(ctx_r1.interestSignals());
    \u0275\u0275advance(11);
    \u0275\u0275property("ngModel", ctx_r1.workflowConfig().groupNameTemplate || ctx_r1.groupNameDefault)("placeholder", ctx_r1.groupNameDefault);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate4(" \u53EF\u7528\u8B8A\u91CF: ", "{", "user", "}", " = \u7528\u6236\u540D, ", "{", "date", "}", " = \u65E5\u671F ");
    \u0275\u0275advance(11);
    \u0275\u0275repeater((tmp_26_0 = ctx_r1.currentWorkflow()) == null ? null : tmp_26_0.steps);
  }
}
function WorkflowConfigComponent_Conditional_16_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 7)(1, "span", 50);
    \u0275\u0275text(2, "\u2699\uFE0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p");
    \u0275\u0275text(4, "\u7121\u53EF\u7528\u5DE5\u4F5C\u6D41");
    \u0275\u0275elementEnd()();
  }
}
var WorkflowConfigComponent = class _WorkflowConfigComponent {
  constructor() {
    this.workflowService = inject(AutomationWorkflowService);
    this.toast = inject(ToastService);
    this.ipc = inject(ElectronIpcService);
    this.currentWorkflow = computed(() => this.workflowService.workflows()[0], ...ngDevMode ? [{ debugName: "currentWorkflow" }] : []);
    this.triggerConfig = computed(() => this.currentWorkflow()?.trigger || {
      minIntentScore: 60,
      cooldownMinutes: 1440,
      excludeContacted: true,
      excludeBlacklist: true
    }, ...ngDevMode ? [{ debugName: "triggerConfig" }] : []);
    this.workflowConfig = computed(() => this.currentWorkflow()?.config || {
      marketingGoal: "\u4FC3\u9032\u6210\u4EA4",
      roleCount: "auto",
      accountSelection: "auto",
      firstContactDelay: { min: 5, max: 15 },
      interestSignals: [],
      groupNameTemplate: "VIP \u670D\u52D9\u7FA4 - {user}"
    }, ...ngDevMode ? [{ debugName: "workflowConfig" }] : []);
    this.marketingGoals = [
      { id: "\u4FC3\u9032\u6210\u4EA4", name: "\u4FC3\u9032\u6210\u4EA4", icon: "\u{1F4B0}", description: "\u5F15\u5C0E\u7528\u6236\u8CFC\u8CB7\u7522\u54C1" },
      { id: "\u54C1\u724C\u63A8\u5EE3", name: "\u54C1\u724C\u63A8\u5EE3", icon: "\u{1F4E2}", description: "\u63D0\u5347\u54C1\u724C\u77E5\u540D\u5EA6" },
      { id: "\u7528\u6236\u57F9\u80B2", name: "\u7528\u6236\u57F9\u80B2", icon: "\u{1F331}", description: "\u5EFA\u7ACB\u4FE1\u4EFB\u95DC\u4FC2" },
      { id: "\u6536\u96C6\u53CD\u994B", name: "\u6536\u96C6\u53CD\u994B", icon: "\u{1F4CB}", description: "\u4E86\u89E3\u7528\u6236\u9700\u6C42" }
    ];
    this.interestSignals = signal([
      { id: "price_inquiry", name: "\u50F9\u683C\u8A62\u554F", icon: "\u{1F4B0}", keywords: ["\u591A\u5C11\u9322", "\u4EC0\u9EBC\u50F9\u683C", "\u50F9\u683C", "\u8CBB\u7528", "\u6536\u8CBB"], enabled: true },
      { id: "product_detail", name: "\u7522\u54C1\u7D30\u7BC0", icon: "\u{1F4E6}", keywords: ["\u600E\u9EBC\u7528", "\u6709\u4EC0\u9EBC\u529F\u80FD", "\u8A73\u7D30\u4ECB\u7D39", "\u4E86\u89E3\u4E00\u4E0B"], enabled: true },
      { id: "purchase_intent", name: "\u8CFC\u8CB7\u610F\u5411", icon: "\u{1F6D2}", keywords: ["\u600E\u9EBC\u8CB7", "\u5728\u54EA\u8CB7", "\u6211\u8981", "\u6211\u60F3\u8CB7", "\u4E0B\u55AE"], enabled: true },
      { id: "positive_feedback", name: "\u6B63\u9762\u53CD\u994B", icon: "\u{1F44D}", keywords: ["\u4E0D\u932F", "\u633A\u597D", "\u53EF\u4EE5", "\u884C", "\u611F\u8208\u8DA3"], enabled: true },
      { id: "comparison", name: "\u6BD4\u8F03\u8AEE\u8A62", icon: "\u2696\uFE0F", keywords: ["\u6BD4", "\u5C0D\u6BD4", "\u5340\u5225", "\u5DEE\u5225", "\u54EA\u500B\u597D"], enabled: false }
    ], ...ngDevMode ? [{ debugName: "interestSignals" }] : []);
    this.expandedSignals = signal(/* @__PURE__ */ new Set(), ...ngDevMode ? [{ debugName: "expandedSignals" }] : []);
    this.groupNameDefault = "VIP \u670D\u52D9\u7FA4 - {user}";
    this.localTriggerConfig = signal({}, ...ngDevMode ? [{ debugName: "localTriggerConfig" }] : []);
    this.localWorkflowConfig = signal({}, ...ngDevMode ? [{ debugName: "localWorkflowConfig" }] : []);
  }
  ngOnInit() {
    const workflow = this.currentWorkflow();
    if (workflow) {
      this.localTriggerConfig.set(__spreadValues({}, workflow.trigger));
      this.localWorkflowConfig.set(__spreadValues({}, workflow.config));
      this.loadInterestSignals(workflow.config.interestSignals || []);
    }
  }
  ngOnDestroy() {
  }
  // ËºâÂÖ•ËààË∂£‰ø°ËôüÈÖçÁΩÆ
  loadInterestSignals(enabledIds) {
    this.interestSignals.update((signals) => signals.map((s) => __spreadProps(__spreadValues({}, s), {
      enabled: enabledIds.length === 0 || enabledIds.includes(s.id)
    })));
  }
  // Êõ¥Êñ∞Ëß∏ÁôºÈÖçÁΩÆ
  updateTriggerConfig(key, value) {
    this.localTriggerConfig.update((config) => __spreadProps(__spreadValues({}, config), {
      [key]: value
    }));
  }
  // Êõ¥Êñ∞Âª∂ÈÅ≤ÈÖçÁΩÆ
  updateDelayConfig(key, value) {
    this.localWorkflowConfig.update((config) => __spreadProps(__spreadValues({}, config), {
      firstContactDelay: __spreadProps(__spreadValues({}, config.firstContactDelay), {
        [key]: value
      })
    }));
  }
  // Êõ¥Êñ∞Â∑•‰ΩúÊµÅÈÖçÁΩÆ
  updateWorkflowConfig(key, value) {
    this.localWorkflowConfig.update((config) => __spreadProps(__spreadValues({}, config), {
      [key]: value
    }));
  }
  // Ë®≠ÁΩÆËßíËâ≤Êï∏Èáè
  setRoleCount(count) {
    this.updateWorkflowConfig("roleCount", count);
  }
  // Ë®≠ÁΩÆÂ∏≥ËôüÈÅ∏ÊìáÊñπÂºè
  setAccountSelection(mode) {
    this.updateWorkflowConfig("accountSelection", mode);
  }
  // Ë®≠ÁΩÆÁáüÈä∑ÁõÆÊ®ô
  setMarketingGoal(goal) {
    this.updateWorkflowConfig("marketingGoal", goal);
  }
  // ÂàáÊèõ‰ø°ËôüÂïüÁî®
  toggleSignal(id) {
    this.interestSignals.update((signals) => signals.map((s) => s.id === id ? __spreadProps(__spreadValues({}, s), { enabled: !s.enabled }) : s));
  }
  // ÂàáÊèõ‰ø°ËôüÂ±ïÈñã
  toggleSignalExpand(id) {
    this.expandedSignals.update((set) => {
      const newSet = new Set(set);
      if (newSet.has(id)) {
        newSet.delete(id);
      } else {
        newSet.add(id);
      }
      return newSet;
    });
  }
  // Êõ¥Êñ∞‰ø°ËôüÈóúÈçµË©û
  updateSignalKeywords(id, value) {
    const keywords = value.split(",").map((k) => k.trim()).filter((k) => k);
    this.interestSignals.update((signals) => signals.map((s) => s.id === id ? __spreadProps(__spreadValues({}, s), { keywords }) : s));
  }
  // ‰øùÂ≠òÈÖçÁΩÆ
  saveConfig() {
    const workflow = this.currentWorkflow();
    if (!workflow)
      return;
    const enabledSignals = this.interestSignals().filter((s) => s.enabled).map((s) => s.id);
    const config = {
      workflowId: workflow.id,
      trigger: this.localTriggerConfig(),
      config: __spreadProps(__spreadValues({}, this.localWorkflowConfig()), {
        interestSignals: enabledSignals
      }),
      interestSignalKeywords: this.interestSignals().reduce((acc, s) => {
        acc[s.id] = s.keywords;
        return acc;
      }, {})
    };
    console.log("[WorkflowConfig] \u4FDD\u5B58\u914D\u7F6E:", config);
    try {
      localStorage.setItem("workflowConfig", JSON.stringify(config));
      this.toast.success("\u2705 \u5DE5\u4F5C\u6D41\u914D\u7F6E\u5DF2\u4FDD\u5B58");
    } catch (e) {
      this.toast.error("\u4FDD\u5B58\u5931\u6557");
    }
  }
  // Áç≤ÂèñÊ≠•È©üÂúñÊ®ô
  getStepIcon(stepType) {
    const icons = {
      "evaluate": "\u{1F4CA}",
      "plan": "\u{1F3AF}",
      "private_chat": "\u{1F4AC}",
      "detect_interest": "\u{1F50D}",
      "create_group": "\u{1F465}",
      "group_marketing": "\u{1F680}",
      "record": "\u{1F4DD}"
    };
    return icons[stepType] || "\u25B6\uFE0F";
  }
  static {
    this.\u0275fac = function WorkflowConfigComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _WorkflowConfigComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _WorkflowConfigComponent, selectors: [["app-workflow-config"]], decls: 17, vars: 1, consts: [[1, "workflow-config"], [1, "flex", "items-center", "justify-between", "mb-6"], [1, "flex", "items-center", "gap-3"], [1, "text-3xl"], [1, "text-xl", "font-bold", 2, "color", "var(--text-primary)"], [1, "text-sm", 2, "color", "var(--text-muted)"], [1, "px-4", "py-2", "bg-gradient-to-r", "from-cyan-500", "to-blue-500", "hover:from-cyan-600", "hover:to-blue-600", "text-white", "rounded-lg", "font-medium", "transition-all", "flex", "items-center", "gap-2", 3, "click"], [1, "text-center", "py-12", 2, "color", "var(--text-muted)"], [1, "grid", "grid-cols-1", "lg:grid-cols-2", "gap-6"], [1, "space-y-6"], [1, "rounded-xl", "p-5", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)"], [1, "text-lg", "font-bold", "mb-4", "flex", "items-center", "gap-2", 2, "color", "var(--text-primary)"], [1, "mb-4"], [1, "block", "text-sm", "font-medium", "mb-2", 2, "color", "var(--text-secondary)"], ["type", "range", "min", "30", "max", "90", "step", "5", 1, "w-full", "h-2", "rounded-lg", "appearance-none", "cursor-pointer", 2, "background", "linear-gradient(to right, var(--success), var(--warning), var(--error))", 3, "ngModelChange", "ngModel"], [1, "flex", "justify-between", "text-xs", "mt-1", 2, "color", "var(--text-muted)"], [1, "flex", "items-center", "gap-2"], ["type", "number", "min", "60", "max", "10080", 1, "flex-1", "px-3", "py-2", "rounded-lg", "border", "text-sm", 2, "background-color", "var(--bg-secondary)", "border-color", "var(--border-color)", "color", "var(--text-primary)", 3, "ngModelChange", "ngModel"], [1, "text-xs", "mt-1", 2, "color", "var(--text-muted)"], [1, "space-y-2"], [1, "flex", "items-center", "gap-2", "cursor-pointer"], ["type", "checkbox", 1, "w-4", "h-4", "rounded", "accent-cyan-500", 3, "ngModelChange", "ngModel"], [1, "text-sm", 2, "color", "var(--text-secondary)"], [1, "grid", "grid-cols-2", "gap-3"], [1, "text-xs", 2, "color", "var(--text-muted)"], ["type", "number", "min", "1", "max", "60", 1, "w-full", "px-3", "py-2", "rounded-lg", "border", "text-sm", 2, "background-color", "var(--bg-secondary)", "border-color", "var(--border-color)", "color", "var(--text-primary)", 3, "ngModelChange", "ngModel"], ["type", "number", "min", "1", "max", "120", 1, "w-full", "px-3", "py-2", "rounded-lg", "border", "text-sm", 2, "background-color", "var(--bg-secondary)", "border-color", "var(--border-color)", "color", "var(--text-primary)", 3, "ngModelChange", "ngModel"], [1, "flex", "gap-2"], [1, "flex-1", "px-3", "py-2", "rounded-lg", "text-sm", "font-medium", "transition-colors", 3, "click"], [1, "px-3", "py-2", "rounded-lg", "text-sm", "font-medium", "transition-colors", 3, "bg-cyan-500", "text-white", "bg-slate-700", "text-slate-300"], [1, "p-3", "rounded-lg", "text-left", "transition-all", "border", 3, "border-cyan-500", "bg-cyan-500/10", "border-color", "background-color"], [1, "space-y-3"], [1, "p-3", "rounded-lg", 2, "background-color", "var(--bg-secondary)"], ["type", "text", 1, "w-full", "px-3", "py-2", "rounded-lg", "border", "text-sm", 2, "background-color", "var(--bg-secondary)", "border-color", "var(--border-color)", "color", "var(--text-primary)", 3, "ngModelChange", "ngModel", "placeholder"], [1, "mt-6", "rounded-xl", "p-5", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)"], [1, "flex", "items-center", "justify-center", "gap-2", "overflow-x-auto", "py-4"], [1, "flex", "items-center"], [1, "px-3", "py-2", "rounded-lg", "text-sm", "font-medium", "transition-colors", 3, "click"], [1, "p-3", "rounded-lg", "text-left", "transition-all", "border", 3, "click"], [1, "text-xl", "mb-1"], [1, "font-medium", "text-sm", 2, "color", "var(--text-primary)"], [1, "flex", "items-center", "justify-between", "mb-2"], ["type", "checkbox", 1, "w-4", "h-4", "rounded", "accent-cyan-500", 3, "change", "checked"], [1, "text-lg"], [1, "text-xs", "px-2", "py-1", "rounded", 2, "color", "var(--text-muted)", 3, "click"], [1, "mt-2"], ["rows", "2", "placeholder", "\u7528\u9017\u865F\u5206\u9694\u95DC\u9375\u8A5E", 1, "w-full", "px-3", "py-2", "rounded-lg", "border", "text-sm", 2, "background-color", "var(--bg-tertiary)", "border-color", "var(--border-color)", "color", "var(--text-primary)", 3, "ngModelChange", "ngModel"], [1, "px-4", "py-3", "rounded-lg", "text-center", "min-w-[100px]", "transition-all"], [1, "text-sm", "font-medium"], [1, "mx-2", "text-xl", 2, "color", "var(--text-muted)"], [1, "text-4xl", "block", "mb-4"]], template: function WorkflowConfigComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "span", 3);
        \u0275\u0275text(4, "\u2699\uFE0F");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(5, "div")(6, "h2", 4);
        \u0275\u0275text(7, "\u5DE5\u4F5C\u6D41\u914D\u7F6E");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "p", 5);
        \u0275\u0275text(9, "\u81EA\u5B9A\u7FA9\u81EA\u52D5\u5316\u71DF\u92B7\u6D41\u7A0B");
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(10, "button", 6);
        \u0275\u0275listener("click", function WorkflowConfigComponent_Template_button_click_10_listener() {
          return ctx.saveConfig();
        });
        \u0275\u0275elementStart(11, "span");
        \u0275\u0275text(12, "\u{1F4BE}");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(13, "span");
        \u0275\u0275text(14, "\u4FDD\u5B58\u914D\u7F6E");
        \u0275\u0275elementEnd()()();
        \u0275\u0275conditionalCreate(15, WorkflowConfigComponent_Conditional_15_Template, 120, 38)(16, WorkflowConfigComponent_Conditional_16_Template, 5, 0, "div", 7);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275advance(15);
        \u0275\u0275conditional(ctx.currentWorkflow() ? 15 : 16);
      }
    }, dependencies: [CommonModule, FormsModule, DefaultValueAccessor, NumberValueAccessor, RangeValueAccessor, CheckboxControlValueAccessor, NgControlStatus, MinValidator, MaxValidator, NgModel], styles: ["\n\n.workflow-config[_ngcontent-%COMP%] {\n  padding: 1.5rem;\n}\ninput[type=range][_ngcontent-%COMP%] {\n  -webkit-appearance: none;\n}\ninput[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  width: 18px;\n  height: 18px;\n  border-radius: 50%;\n  background: white;\n  cursor: pointer;\n  border: 2px solid var(--primary);\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);\n}\n/*# sourceMappingURL=workflow-config.component.css.map */"] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(WorkflowConfigComponent, [{
    type: Component,
    args: [{ selector: "app-workflow-config", standalone: true, imports: [CommonModule, FormsModule], template: `
    <div class="workflow-config">
      <!-- \u6A19\u984C -->
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <span class="text-3xl">\u2699\uFE0F</span>
          <div>
            <h2 class="text-xl font-bold" style="color: var(--text-primary);">\u5DE5\u4F5C\u6D41\u914D\u7F6E</h2>
            <p class="text-sm" style="color: var(--text-muted);">\u81EA\u5B9A\u7FA9\u81EA\u52D5\u5316\u71DF\u92B7\u6D41\u7A0B</p>
          </div>
        </div>
        <button (click)="saveConfig()" 
                class="px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white rounded-lg font-medium transition-all flex items-center gap-2">
          <span>\u{1F4BE}</span>
          <span>\u4FDD\u5B58\u914D\u7F6E</span>
        </button>
      </div>
      
      @if (currentWorkflow()) {
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- \u5DE6\u5074\uFF1A\u89F8\u767C\u689D\u4EF6 -->
          <div class="space-y-6">
            <!-- \u{1F3AF} \u89F8\u767C\u689D\u4EF6 -->
            <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
              <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
                <span>\u{1F3AF}</span>
                <span>\u89F8\u767C\u689D\u4EF6</span>
              </h3>
              
              <!-- \u6700\u4F4E\u610F\u5411\u5206 -->
              <div class="mb-4">
                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">
                  \u6700\u4F4E\u610F\u5411\u5206 ({{ triggerConfig().minIntentScore }})
                </label>
                <input type="range" 
                       [ngModel]="triggerConfig().minIntentScore"
                       (ngModelChange)="updateTriggerConfig('minIntentScore', $event)"
                       min="30" max="90" step="5"
                       class="w-full h-2 rounded-lg appearance-none cursor-pointer"
                       style="background: linear-gradient(to right, var(--success), var(--warning), var(--error));">
                <div class="flex justify-between text-xs mt-1" style="color: var(--text-muted);">
                  <span>\u4F4E\u9580\u6ABB (30)</span>
                  <span>\u9AD8\u9580\u6ABB (90)</span>
                </div>
              </div>
              
              <!-- \u51B7\u537B\u6642\u9593 -->
              <div class="mb-4">
                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">
                  \u540C\u7528\u6236\u51B7\u537B\u6642\u9593
                </label>
                <div class="flex items-center gap-2">
                  <input type="number" 
                         [ngModel]="triggerConfig().cooldownMinutes"
                         (ngModelChange)="updateTriggerConfig('cooldownMinutes', $event)"
                         min="60" max="10080"
                         class="flex-1 px-3 py-2 rounded-lg border text-sm"
                         style="background-color: var(--bg-secondary); border-color: var(--border-color); color: var(--text-primary);">
                  <span class="text-sm" style="color: var(--text-muted);">\u5206\u9418</span>
                </div>
                <p class="text-xs mt-1" style="color: var(--text-muted);">
                  \u63A8\u85A6: 1440 \u5206\u9418 (24\u5C0F\u6642)
                </p>
              </div>
              
              <!-- \u6392\u9664\u9078\u9805 -->
              <div class="space-y-2">
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="checkbox" 
                         [ngModel]="triggerConfig().excludeContacted"
                         (ngModelChange)="updateTriggerConfig('excludeContacted', $event)"
                         class="w-4 h-4 rounded accent-cyan-500">
                  <span class="text-sm" style="color: var(--text-secondary);">\u6392\u9664\u5DF2\u806F\u7E6B\u7528\u6236</span>
                </label>
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="checkbox" 
                         [ngModel]="triggerConfig().excludeBlacklist"
                         (ngModelChange)="updateTriggerConfig('excludeBlacklist', $event)"
                         class="w-4 h-4 rounded accent-cyan-500">
                  <span class="text-sm" style="color: var(--text-secondary);">\u6392\u9664\u9ED1\u540D\u55AE\u7528\u6236</span>
                </label>
              </div>
            </div>
            
            <!-- \u23F1\uFE0F \u57F7\u884C\u6642\u6A5F -->
            <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
              <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
                <span>\u23F1\uFE0F</span>
                <span>\u57F7\u884C\u6642\u6A5F</span>
              </h3>
              
              <!-- \u9996\u6B21\u63A5\u89F8\u5EF6\u9072 -->
              <div class="mb-4">
                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">
                  \u9996\u6B21\u63A5\u89F8\u5EF6\u9072 (\u5206\u9418)
                </label>
                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <span class="text-xs" style="color: var(--text-muted);">\u6700\u77ED</span>
                    <input type="number" 
                           [ngModel]="workflowConfig().firstContactDelay.min"
                           (ngModelChange)="updateDelayConfig('min', $event)"
                           min="1" max="60"
                           class="w-full px-3 py-2 rounded-lg border text-sm"
                           style="background-color: var(--bg-secondary); border-color: var(--border-color); color: var(--text-primary);">
                  </div>
                  <div>
                    <span class="text-xs" style="color: var(--text-muted);">\u6700\u9577</span>
                    <input type="number" 
                           [ngModel]="workflowConfig().firstContactDelay.max"
                           (ngModelChange)="updateDelayConfig('max', $event)"
                           min="1" max="120"
                           class="w-full px-3 py-2 rounded-lg border text-sm"
                           style="background-color: var(--bg-secondary); border-color: var(--border-color); color: var(--text-primary);">
                  </div>
                </div>
                <p class="text-xs mt-1" style="color: var(--text-muted);">
                  \u7CFB\u7D71\u6703\u5728\u6B64\u7BC4\u570D\u5167\u96A8\u6A5F\u5EF6\u9072\uFF0C\u66F4\u81EA\u7136
                </p>
              </div>
            </div>
            
            <!-- \u{1F3AD} \u89D2\u8272\u914D\u7F6E -->
            <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
              <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
                <span>\u{1F3AD}</span>
                <span>\u89D2\u8272\u914D\u7F6E</span>
              </h3>
              
              <!-- \u89D2\u8272\u6578\u91CF -->
              <div class="mb-4">
                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">
                  \u53C3\u8207\u89D2\u8272\u6578\u91CF
                </label>
                <div class="flex gap-2">
                  <button (click)="setRoleCount('auto')"
                          class="flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                          [class.bg-cyan-500]="workflowConfig().roleCount === 'auto'"
                          [class.text-white]="workflowConfig().roleCount === 'auto'"
                          [class.bg-slate-700]="workflowConfig().roleCount !== 'auto'"
                          [class.text-slate-300]="workflowConfig().roleCount !== 'auto'">
                    \u{1F916} AI \u81EA\u52D5
                  </button>
                  @for (n of [2, 3, 4, 5]; track n) {
                    <button (click)="setRoleCount(n)"
                            class="px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                            [class.bg-cyan-500]="workflowConfig().roleCount === n"
                            [class.text-white]="workflowConfig().roleCount === n"
                            [class.bg-slate-700]="workflowConfig().roleCount !== n"
                            [class.text-slate-300]="workflowConfig().roleCount !== n">
                      {{ n }}
                    </button>
                  }
                </div>
              </div>
              
              <!-- \u5E33\u865F\u9078\u64C7\u65B9\u5F0F -->
              <div>
                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">
                  \u5E33\u865F\u9078\u64C7\u65B9\u5F0F
                </label>
                <div class="flex gap-2">
                  <button (click)="setAccountSelection('auto')"
                          class="flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                          [class.bg-cyan-500]="workflowConfig().accountSelection === 'auto'"
                          [class.text-white]="workflowConfig().accountSelection === 'auto'"
                          [class.bg-slate-700]="workflowConfig().accountSelection !== 'auto'"
                          [class.text-slate-300]="workflowConfig().accountSelection !== 'auto'">
                    \u{1F916} AI \u81EA\u52D5\u9078\u64C7
                  </button>
                  <button (click)="setAccountSelection('manual')"
                          class="flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                          [class.bg-cyan-500]="workflowConfig().accountSelection === 'manual'"
                          [class.text-white]="workflowConfig().accountSelection === 'manual'"
                          [class.bg-slate-700]="workflowConfig().accountSelection !== 'manual'"
                          [class.text-slate-300]="workflowConfig().accountSelection !== 'manual'">
                    \u{1F464} \u624B\u52D5\u6307\u5B9A
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- \u53F3\u5074\uFF1A\u71DF\u92B7\u914D\u7F6E -->
          <div class="space-y-6">
            <!-- \u{1F680} \u71DF\u92B7\u76EE\u6A19 -->
            <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
              <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
                <span>\u{1F680}</span>
                <span>\u71DF\u92B7\u76EE\u6A19</span>
              </h3>
              
              <div class="grid grid-cols-2 gap-3">
                @for (goal of marketingGoals; track goal.id) {
                  <button (click)="setMarketingGoal(goal.id)"
                          class="p-3 rounded-lg text-left transition-all border"
                          [class.border-cyan-500]="workflowConfig().marketingGoal === goal.id"
                          [class.bg-cyan-500/10]="workflowConfig().marketingGoal === goal.id"
                          [style.border-color]="workflowConfig().marketingGoal !== goal.id ? 'var(--border-color)' : ''"
                          [style.background-color]="workflowConfig().marketingGoal !== goal.id ? 'var(--bg-secondary)' : ''">
                    <div class="text-xl mb-1">{{ goal.icon }}</div>
                    <div class="font-medium text-sm" style="color: var(--text-primary);">{{ goal.name }}</div>
                    <div class="text-xs" style="color: var(--text-muted);">{{ goal.description }}</div>
                  </button>
                }
              </div>
            </div>
            
            <!-- \u{1F50D} \u8208\u8DA3\u4FE1\u865F -->
            <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
              <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
                <span>\u{1F50D}</span>
                <span>\u8208\u8DA3\u4FE1\u865F\u8B58\u5225</span>
              </h3>
              
              <div class="space-y-3">
                @for (signal of interestSignals(); track signal.id) {
                  <div class="p-3 rounded-lg" style="background-color: var(--bg-secondary);">
                    <div class="flex items-center justify-between mb-2">
                      <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" 
                               [checked]="signal.enabled"
                               (change)="toggleSignal(signal.id)"
                               class="w-4 h-4 rounded accent-cyan-500">
                        <span class="text-lg">{{ signal.icon }}</span>
                        <span class="font-medium text-sm" style="color: var(--text-primary);">{{ signal.name }}</span>
                      </label>
                      <button (click)="toggleSignalExpand(signal.id)"
                              class="text-xs px-2 py-1 rounded"
                              style="color: var(--text-muted);">
                        {{ expandedSignals().has(signal.id) ? '\u6536\u8D77' : '\u7DE8\u8F2F' }}
                      </button>
                    </div>
                    
                    @if (expandedSignals().has(signal.id)) {
                      <div class="mt-2">
                        <textarea [ngModel]="signal.keywords.join(', ')"
                                  (ngModelChange)="updateSignalKeywords(signal.id, $event)"
                                  rows="2"
                                  class="w-full px-3 py-2 rounded-lg border text-sm"
                                  style="background-color: var(--bg-tertiary); border-color: var(--border-color); color: var(--text-primary);"
                                  placeholder="\u7528\u9017\u865F\u5206\u9694\u95DC\u9375\u8A5E"></textarea>
                        <p class="text-xs mt-1" style="color: var(--text-muted);">
                          \u7576\u7528\u6236\u6D88\u606F\u5305\u542B\u9019\u4E9B\u8A5E\u6642\uFF0C\u8B58\u5225\u70BA\u8208\u8DA3\u4FE1\u865F
                        </p>
                      </div>
                    }
                  </div>
                }
              </div>
            </div>
            
            <!-- \u{1F465} \u5EFA\u7FA4\u8A2D\u7F6E -->
            <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
              <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
                <span>\u{1F465}</span>
                <span>\u81EA\u52D5\u5EFA\u7FA4\u8A2D\u7F6E</span>
              </h3>
              
              <div class="mb-4">
                <label class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">
                  \u7FA4\u7D44\u540D\u7A31\u6A21\u677F
                </label>
                <input type="text" 
                       [ngModel]="workflowConfig().groupNameTemplate || groupNameDefault"
                       (ngModelChange)="updateWorkflowConfig('groupNameTemplate', $event)"
                       class="w-full px-3 py-2 rounded-lg border text-sm"
                       style="background-color: var(--bg-secondary); border-color: var(--border-color); color: var(--text-primary);"
                       [placeholder]="groupNameDefault">
                <p class="text-xs mt-1" style="color: var(--text-muted);">
                  \u53EF\u7528\u8B8A\u91CF: {{ '{' }}user{{ '}' }} = \u7528\u6236\u540D, {{ '{' }}date{{ '}' }} = \u65E5\u671F
                </p>
              </div>
              
              <div class="p-3 rounded-lg" style="background-color: var(--bg-secondary);">
                <p class="text-xs" style="color: var(--text-muted);">
                  \u{1F4A1} \u7576\u6AA2\u6E2C\u5230\u7528\u6236\u6709\u8CFC\u8CB7\u610F\u5411\u6642\uFF0C\u7CFB\u7D71\u6703\u81EA\u52D5\u5275\u5EFA VIP \u7FA4\u4E26\u9080\u8ACB\u7528\u6236\u52A0\u5165
                </p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- \u5DE5\u4F5C\u6D41\u9810\u89BD -->
        <div class="mt-6 rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
            <span>\u{1F4CA}</span>
            <span>\u5DE5\u4F5C\u6D41\u9810\u89BD</span>
          </h3>
          
          <div class="flex items-center justify-center gap-2 overflow-x-auto py-4">
            @for (step of currentWorkflow()?.steps; track step.id; let i = $index) {
              <div class="flex items-center">
                <div class="px-4 py-3 rounded-lg text-center min-w-[100px] transition-all"
                     [class.bg-gradient-to-r]="i === 0"
                     [class.from-cyan-500]="i === 0"
                     [class.to-blue-500]="i === 0"
                     [class.text-white]="i === 0"
                     [style.background-color]="i !== 0 ? 'var(--bg-secondary)' : ''">
                  <div class="text-xl mb-1">{{ getStepIcon(step.type) }}</div>
                  <div class="text-sm font-medium" [style.color]="i !== 0 ? 'var(--text-primary)' : ''">{{ step.name }}</div>
                </div>
                @if (i < (currentWorkflow()?.steps?.length || 0) - 1) {
                  <div class="mx-2 text-xl" style="color: var(--text-muted);">\u2192</div>
                }
              </div>
            }
          </div>
        </div>
      } @else {
        <div class="text-center py-12" style="color: var(--text-muted);">
          <span class="text-4xl block mb-4">\u2699\uFE0F</span>
          <p>\u7121\u53EF\u7528\u5DE5\u4F5C\u6D41</p>
        </div>
      }
    </div>
  `, styles: ["/* angular:styles/component:css;323317427a9c66efb06d20554802dcde3e9320c5683188001e1f00a1f7dfd291;D:/tgkz2026/src/components/workflow-config.component.ts */\n.workflow-config {\n  padding: 1.5rem;\n}\ninput[type=range] {\n  -webkit-appearance: none;\n}\ninput[type=range]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  width: 18px;\n  height: 18px;\n  border-radius: 50%;\n  background: white;\n  cursor: pointer;\n  border: 2px solid var(--primary);\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);\n}\n/*# sourceMappingURL=workflow-config.component.css.map */\n"] }]
  }], null, null);
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(WorkflowConfigComponent, { className: "WorkflowConfigComponent", filePath: "src/components/workflow-config.component.ts", lineNumber: 380 });
})();

// src/components/workflow-monitor.component.ts
var _forTrack07 = ($index, $item) => $item.id;
function WorkflowMonitorComponent_For_34_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 15);
    \u0275\u0275domElement(1, "div", 20);
    \u0275\u0275domElementStart(2, "div", 21)(3, "div", 22);
    \u0275\u0275text(4);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(5, "div", 9);
    \u0275\u0275text(6);
    \u0275\u0275domElementEnd()()();
  }
  if (rf & 2) {
    const stage_r1 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275styleProp("height", stage_r1.percentage, "%")("background", stage_r1.gradient);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(stage_r1.count);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(stage_r1.name);
  }
}
function WorkflowMonitorComponent_For_37_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    const _r3 = \u0275\u0275getCurrentView();
    \u0275\u0275domElementStart(0, "button", 38);
    \u0275\u0275domListener("click", function WorkflowMonitorComponent_For_37_Conditional_13_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r3);
      const execution_r4 = \u0275\u0275nextContext().$implicit;
      const ctx_r4 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r4.cancelExecution(execution_r4.id));
    });
    \u0275\u0275text(1, " \u2715 ");
    \u0275\u0275domElementEnd();
  }
}
function WorkflowMonitorComponent_For_37_For_16_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0, " \u2713 ");
  }
}
function WorkflowMonitorComponent_For_37_For_16_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0);
  }
  if (rf & 2) {
    const \u0275$index_100_r6 = \u0275\u0275nextContext().$index;
    \u0275\u0275textInterpolate1(" ", \u0275$index_100_r6 + 1, " ");
  }
}
function WorkflowMonitorComponent_For_37_For_16_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElement(0, "div", 41);
  }
  if (rf & 2) {
    const step_r7 = \u0275\u0275nextContext().$implicit;
    const execution_r4 = \u0275\u0275nextContext().$implicit;
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275classProp("bg-emerald-500", ctx_r4.isStepCompleted(execution_r4, step_r7.id))("bg-slate-600", !ctx_r4.isStepCompleted(execution_r4, step_r7.id));
  }
}
function WorkflowMonitorComponent_For_37_For_16_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 31)(1, "div", 39);
    \u0275\u0275conditionalCreate(2, WorkflowMonitorComponent_For_37_For_16_Conditional_2_Template, 1, 0)(3, WorkflowMonitorComponent_For_37_For_16_Conditional_3_Template, 1, 1);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(4, WorkflowMonitorComponent_For_37_For_16_Conditional_4_Template, 1, 4, "div", 40);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const step_r7 = ctx.$implicit;
    const \u0275$index_100_r6 = ctx.$index;
    const execution_r4 = \u0275\u0275nextContext().$implicit;
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-emerald-500", ctx_r4.isStepCompleted(execution_r4, step_r7.id))("bg-cyan-500", execution_r4.currentStep === step_r7.id && execution_r4.status === "running")("animate-pulse", execution_r4.currentStep === step_r7.id && execution_r4.status === "running")("bg-slate-600", !ctx_r4.isStepCompleted(execution_r4, step_r7.id) && execution_r4.currentStep !== step_r7.id);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r4.isStepCompleted(execution_r4, step_r7.id) ? 2 : 3);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(\u0275$index_100_r6 < ctx_r4.getWorkflowSteps().length - 1 ? 4 : -1);
  }
}
function WorkflowMonitorComponent_For_37_Conditional_22_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "span", 35);
    \u0275\u0275text(1);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const execution_r4 = \u0275\u0275nextContext().$implicit;
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r4.getStepResultSummary(execution_r4), " ");
  }
}
function WorkflowMonitorComponent_For_37_Conditional_23_For_5_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 45)(1, "span", 46);
    \u0275\u0275text(2);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "span");
    \u0275\u0275text(4);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const step_r8 = \u0275\u0275nextContext().$implicit;
    const execution_r4 = \u0275\u0275nextContext(2).$implicit;
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(step_r8.name);
    \u0275\u0275advance();
    \u0275\u0275classProp("text-emerald-400", execution_r4.stepResults[step_r8.id].status === "success")("text-red-400", execution_r4.stepResults[step_r8.id].status === "failed")("text-slate-400", execution_r4.stepResults[step_r8.id].status === "skipped");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r4.getStepStatusText(execution_r4.stepResults[step_r8.id].status), " ");
  }
}
function WorkflowMonitorComponent_For_37_Conditional_23_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275conditionalCreate(0, WorkflowMonitorComponent_For_37_Conditional_23_For_5_Conditional_0_Template, 5, 8, "div", 45);
  }
  if (rf & 2) {
    const step_r8 = ctx.$implicit;
    const execution_r4 = \u0275\u0275nextContext(2).$implicit;
    \u0275\u0275conditional(execution_r4.stepResults[step_r8.id] ? 0 : -1);
  }
}
function WorkflowMonitorComponent_For_37_Conditional_23_Conditional_6_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 44)(1, "span", 33);
    \u0275\u0275text(2, "AI \u7B56\u7565\uFF1A");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "span", 46);
    \u0275\u0275text(4);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const execution_r4 = \u0275\u0275nextContext(2).$implicit;
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(execution_r4.aiPlanResult.strategy || "\u6A19\u6E96\u71DF\u92B7");
  }
}
function WorkflowMonitorComponent_For_37_Conditional_23_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 36)(1, "h4", 42);
    \u0275\u0275text(2, "\u57F7\u884C\u8A73\u60C5");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "div", 43);
    \u0275\u0275repeaterCreate(4, WorkflowMonitorComponent_For_37_Conditional_23_For_5_Template, 1, 1, null, null, _forTrack07);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(6, WorkflowMonitorComponent_For_37_Conditional_23_Conditional_6_Template, 5, 1, "div", 44);
    \u0275\u0275domElementEnd();
  }
  if (rf & 2) {
    const execution_r4 = \u0275\u0275nextContext().$implicit;
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r4.getWorkflowSteps());
    \u0275\u0275advance(2);
    \u0275\u0275conditional(execution_r4.aiPlanResult ? 6 : -1);
  }
}
function WorkflowMonitorComponent_For_37_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275domElementStart(0, "div", 23)(1, "div", 24)(2, "div", 25)(3, "span", 26);
    \u0275\u0275text(4);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(5, "div")(6, "div", 27);
    \u0275\u0275text(7);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(8, "div", 9);
    \u0275\u0275text(9);
    \u0275\u0275domElementEnd()()();
    \u0275\u0275domElementStart(10, "div", 25)(11, "div", 28);
    \u0275\u0275text(12);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(13, WorkflowMonitorComponent_For_37_Conditional_13_Template, 2, 0, "button", 29);
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(14, "div", 30);
    \u0275\u0275repeaterCreate(15, WorkflowMonitorComponent_For_37_For_16_Template, 5, 10, "div", 31, _forTrack07);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(17, "div", 32)(18, "span", 33);
    \u0275\u0275text(19, "\u7576\u524D\uFF1A");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(20, "span", 34);
    \u0275\u0275text(21);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(22, WorkflowMonitorComponent_For_37_Conditional_22_Template, 2, 1, "span", 35);
    \u0275\u0275domElementEnd();
    \u0275\u0275conditionalCreate(23, WorkflowMonitorComponent_For_37_Conditional_23_Template, 7, 1, "div", 36);
    \u0275\u0275domElementStart(24, "button", 37);
    \u0275\u0275domListener("click", function WorkflowMonitorComponent_For_37_Template_button_click_24_listener() {
      const execution_r4 = \u0275\u0275restoreView(_r2).$implicit;
      const ctx_r4 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r4.toggleExpand(execution_r4.id));
    });
    \u0275\u0275text(25);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const execution_r4 = ctx.$implicit;
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275classProp("border-cyan-500", execution_r4.status === "running")("border-l-4", execution_r4.status === "running");
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(ctx_r4.getStatusIcon(execution_r4.status));
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" @", execution_r4.targetUserName, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r4.formatTime(execution_r4.startedAt), " ");
    \u0275\u0275advance(2);
    \u0275\u0275styleProp("background-color", ctx_r4.getConversionColor(execution_r4));
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r4.getConversionProbability(execution_r4), "% \u8F49\u5316 ");
    \u0275\u0275advance();
    \u0275\u0275conditional(execution_r4.status === "running" || execution_r4.status === "pending" ? 13 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275repeater(ctx_r4.getWorkflowSteps());
    \u0275\u0275advance(6);
    \u0275\u0275textInterpolate(ctx_r4.getCurrentStepName(execution_r4));
    \u0275\u0275advance();
    \u0275\u0275conditional((execution_r4.stepResults[execution_r4.currentStep] == null ? null : execution_r4.stepResults[execution_r4.currentStep].data) ? 22 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r4.expandedExecution() === execution_r4.id ? 23 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r4.expandedExecution() === execution_r4.id ? "\u6536\u8D77 \u25B2" : "\u8A73\u60C5 \u25BC", " ");
  }
}
function WorkflowMonitorComponent_ForEmpty_38_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 18)(1, "span", 47);
    \u0275\u0275text(2, "\u{1F3AF}");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "p");
    \u0275\u0275text(4, "\u66AB\u7121\u9032\u884C\u4E2D\u7684\u5DE5\u4F5C\u6D41");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(5, "p", 48);
    \u0275\u0275text(6, "\u7576\u76E3\u63A7\u7FA4\u7D44\u89F8\u767C\u95DC\u9375\u8A5E\u6642\uFF0C\u5DE5\u4F5C\u6D41\u5C07\u81EA\u52D5\u958B\u59CB");
    \u0275\u0275domElementEnd()();
  }
}
function WorkflowMonitorComponent_Conditional_39_For_20_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "tr", 53)(1, "td", 54);
    \u0275\u0275text(2);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "td", 55)(4, "span", 56);
    \u0275\u0275text(5);
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(6, "td", 57);
    \u0275\u0275text(7);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(8, "td", 57);
    \u0275\u0275text(9);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const execution_r9 = ctx.$implicit;
    const ctx_r4 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("@", execution_r9.targetUserName);
    \u0275\u0275advance(2);
    \u0275\u0275classProp("bg-emerald-500/20", execution_r9.outcome === "converted")("text-emerald-400", execution_r9.outcome === "converted")("bg-amber-500/20", execution_r9.outcome === "interested")("text-amber-400", execution_r9.outcome === "interested")("bg-slate-500/20", !execution_r9.outcome || execution_r9.outcome === "neutral")("text-slate-400", !execution_r9.outcome || execution_r9.outcome === "neutral");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r4.getOutcomeText(execution_r9.outcome), " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r4.getDuration(execution_r9));
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r4.formatTime(execution_r9.completedAt));
  }
}
function WorkflowMonitorComponent_Conditional_39_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 19)(1, "h3", 13)(2, "span");
    \u0275\u0275text(3, "\u2705");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(4, "span");
    \u0275\u0275text(5, "\u8FD1\u671F\u5B8C\u6210");
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(6, "div", 49)(7, "table", 50)(8, "thead")(9, "tr", 51)(10, "th", 52);
    \u0275\u0275text(11, "\u7528\u6236");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(12, "th", 52);
    \u0275\u0275text(13, "\u7D50\u679C");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(14, "th", 52);
    \u0275\u0275text(15, "\u8017\u6642");
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(16, "th", 52);
    \u0275\u0275text(17, "\u5B8C\u6210\u6642\u9593");
    \u0275\u0275domElementEnd()()();
    \u0275\u0275domElementStart(18, "tbody");
    \u0275\u0275repeaterCreate(19, WorkflowMonitorComponent_Conditional_39_For_20_Template, 10, 16, "tr", 53, _forTrack07);
    \u0275\u0275domElementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r4 = \u0275\u0275nextContext();
    \u0275\u0275advance(19);
    \u0275\u0275repeater(ctx_r4.completedExecutions().slice(0, 5));
  }
}
var WorkflowMonitorComponent = class _WorkflowMonitorComponent {
  constructor() {
    this.workflowService = inject(AutomationWorkflowService);
    this.toast = inject(ToastService);
    this.expandedExecution = signal(null, ...ngDevMode ? [{ debugName: "expandedExecution" }] : []);
    this.executions = this.workflowService.executions;
    this.activeExecutions = computed(() => this.executions().filter((e) => e.status === "running" || e.status === "pending"), ...ngDevMode ? [{ debugName: "activeExecutions" }] : []);
    this.completedExecutions = computed(() => this.executions().filter((e) => e.status === "completed" || e.status === "failed"), ...ngDevMode ? [{ debugName: "completedExecutions" }] : []);
    this.runningCount = computed(() => this.executions().filter((e) => e.status === "running").length, ...ngDevMode ? [{ debugName: "runningCount" }] : []);
    this.pendingCount = computed(() => this.executions().filter((e) => e.status === "pending").length, ...ngDevMode ? [{ debugName: "pendingCount" }] : []);
    this.completedTodayCount = computed(() => {
      const today = (/* @__PURE__ */ new Date()).toDateString();
      return this.executions().filter((e) => e.status === "completed" && e.completedAt && new Date(e.completedAt).toDateString() === today).length;
    }, ...ngDevMode ? [{ debugName: "completedTodayCount" }] : []);
    this.funnelStages = computed(() => {
      const all = this.executions();
      const total = all.length || 1;
      const triggered = all.length;
      const planned = all.filter((e) => e.stepResults["plan"]?.status === "success").length;
      const chatted = all.filter((e) => e.stepResults["private_chat"]?.status === "success").length;
      const interested = all.filter((e) => e.stepResults["detect_interest"]?.status === "success").length;
      const converted = all.filter((e) => e.outcome === "converted").length;
      return [
        { id: "triggered", name: "\u89F8\u767C", count: triggered, percentage: 100, gradient: "linear-gradient(to top, #6366f1, #8b5cf6)" },
        { id: "planned", name: "\u7B56\u5283", count: planned, percentage: planned / total * 100, gradient: "linear-gradient(to top, #3b82f6, #6366f1)" },
        { id: "chatted", name: "\u79C1\u804A", count: chatted, percentage: chatted / total * 100, gradient: "linear-gradient(to top, #06b6d4, #3b82f6)" },
        { id: "interested", name: "\u8208\u8DA3", count: interested, percentage: interested / total * 100, gradient: "linear-gradient(to top, #10b981, #06b6d4)" },
        { id: "converted", name: "\u8F49\u5316", count: converted, percentage: converted / total * 100, gradient: "linear-gradient(to top, #22c55e, #10b981)" }
      ];
    }, ...ngDevMode ? [{ debugName: "funnelStages" }] : []);
    this.workflowSteps = [
      { id: "evaluate", name: "\u8A55\u4F30" },
      { id: "plan", name: "AI\u7B56\u5283" },
      { id: "private_chat", name: "\u79C1\u804A" },
      { id: "detect_interest", name: "\u8208\u8DA3" },
      { id: "create_group", name: "\u5EFA\u7FA4" },
      { id: "group_marketing", name: "\u71DF\u92B7" },
      { id: "record", name: "\u8A18\u9304" }
    ];
  }
  ngOnInit() {
  }
  ngOnDestroy() {
  }
  // Áç≤ÂèñÂ∑•‰ΩúÊµÅÊ≠•È©ü
  getWorkflowSteps() {
    return this.workflowSteps;
  }
  // Ê≠•È©üÊòØÂê¶ÂÆåÊàê
  isStepCompleted(execution, stepId) {
    return execution.stepResults[stepId]?.status === "success";
  }
  // Áç≤ÂèñÁï∂ÂâçÊ≠•È©üÂêçÁ®±
  getCurrentStepName(execution) {
    const step = this.workflowSteps.find((s) => s.id === execution.currentStep);
    return step?.name || execution.currentStep;
  }
  // Áç≤ÂèñÁãÄÊÖãÂúñÊ®ô
  getStatusIcon(status) {
    const icons = {
      "running": "\u{1F504}",
      "pending": "\u23F3",
      "completed": "\u2705",
      "failed": "\u274C",
      "cancelled": "\u{1F6AB}",
      "paused": "\u23F8\uFE0F"
    };
    return icons[status] || "\u2753";
  }
  // Áç≤ÂèñÊ≠•È©üÁãÄÊÖãÊñáÊú¨
  getStepStatusText(status) {
    const texts = {
      "success": "\u2713 \u5B8C\u6210",
      "failed": "\u2717 \u5931\u6557",
      "skipped": "- \u8DF3\u904E"
    };
    return texts[status] || status;
  }
  // Áç≤ÂèñÁµêÊûúÊëòË¶Å
  getStepResultSummary(execution) {
    const result = execution.stepResults[execution.currentStep];
    if (!result?.data)
      return "";
    if (result.data.type) {
      return `\u4FE1\u865F: ${result.data.type}`;
    }
    return "";
  }
  // Áç≤ÂèñËΩâÂåñÊ¶ÇÁéá
  getConversionProbability(execution) {
    return Math.round(this.workflowService.calculateConversionProbability(execution) * 100);
  }
  // Áç≤ÂèñËΩâÂåñÊ¶ÇÁéáÈ°èËâ≤
  getConversionColor(execution) {
    const prob = this.workflowService.calculateConversionProbability(execution);
    if (prob >= 0.7)
      return "#22c55e";
    if (prob >= 0.5)
      return "#f59e0b";
    return "#6b7280";
  }
  // Áç≤ÂèñÁµêÊûúÊñáÊú¨
  getOutcomeText(outcome) {
    const texts = {
      "converted": "\u5DF2\u8F49\u5316",
      "interested": "\u6709\u8208\u8DA3",
      "neutral": "\u4E2D\u6027",
      "rejected": "\u62D2\u7D55",
      "no_response": "\u7121\u97FF\u61C9"
    };
    return texts[outcome || ""] || "\u9032\u884C\u4E2D";
  }
  // Ë®àÁÆóËÄóÊôÇ
  getDuration(execution) {
    if (!execution.completedAt)
      return "-";
    const start = new Date(execution.startedAt).getTime();
    const end = new Date(execution.completedAt).getTime();
    const minutes = Math.round((end - start) / 6e4);
    return `${minutes}\u5206\u9418`;
  }
  // Ê†ºÂºèÂåñÊôÇÈñì
  formatTime(date) {
    if (!date)
      return "-";
    const d = new Date(date);
    return `${d.getHours().toString().padStart(2, "0")}:${d.getMinutes().toString().padStart(2, "0")}`;
  }
  // Â±ïÈñã/Êî∂Ëµ∑
  toggleExpand(id) {
    this.expandedExecution.update((current) => current === id ? null : id);
  }
  // ÂèñÊ∂àÂü∑Ë°å
  cancelExecution(id) {
    this.workflowService.cancelExecution(id);
  }
  static {
    this.\u0275fac = function WorkflowMonitorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _WorkflowMonitorComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _WorkflowMonitorComponent, selectors: [["app-workflow-monitor"]], decls: 40, vars: 5, consts: [[1, "workflow-monitor"], [1, "flex", "items-center", "justify-between", "mb-6"], [1, "flex", "items-center", "gap-3"], [1, "text-3xl"], [1, "text-xl", "font-bold", 2, "color", "var(--text-primary)"], [1, "text-sm", 2, "color", "var(--text-muted)"], [1, "flex", "items-center", "gap-4"], [1, "text-center"], [1, "text-2xl", "font-bold", 2, "color", "var(--success)"], [1, "text-xs", 2, "color", "var(--text-muted)"], [1, "text-2xl", "font-bold", 2, "color", "var(--warning)"], [1, "text-2xl", "font-bold", 2, "color", "var(--primary)"], [1, "rounded-xl", "p-5", "mb-6", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)"], [1, "text-lg", "font-bold", "mb-4", "flex", "items-center", "gap-2", 2, "color", "var(--text-primary)"], [1, "flex", "items-end", "justify-between", "gap-2", "h-32"], [1, "flex-1", "flex", "flex-col", "items-center"], [1, "grid", "grid-cols-1", "lg:grid-cols-2", "gap-4"], [1, "rounded-xl", "p-4", "transition-all", "hover:shadow-lg", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)", 3, "border-cyan-500", "border-l-4"], [1, "col-span-2", "text-center", "py-12", 2, "color", "var(--text-muted)"], [1, "mt-6"], [1, "w-full", "rounded-t-lg", "transition-all", "duration-500"], [1, "mt-2", "text-center"], [1, "text-sm", "font-bold", 2, "color", "var(--text-primary)"], [1, "rounded-xl", "p-4", "transition-all", "hover:shadow-lg", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)"], [1, "flex", "items-center", "justify-between", "mb-3"], [1, "flex", "items-center", "gap-2"], [1, "text-lg"], [1, "font-medium", 2, "color", "var(--text-primary)"], [1, "px-2", "py-1", "rounded-full", "text-xs", "font-medium", 2, "color", "white"], ["title", "\u53D6\u6D88\u57F7\u884C", 1, "p-1", "rounded", "hover:bg-red-500/20", "transition-colors", 2, "color", "var(--error)"], [1, "flex", "items-center", "gap-1", "mb-3"], [1, "flex", "items-center"], [1, "text-sm", "p-2", "rounded-lg", 2, "background-color", "var(--bg-secondary)"], [2, "color", "var(--text-muted)"], [2, "color", "var(--text-primary)"], [1, "text-xs", "ml-2", 2, "color", "var(--success)"], [1, "mt-3", "pt-3", "border-t", 2, "border-color", "var(--border-color)"], [1, "w-full", "mt-2", "text-xs", "py-1", "rounded", "transition-colors", "hover:bg-slate-700/50", 2, "color", "var(--text-muted)", 3, "click"], ["title", "\u53D6\u6D88\u57F7\u884C", 1, "p-1", "rounded", "hover:bg-red-500/20", "transition-colors", 2, "color", "var(--error)", 3, "click"], [1, "w-6", "h-6", "rounded-full", "flex", "items-center", "justify-center", "text-xs", "transition-all", 2, "color", "white"], [1, "w-4", "h-0.5", "transition-all", 3, "bg-emerald-500", "bg-slate-600"], [1, "w-4", "h-0.5", "transition-all"], [1, "text-sm", "font-medium", "mb-2", 2, "color", "var(--text-secondary)"], [1, "space-y-2", "text-xs"], [1, "mt-2", "p-2", "rounded", "text-xs", 2, "background-color", "var(--bg-tertiary)"], [1, "flex", "items-center", "justify-between", "p-2", "rounded", 2, "background-color", "var(--bg-tertiary)"], [2, "color", "var(--text-secondary)"], [1, "text-4xl", "block", "mb-4"], [1, "text-sm", "mt-2"], [1, "rounded-xl", "overflow-hidden", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)"], [1, "w-full", "text-sm"], [2, "background-color", "var(--bg-secondary)"], [1, "text-left", "p-3", 2, "color", "var(--text-muted)"], [1, "border-t", 2, "border-color", "var(--border-color)"], [1, "p-3", 2, "color", "var(--text-primary)"], [1, "p-3"], [1, "px-2", "py-1", "rounded-full", "text-xs"], [1, "p-3", 2, "color", "var(--text-muted)"]], template: function WorkflowMonitorComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275domElementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "span", 3);
        \u0275\u0275text(4, "\u{1F4CA}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(5, "div")(6, "h2", 4);
        \u0275\u0275text(7, "\u57F7\u884C\u76E3\u63A7");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(8, "p", 5);
        \u0275\u0275text(9, "\u5BE6\u6642\u8FFD\u8E64\u5DE5\u4F5C\u6D41\u57F7\u884C\u72C0\u614B");
        \u0275\u0275domElementEnd()()();
        \u0275\u0275domElementStart(10, "div", 6)(11, "div", 7)(12, "div", 8);
        \u0275\u0275text(13);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(14, "div", 9);
        \u0275\u0275text(15, "\u9032\u884C\u4E2D");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(16, "div", 7)(17, "div", 10);
        \u0275\u0275text(18);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(19, "div", 9);
        \u0275\u0275text(20, "\u7B49\u5F85\u4E2D");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(21, "div", 7)(22, "div", 11);
        \u0275\u0275text(23);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(24, "div", 9);
        \u0275\u0275text(25, "\u4ECA\u65E5\u5B8C\u6210");
        \u0275\u0275domElementEnd()()()();
        \u0275\u0275domElementStart(26, "div", 12)(27, "h3", 13)(28, "span");
        \u0275\u0275text(29, "\u{1F3AF}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(30, "span");
        \u0275\u0275text(31, "\u8F49\u5316\u6F0F\u6597");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(32, "div", 14);
        \u0275\u0275repeaterCreate(33, WorkflowMonitorComponent_For_34_Template, 7, 6, "div", 15, _forTrack07);
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(35, "div", 16);
        \u0275\u0275repeaterCreate(36, WorkflowMonitorComponent_For_37_Template, 26, 15, "div", 17, _forTrack07, false, WorkflowMonitorComponent_ForEmpty_38_Template, 7, 0, "div", 18);
        \u0275\u0275domElementEnd();
        \u0275\u0275conditionalCreate(39, WorkflowMonitorComponent_Conditional_39_Template, 21, 0, "div", 19);
        \u0275\u0275domElementEnd();
      }
      if (rf & 2) {
        \u0275\u0275advance(13);
        \u0275\u0275textInterpolate(ctx.runningCount());
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.pendingCount());
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.completedTodayCount());
        \u0275\u0275advance(10);
        \u0275\u0275repeater(ctx.funnelStages());
        \u0275\u0275advance(3);
        \u0275\u0275repeater(ctx.activeExecutions());
        \u0275\u0275advance(3);
        \u0275\u0275conditional(ctx.completedExecutions().length > 0 ? 39 : -1);
      }
    }, dependencies: [CommonModule], styles: ["\n\n.workflow-monitor[_ngcontent-%COMP%] {\n  padding: 1.5rem;\n}\n/*# sourceMappingURL=workflow-monitor.component.css.map */"] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(WorkflowMonitorComponent, [{
    type: Component,
    args: [{ selector: "app-workflow-monitor", standalone: true, imports: [CommonModule], template: `
    <div class="workflow-monitor">
      <!-- \u6A19\u984C\u548C\u7D71\u8A08 -->
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <span class="text-3xl">\u{1F4CA}</span>
          <div>
            <h2 class="text-xl font-bold" style="color: var(--text-primary);">\u57F7\u884C\u76E3\u63A7</h2>
            <p class="text-sm" style="color: var(--text-muted);">\u5BE6\u6642\u8FFD\u8E64\u5DE5\u4F5C\u6D41\u57F7\u884C\u72C0\u614B</p>
          </div>
        </div>
        
        <!-- \u5FEB\u901F\u7D71\u8A08 -->
        <div class="flex items-center gap-4">
          <div class="text-center">
            <div class="text-2xl font-bold" style="color: var(--success);">{{ runningCount() }}</div>
            <div class="text-xs" style="color: var(--text-muted);">\u9032\u884C\u4E2D</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold" style="color: var(--warning);">{{ pendingCount() }}</div>
            <div class="text-xs" style="color: var(--text-muted);">\u7B49\u5F85\u4E2D</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold" style="color: var(--primary);">{{ completedTodayCount() }}</div>
            <div class="text-xs" style="color: var(--text-muted);">\u4ECA\u65E5\u5B8C\u6210</div>
          </div>
        </div>
      </div>
      
      <!-- \u8F49\u5316\u6F0F\u6597 -->
      <div class="rounded-xl p-5 mb-6" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
        <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
          <span>\u{1F3AF}</span>
          <span>\u8F49\u5316\u6F0F\u6597</span>
        </h3>
        
        <div class="flex items-end justify-between gap-2 h-32">
          @for (stage of funnelStages(); track stage.id) {
            <div class="flex-1 flex flex-col items-center">
              <div class="w-full rounded-t-lg transition-all duration-500"
                   [style.height.%]="stage.percentage"
                   [style.background]="stage.gradient">
              </div>
              <div class="mt-2 text-center">
                <div class="text-sm font-bold" style="color: var(--text-primary);">{{ stage.count }}</div>
                <div class="text-xs" style="color: var(--text-muted);">{{ stage.name }}</div>
              </div>
            </div>
          }
        </div>
      </div>
      
      <!-- \u57F7\u884C\u5217\u8868 -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        @for (execution of activeExecutions(); track execution.id) {
          <div class="rounded-xl p-4 transition-all hover:shadow-lg"
               style="background-color: var(--bg-card); border: 1px solid var(--border-color);"
               [class.border-cyan-500]="execution.status === 'running'"
               [class.border-l-4]="execution.status === 'running'">
            <!-- \u57F7\u884C\u982D\u90E8 -->
            <div class="flex items-center justify-between mb-3">
              <div class="flex items-center gap-2">
                <span class="text-lg">{{ getStatusIcon(execution.status) }}</span>
                <div>
                  <div class="font-medium" style="color: var(--text-primary);">
                    @{{ execution.targetUserName }}
                  </div>
                  <div class="text-xs" style="color: var(--text-muted);">
                    {{ formatTime(execution.startedAt) }}
                  </div>
                </div>
              </div>
              
              <div class="flex items-center gap-2">
                <!-- \u8F49\u5316\u6982\u7387 -->
                <div class="px-2 py-1 rounded-full text-xs font-medium"
                     [style.background-color]="getConversionColor(execution)"
                     style="color: white;">
                  {{ getConversionProbability(execution) }}% \u8F49\u5316
                </div>
                
                <!-- \u64CD\u4F5C\u6309\u9215 -->
                @if (execution.status === 'running' || execution.status === 'pending') {
                  <button (click)="cancelExecution(execution.id)"
                          class="p-1 rounded hover:bg-red-500/20 transition-colors"
                          style="color: var(--error);"
                          title="\u53D6\u6D88\u57F7\u884C">
                    \u2715
                  </button>
                }
              </div>
            </div>
            
            <!-- \u6B65\u9A5F\u9032\u5EA6 -->
            <div class="flex items-center gap-1 mb-3">
              @for (step of getWorkflowSteps(); track step.id; let i = $index) {
                <div class="flex items-center">
                  <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs transition-all"
                       [class.bg-emerald-500]="isStepCompleted(execution, step.id)"
                       [class.bg-cyan-500]="execution.currentStep === step.id && execution.status === 'running'"
                       [class.animate-pulse]="execution.currentStep === step.id && execution.status === 'running'"
                       [class.bg-slate-600]="!isStepCompleted(execution, step.id) && execution.currentStep !== step.id"
                       style="color: white;">
                    @if (isStepCompleted(execution, step.id)) {
                      \u2713
                    } @else {
                      {{ i + 1 }}
                    }
                  </div>
                  @if (i < getWorkflowSteps().length - 1) {
                    <div class="w-4 h-0.5 transition-all"
                         [class.bg-emerald-500]="isStepCompleted(execution, step.id)"
                         [class.bg-slate-600]="!isStepCompleted(execution, step.id)">
                    </div>
                  }
                </div>
              }
            </div>
            
            <!-- \u7576\u524D\u6B65\u9A5F\u8AAA\u660E -->
            <div class="text-sm p-2 rounded-lg" style="background-color: var(--bg-secondary);">
              <span style="color: var(--text-muted);">\u7576\u524D\uFF1A</span>
              <span style="color: var(--text-primary);">{{ getCurrentStepName(execution) }}</span>
              
              @if (execution.stepResults[execution.currentStep]?.data) {
                <span class="text-xs ml-2" style="color: var(--success);">
                  {{ getStepResultSummary(execution) }}
                </span>
              }
            </div>
            
            <!-- \u8A73\u60C5\u5C55\u958B -->
            @if (expandedExecution() === execution.id) {
              <div class="mt-3 pt-3 border-t" style="border-color: var(--border-color);">
                <h4 class="text-sm font-medium mb-2" style="color: var(--text-secondary);">\u57F7\u884C\u8A73\u60C5</h4>
                
                <div class="space-y-2 text-xs">
                  @for (step of getWorkflowSteps(); track step.id) {
                    @if (execution.stepResults[step.id]) {
                      <div class="flex items-center justify-between p-2 rounded" style="background-color: var(--bg-tertiary);">
                        <span style="color: var(--text-secondary);">{{ step.name }}</span>
                        <span [class.text-emerald-400]="execution.stepResults[step.id].status === 'success'"
                              [class.text-red-400]="execution.stepResults[step.id].status === 'failed'"
                              [class.text-slate-400]="execution.stepResults[step.id].status === 'skipped'">
                          {{ getStepStatusText(execution.stepResults[step.id].status) }}
                        </span>
                      </div>
                    }
                  }
                </div>
                
                @if (execution.aiPlanResult) {
                  <div class="mt-2 p-2 rounded text-xs" style="background-color: var(--bg-tertiary);">
                    <span style="color: var(--text-muted);">AI \u7B56\u7565\uFF1A</span>
                    <span style="color: var(--text-secondary);">{{ execution.aiPlanResult.strategy || '\u6A19\u6E96\u71DF\u92B7' }}</span>
                  </div>
                }
              </div>
            }
            
            <!-- \u5C55\u958B/\u6536\u8D77\u6309\u9215 -->
            <button (click)="toggleExpand(execution.id)"
                    class="w-full mt-2 text-xs py-1 rounded transition-colors hover:bg-slate-700/50"
                    style="color: var(--text-muted);">
              {{ expandedExecution() === execution.id ? '\u6536\u8D77 \u25B2' : '\u8A73\u60C5 \u25BC' }}
            </button>
          </div>
        } @empty {
          <div class="col-span-2 text-center py-12" style="color: var(--text-muted);">
            <span class="text-4xl block mb-4">\u{1F3AF}</span>
            <p>\u66AB\u7121\u9032\u884C\u4E2D\u7684\u5DE5\u4F5C\u6D41</p>
            <p class="text-sm mt-2">\u7576\u76E3\u63A7\u7FA4\u7D44\u89F8\u767C\u95DC\u9375\u8A5E\u6642\uFF0C\u5DE5\u4F5C\u6D41\u5C07\u81EA\u52D5\u958B\u59CB</p>
          </div>
        }
      </div>
      
      <!-- \u5DF2\u5B8C\u6210\u5217\u8868 -->
      @if (completedExecutions().length > 0) {
        <div class="mt-6">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
            <span>\u2705</span>
            <span>\u8FD1\u671F\u5B8C\u6210</span>
          </h3>
          
          <div class="rounded-xl overflow-hidden" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
            <table class="w-full text-sm">
              <thead>
                <tr style="background-color: var(--bg-secondary);">
                  <th class="text-left p-3" style="color: var(--text-muted);">\u7528\u6236</th>
                  <th class="text-left p-3" style="color: var(--text-muted);">\u7D50\u679C</th>
                  <th class="text-left p-3" style="color: var(--text-muted);">\u8017\u6642</th>
                  <th class="text-left p-3" style="color: var(--text-muted);">\u5B8C\u6210\u6642\u9593</th>
                </tr>
              </thead>
              <tbody>
                @for (execution of completedExecutions().slice(0, 5); track execution.id) {
                  <tr class="border-t" style="border-color: var(--border-color);">
                    <td class="p-3" style="color: var(--text-primary);">@{{ execution.targetUserName }}</td>
                    <td class="p-3">
                      <span class="px-2 py-1 rounded-full text-xs"
                            [class.bg-emerald-500/20]="execution.outcome === 'converted'"
                            [class.text-emerald-400]="execution.outcome === 'converted'"
                            [class.bg-amber-500/20]="execution.outcome === 'interested'"
                            [class.text-amber-400]="execution.outcome === 'interested'"
                            [class.bg-slate-500/20]="!execution.outcome || execution.outcome === 'neutral'"
                            [class.text-slate-400]="!execution.outcome || execution.outcome === 'neutral'">
                        {{ getOutcomeText(execution.outcome) }}
                      </span>
                    </td>
                    <td class="p-3" style="color: var(--text-muted);">{{ getDuration(execution) }}</td>
                    <td class="p-3" style="color: var(--text-muted);">{{ formatTime(execution.completedAt) }}</td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      }
    </div>
  `, styles: ["/* angular:styles/component:css;111f7226c2605cecfbf4d6542766b57c0ec854b8541cdec21b407e17363e709e;D:/tgkz2026/src/components/workflow-monitor.component.ts */\n.workflow-monitor {\n  padding: 1.5rem;\n}\n/*# sourceMappingURL=workflow-monitor.component.css.map */\n"] }]
  }], null, null);
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(WorkflowMonitorComponent, { className: "WorkflowMonitorComponent", filePath: "src/components/workflow-monitor.component.ts", lineNumber: 249 });
})();

// src/components/workflow-analytics.component.ts
var _forTrack08 = ($index, $item) => $item.date;
var _forTrack13 = ($index, $item) => $item.id;
function WorkflowAnalyticsComponent_For_87_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 33)(1, "div", 40);
    \u0275\u0275domElement(2, "div", 41)(3, "div", 42);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(4, "span", 43);
    \u0275\u0275text(5);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const point_r1 = ctx.$implicit;
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275styleProp("height", ctx_r1.Math.max(4, point_r1.conversions * 8), "px");
    \u0275\u0275advance();
    \u0275\u0275styleProp("height", ctx_r1.Math.max(4, point_r1.triggers * 4), "px");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.formatDate(point_r1.date));
  }
}
function WorkflowAnalyticsComponent_For_105_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 2)(1, "span", 44);
    \u0275\u0275text(2);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "div", 45)(4, "div", 46)(5, "span", 47);
    \u0275\u0275text(6);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(7, "span", 5);
    \u0275\u0275text(8);
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(9, "div", 48);
    \u0275\u0275domElement(10, "div", 49);
    \u0275\u0275domElementEnd()();
    \u0275\u0275domElementStart(11, "span", 50);
    \u0275\u0275text(12);
    \u0275\u0275domElementEnd()();
  }
  if (rf & 2) {
    const role_r3 = ctx.$implicit;
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(role_r3.icon);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(role_r3.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", role_r3.engagements, " \u6B21");
    \u0275\u0275advance(2);
    \u0275\u0275styleProp("width", role_r3.effectiveness, "%")("background", role_r3.color);
    \u0275\u0275advance();
    \u0275\u0275styleProp("color", role_r3.color);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1("", role_r3.effectiveness, "%");
  }
}
function WorkflowAnalyticsComponent_For_114_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275domElementStart(0, "div", 51)(1, "span", 52);
    \u0275\u0275text(2);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(3, "div")(4, "div", 53);
    \u0275\u0275text(5);
    \u0275\u0275domElementEnd();
    \u0275\u0275domElementStart(6, "div", 43);
    \u0275\u0275text(7);
    \u0275\u0275domElementEnd()()();
  }
  if (rf & 2) {
    const insight_r4 = ctx.$implicit;
    \u0275\u0275styleProp("background-color", insight_r4.bgColor);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(insight_r4.icon);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(insight_r4.title);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(insight_r4.description);
  }
}
var WorkflowAnalyticsComponent = class _WorkflowAnalyticsComponent {
  constructor() {
    this.workflowService = inject(AutomationWorkflowService);
    this.ipc = inject(ElectronIpcService);
    this.Math = Math;
    this.analytics = signal({
      totals: { triggers: 0, plans: 0, privateChats: 0, groupsCreated: 0, conversions: 0 },
      conversionRate: 0,
      activeExecutions: 0,
      daily: {}
    }, ...ngDevMode ? [{ debugName: "analytics" }] : []);
    this.trendData = computed(() => {
      const daily = this.analytics().daily || {};
      const dates = Object.keys(daily).sort().slice(-7);
      if (dates.length === 0) {
        return this.generateMockTrendData();
      }
      return dates.map((date) => ({
        date,
        triggers: daily[date]?.triggers || 0,
        conversions: daily[date]?.conversions || 0,
        rate: daily[date]?.triggers ? Math.round(daily[date]?.conversions / daily[date]?.triggers * 100) : 0
      }));
    }, ...ngDevMode ? [{ debugName: "trendData" }] : []);
    this.rolePerformance = signal([
      { id: "closer", name: "\u6210\u4EA4\u5C08\u5BB6", icon: "\u{1F4BC}", engagements: 45, effectiveness: 78, color: "#22c55e" },
      { id: "expert", name: "\u7522\u54C1\u5C08\u5BB6", icon: "\u{1F393}", engagements: 38, effectiveness: 72, color: "#3b82f6" },
      { id: "testimonial", name: "\u898B\u8B49\u8005", icon: "\u2B50", engagements: 32, effectiveness: 65, color: "#f59e0b" },
      { id: "supporter", name: "\u5BA2\u670D\u652F\u6301", icon: "\u{1F91D}", engagements: 28, effectiveness: 58, color: "#8b5cf6" },
      { id: "connector", name: "\u793E\u4EA4\u9054\u4EBA", icon: "\u{1F31F}", engagements: 22, effectiveness: 52, color: "#ec4899" }
    ], ...ngDevMode ? [{ debugName: "rolePerformance" }] : []);
    this.insights = computed(() => {
      const data = this.analytics();
      const insights = [];
      if (data.conversionRate > 30) {
        insights.push({
          id: "high_conversion",
          icon: "\u{1F389}",
          title: "\u8F49\u5316\u7387\u512A\u79C0",
          description: `\u7576\u524D\u8F49\u5316\u7387 ${data.conversionRate}%\uFF0C\u9AD8\u65BC\u884C\u696D\u5E73\u5747\u6C34\u5E73`,
          bgColor: "rgba(34, 197, 94, 0.1)"
        });
      } else if (data.conversionRate < 15) {
        insights.push({
          id: "low_conversion",
          icon: "\u26A0\uFE0F",
          title: "\u8F49\u5316\u7387\u5F85\u63D0\u5347",
          description: "\u5EFA\u8B70\u512A\u5316\u8A71\u8853\u6A21\u677F\u6216\u8ABF\u6574\u76EE\u6A19\u7528\u6236\u7BE9\u9078\u689D\u4EF6",
          bgColor: "rgba(245, 158, 11, 0.1)"
        });
      }
      if (data.activeExecutions > 5) {
        insights.push({
          id: "high_activity",
          icon: "\u{1F525}",
          title: "\u9AD8\u6D3B\u8E8D\u5EA6",
          description: `\u7576\u524D\u6709 ${data.activeExecutions} \u500B\u5DE5\u4F5C\u6D41\u6B63\u5728\u57F7\u884C`,
          bgColor: "rgba(239, 68, 68, 0.1)"
        });
      }
      if (insights.length === 0) {
        insights.push({
          id: "tip",
          icon: "\u{1F4A1}",
          title: "\u63D0\u5347\u5EFA\u8B70",
          description: "\u5617\u8A66\u555F\u7528\u81EA\u52D5\u5316\u5DE5\u4F5C\u6D41\u4F86\u63D0\u5347\u71DF\u92B7\u6548\u7387",
          bgColor: "rgba(99, 102, 241, 0.1)"
        });
      }
      insights.push({
        id: "best_time",
        icon: "\u23F0",
        title: "\u6700\u4F73\u6642\u6BB5",
        description: "\u6578\u64DA\u986F\u793A 14:00-18:00 \u7528\u6236\u97FF\u61C9\u7387\u6700\u9AD8",
        bgColor: "rgba(6, 182, 212, 0.1)"
      });
      return insights;
    }, ...ngDevMode ? [{ debugName: "insights" }] : []);
  }
  ngOnInit() {
    this.refreshData();
  }
  ngOnDestroy() {
  }
  // Âà∑Êñ∞Êï∏Êìö
  refreshData() {
    this.ipc.send("workflow:get-analytics", {});
    setTimeout(() => {
      this.analytics.set({
        totals: {
          triggers: 156,
          plans: 142,
          privateChats: 98,
          groupsCreated: 45,
          conversions: 32
        },
        conversionRate: 20.5,
        activeExecutions: 3,
        daily: {}
      });
    }, 500);
  }
  // ÁîüÊàêÊ®°Êì¨Ë∂®Âã¢Êï∏Êìö
  generateMockTrendData() {
    const data = [];
    const today = /* @__PURE__ */ new Date();
    for (let i = 6; i >= 0; i--) {
      const date = new Date(today);
      date.setDate(date.getDate() - i);
      const dateStr = date.toISOString().split("T")[0];
      const triggers = Math.floor(Math.random() * 30) + 10;
      const conversions = Math.floor(triggers * (0.15 + Math.random() * 0.2));
      data.push({
        date: dateStr,
        triggers,
        conversions,
        rate: Math.round(conversions / triggers * 100)
      });
    }
    return data;
  }
  // Áç≤ÂèñËΩâÂåñÁéáÈ°èËâ≤
  getConversionColor() {
    const rate = this.analytics().conversionRate;
    if (rate >= 30)
      return "#22c55e";
    if (rate >= 20)
      return "#f59e0b";
    return "#ef4444";
  }
  // Áç≤ÂèñËΩâÂåñÁéáÂúìÁí∞
  getConversionDashArray() {
    const rate = this.analytics().conversionRate;
    const circumference = 2 * Math.PI * 70;
    const filled = rate / 100 * circumference;
    return `${filled} ${circumference}`;
  }
  // Áç≤ÂèñÊºèÊñóËΩâÂåñÁéá
  getFunnelRate(stage) {
    const totals = this.analytics().totals;
    switch (stage) {
      case "plan":
        return totals.triggers ? Math.round(totals.plans / totals.triggers * 100) : 0;
      case "chat":
        return totals.plans ? Math.round(totals.privateChats / totals.plans * 100) : 0;
      case "group":
        return totals.privateChats ? Math.round(totals.groupsCreated / totals.privateChats * 100) : 0;
      case "conversion":
        return totals.groupsCreated ? Math.round(totals.conversions / totals.groupsCreated * 100) : 0;
      default:
        return 0;
    }
  }
  // Ê†ºÂºèÂåñÊó•Êúü
  formatDate(dateStr) {
    const date = new Date(dateStr);
    return `${date.getMonth() + 1}/${date.getDate()}`;
  }
  static {
    this.\u0275fac = function WorkflowAnalyticsComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _WorkflowAnalyticsComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _WorkflowAnalyticsComponent, selectors: [["app-workflow-analytics"]], decls: 115, vars: 14, consts: [[1, "workflow-analytics"], [1, "flex", "items-center", "justify-between", "mb-6"], [1, "flex", "items-center", "gap-3"], [1, "text-3xl"], [1, "text-xl", "font-bold", 2, "color", "var(--text-primary)"], [1, "text-sm", 2, "color", "var(--text-muted)"], [1, "px-4", "py-2", "rounded-lg", "transition-colors", "flex", "items-center", "gap-2", 2, "background-color", "var(--bg-secondary)", "color", "var(--text-secondary)", 3, "click"], [1, "grid", "grid-cols-2", "lg:grid-cols-5", "gap-4", "mb-6"], [1, "rounded-xl", "p-4", "text-center", 2, "background", "linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1))", "border", "1px solid rgba(99, 102, 241, 0.3)"], [1, "text-3xl", "font-bold", 2, "color", "#818cf8"], [1, "rounded-xl", "p-4", "text-center", 2, "background", "linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(34, 211, 238, 0.1))", "border", "1px solid rgba(6, 182, 212, 0.3)"], [1, "text-3xl", "font-bold", 2, "color", "#22d3ee"], [1, "rounded-xl", "p-4", "text-center", 2, "background", "linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(251, 191, 36, 0.1))", "border", "1px solid rgba(245, 158, 11, 0.3)"], [1, "text-3xl", "font-bold", 2, "color", "#fbbf24"], [1, "rounded-xl", "p-4", "text-center", 2, "background", "linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(244, 114, 182, 0.1))", "border", "1px solid rgba(236, 72, 153, 0.3)"], [1, "text-3xl", "font-bold", 2, "color", "#f472b6"], [1, "rounded-xl", "p-4", "text-center", 2, "background", "linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(74, 222, 128, 0.1))", "border", "1px solid rgba(34, 197, 94, 0.3)"], [1, "text-3xl", "font-bold", 2, "color", "#4ade80"], [1, "grid", "grid-cols-1", "lg:grid-cols-2", "gap-6"], [1, "rounded-xl", "p-5", 2, "background-color", "var(--bg-card)", "border", "1px solid var(--border-color)"], [1, "text-lg", "font-bold", "mb-4", "flex", "items-center", "gap-2", 2, "color", "var(--text-primary)"], [1, "flex", "items-center", "justify-center", "py-8"], [1, "relative", "w-40", "h-40"], [1, "w-full", "h-full", "transform", "-rotate-90"], ["cx", "80", "cy", "80", "r", "70", "stroke", "rgba(100, 116, 139, 0.3)", "stroke-width", "12", "fill", "none"], ["cx", "80", "cy", "80", "r", "70", "stroke-width", "12", "fill", "none", "stroke-linecap", "round", 1, "transition-all", "duration-1000"], [1, "absolute", "inset-0", "flex", "flex-col", "items-center", "justify-center"], [1, "text-4xl", "font-bold"], [1, "space-y-2", "mt-4"], [1, "flex", "items-center", "justify-between", "text-sm"], [2, "color", "var(--text-secondary)"], [2, "color", "var(--text-primary)"], [1, "h-48", "flex", "items-end", "justify-between", "gap-2", "px-2"], [1, "flex-1", "flex", "flex-col", "items-center", "gap-1"], [1, "flex", "items-center", "justify-center", "gap-6", "mt-4", "text-xs", 2, "color", "var(--text-muted)"], [1, "flex", "items-center", "gap-1"], [1, "w-3", "h-3", "rounded", 2, "background", "linear-gradient(to top, #6366f1, #818cf8)"], [1, "w-3", "h-3", "rounded", 2, "background", "linear-gradient(to top, #22c55e, #4ade80)"], [1, "space-y-3"], [1, "p-3", "rounded-lg", "flex", "items-start", "gap-3", 3, "background-color"], [1, "w-full", "flex", "flex-col", "gap-1"], [1, "w-full", "rounded-t", "transition-all", "duration-500", 2, "background", "linear-gradient(to top, #22c55e, #4ade80)"], [1, "w-full", "rounded-t", "transition-all", "duration-500", 2, "background", "linear-gradient(to top, #6366f1, #818cf8)"], [1, "text-xs", 2, "color", "var(--text-muted)"], [1, "text-2xl"], [1, "flex-1"], [1, "flex", "items-center", "justify-between", "mb-1"], [1, "text-sm", "font-medium", 2, "color", "var(--text-primary)"], [1, "w-full", "h-2", "rounded-full", 2, "background-color", "var(--bg-secondary)"], [1, "h-full", "rounded-full", "transition-all", "duration-500"], [1, "text-sm", "font-medium"], [1, "p-3", "rounded-lg", "flex", "items-start", "gap-3"], [1, "text-xl"], [1, "font-medium", "text-sm", 2, "color", "var(--text-primary)"]], template: function WorkflowAnalyticsComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275domElementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "span", 3);
        \u0275\u0275text(4, "\u{1F4C8}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(5, "div")(6, "h2", 4);
        \u0275\u0275text(7, "\u6578\u64DA\u5206\u6790");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(8, "p", 5);
        \u0275\u0275text(9, "\u5DE5\u4F5C\u6D41\u57F7\u884C\u6548\u679C\u8FFD\u8E64");
        \u0275\u0275domElementEnd()()();
        \u0275\u0275domElementStart(10, "button", 6);
        \u0275\u0275domListener("click", function WorkflowAnalyticsComponent_Template_button_click_10_listener() {
          return ctx.refreshData();
        });
        \u0275\u0275domElementStart(11, "span");
        \u0275\u0275text(12, "\u{1F504}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(13, "span");
        \u0275\u0275text(14, "\u5237\u65B0");
        \u0275\u0275domElementEnd()()();
        \u0275\u0275domElementStart(15, "div", 7)(16, "div", 8)(17, "div", 9);
        \u0275\u0275text(18);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(19, "div", 5);
        \u0275\u0275text(20, "\u7E3D\u89F8\u767C");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(21, "div", 10)(22, "div", 11);
        \u0275\u0275text(23);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(24, "div", 5);
        \u0275\u0275text(25, "AI \u7B56\u5283");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(26, "div", 12)(27, "div", 13);
        \u0275\u0275text(28);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(29, "div", 5);
        \u0275\u0275text(30, "\u79C1\u804A\u5354\u4F5C");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(31, "div", 14)(32, "div", 15);
        \u0275\u0275text(33);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(34, "div", 5);
        \u0275\u0275text(35, "\u5EFA\u7FA4\u6578");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(36, "div", 16)(37, "div", 17);
        \u0275\u0275text(38);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(39, "div", 5);
        \u0275\u0275text(40, "\u6210\u529F\u8F49\u5316");
        \u0275\u0275domElementEnd()()();
        \u0275\u0275domElementStart(41, "div", 18)(42, "div", 19)(43, "h3", 20)(44, "span");
        \u0275\u0275text(45, "\u{1F3AF}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(46, "span");
        \u0275\u0275text(47, "\u8F49\u5316\u7387");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(48, "div", 21)(49, "div", 22);
        \u0275\u0275namespaceSVG();
        \u0275\u0275domElementStart(50, "svg", 23);
        \u0275\u0275domElement(51, "circle", 24)(52, "circle", 25);
        \u0275\u0275domElementEnd();
        \u0275\u0275namespaceHTML();
        \u0275\u0275domElementStart(53, "div", 26)(54, "span", 27);
        \u0275\u0275text(55);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(56, "span", 5);
        \u0275\u0275text(57, "\u8F49\u5316\u7387");
        \u0275\u0275domElementEnd()()()();
        \u0275\u0275domElementStart(58, "div", 28)(59, "div", 29)(60, "span", 30);
        \u0275\u0275text(61, "\u89F8\u767C \u2192 \u7B56\u5283");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(62, "span", 31);
        \u0275\u0275text(63);
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(64, "div", 29)(65, "span", 30);
        \u0275\u0275text(66, "\u7B56\u5283 \u2192 \u79C1\u804A");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(67, "span", 31);
        \u0275\u0275text(68);
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(69, "div", 29)(70, "span", 30);
        \u0275\u0275text(71, "\u79C1\u804A \u2192 \u5EFA\u7FA4");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(72, "span", 31);
        \u0275\u0275text(73);
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(74, "div", 29)(75, "span", 30);
        \u0275\u0275text(76, "\u5EFA\u7FA4 \u2192 \u8F49\u5316");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(77, "span", 31);
        \u0275\u0275text(78);
        \u0275\u0275domElementEnd()()()();
        \u0275\u0275domElementStart(79, "div", 19)(80, "h3", 20)(81, "span");
        \u0275\u0275text(82, "\u{1F4CA}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(83, "span");
        \u0275\u0275text(84, "7 \u65E5\u8DA8\u52E2");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(85, "div", 32);
        \u0275\u0275repeaterCreate(86, WorkflowAnalyticsComponent_For_87_Template, 6, 5, "div", 33, _forTrack08);
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(88, "div", 34)(89, "div", 35);
        \u0275\u0275domElement(90, "div", 36);
        \u0275\u0275domElementStart(91, "span");
        \u0275\u0275text(92, "\u89F8\u767C");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(93, "div", 35);
        \u0275\u0275domElement(94, "div", 37);
        \u0275\u0275domElementStart(95, "span");
        \u0275\u0275text(96, "\u8F49\u5316");
        \u0275\u0275domElementEnd()()()();
        \u0275\u0275domElementStart(97, "div", 19)(98, "h3", 20)(99, "span");
        \u0275\u0275text(100, "\u{1F3AD}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(101, "span");
        \u0275\u0275text(102, "\u89D2\u8272\u6548\u80FD");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(103, "div", 38);
        \u0275\u0275repeaterCreate(104, WorkflowAnalyticsComponent_For_105_Template, 13, 10, "div", 2, _forTrack13);
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(106, "div", 19)(107, "h3", 20)(108, "span");
        \u0275\u0275text(109, "\u{1F4A1}");
        \u0275\u0275domElementEnd();
        \u0275\u0275domElementStart(110, "span");
        \u0275\u0275text(111, "\u5FEB\u901F\u6D1E\u5BDF");
        \u0275\u0275domElementEnd()();
        \u0275\u0275domElementStart(112, "div", 38);
        \u0275\u0275repeaterCreate(113, WorkflowAnalyticsComponent_For_114_Template, 8, 5, "div", 39, _forTrack13);
        \u0275\u0275domElementEnd()()()();
      }
      if (rf & 2) {
        \u0275\u0275advance(18);
        \u0275\u0275textInterpolate(ctx.analytics().totals.triggers);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.analytics().totals.plans);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.analytics().totals.privateChats);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.analytics().totals.groupsCreated);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.analytics().totals.conversions);
        \u0275\u0275advance(14);
        \u0275\u0275attribute("stroke", ctx.getConversionColor())("stroke-dasharray", ctx.getConversionDashArray());
        \u0275\u0275advance(2);
        \u0275\u0275styleProp("color", ctx.getConversionColor());
        \u0275\u0275advance();
        \u0275\u0275textInterpolate1(" ", ctx.analytics().conversionRate, "% ");
        \u0275\u0275advance(8);
        \u0275\u0275textInterpolate1("", ctx.getFunnelRate("plan"), "%");
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate1("", ctx.getFunnelRate("chat"), "%");
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate1("", ctx.getFunnelRate("group"), "%");
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate1("", ctx.getFunnelRate("conversion"), "%");
        \u0275\u0275advance(8);
        \u0275\u0275repeater(ctx.trendData());
        \u0275\u0275advance(18);
        \u0275\u0275repeater(ctx.rolePerformance());
        \u0275\u0275advance(9);
        \u0275\u0275repeater(ctx.insights());
      }
    }, dependencies: [CommonModule], styles: ["\n\n.workflow-analytics[_ngcontent-%COMP%] {\n  padding: 1.5rem;\n}\n/*# sourceMappingURL=workflow-analytics.component.css.map */"] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(WorkflowAnalyticsComponent, [{
    type: Component,
    args: [{ selector: "app-workflow-analytics", standalone: true, imports: [CommonModule], template: `
    <div class="workflow-analytics">
      <!-- \u6A19\u984C -->
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <span class="text-3xl">\u{1F4C8}</span>
          <div>
            <h2 class="text-xl font-bold" style="color: var(--text-primary);">\u6578\u64DA\u5206\u6790</h2>
            <p class="text-sm" style="color: var(--text-muted);">\u5DE5\u4F5C\u6D41\u57F7\u884C\u6548\u679C\u8FFD\u8E64</p>
          </div>
        </div>
        <button (click)="refreshData()" 
                class="px-4 py-2 rounded-lg transition-colors flex items-center gap-2"
                style="background-color: var(--bg-secondary); color: var(--text-secondary);">
          <span>\u{1F504}</span>
          <span>\u5237\u65B0</span>
        </button>
      </div>
      
      <!-- KPI \u5361\u7247 -->
      <div class="grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
        <div class="rounded-xl p-4 text-center" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(99, 102, 241, 0.3);">
          <div class="text-3xl font-bold" style="color: #818cf8;">{{ analytics().totals.triggers }}</div>
          <div class="text-sm" style="color: var(--text-muted);">\u7E3D\u89F8\u767C</div>
        </div>
        
        <div class="rounded-xl p-4 text-center" style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(34, 211, 238, 0.1)); border: 1px solid rgba(6, 182, 212, 0.3);">
          <div class="text-3xl font-bold" style="color: #22d3ee;">{{ analytics().totals.plans }}</div>
          <div class="text-sm" style="color: var(--text-muted);">AI \u7B56\u5283</div>
        </div>
        
        <div class="rounded-xl p-4 text-center" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(251, 191, 36, 0.1)); border: 1px solid rgba(245, 158, 11, 0.3);">
          <div class="text-3xl font-bold" style="color: #fbbf24;">{{ analytics().totals.privateChats }}</div>
          <div class="text-sm" style="color: var(--text-muted);">\u79C1\u804A\u5354\u4F5C</div>
        </div>
        
        <div class="rounded-xl p-4 text-center" style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(244, 114, 182, 0.1)); border: 1px solid rgba(236, 72, 153, 0.3);">
          <div class="text-3xl font-bold" style="color: #f472b6;">{{ analytics().totals.groupsCreated }}</div>
          <div class="text-sm" style="color: var(--text-muted);">\u5EFA\u7FA4\u6578</div>
        </div>
        
        <div class="rounded-xl p-4 text-center" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(74, 222, 128, 0.1)); border: 1px solid rgba(34, 197, 94, 0.3);">
          <div class="text-3xl font-bold" style="color: #4ade80;">{{ analytics().totals.conversions }}</div>
          <div class="text-sm" style="color: var(--text-muted);">\u6210\u529F\u8F49\u5316</div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- \u8F49\u5316\u7387\u9762\u677F -->
        <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
            <span>\u{1F3AF}</span>
            <span>\u8F49\u5316\u7387</span>
          </h3>
          
          <div class="flex items-center justify-center py-8">
            <div class="relative w-40 h-40">
              <!-- \u5713\u74B0\u80CC\u666F -->
              <svg class="w-full h-full transform -rotate-90">
                <circle cx="80" cy="80" r="70" 
                        stroke="rgba(100, 116, 139, 0.3)" 
                        stroke-width="12" 
                        fill="none"/>
                <circle cx="80" cy="80" r="70" 
                        [attr.stroke]="getConversionColor()"
                        stroke-width="12" 
                        fill="none"
                        [attr.stroke-dasharray]="getConversionDashArray()"
                        stroke-linecap="round"
                        class="transition-all duration-1000"/>
              </svg>
              <!-- \u4E2D\u5FC3\u6587\u5B57 -->
              <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span class="text-4xl font-bold" [style.color]="getConversionColor()">
                  {{ analytics().conversionRate }}%
                </span>
                <span class="text-sm" style="color: var(--text-muted);">\u8F49\u5316\u7387</span>
              </div>
            </div>
          </div>
          
          <!-- \u8F49\u5316\u6F0F\u6597 -->
          <div class="space-y-2 mt-4">
            <div class="flex items-center justify-between text-sm">
              <span style="color: var(--text-secondary);">\u89F8\u767C \u2192 \u7B56\u5283</span>
              <span style="color: var(--text-primary);">{{ getFunnelRate('plan') }}%</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span style="color: var(--text-secondary);">\u7B56\u5283 \u2192 \u79C1\u804A</span>
              <span style="color: var(--text-primary);">{{ getFunnelRate('chat') }}%</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span style="color: var(--text-secondary);">\u79C1\u804A \u2192 \u5EFA\u7FA4</span>
              <span style="color: var(--text-primary);">{{ getFunnelRate('group') }}%</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span style="color: var(--text-secondary);">\u5EFA\u7FA4 \u2192 \u8F49\u5316</span>
              <span style="color: var(--text-primary);">{{ getFunnelRate('conversion') }}%</span>
            </div>
          </div>
        </div>
        
        <!-- \u8DA8\u52E2\u5716 -->
        <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
            <span>\u{1F4CA}</span>
            <span>7 \u65E5\u8DA8\u52E2</span>
          </h3>
          
          <div class="h-48 flex items-end justify-between gap-2 px-2">
            @for (point of trendData(); track point.date) {
              <div class="flex-1 flex flex-col items-center gap-1">
                <div class="w-full flex flex-col gap-1">
                  <!-- \u8F49\u5316\u689D -->
                  <div class="w-full rounded-t transition-all duration-500"
                       [style.height.px]="Math.max(4, point.conversions * 8)"
                       style="background: linear-gradient(to top, #22c55e, #4ade80);">
                  </div>
                  <!-- \u89F8\u767C\u689D -->
                  <div class="w-full rounded-t transition-all duration-500"
                       [style.height.px]="Math.max(4, point.triggers * 4)"
                       style="background: linear-gradient(to top, #6366f1, #818cf8);">
                  </div>
                </div>
                <span class="text-xs" style="color: var(--text-muted);">{{ formatDate(point.date) }}</span>
              </div>
            }
          </div>
          
          <!-- \u5716\u4F8B -->
          <div class="flex items-center justify-center gap-6 mt-4 text-xs" style="color: var(--text-muted);">
            <div class="flex items-center gap-1">
              <div class="w-3 h-3 rounded" style="background: linear-gradient(to top, #6366f1, #818cf8);"></div>
              <span>\u89F8\u767C</span>
            </div>
            <div class="flex items-center gap-1">
              <div class="w-3 h-3 rounded" style="background: linear-gradient(to top, #22c55e, #4ade80);"></div>
              <span>\u8F49\u5316</span>
            </div>
          </div>
        </div>
        
        <!-- \u89D2\u8272\u6548\u80FD -->
        <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
            <span>\u{1F3AD}</span>
            <span>\u89D2\u8272\u6548\u80FD</span>
          </h3>
          
          <div class="space-y-3">
            @for (role of rolePerformance(); track role.id) {
              <div class="flex items-center gap-3">
                <span class="text-2xl">{{ role.icon }}</span>
                <div class="flex-1">
                  <div class="flex items-center justify-between mb-1">
                    <span class="text-sm font-medium" style="color: var(--text-primary);">{{ role.name }}</span>
                    <span class="text-sm" style="color: var(--text-muted);">{{ role.engagements }} \u6B21</span>
                  </div>
                  <div class="w-full h-2 rounded-full" style="background-color: var(--bg-secondary);">
                    <div class="h-full rounded-full transition-all duration-500"
                         [style.width.%]="role.effectiveness"
                         [style.background]="role.color">
                    </div>
                  </div>
                </div>
                <span class="text-sm font-medium" [style.color]="role.color">{{ role.effectiveness }}%</span>
              </div>
            }
          </div>
        </div>
        
        <!-- \u5FEB\u901F\u6D1E\u5BDF -->
        <div class="rounded-xl p-5" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary);">
            <span>\u{1F4A1}</span>
            <span>\u5FEB\u901F\u6D1E\u5BDF</span>
          </h3>
          
          <div class="space-y-3">
            @for (insight of insights(); track insight.id) {
              <div class="p-3 rounded-lg flex items-start gap-3"
                   [style.background-color]="insight.bgColor">
                <span class="text-xl">{{ insight.icon }}</span>
                <div>
                  <div class="font-medium text-sm" style="color: var(--text-primary);">{{ insight.title }}</div>
                  <div class="text-xs" style="color: var(--text-muted);">{{ insight.description }}</div>
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    </div>
  `, styles: ["/* angular:styles/component:css;d11053ce0d31d8acc3ce7ea099ed66cdd10b71070d7060e8155d61ff3d8a5314;D:/tgkz2026/src/components/workflow-analytics.component.ts */\n.workflow-analytics {\n  padding: 1.5rem;\n}\n/*# sourceMappingURL=workflow-analytics.component.css.map */\n"] }]
  }], null, null);
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(WorkflowAnalyticsComponent, { className: "WorkflowAnalyticsComponent", filePath: "src/components/workflow-analytics.component.ts", lineNumber: 243 });
})();

// src/multi-role/multi-role-center.component.ts
var _c03 = ["importFileInput"];
var _c12 = ["goalInput"];
var _c2 = () => [1, 2, 3, 4, 5];
var _forTrack09 = ($index, $item) => $item.id;
var _forTrack14 = ($index, $item) => $item.telegramId;
var _forTrack22 = ($index, $item) => $item.step;
function MultiRoleCenterComponent_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 9);
    \u0275\u0275element(1, "span", 28);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r0.multiRoleService.activeGroupCount(), " \u500B\u5354\u4F5C\u9032\u884C\u4E2D ");
  }
}
function MultiRoleCenterComponent_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 10);
    \u0275\u0275text(1, " \u7121\u6D3B\u8E8D\u5354\u4F5C ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_For_31_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 29);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_For_31_Template_button_click_0_listener() {
      const tab_r3 = \u0275\u0275restoreView(_r2).$implicit;
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.activeTab.set(tab_r3.id));
    });
    \u0275\u0275elementStart(1, "span", 30);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "span");
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const tab_r3 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275classProp("bg-gradient-to-r", ctx_r0.activeTab() === tab_r3.id)("from-purple-500", ctx_r0.activeTab() === tab_r3.id)("to-pink-500", ctx_r0.activeTab() === tab_r3.id)("text-white", ctx_r0.activeTab() === tab_r3.id)("shadow-lg", ctx_r0.activeTab() === tab_r3.id)("text-slate-400", ctx_r0.activeTab() !== tab_r3.id)("hover:text-white", ctx_r0.activeTab() !== tab_r3.id)("hover:bg-slate-700/50", ctx_r0.activeTab() !== tab_r3.id);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(tab_r3.icon);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(tab_r3.label);
  }
}
function MultiRoleCenterComponent_Case_33_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 21)(1, "div", 31)(2, "div", 4)(3, "div")(4, "h2", 32)(5, "span", 7);
    \u0275\u0275text(6, "\u{1F916}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(7, " AI \u667A\u80FD\u7B56\u5283 ");
    \u0275\u0275elementStart(8, "span", 33);
    \u0275\u0275text(9, "NEW");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(10, "p", 34);
    \u0275\u0275text(11, "\u544A\u8A34 AI \u4F60\u7684\u76EE\u6A19\uFF0C\u81EA\u52D5\u751F\u6210\u6700\u4F73\u89D2\u8272\u7D44\u5408\u548C\u57F7\u884C\u7B56\u7565");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(12, "button", 35);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_33_Template_button_click_12_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.openAIPlanner());
    });
    \u0275\u0275elementStart(13, "span");
    \u0275\u0275text(14, "\u{1F680}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(15, " \u958B\u59CB\u7B56\u5283 ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(16, "div", 36)(17, "span", 37);
    \u0275\u0275text(18, "\u5FEB\u901F\u9078\u64C7\uFF1A");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "button", 38);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_33_Template_button_click_19_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.quickAIPlan("\u4FC3\u9032\u9996\u55AE\u6210\u4EA4"));
    });
    \u0275\u0275text(20, " \u{1F4B0} \u4FC3\u9032\u9996\u55AE ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "button", 38);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_33_Template_button_click_21_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.quickAIPlan("\u633D\u56DE\u6D41\u5931\u5BA2\u6236"));
    });
    \u0275\u0275text(22, " \u{1F49D} \u633D\u56DE\u6D41\u5931 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "button", 38);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_33_Template_button_click_23_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.quickAIPlan("\u63D0\u5347\u793E\u7FA4\u6D3B\u8E8D\u5EA6"));
    });
    \u0275\u0275text(24, " \u{1F389} \u793E\u7FA4\u6D3B\u8E8D ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(25, "button", 38);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_33_Template_button_click_25_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.quickAIPlan("\u8655\u7406\u552E\u5F8C\u554F\u984C"));
    });
    \u0275\u0275text(26, " \u{1F527} \u552E\u5F8C\u670D\u52D9 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275element(27, "app-collaboration-dashboard");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Case_34_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "app-role-library", 39);
    \u0275\u0275listener("roleAdded", function MultiRoleCenterComponent_Case_34_Template_app_role_library_roleAdded_0_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onPresetRoleAdded($event));
    })("roleEdit", function MultiRoleCenterComponent_Case_34_Template_app_role_library_roleEdit_0_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onPresetRoleEdit($event));
    });
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Case_35_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 21)(1, "div", 4)(2, "div")(3, "h2", 40)(4, "span");
    \u0275\u0275text(5, "\u{1F3AC}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(6, " \u5834\u666F\u6A21\u677F\u5EAB ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "p", 41);
    \u0275\u0275text(8, "10\u500B\u9810\u8A2D\u5834\u666F\uFF0C\u5FEB\u901F\u555F\u52D5\u591A\u89D2\u8272\u5354\u4F5C");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(9, "app-scenario-selector", 42);
    \u0275\u0275listener("scenarioApplied", function MultiRoleCenterComponent_Case_35_Template_app_scenario_selector_scenarioApplied_9_listener($event) {
      \u0275\u0275restoreView(_r6);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onScenarioApplied($event));
    });
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Case_36_For_11_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 57);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const role_r10 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u7D81\u5B9A: ", role_r10.boundAccountPhone, " ");
  }
}
function MultiRoleCenterComponent_Case_36_For_11_Conditional_11_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 58);
    \u0275\u0275text(1, " \u672A\u7D81\u5B9A\u5E33\u865F ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Case_36_For_11_Template(rf, ctx) {
  if (rf & 1) {
    const _r9 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 48)(1, "div", 5)(2, "div", 53);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div")(5, "div", 54);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "div", 55);
    \u0275\u0275text(8);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "div", 56);
    \u0275\u0275conditionalCreate(10, MultiRoleCenterComponent_Case_36_For_11_Conditional_10_Template, 2, 1, "span", 57)(11, MultiRoleCenterComponent_Case_36_For_11_Conditional_11_Template, 2, 0, "span", 58);
    \u0275\u0275elementStart(12, "span", 59);
    \u0275\u0275text(13);
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(14, "div", 60)(15, "button", 61);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_36_For_11_Template_button_click_15_listener() {
      const role_r10 = \u0275\u0275restoreView(_r9).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.editRole(role_r10));
    });
    \u0275\u0275text(16, " \u7DE8\u8F2F ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(17, "button", 62);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_36_For_11_Template_button_click_17_listener() {
      const role_r10 = \u0275\u0275restoreView(_r9).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.deleteRole(role_r10));
    });
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(18, "svg", 63);
    \u0275\u0275element(19, "path", 64);
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const role_r10 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(2);
    \u0275\u0275classProp("bg-purple-500/20", role_r10.type === "expert")("bg-emerald-500/20", role_r10.type === "satisfied_customer")("bg-cyan-500/20", role_r10.type === "support")("bg-orange-500/20", role_r10.type === "manager")("bg-slate-600", role_r10.type === "custom");
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r0.getRoleIcon(role_r10.type), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(role_r10.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(role_r10.personality.description);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(role_r10.boundAccountPhone ? 10 : 11);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ctx_r0.getRoleStyleLabel(role_r10.personality.speakingStyle), " ");
  }
}
function MultiRoleCenterComponent_Case_36_ForEmpty_12_Template(rf, ctx) {
  if (rf & 1) {
    const _r8 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 49)(1, "div", 65);
    \u0275\u0275text(2, "\u{1F3AD}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p", 66);
    \u0275\u0275text(4, "\u5C1A\u672A\u5B9A\u7FA9\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "p", 67);
    \u0275\u0275text(6, "\u5275\u5EFA\u89D2\u8272\u4F86\u7D44\u5EFA\u591A\u89D2\u8272\u5354\u4F5C\u5718\u968A");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "button", 68);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_36_ForEmpty_12_Template_button_click_7_listener() {
      \u0275\u0275restoreView(_r8);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.showAddRole.set(true));
    });
    \u0275\u0275text(8, " + \u5275\u5EFA\u7B2C\u4E00\u500B\u89D2\u8272 ");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Case_36_For_18_Template(rf, ctx) {
  if (rf & 1) {
    const _r11 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 69);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_36_For_18_Template_button_click_0_listener() {
      const type_r12 = \u0275\u0275restoreView(_r11).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.quickAddRole(type_r12.id));
    });
    \u0275\u0275elementStart(1, "div", 70);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 71);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 72);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const type_r12 = ctx.$implicit;
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(type_r12.icon);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(type_r12.label);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(type_r12.description);
  }
}
function MultiRoleCenterComponent_Case_36_Template(rf, ctx) {
  if (rf & 1) {
    const _r7 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 22)(1, "div", 43)(2, "div", 44)(3, "h3", 45)(4, "span");
    \u0275\u0275text(5, "\u{1F3AD}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(6, " \u89D2\u8272\u5B9A\u7FA9 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "button", 46);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_36_Template_button_click_7_listener() {
      \u0275\u0275restoreView(_r7);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.showAddRole.set(true));
    });
    \u0275\u0275text(8, " + \u6DFB\u52A0\u89D2\u8272 ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(9, "div", 47);
    \u0275\u0275repeaterCreate(10, MultiRoleCenterComponent_Case_36_For_11_Template, 20, 15, "div", 48, _forTrack09, false, MultiRoleCenterComponent_Case_36_ForEmpty_12_Template, 9, 0, "div", 49);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(13, "div", 43)(14, "h4", 50);
    \u0275\u0275text(15, "\u5FEB\u901F\u6DFB\u52A0\u9810\u8A2D\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "div", 51);
    \u0275\u0275repeaterCreate(17, MultiRoleCenterComponent_Case_36_For_18_Template, 7, 3, "button", 52, _forTrack09);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275repeater(ctx_r0.multiRoleService.roles());
    \u0275\u0275advance(7);
    \u0275\u0275repeater(ctx_r0.roleTypes);
  }
}
function MultiRoleCenterComponent_Case_37_For_11_Conditional_14_For_2_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(0, "svg", 85);
    \u0275\u0275element(1, "path", 86);
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Case_37_For_11_Conditional_14_For_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 8)(1, "div", 84);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(3, MultiRoleCenterComponent_Case_37_For_11_Conditional_14_For_2_Conditional_3_Template, 2, 0, ":svg:svg", 85);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const stage_r17 = ctx.$implicit;
    const \u0275$index_274_r18 = ctx.$index;
    const script_r16 = \u0275\u0275nextContext(2).$implicit;
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", stage_r17.name, " ");
    \u0275\u0275advance();
    \u0275\u0275conditional(\u0275$index_274_r18 < script_r16.stages.length - 1 ? 3 : -1);
  }
}
function MultiRoleCenterComponent_Case_37_For_11_Conditional_14_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 82);
    \u0275\u0275repeaterCreate(1, MultiRoleCenterComponent_Case_37_For_11_Conditional_14_For_2_Template, 4, 2, "div", 8, _forTrack09);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const script_r16 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance();
    \u0275\u0275repeater(script_r16.stages);
  }
}
function MultiRoleCenterComponent_Case_37_For_11_Template(rf, ctx) {
  if (rf & 1) {
    const _r15 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 73)(1, "div", 78)(2, "div")(3, "div", 54);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 55);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(7, "div", 8)(8, "span", 79);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "button", 80);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_37_For_11_Template_button_click_10_listener() {
      const script_r16 = \u0275\u0275restoreView(_r15).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.editScript(script_r16));
    });
    \u0275\u0275text(11, " \u7DE8\u8F2F ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(12, "button", 81);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_37_For_11_Template_button_click_12_listener() {
      const script_r16 = \u0275\u0275restoreView(_r15).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.deleteScript(script_r16));
    });
    \u0275\u0275text(13, " \u522A\u9664 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(14, MultiRoleCenterComponent_Case_37_For_11_Conditional_14_Template, 3, 0, "div", 82);
    \u0275\u0275elementStart(15, "div", 83)(16, "span");
    \u0275\u0275text(17);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(18, "span");
    \u0275\u0275text(19);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(20, "span");
    \u0275\u0275text(21);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const script_r16 = ctx.$implicit;
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(script_r16.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(script_r16.description);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", script_r16.stages.length, " \u500B\u968E\u6BB5 ");
    \u0275\u0275advance(5);
    \u0275\u0275conditional(script_r16.stages.length > 0 ? 14 : -1);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1("\u4F7F\u7528 ", script_r16.stats.useCount, " \u6B21");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("\u6210\u529F\u7387 ", (script_r16.stats.conversionRate * 100).toFixed(0), "%");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("\u5E73\u5747 ", script_r16.stats.avgDuration, " \u5206\u9418");
  }
}
function MultiRoleCenterComponent_Case_37_ForEmpty_12_Template(rf, ctx) {
  if (rf & 1) {
    const _r14 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 74)(1, "div", 87);
    \u0275\u0275text(2, "\u{1F4DC}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p");
    \u0275\u0275text(4, "\u5C1A\u672A\u5275\u5EFA\u5287\u672C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "button", 88);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_37_ForEmpty_12_Template_button_click_5_listener() {
      \u0275\u0275restoreView(_r14);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.addScript());
    });
    \u0275\u0275text(6, " + \u5275\u5EFA\u5287\u672C ");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Case_37_Template(rf, ctx) {
  if (rf & 1) {
    const _r13 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 22)(1, "div", 43)(2, "div", 44)(3, "h3", 45)(4, "span");
    \u0275\u0275text(5, "\u{1F4DC}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(6, " \u5354\u4F5C\u5287\u672C ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "button", 46);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_37_Template_button_click_7_listener() {
      \u0275\u0275restoreView(_r13);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.addScript());
    });
    \u0275\u0275text(8, " + \u65B0\u5EFA\u5287\u672C ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(9, "div", 47);
    \u0275\u0275repeaterCreate(10, MultiRoleCenterComponent_Case_37_For_11_Template, 22, 7, "div", 73, _forTrack09, false, MultiRoleCenterComponent_Case_37_ForEmpty_12_Template, 7, 0, "div", 74);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(13, "div", 43)(14, "h4", 50);
    \u0275\u0275text(15, "\u4F7F\u7528\u9810\u8A2D\u6A21\u677F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "div", 75)(17, "button", 76);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_37_Template_button_click_17_listener() {
      \u0275\u0275restoreView(_r13);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.useTemplate("high_intent"));
    });
    \u0275\u0275elementStart(18, "div", 77)(19, "span", 7);
    \u0275\u0275text(20, "\u{1F3AF}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "span", 54);
    \u0275\u0275text(22, "\u9AD8\u610F\u5411\u5BA2\u6236\u8F49\u5316");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(23, "p", 55);
    \u0275\u0275text(24, "\u5C08\u5BB6\u4ECB\u7D39 + \u8001\u5BA2\u6236\u80CC\u66F8 + \u5BA2\u670D\u4FC3\u55AE");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(25, "button", 76);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_37_Template_button_click_25_listener() {
      \u0275\u0275restoreView(_r13);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.useTemplate("product_demo"));
    });
    \u0275\u0275elementStart(26, "div", 77)(27, "span", 7);
    \u0275\u0275text(28, "\u{1F4E6}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "span", 54);
    \u0275\u0275text(30, "\u7522\u54C1\u6F14\u793A\u63A8\u85A6");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(31, "p", 55);
    \u0275\u0275text(32, "\u529F\u80FD\u5C55\u793A + \u4F7F\u7528\u5834\u666F + \u6548\u679C\u5206\u4EAB");
    \u0275\u0275elementEnd()()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275repeater(ctx_r0.multiRoleService.scripts());
  }
}
function MultiRoleCenterComponent_Case_38_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 49)(1, "div", 65);
    \u0275\u0275text(2, "\u{1F3E0}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p", 66);
    \u0275\u0275text(4, "\u66AB\u7121\u5354\u4F5C\u7FA4\u7D44");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "p", 67);
    \u0275\u0275text(6, "\u7576\u89F8\u767C\u591A\u89D2\u8272\u5354\u4F5C\u6642\uFF0C\u7CFB\u7D71\u6703\u81EA\u52D5\u5EFA\u7ACB\u5354\u4F5C\u7FA4\u7D44");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "p", 14);
    \u0275\u0275text(8, "\u{1F4A1} \u63D0\u793A\uFF1A\u5148\u5728\u300C\u6211\u7684\u89D2\u8272\u300D\u4E2D\u6DFB\u52A0\u89D2\u8272\u4E26\u7D81\u5B9A\u5E33\u865F");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Case_38_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r19 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 49)(1, "div", 65);
    \u0275\u0275text(2, "\u{1F3E0}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p", 66);
    \u0275\u0275text(4, "\u66AB\u7121\u5354\u4F5C\u7FA4\u7D44");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "p", 67);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "button", 68);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_38_Conditional_10_Template_button_click_7_listener() {
      \u0275\u0275restoreView(_r19);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.showCreateGroupDialog.set(true));
    });
    \u0275\u0275text(8, " + \u5275\u5EFA\u5354\u4F5C\u7FA4\u7D44 ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(6);
    \u0275\u0275textInterpolate1("\u60A8\u5DF2\u6709 ", ctx_r0.multiRoleService.roles().length, " \u500B\u89D2\u8272\u5C31\u7DD2");
  }
}
function MultiRoleCenterComponent_Case_38_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 22)(1, "div", 43)(2, "div", 44)(3, "h3", 45)(4, "span");
    \u0275\u0275text(5, "\u{1F3E0}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(6, " \u5354\u4F5C\u7FA4\u7D44 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "button", 89);
    \u0275\u0275text(8, " + \u624B\u52D5\u5275\u5EFA ");
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(9, MultiRoleCenterComponent_Case_38_Conditional_9_Template, 9, 0, "div", 49)(10, MultiRoleCenterComponent_Case_38_Conditional_10_Template, 9, 1, "div", 49);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(9);
    \u0275\u0275conditional(ctx_r0.multiRoleService.roles().length === 0 ? 9 : 10);
  }
}
function MultiRoleCenterComponent_Case_39_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "app-workflow-config");
  }
}
function MultiRoleCenterComponent_Case_40_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "app-workflow-monitor");
  }
}
function MultiRoleCenterComponent_Case_41_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "app-workflow-analytics");
  }
}
function MultiRoleCenterComponent_Case_42_Template(rf, ctx) {
  if (rf & 1) {
    const _r20 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 23)(1, "div", 43)(2, "h3", 90)(3, "span");
    \u0275\u0275text(4, "\u2699\uFE0F");
    \u0275\u0275elementEnd();
    \u0275\u0275text(5, " \u81EA\u52D5\u5EFA\u7FA4\u8A2D\u7F6E ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 47)(7, "div")(8, "label", 91);
    \u0275\u0275text(9, "\u7FA4\u540D\u6A21\u677F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "input", 92);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_10_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.autoGroupNameTemplate, $event) || (ctx_r0.autoGroupNameTemplate = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "p", 93);
    \u0275\u0275text(12);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(13, "div")(14, "label", 91);
    \u0275\u0275text(15, "\u9080\u8ACB\u8A71\u8853");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "textarea", 94);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_textarea_ngModelChange_16_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.inviteMessage, $event) || (ctx_r0.inviteMessage = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275text(17, "                    ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(18, "div", 75)(19, "div")(20, "label", 91);
    \u0275\u0275text(21, "\u6700\u5927\u540C\u6642\u5354\u4F5C\u6578");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(22, "input", 95);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_22_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.maxConcurrent, $event) || (ctx_r0.maxConcurrent = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(23, "div")(24, "label", 91);
    \u0275\u0275text(25, "\u81EA\u52D5\u95DC\u9589\u5929\u6578");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(26, "input", 96);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_26_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.autoCloseDays, $event) || (ctx_r0.autoCloseDays = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()()()()();
    \u0275\u0275elementStart(27, "div", 43)(28, "h3", 90)(29, "span");
    \u0275\u0275text(30, "\u{1F3AF}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(31, " \u9ED8\u8A8D\u89F8\u767C\u689D\u4EF6 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(32, "div", 47)(33, "div", 75)(34, "div")(35, "label", 91);
    \u0275\u0275text(36, "\u610F\u5411\u8A55\u5206\u95BE\u503C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(37, "div", 8)(38, "input", 97);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_38_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.intentThreshold, $event) || (ctx_r0.intentThreshold = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(39, "span", 98);
    \u0275\u0275text(40);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(41, "div")(42, "label", 91);
    \u0275\u0275text(43, "\u6700\u5C11\u5C0D\u8A71\u8F2A\u6578");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(44, "input", 95);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_44_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.minRounds, $event) || (ctx_r0.minRounds = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(45, "label", 99)(46, "div")(47, "div", 100);
    \u0275\u0275text(48, "\u9700\u8981\u8A62\u554F\u904E\u50F9\u683C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(49, "div", 101);
    \u0275\u0275text(50, "\u53EA\u6709\u8A62\u554F\u904E\u50F9\u683C\u7684\u5BA2\u6236\u624D\u89F8\u767C");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(51, "input", 102);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_51_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.requirePriceInquiry, $event) || (ctx_r0.requirePriceInquiry = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(52, "div", 43)(53, "h3", 90)(54, "span");
    \u0275\u0275text(55, "\u{1F916}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(56, " AI \u8A2D\u7F6E ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(57, "label", 103)(58, "div")(59, "div", 100);
    \u0275\u0275text(60, "\u4F7F\u7528 AI \u4E2D\u5FC3\u914D\u7F6E");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(61, "div", 101);
    \u0275\u0275text(62, "\u5F9E AI \u4E2D\u5FC3\u7372\u53D6\u6A21\u578B\u548C\u77E5\u8B58\u5EAB\u914D\u7F6E");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(63, "input", 102);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Case_42_Template_input_ngModelChange_63_listener($event) {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.useAICenter, $event) || (ctx_r0.useAICenter = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(64, "div")(65, "label", 91);
    \u0275\u0275text(66, "\u5354\u4F5C\u6A21\u5F0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(67, "div", 104)(68, "button", 105);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_42_Template_button_click_68_listener() {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.coordinationMode = "sequential");
    });
    \u0275\u0275text(69, " \u9806\u5E8F\u57F7\u884C ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(70, "button", 105);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_42_Template_button_click_70_listener() {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.coordinationMode = "responsive");
    });
    \u0275\u0275text(71, " \u97FF\u61C9\u5F0F ");
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(72, "button", 106);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Case_42_Template_button_click_72_listener() {
      \u0275\u0275restoreView(_r20);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.saveSettings());
    });
    \u0275\u0275text(73, " \u4FDD\u5B58\u8A2D\u7F6E ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.autoGroupNameTemplate);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate2("\u53EF\u7528\u8B8A\u91CF: ", "{", "\u5BA2\u6236\u540D", "}");
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.inviteMessage);
    \u0275\u0275advance(6);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.maxConcurrent);
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.autoCloseDays);
    \u0275\u0275advance(12);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.intentThreshold);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", ctx_r0.intentThreshold, "%");
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.minRounds);
    \u0275\u0275advance(7);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.requirePriceInquiry);
    \u0275\u0275advance(12);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.useAICenter);
    \u0275\u0275advance(5);
    \u0275\u0275classProp("bg-purple-500", ctx_r0.coordinationMode === "sequential")("text-white", ctx_r0.coordinationMode === "sequential")("bg-slate-700", ctx_r0.coordinationMode !== "sequential")("text-slate-300", ctx_r0.coordinationMode !== "sequential");
    \u0275\u0275advance(2);
    \u0275\u0275classProp("bg-purple-500", ctx_r0.coordinationMode === "responsive")("text-white", ctx_r0.coordinationMode === "responsive")("bg-slate-700", ctx_r0.coordinationMode !== "responsive")("text-slate-300", ctx_r0.coordinationMode !== "responsive");
  }
}
function MultiRoleCenterComponent_Conditional_43_For_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r22 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 117);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_43_For_10_Template_button_click_0_listener() {
      const type_r23 = \u0275\u0275restoreView(_r22).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.newRoleType.set(type_r23.id));
    });
    \u0275\u0275elementStart(1, "div", 118);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 119);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const type_r23 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("border-purple-500", ctx_r0.newRoleType() === type_r23.id)("bg-purple-500/10", ctx_r0.newRoleType() === type_r23.id)("border-transparent", ctx_r0.newRoleType() !== type_r23.id)("bg-slate-700", ctx_r0.newRoleType() !== type_r23.id);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(type_r23.icon);
    \u0275\u0275advance();
    \u0275\u0275classProp("text-purple-400", ctx_r0.newRoleType() === type_r23.id)("text-slate-300", ctx_r0.newRoleType() !== type_r23.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", type_r23.label, " ");
  }
}
function MultiRoleCenterComponent_Conditional_43_Template(rf, ctx) {
  if (rf & 1) {
    const _r21 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 24)(1, "div", 107)(2, "h3", 108);
    \u0275\u0275text(3, "\u6DFB\u52A0\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 47)(5, "div")(6, "label", 91);
    \u0275\u0275text(7, "\u89D2\u8272\u985E\u578B");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div", 109);
    \u0275\u0275repeaterCreate(9, MultiRoleCenterComponent_Conditional_43_For_10_Template, 5, 14, "button", 110, _forTrack09);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(11, "div")(12, "label", 91);
    \u0275\u0275text(13, "\u89D2\u8272\u540D\u7A31");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "input", 111);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_43_Template_input_ngModelChange_14_listener($event) {
      \u0275\u0275restoreView(_r21);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.newRoleName, $event) || (ctx_r0.newRoleName = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(15, "div")(16, "label", 91);
    \u0275\u0275text(17, "\u4EBA\u8A2D\u63CF\u8FF0");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(18, "textarea", 112);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_43_Template_textarea_ngModelChange_18_listener($event) {
      \u0275\u0275restoreView(_r21);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.newRoleDescription, $event) || (ctx_r0.newRoleDescription = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275text(19, "                ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(20, "div")(21, "label", 91);
    \u0275\u0275text(22, "AI \u4EBA\u8A2D Prompt");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "textarea", 113);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_43_Template_textarea_ngModelChange_23_listener($event) {
      \u0275\u0275restoreView(_r21);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.newRolePrompt, $event) || (ctx_r0.newRolePrompt = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275text(24, "                ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(25, "div", 114)(26, "button", 115);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_43_Template_button_click_26_listener() {
      \u0275\u0275restoreView(_r21);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.showAddRole.set(false));
    });
    \u0275\u0275text(27, " \u53D6\u6D88 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(28, "button", 116);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_43_Template_button_click_28_listener() {
      \u0275\u0275restoreView(_r21);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.saveNewRole());
    });
    \u0275\u0275text(29, " \u6DFB\u52A0 ");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(9);
    \u0275\u0275repeater(ctx_r0.roleTypes);
    \u0275\u0275advance(5);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.newRoleName);
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.newRoleDescription);
    \u0275\u0275advance(5);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.newRolePrompt);
  }
}
function MultiRoleCenterComponent_Conditional_44_Template(rf, ctx) {
  if (rf & 1) {
    const _r24 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "app-role-editor", 120);
    \u0275\u0275listener("saved", function MultiRoleCenterComponent_Conditional_44_Template_app_role_editor_saved_0_listener($event) {
      \u0275\u0275restoreView(_r24);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onRoleSaved($event));
    })("cancelled", function MultiRoleCenterComponent_Conditional_44_Template_app_role_editor_cancelled_0_listener() {
      \u0275\u0275restoreView(_r24);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onRoleEditorCancelled());
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("role", ctx_r0.editingRole())("availableAccounts", ctx_r0.availableAccounts());
  }
}
function MultiRoleCenterComponent_Conditional_45_Template(rf, ctx) {
  if (rf & 1) {
    const _r25 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "app-script-editor", 121);
    \u0275\u0275listener("saved", function MultiRoleCenterComponent_Conditional_45_Template_app_script_editor_saved_0_listener($event) {
      \u0275\u0275restoreView(_r25);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onScriptSaved($event));
    })("cancelled", function MultiRoleCenterComponent_Conditional_45_Template_app_script_editor_cancelled_0_listener() {
      \u0275\u0275restoreView(_r25);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onScriptEditorCancelled());
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("script", ctx_r0.editingScript());
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template(rf, ctx) {
  if (rf & 1) {
    const _r27 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div")(1, "label", 91);
    \u0275\u0275text(2, "\u{1F3AF} \u544A\u8A34 AI \u4F60\u60F3\u9054\u6210\u4EC0\u9EBC\u76EE\u6A19");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "textarea", 129, 0);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template_textarea_ngModelChange_3_listener($event) {
      \u0275\u0275restoreView(_r27);
      const ctx_r0 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r0.aiPlannerGoal, $event) || (ctx_r0.aiPlannerGoal = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template_textarea_click_3_listener($event) {
      \u0275\u0275restoreView(_r27);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275text(5, "                  ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(6, "div")(7, "label", 91);
    \u0275\u0275text(8, "\u6216\u9078\u64C7\u5E38\u898B\u76EE\u6A19");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "div", 130)(10, "button", 131);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template_button_click_10_listener() {
      \u0275\u0275restoreView(_r27);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.aiPlannerGoal = "\u628A\u7336\u8C6B\u4E0D\u6C7A\u7684\u6F5B\u5728\u5BA2\u6236\u8F49\u5316\u70BA\u4ED8\u8CBB\u7528\u6236");
    });
    \u0275\u0275elementStart(11, "div", 132);
    \u0275\u0275text(12, "\u{1F4B0}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(13, "div", 71);
    \u0275\u0275text(14, "\u4FC3\u9032\u9996\u55AE\u6210\u4EA4");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "div", 101);
    \u0275\u0275text(16, "\u591A\u89D2\u8272\u914D\u5408\u4FC3\u9032\u7336\u8C6B\u5BA2\u6236\u4E0B\u55AE");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(17, "button", 131);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template_button_click_17_listener() {
      \u0275\u0275restoreView(_r27);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.aiPlannerGoal = "\u633D\u56DE\u5DF2\u6D41\u5931\u7684\u8001\u5BA2\u6236\uFF0C\u8B93\u4ED6\u5011\u91CD\u65B0\u8CFC\u8CB7");
    });
    \u0275\u0275elementStart(18, "div", 132);
    \u0275\u0275text(19, "\u{1F49D}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(20, "div", 71);
    \u0275\u0275text(21, "\u633D\u56DE\u6D41\u5931\u5BA2\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(22, "div", 101);
    \u0275\u0275text(23, "\u95DC\u61F7\u56DE\u8A2A + \u7279\u5225\u512A\u60E0");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(24, "button", 131);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template_button_click_24_listener() {
      \u0275\u0275restoreView(_r27);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.aiPlannerGoal = "\u8B93\u793E\u7FA4\u66F4\u6D3B\u8E8D\uFF0C\u589E\u52A0\u7528\u6236\u4E92\u52D5\u548C\u7C98\u6027");
    });
    \u0275\u0275elementStart(25, "div", 132);
    \u0275\u0275text(26, "\u{1F389}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(27, "div", 71);
    \u0275\u0275text(28, "\u63D0\u5347\u793E\u7FA4\u6D3B\u8E8D");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "div", 101);
    \u0275\u0275text(30, "\u8A71\u984C\u5F15\u5C0E + \u4E92\u52D5\u6FC0\u52F5");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(31, "button", 131);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_11_Template_button_click_31_listener() {
      \u0275\u0275restoreView(_r27);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.aiPlannerGoal = "\u9AD8\u6548\u8655\u7406\u5BA2\u6236\u552E\u5F8C\u554F\u984C\uFF0C\u63D0\u5347\u6EFF\u610F\u5EA6");
    });
    \u0275\u0275elementStart(32, "div", 132);
    \u0275\u0275text(33, "\u{1F527}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(34, "div", 71);
    \u0275\u0275text(35, "\u552E\u5F8C\u554F\u984C\u8655\u7406");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(36, "div", 101);
    \u0275\u0275text(37, "\u5FEB\u901F\u97FF\u61C9 + \u6EFF\u610F\u5EA6\u8DDF\u9032");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(3);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.aiPlannerGoal);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_12_Conditional_7_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 136)(1, "div", 138);
    \u0275\u0275element(2, "div", 139);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "span", 14);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(2);
    \u0275\u0275styleProp("width", ctx_r0.Math.min(ctx_r0.aiPlanningElapsed() / 45 * 100, 95), "%");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", ctx_r0.aiPlanningElapsed(), "\u79D2");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 126)(1, "div", 133);
    \u0275\u0275text(2, "\u{1F916}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p", 134);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "p", 135);
    \u0275\u0275text(6, "\u5206\u6790\u76EE\u6A19 \u2192 \u9078\u64C7\u89D2\u8272 \u2192 \u8A2D\u8A08\u6D41\u7A0B");
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(7, MultiRoleCenterComponent_Conditional_46_Conditional_12_Conditional_7_Template, 5, 3, "div", 136);
    \u0275\u0275elementStart(8, "p", 137);
    \u0275\u0275text(9, "AI \u8ABF\u7528\u53EF\u80FD\u9700\u8981 30-45 \u79D2\uFF0C\u8ACB\u8010\u5FC3\u7B49\u5F85");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(ctx_r0.aiPlanningProgress());
    \u0275\u0275advance(3);
    \u0275\u0275conditional(ctx_r0.aiPlanningElapsed() > 0 ? 7 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_16_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 194);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const pain_r29 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate(pain_r29);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_16_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 192)(1, "div", 191);
    \u0275\u0275text(2, "\u5BA2\u6236\u75DB\u9EDE");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 193);
    \u0275\u0275repeaterCreate(4, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_16_For_5_Template, 2, 1, "span", 194, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r0.aiPlanResult().goalAnalysis.painPoints);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_17_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 195);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const point_r30 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate(point_r30);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_17_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 192)(1, "div", 191);
    \u0275\u0275text(2, "\u7522\u54C1\u512A\u52E2");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 193);
    \u0275\u0275repeaterCreate(4, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_17_For_5_Template, 2, 1, "span", 195, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r0.aiPlanResult().goalAnalysis.keySellingPoints);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 140)(1, "h4", 189)(2, "span");
    \u0275\u0275text(3, "\u{1F3AF}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(4, " \u76EE\u6A19\u5206\u6790 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 190)(6, "div")(7, "div", 191);
    \u0275\u0275text(8, "\u7522\u54C1\u985E\u578B");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "div", 100);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(11, "div")(12, "div", 191);
    \u0275\u0275text(13, "\u76EE\u6A19\u5BA2\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "div", 100);
    \u0275\u0275text(15);
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(16, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_16_Template, 6, 0, "div", 192);
    \u0275\u0275conditionalCreate(17, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Conditional_17_Template, 6, 0, "div", 192);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    let tmp_3_0;
    let tmp_4_0;
    let tmp_5_0;
    let tmp_6_0;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(10);
    \u0275\u0275textInterpolate((tmp_3_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_3_0.goalAnalysis == null ? null : tmp_3_0.goalAnalysis.productType);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate((tmp_4_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_4_0.goalAnalysis == null ? null : tmp_4_0.goalAnalysis.targetAudience);
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_5_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_5_0.goalAnalysis == null ? null : tmp_5_0.goalAnalysis.painPoints == null ? null : tmp_5_0.goalAnalysis.painPoints.length) ? 16 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_6_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_6_0.goalAnalysis == null ? null : tmp_6_0.goalAnalysis.keySellingPoints == null ? null : tmp_6_0.goalAnalysis.keySellingPoints.length) ? 17 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 145);
    \u0275\u0275text(1, " \u{1F916} AI \u751F\u6210 ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 146);
    \u0275\u0275text(1, " \u{1F4CB} \u6A21\u677F\u7B56\u7565 ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_53_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 155);
    \u0275\u0275text(1, "\uFF08\u4E0D\u8DB3\uFF01\uFF09");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_54_Template(rf, ctx) {
  if (rf & 1) {
    const _r31 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 156)(1, "div", 196)(2, "span");
    \u0275\u0275text(3, "\u26A0\uFE0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "span");
    \u0275\u0275text(5);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(6, "button", 197);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_54_Template_button_click_6_listener() {
      \u0275\u0275restoreView(_r31);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.goToAccountManagement());
    });
    \u0275\u0275text(7, " \u2795 \u6DFB\u52A0\u66F4\u591A\u5E33\u865F ");
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate2("\u5E33\u865F\u4E0D\u8DB3\uFF01\u9700\u8981 ", ctx_r0.requiredAccountsForGroup(), " \u500B\u5E33\u865F\uFF0C\u7576\u524D\u53EA\u6709 ", ctx_r0.availableAccountCount(), " \u500B\u5728\u7DDA\u3002");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_55_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 157)(1, "div", 198);
    \u0275\u0275text(2, "\u{1F3AC} \u7FA4\u804A\u5354\u4F5C\u6D41\u7A0B");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 199)(4, "span", 200);
    \u0275\u0275text(5, "\u2460 \u5EFA\u7FA4");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "span");
    \u0275\u0275text(7, "\u2192");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "span", 200);
    \u0275\u0275text(9, "\u2461 \u9080\u8ACB\u5BA2\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "span");
    \u0275\u0275text(11, "\u2192");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(12, "span", 200);
    \u0275\u0275text(13, "\u2462 \u9080\u8ACB\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "span");
    \u0275\u0275text(15, "\u2192");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "span", 200);
    \u0275\u0275text(17, "\u2463 \u5354\u4F5C\u670D\u52D9");
    \u0275\u0275elementEnd()()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_82_Template(rf, ctx) {
  if (rf & 1) {
    const _r32 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 162)(1, "div", 201);
    \u0275\u0275text(2, "\u8ACB\u9078\u64C7\u8981\u9032\u884C\u71DF\u92B7\u7684\u76EE\u6A19\u7528\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 202)(4, "button", 203);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_82_Template_button_click_4_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.openTargetUserSelector());
    });
    \u0275\u0275text(5, " \u{1F4D2} \u5F9E\u901A\u8A0A\u9304\u9078\u64C7 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "button", 204);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_82_Template_button_click_6_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.selectHighIntentUsers());
    });
    \u0275\u0275text(7, " \u2B50 \u81EA\u52D5\u9078\u9AD8\u610F\u5411 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "button", 205);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_82_Template_button_click_8_listener() {
      \u0275\u0275restoreView(_r32);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.triggerImportFile());
    });
    \u0275\u0275text(9, " \u{1F4E5} \u6279\u91CF\u5C0E\u5165 ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(10, "input", 206, 1);
    \u0275\u0275listener("change", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_82_Template_input_change_10_listener($event) {
      \u0275\u0275restoreView(_r32);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.handleImportFile($event));
    });
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_For_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 210);
    \u0275\u0275text(1);
    \u0275\u0275elementStart(2, "span", 212);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const user_r34 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", user_r34.firstName || user_r34.username || user_r34.telegramId, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("", user_r34.intentScore, "\u5206");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_Conditional_11_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 211);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" +", ctx_r0.selectedTargetUsers().length - 5, " \u66F4\u591A ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_Template(rf, ctx) {
  if (rf & 1) {
    const _r33 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 142)(1, "span", 207);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 104)(4, "button", 208);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_Template_button_click_4_listener() {
      \u0275\u0275restoreView(_r33);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.openTargetUserSelector());
    });
    \u0275\u0275text(5, " \u4FEE\u6539 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "button", 209);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_Template_button_click_6_listener() {
      \u0275\u0275restoreView(_r33);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.clearSelectedUsers());
    });
    \u0275\u0275text(7, " \u6E05\u7A7A ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(8, "div", 193);
    \u0275\u0275repeaterCreate(9, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_For_10_Template, 4, 2, "span", 210, _forTrack14);
    \u0275\u0275conditionalCreate(11, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_Conditional_11_Template, 2, 1, "span", 211);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" \u2713 \u5DF2\u9078\u64C7 ", ctx_r0.selectedTargetUsers().length, " \u500B\u76EE\u6A19 ");
    \u0275\u0275advance(7);
    \u0275\u0275repeater(ctx_r0.selectedTargetUsers().slice(0, 5));
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.selectedTargetUsers().length > 5 ? 11 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_91_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 165);
    \u0275\u0275text(1, "AI \u81EA\u52D5\u5206\u914D");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_92_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 166);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u5DF2\u9078 ", ctx_r0.plannerSelectedAccounts().length, " \u500B\u5E33\u865F ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_For_14_Template(rf, ctx) {
  if (rf & 1) {
    const _r36 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 221);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_For_14_Template_button_click_0_listener() {
      const n_r37 = \u0275\u0275restoreView(_r36).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.plannerAccountCount.set(ctx_r0.Math.min(n_r37, ctx_r0.availableAccountCount())));
    });
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const n_r37 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275classProp("bg-purple-500", ctx_r0.plannerAccountCount() === n_r37)("text-white", ctx_r0.plannerAccountCount() === n_r37)("bg-slate-700", ctx_r0.plannerAccountCount() !== n_r37)("text-slate-400", ctx_r0.plannerAccountCount() !== n_r37);
    \u0275\u0275property("disabled", n_r37 > ctx_r0.availableAccountCount());
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", n_r37, " ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Conditional_5_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "option", 233);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const role_r42 = ctx.$implicit;
    \u0275\u0275property("value", role_r42.id);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate2("", role_r42.icon, " ", role_r42.name);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Conditional_5_Template(rf, ctx) {
  if (rf & 1) {
    const _r41 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 230)(1, "select", 231);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Conditional_5_Template_select_click_1_listener($event) {
      \u0275\u0275restoreView(_r41);
      return \u0275\u0275resetView($event.stopPropagation());
    })("change", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Conditional_5_Template_select_change_1_listener($event) {
      \u0275\u0275restoreView(_r41);
      const account_r40 = \u0275\u0275nextContext(2).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(5);
      return \u0275\u0275resetView(ctx_r0.onAccountRoleChange(account_r40.id, $event));
    });
    \u0275\u0275elementStart(2, "option", 232);
    \u0275\u0275text(3, "\u{1F916} AI \u5206\u914D\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275repeaterCreate(4, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Conditional_5_For_5_Template, 2, 3, "option", 233, _forTrack09);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const account_r40 = \u0275\u0275nextContext(2).$implicit;
    const ctx_r0 = \u0275\u0275nextContext(5);
    \u0275\u0275advance();
    \u0275\u0275property("value", ctx_r0.plannerAccountRoles().get(account_r40.id) || "");
    \u0275\u0275advance(3);
    \u0275\u0275repeater(ctx_r0.availableRoleTypes);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    const _r39 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 227);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r39);
      const account_r40 = \u0275\u0275nextContext().$implicit;
      const ctx_r0 = \u0275\u0275nextContext(5);
      return \u0275\u0275resetView(ctx_r0.toggleAccountSelection(account_r40.id));
    });
    \u0275\u0275elementStart(1, "div", 8);
    \u0275\u0275element(2, "span", 228);
    \u0275\u0275elementStart(3, "span", 229);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(5, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Conditional_5_Template, 6, 1, "div", 230);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const account_r40 = \u0275\u0275nextContext().$implicit;
    const ctx_r0 = \u0275\u0275nextContext(5);
    \u0275\u0275classProp("border-purple-500", ctx_r0.plannerSelectedAccounts().includes(account_r40.id))("bg-purple-500/10", ctx_r0.plannerSelectedAccounts().includes(account_r40.id))("border-slate-700", !ctx_r0.plannerSelectedAccounts().includes(account_r40.id))("bg-slate-800", !ctx_r0.plannerSelectedAccounts().includes(account_r40.id));
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate(account_r40.phone);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.plannerSelectedAccounts().includes(account_r40.id) ? 5 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275conditionalCreate(0, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Conditional_0_Template, 6, 10, "button", 226);
  }
  if (rf & 2) {
    const account_r40 = ctx.$implicit;
    \u0275\u0275conditional(account_r40.status === "Online" ? 0 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Conditional_12_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 235);
    \u0275\u0275text(1);
    \u0275\u0275elementStart(2, "span", 236);
    \u0275\u0275text(3, "\u2192");
    \u0275\u0275elementEnd();
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const accId_r43 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext(6);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r0.getAccountPhone(accId_r43), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ctx_r0.getAssignedRoleName(accId_r43), " ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 225)(1, "div", 234);
    \u0275\u0275text(2, "\u5DF2\u9078\u5E33\u865F\u89D2\u8272\u9810\u89BD\uFF1A");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 193);
    \u0275\u0275repeaterCreate(4, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Conditional_12_For_5_Template, 5, 2, "span", 235, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(5);
    \u0275\u0275advance(4);
    \u0275\u0275repeater(ctx_r0.plannerSelectedAccounts());
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Template(rf, ctx) {
  if (rf & 1) {
    const _r38 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div")(1, "div", 142)(2, "label", 55);
    \u0275\u0275text(3, "\u9078\u64C7\u5E33\u865F\uFF08\u9EDE\u64CA\u9078\u64C7/\u53D6\u6D88\uFF09");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 104)(5, "button", 222);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Template_button_click_5_listener() {
      \u0275\u0275restoreView(_r38);
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.selectAllOnlineAccounts());
    });
    \u0275\u0275text(6, "\u5168\u9078\u5728\u7DDA");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "button", 223);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Template_button_click_7_listener() {
      \u0275\u0275restoreView(_r38);
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.plannerSelectedAccounts.set([]));
    });
    \u0275\u0275text(8, "\u6E05\u7A7A");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(9, "div", 224);
    \u0275\u0275repeaterCreate(10, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_For_11_Template, 1, 1, null, null, _forTrack09);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(12, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Conditional_12_Template, 6, 0, "div", 225);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275advance(10);
    \u0275\u0275repeater(ctx_r0.accountService.accounts());
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.plannerSelectedAccounts().length > 0 ? 12 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Template(rf, ctx) {
  if (rf & 1) {
    const _r35 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 168)(1, "div")(2, "div", 142)(3, "label", 55);
    \u0275\u0275text(4, "\u53C3\u8207\u5E33\u865F\u6578\u91CF");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 8)(6, "span", 134);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "span", 14);
    \u0275\u0275text(9);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(10, "div", 60)(11, "input", 213);
    \u0275\u0275listener("input", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Template_input_input_11_listener($event) {
      \u0275\u0275restoreView(_r35);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.onAccountCountChange($event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(12, "div", 214);
    \u0275\u0275repeaterCreate(13, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_For_14_Template, 2, 10, "button", 215, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(15, "div", 216);
    \u0275\u0275text(16);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(17, "div", 217)(18, "div")(19, "div", 218);
    \u0275\u0275text(20, "AI \u81EA\u52D5\u5206\u914D\u5E33\u865F\u548C\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "div", 14);
    \u0275\u0275text(22, "\u95DC\u9589\u5F8C\u53EF\u624B\u52D5\u9078\u64C7\u5E33\u865F\u4E26\u6307\u5B9A\u89D2\u8272");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(23, "button", 219);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Template_button_click_23_listener() {
      \u0275\u0275restoreView(_r35);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.plannerAutoAssign.set(!ctx_r0.plannerAutoAssign()));
    });
    \u0275\u0275element(24, "span", 220);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(25, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Conditional_25_Template, 13, 1, "div");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(7);
    \u0275\u0275textInterpolate(ctx_r0.plannerAccountCount());
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("/ ", ctx_r0.availableAccountCount(), " \u53EF\u7528");
    \u0275\u0275advance(2);
    \u0275\u0275property("min", 1)("max", ctx_r0.Math.min(5, ctx_r0.availableAccountCount()))("value", ctx_r0.plannerAccountCount());
    \u0275\u0275advance(2);
    \u0275\u0275repeater(\u0275\u0275pureFunction0(15, _c2));
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" \u{1F916} AI \u63A8\u85A6\uFF1A", ctx_r0.getRecommendedAccountCount(), " \u500B\u5E33\u865F\uFF08\u57FA\u65BC\u76EE\u6A19\u5206\u6790\uFF09 ");
    \u0275\u0275advance(7);
    \u0275\u0275classProp("bg-purple-500", ctx_r0.plannerAutoAssign())("bg-slate-600", !ctx_r0.plannerAutoAssign());
    \u0275\u0275advance();
    \u0275\u0275classProp("left-1", !ctx_r0.plannerAutoAssign())("left-7", ctx_r0.plannerAutoAssign());
    \u0275\u0275advance();
    \u0275\u0275conditional(!ctx_r0.plannerAutoAssign() ? 25 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_100_Template(rf, ctx) {
  if (rf & 1) {
    const _r44 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 237);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_100_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r44);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.toggleAccountExplanation());
    });
    \u0275\u0275text(1, " \u{1F4A1} \u70BA\u4EC0\u9EBC\uFF1F ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_101_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 170)(1, "div", 238)(2, "span", 236);
    \u0275\u0275text(3, "\u{1F4A1}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 147)(5, "p", 239);
    \u0275\u0275text(6, "AI \u63A8\u85A6 ");
    \u0275\u0275elementStart(7, "strong", 236);
    \u0275\u0275text(8);
    \u0275\u0275elementEnd();
    \u0275\u0275text(9, " \u500B\u89D2\u8272\uFF1A");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "ul", 240)(11, "li");
    \u0275\u0275text(12, "\u904E\u591A\u5E33\u865F\u53EF\u80FD\u5C0E\u81F4\u904E\u5EA6\u66DD\u5149\uFF0C\u5F15\u8D77\u7528\u6236\u8B66\u89BA");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(13, "li");
    \u0275\u0275text(14, "\u89D2\u8272\u5206\u5DE5\u660E\u78BA\uFF0C\u6BCF\u500B\u89D2\u8272\u6709\u7368\u7279\u4F5C\u7528");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "li");
    \u0275\u0275text(16, "\u5269\u9918\u5E33\u865F\u53EF\u4F5C\u70BA\u5099\u7528\uFF0C\u96A8\u6642\u66FF\u88DC");
    \u0275\u0275elementEnd()()()()();
  }
  if (rf & 2) {
    let tmp_3_0;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(8);
    \u0275\u0275textInterpolate(((tmp_3_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_3_0.recommendedRoles == null ? null : tmp_3_0.recommendedRoles.length) || 0);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 8);
    \u0275\u0275element(1, "span", 249);
    \u0275\u0275elementStart(2, "span", 100);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const \u0275$index_1154_r46 = \u0275\u0275nextContext().$index;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r0.accountMatchResults()[\u0275$index_1154_r46].accountPhone);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 242);
    \u0275\u0275text(1, "\u5F85\u5206\u914D...");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_14_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 243);
    \u0275\u0275text(1, "\u4E3B\u5C0E");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_15_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 166);
    \u0275\u0275text(1, "\u5F85\u547D");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_16_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 244);
    \u0275\u0275text(1, "\u5339\u914D\u4E2D");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_For_6_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 258);
    \u0275\u0275text(1, "\u7576\u524D");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_For_6_Template(rf, ctx) {
  if (rf & 1) {
    const _r48 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 256);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_For_6_Template_button_click_0_listener() {
      const roleType_r49 = \u0275\u0275restoreView(_r48).$implicit;
      const \u0275$index_1154_r46 = \u0275\u0275nextContext(2).$index;
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.changeRoleForIndex(\u0275$index_1154_r46, roleType_r49));
    });
    \u0275\u0275elementStart(1, "span", 30);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 257)(4, "div", 100);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 14);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(8, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_For_6_Conditional_8_Template, 2, 0, "span", 258);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const roleType_r49 = ctx.$implicit;
    const role_r50 = \u0275\u0275nextContext(2).$implicit;
    \u0275\u0275classProp("bg-purple-500/20", role_r50.name === roleType_r49.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(roleType_r49.icon);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(roleType_r49.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(roleType_r49.desc);
    \u0275\u0275advance();
    \u0275\u0275conditional(role_r50.name === roleType_r49.name ? 8 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_Template(rf, ctx) {
  if (rf & 1) {
    const _r47 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 250);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_Template_div_click_0_listener($event) {
      \u0275\u0275restoreView(_r47);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275elementStart(1, "div", 251)(2, "span", 101);
    \u0275\u0275text(3, "\u{1F504} \u9078\u64C7\u65B0\u89D2\u8272");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(4, "div", 252);
    \u0275\u0275repeaterCreate(5, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_For_6_Template, 9, 6, "button", 253, _forTrack09);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "div", 254)(8, "button", 255);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_Template_button_click_8_listener() {
      \u0275\u0275restoreView(_r47);
      const \u0275$index_1154_r46 = \u0275\u0275nextContext().$index;
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.removeRoleAssignment(\u0275$index_1154_r46));
    });
    \u0275\u0275elementStart(9, "span");
    \u0275\u0275text(10, "\u{1F5D1}\uFE0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "span");
    \u0275\u0275text(12, "\u79FB\u70BA\u5099\u7528");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r0.availableRoleTypes);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Template(rf, ctx) {
  if (rf & 1) {
    const _r45 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "tr", 179)(1, "td", 241);
    \u0275\u0275conditionalCreate(2, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_2_Template, 4, 1, "div", 8)(3, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_3_Template, 2, 0, "span", 242);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "td", 241)(5, "div", 8)(6, "span", 30);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div")(9, "div", 100);
    \u0275\u0275text(10);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "div", 14);
    \u0275\u0275text(12);
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(13, "td", 176);
    \u0275\u0275conditionalCreate(14, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_14_Template, 2, 0, "span", 243)(15, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_15_Template, 2, 0, "span", 166)(16, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_16_Template, 2, 0, "span", 244);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(17, "td", 245)(18, "div", 246)(19, "button", 247);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Template_button_click_19_listener($event) {
      const \u0275$index_1154_r46 = \u0275\u0275restoreView(_r45).$index;
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.toggleRoleDropdown(\u0275$index_1154_r46, $event));
    });
    \u0275\u0275text(20, " \u66F4\u63DB ");
    \u0275\u0275elementStart(21, "span");
    \u0275\u0275text(22, "\u25BC");
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(23, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Conditional_23_Template, 13, 0, "div", 248);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const role_r50 = ctx.$implicit;
    const \u0275$index_1154_r46 = ctx.$index;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.accountMatchResults().length > \u0275$index_1154_r46 ? 2 : 3);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(role_r50.icon);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(role_r50.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(role_r50.purpose);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(\u0275$index_1154_r46 === 0 ? 14 : ctx_r0.accountMatchResults().length > \u0275$index_1154_r46 ? 15 : 16);
    \u0275\u0275advance(7);
    \u0275\u0275classProp("rotate-180", ctx_r0.roleChangeModalIndex() === \u0275$index_1154_r46);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.roleChangeModalIndex() === \u0275$index_1154_r46 ? 23 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_For_6_Template(rf, ctx) {
  if (rf & 1) {
    const _r54 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 256);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_For_6_Template_button_click_0_listener() {
      const roleType_r55 = \u0275\u0275restoreView(_r54).$implicit;
      const acc_r52 = \u0275\u0275nextContext(2).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.assignBackupToRole(acc_r52.id, roleType_r55));
    });
    \u0275\u0275elementStart(1, "span", 30);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 257)(4, "div", 100);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 14);
    \u0275\u0275text(7);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const roleType_r55 = ctx.$implicit;
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(roleType_r55.icon);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(roleType_r55.name);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(roleType_r55.desc);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_Template(rf, ctx) {
  if (rf & 1) {
    const _r53 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 250);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_Template_div_click_0_listener($event) {
      \u0275\u0275restoreView(_r53);
      return \u0275\u0275resetView($event.stopPropagation());
    });
    \u0275\u0275elementStart(1, "div", 251)(2, "span", 101);
    \u0275\u0275text(3, "\u{1F4CB} \u5206\u914D\u89D2\u8272");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(4, "div", 252);
    \u0275\u0275repeaterCreate(5, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_For_6_Template, 8, 3, "button", 262, _forTrack09);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "div", 254)(8, "button", 263);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_Template_button_click_8_listener() {
      \u0275\u0275restoreView(_r53);
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.closeBackupDropdown());
    });
    \u0275\u0275elementStart(9, "span");
    \u0275\u0275text(10, "\u26AA");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "span");
    \u0275\u0275text(12, "\u4FDD\u6301\u5099\u7528");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(4);
    \u0275\u0275advance(5);
    \u0275\u0275repeater(ctx_r0.availableRoleTypes);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Template(rf, ctx) {
  if (rf & 1) {
    const _r51 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "tr", 180)(1, "td", 241)(2, "div", 8);
    \u0275\u0275element(3, "span", 259);
    \u0275\u0275elementStart(4, "span", 186);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(6, "td", 241)(7, "span", 242);
    \u0275\u0275text(8, "\u26AA \u5099\u7528\u5E33\u865F");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(9, "td", 176)(10, "span", 260);
    \u0275\u0275text(11, "\u9592\u7F6E");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(12, "td", 245)(13, "div", 246)(14, "button", 261);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Template_button_click_14_listener($event) {
      const acc_r52 = \u0275\u0275restoreView(_r51).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.toggleBackupDropdown(acc_r52.id, $event));
    });
    \u0275\u0275text(15, " \u5206\u914D ");
    \u0275\u0275elementStart(16, "span");
    \u0275\u0275text(17, "\u25BC");
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(18, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Conditional_18_Template, 13, 0, "div", 248);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const acc_r52 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate(acc_r52.phone);
    \u0275\u0275advance(11);
    \u0275\u0275classProp("rotate-180", ctx_r0.backupDropdownId() === acc_r52.id);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.backupDropdownId() === acc_r52.id ? 18 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_119_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 181)(1, "div", 264);
    \u0275\u0275text(2, "\u{1F4AC} \u958B\u5834\u767D\u9810\u89BD");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 265);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    let tmp_3_0;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1('"', (tmp_3_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_3_0.recommendedRoles == null ? null : tmp_3_0.recommendedRoles[0] == null ? null : tmp_3_0.recommendedRoles[0].openingLine, '"');
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_120_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 182)(1, "span", 266);
    \u0275\u0275text(2, "\u{1F504} \u6B63\u5728\u667A\u80FD\u5339\u914D\u5E33\u865F...");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r56 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 267)(1, "span", 7);
    \u0275\u0275text(2, "\u26A0\uFE0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div")(4, "div", 269);
    \u0275\u0275text(5, "\u7121\u53EF\u7528\u5E33\u865F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 270);
    \u0275\u0275text(7, " \u8ACB\u5148\u6DFB\u52A0 Telegram \u5E33\u865F\u4E26\u8A2D\u7F6E\u70BA AI \u89D2\u8272\uFF0C\u624D\u80FD\u57F7\u884C\u591A\u89D2\u8272\u5354\u4F5C\u3002 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div", 104)(9, "button", 271);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_1_Template_button_click_9_listener() {
      \u0275\u0275restoreView(_r56);
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.goToAccountManagement());
    });
    \u0275\u0275text(10, " \u2795 \u6DFB\u52A0\u5E33\u865F ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "button", 272);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_1_Template_button_click_11_listener() {
      \u0275\u0275restoreView(_r56);
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.performAccountMatching());
    });
    \u0275\u0275text(12, " \u{1F504} \u91CD\u65B0\u5339\u914D ");
    \u0275\u0275elementEnd()()()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r57 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 268);
    \u0275\u0275text(1, " \u5339\u914D\u904E\u7A0B\u51FA\u932F\uFF0C\u8ACB\u91CD\u8A66 ");
    \u0275\u0275elementStart(2, "button", 273);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_2_Template_button_click_2_listener() {
      \u0275\u0275restoreView(_r57);
      const ctx_r0 = \u0275\u0275nextContext(4);
      return \u0275\u0275resetView(ctx_r0.performAccountMatching());
    });
    \u0275\u0275text(3, " \u{1F504} \u91CD\u65B0\u5339\u914D ");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 183);
    \u0275\u0275conditionalCreate(1, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_1_Template, 13, 0, "div", 267)(2, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Conditional_2_Template, 4, 0, "div", 268);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.matchFailureReason() === "no_accounts" ? 1 : 2);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_122_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 184)(1, "div", 274)(2, "span");
    \u0275\u0275text(3, "\u{1F504}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "span");
    \u0275\u0275text(5, "\u4E00\u865F\u591A\u89D2\u6A21\u5F0F\u5DF2\u555F\u7528");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(6, "div", 275);
    \u0275\u0275text(7, " \u5E33\u865F\u6578\u91CF\u4E0D\u8DB3\uFF0C\u540C\u4E00\u5E33\u865F\u5C07\u8F2A\u63DB\u626E\u6F14\u591A\u500B\u89D2\u8272 ");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_123_For_5_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 280)(1, "div", 281);
    \u0275\u0275text(2, "\u{1F4AC} \u8A71\u8853\u9810\u89BD");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 265);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const step_r58 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1('"', step_r58.scriptPreview, '"');
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_123_For_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 277)(1, "div", 60)(2, "div", 278);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 257)(5, "div", 218);
    \u0275\u0275text(6);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "div", 279);
    \u0275\u0275text(8);
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(9, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_123_For_5_Conditional_9_Template, 5, 1, "div", 280);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const step_r58 = ctx.$implicit;
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", step_r58.step, " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(step_r58.action);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1("\u57F7\u884C\u8005: ", step_r58.role);
    \u0275\u0275advance();
    \u0275\u0275conditional(step_r58.scriptPreview ? 9 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_123_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div")(1, "h4", 148);
    \u0275\u0275text(2, "\u{1F3AC} \u57F7\u884C\u6D41\u7A0B");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 276);
    \u0275\u0275repeaterCreate(4, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_123_For_5_Template, 10, 4, "div", 277, _forTrack22);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    let tmp_3_0;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance(4);
    \u0275\u0275repeater((tmp_3_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_3_0.suggestedFlow);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_124_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 185)(1, "h4", 282);
    \u0275\u0275text(2, "\u{1F916} \u7121\u5287\u672C\u6A21\u5F0F\u7279\u6027");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "ul", 283)(4, "li");
    \u0275\u0275text(5, "\u2022 AI \u6839\u64DA\u5C0D\u8A71\u4E0A\u4E0B\u6587\u5373\u6642\u751F\u6210\u56DE\u8986");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "li");
    \u0275\u0275text(7, "\u2022 \u6BCF 10 \u689D\u6D88\u606F\u81EA\u52D5\u5206\u6790\u5BA2\u6236\u8208\u8DA3\u548C\u60C5\u7DD2");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "li");
    \u0275\u0275text(9, "\u2022 \u667A\u80FD\u5207\u63DB\u89D2\u8272\u548C\u8ABF\u6574\u7B56\u7565");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "li");
    \u0275\u0275text(11, "\u2022 \u6AA2\u6E2C\u5230\u8F49\u5316\u4FE1\u865F\u81EA\u52D5\u5207\u63DB\u92B7\u552E\u6A21\u5F0F");
    \u0275\u0275elementEnd()()();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_131_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 188);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    let tmp_3_0;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u{1F4CA} ", (tmp_3_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_3_0.successRateReason, " ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    const _r28 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 127);
    \u0275\u0275conditionalCreate(1, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_1_Template, 18, 4, "div", 140);
    \u0275\u0275elementStart(2, "div", 141)(3, "div", 142)(4, "div", 143)(5, "span");
    \u0275\u0275text(6, "\u2713");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(7, "span", 144);
    \u0275\u0275text(8, "\u7B56\u5283\u5B8C\u6210\uFF01");
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(9, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_9_Template, 2, 0, "span", 145)(10, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_10_Template, 2, 0, "span", 146);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(11, "p", 147);
    \u0275\u0275text(12);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(13, "div")(14, "h4", 148);
    \u0275\u0275text(15, "\u{1F3AF} \u9078\u64C7\u5354\u4F5C\u5834\u666F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(16, "div", 130)(17, "button", 149);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Template_button_click_17_listener() {
      \u0275\u0275restoreView(_r28);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.selectedChatScenario.set("private"));
    });
    \u0275\u0275elementStart(18, "div", 150)(19, "span", 7);
    \u0275\u0275text(20, "\u{1F4AC}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "div")(22, "div", 134);
    \u0275\u0275text(23, "\u79C1\u804A\u6A21\u5F0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(24, "div", 101);
    \u0275\u0275text(25, "1v1 \u5C0D\u8A71");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(26, "ul", 151)(27, "li");
    \u0275\u0275text(28, "\u2022 \u55AE\u4E00\u89D2\u8272\u8207\u5BA2\u6236\u5C0D\u8A71");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(29, "li");
    \u0275\u0275text(30, "\u2022 \u9069\u5408\u9996\u6B21\u63A5\u89F8\u3001\u5FEB\u901F\u7BE9\u9078");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(31, "li");
    \u0275\u0275text(32, "\u2022 \u4F4E\u6210\u672C\u6279\u91CF\u89F8\u9054");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(33, "div", 152);
    \u0275\u0275text(34, " \u9700\u8981\u5E33\u865F\uFF1A1 \u500B ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(35, "button", 149);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Template_button_click_35_listener() {
      \u0275\u0275restoreView(_r28);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.selectedChatScenario.set("group"));
    });
    \u0275\u0275elementStart(36, "div", 150)(37, "span", 7);
    \u0275\u0275text(38, "\u{1F465}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(39, "div")(40, "div", 134);
    \u0275\u0275text(41, "\u7FA4\u804A\u5354\u4F5C");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(42, "div", 153);
    \u0275\u0275text(43, "\u591A\u89D2\u8272\u5354\u540C");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(44, "ul", 151)(45, "li");
    \u0275\u0275text(46, "\u2022 \u5EFA\u7FA4\u9080\u8ACB\u5BA2\u6236 + \u591A\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(47, "li");
    \u0275\u0275text(48, "\u2022 \u89D2\u8272\u5206\u5DE5\u5354\u4F5C\u670D\u52D9");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(49, "li");
    \u0275\u0275text(50, "\u2022 \u9AD8\u8F49\u5316\u6DF1\u5EA6\u71DF\u92B7");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(51, "div", 154);
    \u0275\u0275text(52);
    \u0275\u0275conditionalCreate(53, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_53_Template, 2, 0, "span", 155);
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(54, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_54_Template, 8, 2, "div", 156);
    \u0275\u0275conditionalCreate(55, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_55_Template, 18, 0, "div", 157);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(56, "div")(57, "h4", 148);
    \u0275\u0275text(58, "\u2699\uFE0F AI \u5C0D\u8A71\u6A21\u5F0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(59, "div", 130)(60, "button", 158);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Template_button_click_60_listener() {
      \u0275\u0275restoreView(_r28);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.selectedExecutionMode.set("hybrid"));
    });
    \u0275\u0275elementStart(61, "div", 159)(62, "span");
    \u0275\u0275text(63, "\u{1F4CB}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(64, "span", 71);
    \u0275\u0275text(65, "\u5F15\u5C0E\u5F0F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(66, "span", 160);
    \u0275\u0275text(67, "\u63A8\u85A6");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(68, "p", 101);
    \u0275\u0275text(69, "\u9810\u8A2D\u8A71\u8853 + AI \u9748\u6D3B\u88DC\u5145");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(70, "button", 158);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Template_button_click_70_listener() {
      \u0275\u0275restoreView(_r28);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.selectedExecutionMode.set("scriptless"));
    });
    \u0275\u0275elementStart(71, "div", 159)(72, "span");
    \u0275\u0275text(73, "\u{1F916}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(74, "span", 71);
    \u0275\u0275text(75, "\u7D14 AI");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(76, "p", 101);
    \u0275\u0275text(77, "\u6BCF\u689D\u6D88\u606F\u5373\u6642\u751F\u6210");
    \u0275\u0275elementEnd()()()();
    \u0275\u0275elementStart(78, "div")(79, "h4", 148);
    \u0275\u0275text(80, "\u{1F464} \u9078\u64C7\u71DF\u92B7\u76EE\u6A19");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(81, "div", 161);
    \u0275\u0275conditionalCreate(82, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_82_Template, 12, 0, "div", 162)(83, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_83_Template, 12, 2);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(84, "div", 163)(85, "button", 164);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_13_Template_button_click_85_listener() {
      \u0275\u0275restoreView(_r28);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.showAdvancedAccountSettings.set(!ctx_r0.showAdvancedAccountSettings()));
    });
    \u0275\u0275elementStart(86, "div", 8)(87, "span");
    \u0275\u0275text(88, "\u{1F465}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(89, "span", 71);
    \u0275\u0275text(90, "\u5E33\u865F\u914D\u7F6E");
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(91, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_91_Template, 2, 0, "span", 165)(92, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_92_Template, 2, 1, "span", 166);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(93, "span", 167);
    \u0275\u0275text(94);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(95, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_95_Template, 26, 16, "div", 168);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(96, "div")(97, "div", 78)(98, "h4", 55);
    \u0275\u0275text(99);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(100, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_100_Template, 2, 0, "button", 169);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(101, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_101_Template, 17, 1, "div", 170);
    \u0275\u0275elementStart(102, "div", 171)(103, "table", 172)(104, "thead", 173)(105, "tr", 174)(106, "th", 175);
    \u0275\u0275text(107, "\u5E33\u865F");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(108, "th", 175);
    \u0275\u0275text(109, "\u89D2\u8272");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(110, "th", 176);
    \u0275\u0275text(111, "\u72C0\u614B");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(112, "th", 177);
    \u0275\u0275text(113, "\u64CD\u4F5C");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(114, "tbody", 178);
    \u0275\u0275repeaterCreate(115, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_116_Template, 24, 8, "tr", 179, \u0275\u0275repeaterTrackByIndex);
    \u0275\u0275repeaterCreate(117, MultiRoleCenterComponent_Conditional_46_Conditional_13_For_118_Template, 19, 4, "tr", 180, _forTrack09);
    \u0275\u0275elementEnd()()();
    \u0275\u0275conditionalCreate(119, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_119_Template, 5, 1, "div", 181);
    \u0275\u0275conditionalCreate(120, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_120_Template, 3, 0, "div", 182);
    \u0275\u0275conditionalCreate(121, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_121_Template, 3, 1, "div", 183);
    \u0275\u0275conditionalCreate(122, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_122_Template, 8, 0, "div", 184);
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(123, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_123_Template, 6, 0, "div");
    \u0275\u0275conditionalCreate(124, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_124_Template, 12, 0, "div", 185);
    \u0275\u0275elementStart(125, "div", 161)(126, "div", 4)(127, "span", 186);
    \u0275\u0275text(128, "\u9810\u4F30\u6210\u529F\u7387");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(129, "span", 187);
    \u0275\u0275text(130);
    \u0275\u0275elementEnd()();
    \u0275\u0275conditionalCreate(131, MultiRoleCenterComponent_Conditional_46_Conditional_13_Conditional_131_Template, 2, 1, "div", 188);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    let tmp_2_0;
    let tmp_4_0;
    let tmp_32_0;
    let tmp_34_0;
    let tmp_36_0;
    let tmp_42_0;
    let tmp_43_0;
    let tmp_44_0;
    let tmp_45_0;
    let tmp_46_0;
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_2_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_2_0.goalAnalysis) ? 1 : -1);
    \u0275\u0275advance(8);
    \u0275\u0275conditional(ctx_r0.aiPlanningSource() === "ai" ? 9 : ctx_r0.aiPlanningSource() === "template" ? 10 : -1);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate((tmp_4_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_4_0.strategy);
    \u0275\u0275advance(5);
    \u0275\u0275classProp("border-blue-500", ctx_r0.selectedChatScenario() === "private")("bg-blue-500/10", ctx_r0.selectedChatScenario() === "private")("border-slate-700", ctx_r0.selectedChatScenario() !== "private")("bg-slate-800", ctx_r0.selectedChatScenario() !== "private");
    \u0275\u0275advance(18);
    \u0275\u0275classProp("border-green-500", ctx_r0.selectedChatScenario() === "group")("bg-green-500/10", ctx_r0.selectedChatScenario() === "group")("border-slate-700", ctx_r0.selectedChatScenario() !== "group")("bg-slate-800", ctx_r0.selectedChatScenario() !== "group");
    \u0275\u0275advance(16);
    \u0275\u0275classProp("text-green-400", ctx_r0.hasEnoughAccounts())("text-amber-400", !ctx_r0.hasEnoughAccounts());
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u9700\u8981\u5E33\u865F\uFF1A", ctx_r0.requiredAccountsForGroup(), " \u500B ");
    \u0275\u0275advance();
    \u0275\u0275conditional(!ctx_r0.hasEnoughAccounts() && ctx_r0.selectedChatScenario() === "group" ? 53 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.isGroupChatMode() && !ctx_r0.hasEnoughAccounts() ? 54 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.isGroupChatMode() && ctx_r0.hasEnoughAccounts() ? 55 : -1);
    \u0275\u0275advance(5);
    \u0275\u0275classProp("border-cyan-500", ctx_r0.selectedExecutionMode() === "hybrid")("bg-cyan-500/10", ctx_r0.selectedExecutionMode() === "hybrid")("border-slate-700", ctx_r0.selectedExecutionMode() !== "hybrid")("bg-slate-800", ctx_r0.selectedExecutionMode() !== "hybrid");
    \u0275\u0275advance(10);
    \u0275\u0275classProp("border-pink-500", ctx_r0.selectedExecutionMode() === "scriptless")("bg-pink-500/10", ctx_r0.selectedExecutionMode() === "scriptless")("border-slate-700", ctx_r0.selectedExecutionMode() !== "scriptless")("bg-slate-800", ctx_r0.selectedExecutionMode() !== "scriptless");
    \u0275\u0275advance(12);
    \u0275\u0275conditional(ctx_r0.selectedTargetUsers().length === 0 ? 82 : 83);
    \u0275\u0275advance(9);
    \u0275\u0275conditional(ctx_r0.plannerAutoAssign() ? 91 : 92);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r0.showAdvancedAccountSettings() ? "\u25B2" : "\u25BC");
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.showAdvancedAccountSettings() ? 95 : -1);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate2("\u{1F465} \u89D2\u8272\u5206\u914D\u9810\u89BD (", ctx_r0.getDisplayedRolesCount(), "/", ctx_r0.plannerAccountCount(), " \u5E33\u865F)");
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_32_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_32_0.recommendedRoles == null ? null : tmp_32_0.recommendedRoles.length) !== ctx_r0.plannerAccountCount() ? 100 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.showAccountExplanation() ? 101 : -1);
    \u0275\u0275advance(14);
    \u0275\u0275repeater((tmp_34_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_34_0.recommendedRoles);
    \u0275\u0275advance(2);
    \u0275\u0275repeater(ctx_r0.getBackupAccounts());
    \u0275\u0275advance(2);
    \u0275\u0275conditional(((tmp_36_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_36_0.recommendedRoles == null ? null : tmp_36_0.recommendedRoles[0] == null ? null : tmp_36_0.recommendedRoles[0].openingLine) ? 119 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.accountMatchResults().length === 0 && !ctx_r0.matchFailureReason() ? 120 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.matchFailureReason() ? 121 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.matchMode() === "multi-role" && ctx_r0.accountMatchResults().length > 0 ? 122 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.selectedExecutionMode() !== "scriptless" ? 123 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.selectedExecutionMode() === "scriptless" ? 124 : -1);
    \u0275\u0275advance(5);
    \u0275\u0275classProp("text-green-400", (((tmp_42_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_42_0.estimatedSuccessRate) || 0) >= 70)("text-amber-400", (((tmp_43_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_43_0.estimatedSuccessRate) || 0) >= 40 && (((tmp_43_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_43_0.estimatedSuccessRate) || 0) < 70)("text-red-400", (((tmp_44_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_44_0.estimatedSuccessRate) || 0) < 40);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", (tmp_45_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_45_0.estimatedSuccessRate, "% ");
    \u0275\u0275advance();
    \u0275\u0275conditional(((tmp_46_0 = ctx_r0.aiPlanResult()) == null ? null : tmp_46_0.successRateReason) ? 131 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_15_Template(rf, ctx) {
  if (rf & 1) {
    const _r59 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 284);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_15_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r59);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.closeAIPlanner());
    });
    \u0275\u0275text(1, " \u53D6\u6D88 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "button", 285);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_15_Template_button_click_2_listener() {
      \u0275\u0275restoreView(_r59);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.startAIPlanning());
    });
    \u0275\u0275text(3, " \u{1F916} \u958B\u59CB\u7B56\u5283 ");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(2);
    \u0275\u0275property("disabled", !ctx_r0.aiPlannerGoal.trim());
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r61 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 288);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_2_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r61);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.applyAIPlan());
    });
    \u0275\u0275text(1, " \u{1F4AC} \u958B\u59CB\u79C1\u804A ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 290);
    \u0275\u0275text(1, "\u23F3");
    \u0275\u0275elementEnd();
    \u0275\u0275text(2, " \u5275\u5EFA\u7FA4\u7D44\u4E2D... ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 291);
    \u0275\u0275text(1, "\u{1F4E8}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(2, " \u9080\u8ACB\u5BA2\u6236\u4E2D... ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 291);
    \u0275\u0275text(1, "\u{1F465}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(2, " \u9080\u8ACB\u89D2\u8272\u4E2D... ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0, " \u{1F465} \u958B\u59CB\u7FA4\u804A\u5354\u4F5C ");
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    const _r62 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 289);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r62);
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.startGroupCollaboration());
    });
    \u0275\u0275conditionalCreate(1, MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_1_Template, 3, 0)(2, MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_2_Template, 3, 0)(3, MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_3_Template, 3, 0)(4, MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Conditional_4_Template, 1, 0);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275property("disabled", !ctx_r0.hasEnoughAccounts() || ctx_r0.selectedTargetUsers().length === 0);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.groupCreationStatus() === "creating" ? 1 : ctx_r0.groupCreationStatus() === "inviting_target" ? 2 : ctx_r0.groupCreationStatus() === "inviting_roles" ? 3 : 4);
  }
}
function MultiRoleCenterComponent_Conditional_46_Conditional_16_Template(rf, ctx) {
  if (rf & 1) {
    const _r60 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 284);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Conditional_16_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r60);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.resetAIPlanner());
    });
    \u0275\u0275text(1, " \u91CD\u65B0\u7B56\u5283 ");
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(2, MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_2_Template, 2, 0, "button", 286)(3, MultiRoleCenterComponent_Conditional_46_Conditional_16_Conditional_3_Template, 5, 2, "button", 287);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.isPrivateChatMode() ? 2 : 3);
  }
}
function MultiRoleCenterComponent_Conditional_46_Template(rf, ctx) {
  if (rf & 1) {
    const _r26 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 27)(1, "div", 122)(2, "div", 123)(3, "div", 4)(4, "h2", 32)(5, "span", 7);
    \u0275\u0275text(6, "\u{1F916}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(7, " AI \u667A\u80FD\u7B56\u5283 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "button", 124);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_46_Template_button_click_8_listener() {
      \u0275\u0275restoreView(_r26);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.closeAIPlanner());
    });
    \u0275\u0275text(9, " \u2715 ");
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(10, "div", 125);
    \u0275\u0275conditionalCreate(11, MultiRoleCenterComponent_Conditional_46_Conditional_11_Template, 38, 1);
    \u0275\u0275conditionalCreate(12, MultiRoleCenterComponent_Conditional_46_Conditional_12_Template, 10, 2, "div", 126);
    \u0275\u0275conditionalCreate(13, MultiRoleCenterComponent_Conditional_46_Conditional_13_Template, 132, 65, "div", 127);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "div", 128);
    \u0275\u0275conditionalCreate(15, MultiRoleCenterComponent_Conditional_46_Conditional_15_Template, 4, 1);
    \u0275\u0275conditionalCreate(16, MultiRoleCenterComponent_Conditional_46_Conditional_16_Template, 4, 1);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(11);
    \u0275\u0275conditional(ctx_r0.aiPlannerStatus() === "idle" ? 11 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.aiPlannerStatus() === "planning" ? 12 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.aiPlannerStatus() === "ready" && ctx_r0.aiPlanResult() ? 13 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.aiPlannerStatus() === "idle" ? 15 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.aiPlannerStatus() === "ready" ? 16 : -1);
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span", 310);
    \u0275\u0275text(1, "\u27F3");
    \u0275\u0275elementEnd();
    \u0275\u0275text(2, " \u540C\u6B65\u4E2D... ");
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0, " \u{1F504} \u540C\u6B65\u6578\u64DA ");
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_18_Template(rf, ctx) {
  if (rf & 1) {
    const _r64 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "button", 311);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Conditional_18_Template_button_click_0_listener() {
      \u0275\u0275restoreView(_r64);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.clearSearchQuery());
    });
    \u0275\u0275text(1, " \u2715 ");
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_29_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 307)(1, "div", 312);
    \u0275\u0275text(2, "\u{1F4ED}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "p");
    \u0275\u0275text(4, "\u66AB\u7121\u53EF\u9078\u7528\u6236");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "p", 313);
    \u0275\u0275text(6, "\u8ACB\u5148\u5F9E\u7FA4\u7D44\u63D0\u53D6\u6210\u54E1\u6216\u5C0E\u5165\u806F\u7E6B\u4EBA");
    \u0275\u0275elementEnd()();
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275namespaceSVG();
    \u0275\u0275elementStart(0, "svg", 317);
    \u0275\u0275element(1, "path", 321);
    \u0275\u0275elementEnd();
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0);
  }
  if (rf & 2) {
    const user_r66 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275textInterpolate1(" ", user_r66.lastName, " ");
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275text(0);
  }
  if (rf & 2) {
    const user_r66 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275textInterpolate1(" @", user_r66.username, " \xB7 ");
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r65 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 315);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Template_div_click_0_listener() {
      const user_r66 = \u0275\u0275restoreView(_r65).$implicit;
      const ctx_r0 = \u0275\u0275nextContext(3);
      return \u0275\u0275resetView(ctx_r0.toggleTargetUser(user_r66));
    });
    \u0275\u0275elementStart(1, "div", 316);
    \u0275\u0275conditionalCreate(2, MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Conditional_2_Template, 2, 0, ":svg:svg", 317);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 318);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(5, "div", 257)(6, "div", 134);
    \u0275\u0275text(7);
    \u0275\u0275conditionalCreate(8, MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Conditional_8_Template, 1, 1);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "div", 101);
    \u0275\u0275conditionalCreate(10, MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Conditional_10_Template, 1, 1);
    \u0275\u0275text(11);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(12, "div", 319)(13, "div", 320);
    \u0275\u0275text(14);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(15, "div", 14);
    \u0275\u0275text(16);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const user_r66 = ctx.$implicit;
    const ctx_r0 = \u0275\u0275nextContext(3);
    \u0275\u0275classProp("bg-purple-500/20", ctx_r0.isUserSelected(user_r66))("border-purple-500", ctx_r0.isUserSelected(user_r66))("bg-slate-700/50", !ctx_r0.isUserSelected(user_r66))("hover:bg-slate-700", !ctx_r0.isUserSelected(user_r66))("border", true)("border-transparent", !ctx_r0.isUserSelected(user_r66));
    \u0275\u0275advance();
    \u0275\u0275classProp("bg-purple-500", ctx_r0.isUserSelected(user_r66))("border-purple-500", ctx_r0.isUserSelected(user_r66))("border-slate-500", !ctx_r0.isUserSelected(user_r66));
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.isUserSelected(user_r66) ? 2 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", (user_r66.firstName || user_r66.username || "?")[0].toUpperCase(), " ");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", user_r66.firstName || user_r66.username || "Unknown", " ");
    \u0275\u0275advance();
    \u0275\u0275conditional(user_r66.lastName ? 8 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(user_r66.username ? 10 : -1);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ID: ", user_r66.telegramId, " ");
    \u0275\u0275advance(2);
    \u0275\u0275classProp("text-emerald-400", user_r66.intentScore >= 60)("text-amber-400", user_r66.intentScore >= 40 && user_r66.intentScore < 60)("text-slate-400", user_r66.intentScore < 40);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", user_r66.intentScore, "\u5206 ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(user_r66.source);
  }
}
function MultiRoleCenterComponent_Conditional_47_Conditional_30_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 308);
    \u0275\u0275repeaterCreate(1, MultiRoleCenterComponent_Conditional_47_Conditional_30_For_2_Template, 17, 32, "div", 314, _forTrack14);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275repeater(ctx_r0.filteredTargetUsers());
  }
}
function MultiRoleCenterComponent_Conditional_47_Template(rf, ctx) {
  if (rf & 1) {
    const _r63 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 24)(1, "div", 292)(2, "div", 293)(3, "div", 294)(4, "div")(5, "h3", 40)(6, "span");
    \u0275\u0275text(7, "\u{1F464}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(8, " \u9078\u64C7\u71DF\u92B7\u76EE\u6A19\u7528\u6236 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(9, "p", 295);
    \u0275\u0275text(10, "\u5F9E\u767C\u9001\u63A7\u5236\u53F0\u540C\u6B65\u6700\u65B0\u7684\u76EE\u6A19\u5BA2\u6236\u6578\u64DA");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(11, "button", 296);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Template_button_click_11_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.syncTargetUsersFromSendConsole());
    });
    \u0275\u0275conditionalCreate(12, MultiRoleCenterComponent_Conditional_47_Conditional_12_Template, 3, 0)(13, MultiRoleCenterComponent_Conditional_47_Conditional_13_Template, 1, 0);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(14, "div", 297)(15, "div", 298)(16, "div", 299)(17, "input", 300);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_47_Template_input_ngModelChange_17_listener($event) {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.targetUserSearchQuery, $event) || (ctx_r0.targetUserSearchQuery = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("keyup.enter", function MultiRoleCenterComponent_Conditional_47_Template_input_keyup_enter_17_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.searchTargetUsers());
    });
    \u0275\u0275elementEnd();
    \u0275\u0275conditionalCreate(18, MultiRoleCenterComponent_Conditional_47_Conditional_18_Template, 2, 0, "button", 301);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "button", 302);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Template_button_click_19_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.searchTargetUsers());
    });
    \u0275\u0275text(20, " \u{1F50D} \u641C\u7D22 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(21, "button", 303);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Template_button_click_21_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.toggleSelectAll());
    });
    \u0275\u0275text(22);
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(23, "div", 304)(24, "button", 305);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Template_button_click_24_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.selectHighIntentUsers());
    });
    \u0275\u0275text(25, " \u2B50 \u9AD8\u610F\u5411 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(26, "span", 306);
    \u0275\u0275text(27);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(28, "div", 20);
    \u0275\u0275conditionalCreate(29, MultiRoleCenterComponent_Conditional_47_Conditional_29_Template, 7, 0, "div", 307)(30, MultiRoleCenterComponent_Conditional_47_Conditional_30_Template, 3, 0, "div", 308);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(31, "div", 128)(32, "button", 284);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Template_button_click_32_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.closeTargetUserSelector());
    });
    \u0275\u0275text(33, " \u53D6\u6D88 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(34, "button", 309);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_47_Template_button_click_34_listener() {
      \u0275\u0275restoreView(_r63);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.confirmTargetUsers());
    });
    \u0275\u0275text(35);
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(11);
    \u0275\u0275property("disabled", ctx_r0.isSyncingTargetUsers());
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.isSyncingTargetUsers() ? 12 : 13);
    \u0275\u0275advance(5);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.targetUserSearchQuery);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.targetUserSearchQuery ? 18 : -1);
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1(" ", ctx_r0.isAllSelected() ? "\u53D6\u6D88\u5168\u9078" : "\u5168\u9078", " ");
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1(" \u5DF2\u9078: ", ctx_r0.selectedTargetUsers().length, " \u500B ");
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r0.filteredTargetUsers().length === 0 ? 29 : 30);
    \u0275\u0275advance(5);
    \u0275\u0275property("disabled", ctx_r0.selectedTargetUsers().length === 0);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" \u78BA\u8A8D\u9078\u64C7 (", ctx_r0.selectedTargetUsers().length, ") ");
  }
}
function MultiRoleCenterComponent_Conditional_48_Template(rf, ctx) {
  if (rf & 1) {
    const _r67 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 24)(1, "div", 322)(2, "h3", 323)(3, "span");
    \u0275\u0275text(4, "\u{1F4DC}");
    \u0275\u0275elementEnd();
    \u0275\u0275text(5, " \u65B0\u5EFA\u5287\u672C ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 47)(7, "div")(8, "label", 91);
    \u0275\u0275text(9, "\u5287\u672C\u540D\u7A31 *");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "input", 324);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_48_Template_input_ngModelChange_10_listener($event) {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.newScriptName, $event) || (ctx_r0.newScriptName = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(11, "div")(12, "label", 91);
    \u0275\u0275text(13, "\u5287\u672C\u63CF\u8FF0");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(14, "textarea", 325);
    \u0275\u0275twoWayListener("ngModelChange", function MultiRoleCenterComponent_Conditional_48_Template_textarea_ngModelChange_14_listener($event) {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.newScriptDescription, $event) || (ctx_r0.newScriptDescription = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275text(15, "                ");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(16, "div")(17, "label", 91);
    \u0275\u0275text(18, "\u6216\u5F9E\u6A21\u677F\u5275\u5EFA");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(19, "div", 224)(20, "button", 326);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_48_Template_button_click_20_listener() {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.createFromTemplate("high_intent"));
    });
    \u0275\u0275elementStart(21, "div", 132);
    \u0275\u0275text(22, "\u{1F3AF}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(23, "div", 218);
    \u0275\u0275text(24, "\u9AD8\u610F\u5411\u8F49\u5316");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(25, "button", 326);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_48_Template_button_click_25_listener() {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.createFromTemplate("product_demo"));
    });
    \u0275\u0275elementStart(26, "div", 132);
    \u0275\u0275text(27, "\u{1F4E6}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(28, "div", 218);
    \u0275\u0275text(29, "\u7522\u54C1\u6F14\u793A");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(30, "button", 326);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_48_Template_button_click_30_listener() {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.createFromTemplate("customer_support"));
    });
    \u0275\u0275elementStart(31, "div", 132);
    \u0275\u0275text(32, "\u{1F527}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(33, "div", 218);
    \u0275\u0275text(34, "\u552E\u5F8C\u670D\u52D9");
    \u0275\u0275elementEnd()();
    \u0275\u0275elementStart(35, "button", 326);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_48_Template_button_click_35_listener() {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.createFromTemplate("community"));
    });
    \u0275\u0275elementStart(36, "div", 132);
    \u0275\u0275text(37, "\u{1F389}");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(38, "div", 218);
    \u0275\u0275text(39, "\u793E\u7FA4\u6D3B\u8E8D");
    \u0275\u0275elementEnd()()()()();
    \u0275\u0275elementStart(40, "div", 114)(41, "button", 115);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_48_Template_button_click_41_listener() {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.cancelAddScript());
    });
    \u0275\u0275text(42, " \u53D6\u6D88 ");
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(43, "button", 327);
    \u0275\u0275listener("click", function MultiRoleCenterComponent_Conditional_48_Template_button_click_43_listener() {
      \u0275\u0275restoreView(_r67);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.confirmAddScript());
    });
    \u0275\u0275text(44, " \u5275\u5EFA\u5287\u672C ");
    \u0275\u0275elementEnd()()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(10);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.newScriptName);
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.newScriptDescription);
    \u0275\u0275advance(29);
    \u0275\u0275property("disabled", !ctx_r0.newScriptName.trim());
  }
}
var EMOJI_SHORTCODE_MAP = {
  ":payment:": "\u{1F4B3}",
  ":money:": "\u{1F4B0}",
  ":dollar:": "\u{1F4B5}",
  ":credit_card:": "\u{1F4B3}",
  ":moneybag:": "\u{1F4B0}",
  ":chart:": "\u{1F4CA}",
  ":briefcase:": "\u{1F4BC}",
  ":handshake:": "\u{1F91D}",
  ":star:": "\u2B50",
  ":heart:": "\u2764\uFE0F",
  ":fire:": "\u{1F525}",
  ":rocket:": "\u{1F680}",
  ":crown:": "\u{1F451}",
  ":trophy:": "\u{1F3C6}",
  ":phone:": "\u{1F4DE}",
  ":headphone:": "\u{1F3A7}",
  ":headphones:": "\u{1F3A7}",
  ":wrench:": "\u{1F527}",
  ":gear:": "\u2699\uFE0F",
  ":speech_balloon:": "\u{1F4AC}",
  ":bulb:": "\u{1F4A1}",
  ":lightbulb:": "\u{1F4A1}",
  ":target:": "\u{1F3AF}",
  ":dart:": "\u{1F3AF}",
  ":man_office_worker:": "\u{1F468}\u200D\u{1F4BC}",
  ":woman_office_worker:": "\u{1F469}\u200D\u{1F4BC}",
  ":person:": "\u{1F464}",
  ":people:": "\u{1F465}",
  ":smile:": "\u{1F60A}",
  ":thumbsup:": "\u{1F44D}",
  ":ok_hand:": "\u{1F44C}",
  ":wave:": "\u{1F44B}",
  ":clipboard:": "\u{1F4CB}",
  ":memo:": "\u{1F4DD}",
  ":book:": "\u{1F4DA}",
  ":graduation_cap:": "\u{1F393}",
  ":sparkles:": "\u2728",
  ":party_popper:": "\u{1F389}",
  ":gift:": "\u{1F381}",
  ":house:": "\u{1F3E0}",
  ":office:": "\u{1F3E2}",
  ":bank:": "\u{1F3E6}",
  ":shopping_cart:": "\u{1F6D2}",
  ":package:": "\u{1F4E6}",
  ":truck:": "\u{1F69A}",
  ":clock:": "\u23F0",
  ":calendar:": "\u{1F4C5}",
  ":lock:": "\u{1F512}",
  ":key:": "\u{1F511}",
  ":shield:": "\u{1F6E1}\uFE0F",
  ":check:": "\u2705",
  ":x:": "\u274C",
  ":warning:": "\u26A0\uFE0F",
  ":question:": "\u2753",
  ":info:": "\u2139\uFE0F"
};
function sanitizeIcon(icon, defaultIcon = "\u{1F4BC}") {
  if (!icon)
    return defaultIcon;
  if (!/^[\x00-\x7F]*$/.test(icon) && !icon.includes(":")) {
    return icon;
  }
  const normalized = icon.toLowerCase().trim();
  if (EMOJI_SHORTCODE_MAP[normalized]) {
    return EMOJI_SHORTCODE_MAP[normalized];
  }
  const match = normalized.match(/^:([a-z_]+):$/);
  if (match) {
    const key = `:${match[1]}:`;
    if (EMOJI_SHORTCODE_MAP[key]) {
      return EMOJI_SHORTCODE_MAP[key];
    }
  }
  if (icon.startsWith(":") && icon.endsWith(":")) {
    console.warn(`[MultiRole] \u672A\u8B58\u5225\u7684 emoji shortcode: ${icon}\uFF0C\u4F7F\u7528\u9ED8\u8A8D\u503C`);
    return defaultIcon;
  }
  return icon;
}
function sanitizeRoleIcons(roles) {
  if (!Array.isArray(roles))
    return [];
  return roles.map((role) => __spreadProps(__spreadValues({}, role), {
    icon: sanitizeIcon(role.icon, "\u{1F4BC}")
  }));
}
var MultiRoleCenterComponent = class _MultiRoleCenterComponent {
  constructor() {
    this.Math = Math;
    this.multiRoleService = inject(MultiRoleService);
    this.autoGroupService = inject(AutoGroupService);
    this.executorService = inject(CollaborationExecutorService);
    this.dynamicEngine = inject(DynamicScriptEngineService);
    this.orchestrator = inject(CollaborationOrchestratorService);
    this.toast = inject(ToastService);
    this.contactsService = inject(UnifiedContactsService);
    this.accountService = inject(AccountManagementService);
    this.ipc = inject(ElectronIpcService);
    this.ipcCleanup = [];
    this.activeTab = signal("dashboard", ...ngDevMode ? [{ debugName: "activeTab" }] : []);
    this.showAddRole = signal(false, ...ngDevMode ? [{ debugName: "showAddRole" }] : []);
    this.showCreateGroupDialog = signal(false, ...ngDevMode ? [{ debugName: "showCreateGroupDialog" }] : []);
    this.showTargetUserSelector = signal(false, ...ngDevMode ? [{ debugName: "showTargetUserSelector" }] : []);
    this.selectedTargetUsers = signal([], ...ngDevMode ? [{ debugName: "selectedTargetUsers" }] : []);
    this.targetUserSearchQuery = "";
    this.isSyncingTargetUsers = signal(false, ...ngDevMode ? [{ debugName: "isSyncingTargetUsers" }] : []);
    this.availableTargetUsers = computed(() => {
      const contacts = this.contactsService.contacts();
      return contacts.filter((c) => c.telegram_id).map((c) => ({
        id: c.id?.toString() || c.telegram_id,
        telegramId: c.telegram_id,
        username: c.username,
        firstName: c.display_name?.split(" ")[0] || c.first_name || c.username,
        lastName: c.display_name?.split(" ")[1] || c.last_name,
        intentScore: this.calculateContactIntent(c),
        source: c.source_type || "contacts"
      })).sort((a, b) => b.intentScore - a.intentScore);
    }, ...ngDevMode ? [{ debugName: "availableTargetUsers" }] : []);
    this.filteredTargetUsers = computed(() => {
      const query = this.targetUserSearchQuery.toLowerCase().trim();
      const users = this.availableTargetUsers();
      if (!query)
        return users.slice(0, 50);
      return users.filter((u) => u.username?.toLowerCase().includes(query) || u.firstName?.toLowerCase().includes(query) || u.telegramId?.includes(query)).slice(0, 50);
    }, ...ngDevMode ? [{ debugName: "filteredTargetUsers" }] : []);
    this.showRoleEditor = signal(false, ...ngDevMode ? [{ debugName: "showRoleEditor" }] : []);
    this.editingRole = signal(null, ...ngDevMode ? [{ debugName: "editingRole" }] : []);
    this.showScriptEditor = signal(false, ...ngDevMode ? [{ debugName: "showScriptEditor" }] : []);
    this.editingScript = signal(null, ...ngDevMode ? [{ debugName: "editingScript" }] : []);
    this.tabs = [
      { id: "dashboard", icon: "\u{1F4CA}", label: "\u76E3\u63A7\u4E2D\u5FC3" },
      { id: "library", icon: "\u{1F4DA}", label: "\u89D2\u8272\u5EAB (50+)" },
      { id: "roles", icon: "\u{1F3AD}", label: "\u6211\u7684\u89D2\u8272" },
      { id: "scenarios", icon: "\u{1F3AC}", label: "\u5834\u666F\u6A21\u677F" },
      { id: "scripts", icon: "\u{1F4DC}", label: "\u5287\u672C\u7DE8\u6392" },
      { id: "groups", icon: "\u{1F3E0}", label: "\u5354\u4F5C\u7FA4\u7D44" },
      { id: "workflow", icon: "\u{1F504}", label: "\u5DE5\u4F5C\u6D41" },
      { id: "monitor", icon: "\u{1F4C8}", label: "\u57F7\u884C\u76E3\u63A7" },
      { id: "analytics", icon: "\u{1F4C9}", label: "\u6578\u64DA\u5206\u6790" },
      { id: "settings", icon: "\u2699\uFE0F", label: "\u8A2D\u7F6E" }
    ];
    this.roleTypes = Object.entries(ROLE_TYPE_META).filter(([id]) => id !== "custom").map(([id, meta]) => __spreadValues({
      id
    }, meta));
    this.availableAccounts = computed(() => {
      return [];
    }, ...ngDevMode ? [{ debugName: "availableAccounts" }] : []);
    this.newRoleType = signal("expert", ...ngDevMode ? [{ debugName: "newRoleType" }] : []);
    this.newRoleName = "";
    this.newRoleDescription = "";
    this.newRolePrompt = "";
    this.showAIPlannerDialog = signal(false, ...ngDevMode ? [{ debugName: "showAIPlannerDialog" }] : []);
    this.aiPlannerGoal = "";
    this.aiPlannerStatus = signal("idle", ...ngDevMode ? [{ debugName: "aiPlannerStatus" }] : []);
    this.aiPlanningProgress = signal("AI \u6B63\u5728\u5206\u6790\u60A8\u7684\u76EE\u6A19...", ...ngDevMode ? [{ debugName: "aiPlanningProgress" }] : []);
    this.aiPlanningElapsed = signal(0, ...ngDevMode ? [{ debugName: "aiPlanningElapsed" }] : []);
    this.plannerAccountCount = signal(3, ...ngDevMode ? [{ debugName: "plannerAccountCount" }] : []);
    this.plannerSelectedAccounts = signal([], ...ngDevMode ? [{ debugName: "plannerSelectedAccounts" }] : []);
    this.plannerAccountRoles = signal(/* @__PURE__ */ new Map(), ...ngDevMode ? [{ debugName: "plannerAccountRoles" }] : []);
    this.plannerAutoAssign = signal(true, ...ngDevMode ? [{ debugName: "plannerAutoAssign" }] : []);
    this.showAccountExplanation = signal(false, ...ngDevMode ? [{ debugName: "showAccountExplanation" }] : []);
    this.roleChangeModalIndex = signal(-1, ...ngDevMode ? [{ debugName: "roleChangeModalIndex" }] : []);
    this.backupDropdownId = signal(-1, ...ngDevMode ? [{ debugName: "backupDropdownId" }] : []);
    this.DRAFT_STORAGE_KEY = "aiPlannerDraft";
    this.hasDraft = signal(false, ...ngDevMode ? [{ debugName: "hasDraft" }] : []);
    this.availableRoleTypes = [
      { id: "consultant", name: "\u652F\u4ED8\u9867\u554F", icon: "\u{1F4BC}", desc: "\u8CA0\u8CAC\u6838\u5FC3\u71DF\u92B7" },
      { id: "expert", name: "\u6280\u8853\u5C08\u5BB6", icon: "\u{1F527}", desc: "\u89E3\u7B54\u6280\u8853\u554F\u984C" },
      { id: "oldcustomer", name: "\u8001\u5BA2\u6236", icon: "\u{1F464}", desc: "\u63D0\u4F9B\u771F\u5BE6\u9AD4\u9A57" },
      { id: "support", name: "\u5BA2\u670D", icon: "\u{1F3A7}", desc: "\u89E3\u6C7A\u552E\u5F8C\u554F\u984C" },
      { id: "manager", name: "\u7D93\u7406", icon: "\u{1F454}", desc: "\u8655\u7406\u7279\u6B8A\u60C5\u6CC1" },
      { id: "atmosphere", name: "\u6C23\u6C1B\u7D44", icon: "\u{1F389}", desc: "\u6D3B\u8E8D\u7FA4\u7D44\u6C23\u6C1B" }
    ];
    this.showAdvancedAccountSettings = signal(false, ...ngDevMode ? [{ debugName: "showAdvancedAccountSettings" }] : []);
    this.selectedExecutionMode = signal("hybrid", ...ngDevMode ? [{ debugName: "selectedExecutionMode" }] : []);
    this.selectedChatScenario = signal("private", ...ngDevMode ? [{ debugName: "selectedChatScenario" }] : []);
    this.availableAccountCount = computed(() => {
      const accounts = this.accountService.accounts();
      return accounts.filter((a) => a.status === "Online").length;
    }, ...ngDevMode ? [{ debugName: "availableAccountCount" }] : []);
    this.isPrivateChatMode = computed(() => {
      return this.selectedChatScenario() === "private";
    }, ...ngDevMode ? [{ debugName: "isPrivateChatMode" }] : []);
    this.isGroupChatMode = computed(() => {
      return this.selectedChatScenario() === "group";
    }, ...ngDevMode ? [{ debugName: "isGroupChatMode" }] : []);
    this.requiredAccountsForGroup = computed(() => {
      return this.aiPlanResult()?.recommendedRoles?.length || 2;
    }, ...ngDevMode ? [{ debugName: "requiredAccountsForGroup" }] : []);
    this.hasEnoughAccounts = computed(() => {
      const available = this.availableAccountCount();
      const required = this.isPrivateChatMode() ? 1 : this.requiredAccountsForGroup();
      return available >= required;
    }, ...ngDevMode ? [{ debugName: "hasEnoughAccounts" }] : []);
    this.groupCreationStatus = signal("idle", ...ngDevMode ? [{ debugName: "groupCreationStatus" }] : []);
    this.groupCreationProgress = signal("", ...ngDevMode ? [{ debugName: "groupCreationProgress" }] : []);
    this.createdGroupId = signal(null, ...ngDevMode ? [{ debugName: "createdGroupId" }] : []);
    this.accountMatchResults = signal([], ...ngDevMode ? [{ debugName: "accountMatchResults" }] : []);
    this.aiPlanResult = signal(null, ...ngDevMode ? [{ debugName: "aiPlanResult" }] : []);
    this.autoGroupNameTemplate = "VIP\u5C08\u5C6C\u670D\u52D9\u7FA4 - {\u5BA2\u6236\u540D}";
    this.inviteMessage = "\u70BA\u4E86\u66F4\u597D\u5730\u670D\u52D9\u60A8\uFF0C\u6211\u5011\u7279\u5225\u5EFA\u7ACB\u4E86VIP\u7FA4\uFF01";
    this.maxConcurrent = 5;
    this.autoCloseDays = 7;
    this.intentThreshold = 70;
    this.minRounds = 3;
    this.requirePriceInquiry = false;
    this.useAICenter = true;
    this.coordinationMode = "sequential";
    this.showNewScriptDialog = signal(false, ...ngDevMode ? [{ debugName: "showNewScriptDialog" }] : []);
    this.newScriptName = "";
    this.newScriptDescription = "";
    this.aiPlanningSource = signal(null, ...ngDevMode ? [{ debugName: "aiPlanningSource" }] : []);
    this.matchFailureReason = signal(null, ...ngDevMode ? [{ debugName: "matchFailureReason" }] : []);
    this.matchMode = signal("normal", ...ngDevMode ? [{ debugName: "matchMode" }] : []);
  }
  // üÜï P0: ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâ‰∏ãÊãâÈÅ∏ÂñÆ
  onDocumentClick(event) {
    this.roleChangeModalIndex.set(-1);
    this.backupDropdownId.set(-1);
  }
  ngOnInit() {
    this.checkIncomingTargetUsers();
    this.ipcCleanup.push(this.ipc.on("multi-role:open-ai-planner", (data) => {
      console.log("[MultiRoleCenter] \u6536\u5230\u76EE\u6A19\u7528\u6236:", data.targetUsers?.length);
      if (data.targetUsers && data.targetUsers.length > 0) {
        this.selectedTargetUsers.set(data.targetUsers);
        this.openAIPlanner();
        this.toast.info(`\u5DF2\u52A0\u8F09 ${data.targetUsers.length} \u500B\u76EE\u6A19\u7528\u6236`);
      }
    }));
  }
  ngOnDestroy() {
    this.ipcCleanup.forEach((cleanup) => cleanup());
  }
  /**
   * Ê™¢Êü•‰∏¶Âä†ËºâÂæûÂÖ∂‰ªñÈ†ÅÈù¢ÂÇ≥‰æÜÁöÑÁõÆÊ®ôÁî®Êà∂
   */
  checkIncomingTargetUsers() {
    const stored = sessionStorage.getItem("multiRoleTargetUsers");
    if (stored) {
      try {
        const targetUsers = JSON.parse(stored);
        if (targetUsers.length > 0) {
          this.selectedTargetUsers.set(targetUsers);
          sessionStorage.removeItem("multiRoleTargetUsers");
          setTimeout(() => {
            this.openAIPlanner();
            this.toast.info(`\u5DF2\u52A0\u8F09 ${targetUsers.length} \u500B\u76EE\u6A19\u7528\u6236\uFF0C\u8ACB\u958B\u59CB\u7B56\u5283`);
          }, 300);
        }
      } catch (e) {
        console.error("[MultiRoleCenter] \u89E3\u6790\u76EE\u6A19\u7528\u6236\u5931\u6557:", e);
      }
    }
  }
  getRoleIcon(type) {
    return ROLE_TYPE_META[type]?.icon || "\u{1F3AD}";
  }
  getRoleStyleLabel(style) {
    const labels = {
      professional: "\u5C08\u696D\u6B63\u5F0F",
      friendly: "\u53CB\u597D\u89AA\u5207",
      casual: "\u8F15\u9B06\u96A8\u610F",
      enthusiastic: "\u71B1\u60C5",
      careful: "\u8B39\u614E",
      curious: "\u597D\u5947"
    };
    return labels[style] || style;
  }
  quickAddRole(type) {
    const meta = ROLE_TYPE_META[type];
    this.multiRoleService.addRole({
      name: meta.label,
      type,
      personality: {
        description: meta.description,
        speakingStyle: meta.defaultStyle,
        traits: []
      },
      aiConfig: {
        useGlobalAI: true,
        customPrompt: meta.defaultPrompt,
        responseLength: "medium",
        emojiFrequency: "low",
        typingSpeed: "medium"
      },
      responsibilities: []
    });
  }
  saveNewRole() {
    const type = this.newRoleType();
    const meta = ROLE_TYPE_META[type];
    this.multiRoleService.addRole({
      name: this.newRoleName || meta.label,
      type,
      personality: {
        description: this.newRoleDescription || meta.description,
        speakingStyle: meta.defaultStyle,
        traits: []
      },
      aiConfig: {
        useGlobalAI: true,
        customPrompt: this.newRolePrompt || meta.defaultPrompt,
        responseLength: "medium",
        emojiFrequency: "low",
        typingSpeed: "medium"
      },
      responsibilities: []
    });
    this.showAddRole.set(false);
    this.newRoleName = "";
    this.newRoleDescription = "";
    this.newRolePrompt = "";
  }
  editRole(role) {
    this.editingRole.set(role);
    this.showRoleEditor.set(true);
  }
  openNewRoleEditor() {
    this.editingRole.set(null);
    this.showRoleEditor.set(true);
  }
  onRoleSaved(role) {
    this.showRoleEditor.set(false);
    this.editingRole.set(null);
    this.showAddRole.set(false);
  }
  onRoleEditorCancelled() {
    this.showRoleEditor.set(false);
    this.editingRole.set(null);
  }
  deleteRole(role) {
    if (confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u89D2\u8272\u300C${role.name}\u300D\u55CE\uFF1F`)) {
      this.multiRoleService.deleteRole(role.id);
    }
  }
  // ÂäáÊú¨Á∑®ËºØ
  openNewScriptEditor() {
    this.editingScript.set(null);
    this.showScriptEditor.set(true);
  }
  editScript(script) {
    this.editingScript.set(script);
    this.showScriptEditor.set(true);
  }
  onScriptSaved(script) {
    this.showScriptEditor.set(false);
    this.editingScript.set(null);
  }
  onScriptEditorCancelled() {
    this.showScriptEditor.set(false);
    this.editingScript.set(null);
  }
  deleteScript(script) {
    if (confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u5287\u672C\u300C${script.name}\u300D\u55CE\uFF1F`)) {
      this.multiRoleService.deleteScript(script.id);
    }
  }
  // È†êË®≠ËßíËâ≤ÂíåÂ†¥ÊôØËôïÁêÜ
  onPresetRoleAdded(role) {
    this.multiRoleService.addRole({
      name: role.name,
      type: role.type,
      personality: role.personality,
      aiConfig: role.aiConfig,
      responsibilities: role.responsibilities
    });
    this.activeTab.set("roles");
  }
  onPresetRoleEdit(preset) {
    const roleId = this.multiRoleService.addRole({
      name: preset.name,
      type: preset.type,
      personality: preset.personality,
      aiConfig: preset.aiConfig,
      responsibilities: preset.responsibilities
    });
    if (roleId) {
      const role = this.multiRoleService.roles().find((r) => r.id === roleId);
      if (role) {
        this.editRole(role);
      }
    }
  }
  onScenarioApplied(scenario) {
    scenario.roles.forEach((roleConfig) => {
      const presetRoles = window.PRESET_ROLES || [];
      const preset = presetRoles.find((r) => r.roleType === roleConfig.roleType);
      if (preset) {
        this.multiRoleService.addRole({
          name: preset.name,
          type: preset.type,
          personality: preset.personality,
          aiConfig: preset.aiConfig,
          responsibilities: preset.responsibilities
        });
      }
    });
    this.multiRoleService.addScript({
      name: scenario.name,
      description: scenario.description,
      scenario: scenario.type
    });
    this.activeTab.set("scripts");
  }
  // Áæ§ÁµÑÊìç‰Ωú
  pauseGroup(group) {
    this.autoGroupService.pauseGroup(group.id);
    this.executorService.pauseExecution(group.id);
  }
  resumeGroup(group) {
    this.autoGroupService.resumeGroup(group.id);
    this.executorService.resumeExecution(group.id);
  }
  markGroupConverted(group) {
    this.autoGroupService.markAsConverted(group.id);
  }
  addScript() {
    this.newScriptName = "";
    this.newScriptDescription = "";
    this.showNewScriptDialog.set(true);
  }
  confirmAddScript() {
    if (this.newScriptName.trim()) {
      const scriptId = this.multiRoleService.addScript({
        name: this.newScriptName.trim(),
        description: this.newScriptDescription.trim()
      });
      this.showNewScriptDialog.set(false);
      if (scriptId) {
        const script = this.multiRoleService.scripts().find((s) => s.id === scriptId);
        if (script) {
          this.editScript(script);
        }
      }
    }
  }
  cancelAddScript() {
    this.showNewScriptDialog.set(false);
  }
  useTemplate(type) {
    this.createFromTemplate(type);
  }
  createFromTemplate(templateType) {
    const templates = {
      "high_intent": {
        name: "\u9AD8\u610F\u5411\u5BA2\u6236\u8F49\u5316",
        description: "\u5C08\u5BB6\u4ECB\u7D39 + \u8001\u5BA2\u6236\u80CC\u66F8 + \u5BA2\u670D\u4FC3\u55AE\u7684\u7D93\u5178\u8F49\u5316\u6D41\u7A0B",
        stages: [
          { id: "stage_1", name: "\u5C08\u696D\u4ECB\u7D39", order: 1, trigger: { type: "manual" }, messages: [] },
          { id: "stage_2", name: "\u8001\u5BA2\u6236\u80CC\u66F8", order: 2, trigger: { type: "time", delaySeconds: 120 }, messages: [] },
          { id: "stage_3", name: "\u4FC3\u55AE\u8DDF\u9032", order: 3, trigger: { type: "message" }, messages: [] }
        ]
      },
      "product_demo": {
        name: "\u7522\u54C1\u6F14\u793A\u63A8\u85A6",
        description: "\u529F\u80FD\u5C55\u793A + \u4F7F\u7528\u5834\u666F + \u6548\u679C\u5206\u4EAB\u7684\u7522\u54C1\u63A8\u4ECB\u6D41\u7A0B",
        stages: [
          { id: "stage_1", name: "\u529F\u80FD\u5C55\u793A", order: 1, trigger: { type: "manual" }, messages: [] },
          { id: "stage_2", name: "\u5834\u666F\u61C9\u7528", order: 2, trigger: { type: "time", delaySeconds: 180 }, messages: [] },
          { id: "stage_3", name: "\u6548\u679C\u898B\u8B49", order: 3, trigger: { type: "time", delaySeconds: 120 }, messages: [] }
        ]
      },
      "customer_support": {
        name: "\u552E\u5F8C\u554F\u984C\u8655\u7406",
        description: "\u554F\u984C\u8A18\u9304 + \u6280\u8853\u6392\u67E5 + \u6EFF\u610F\u5EA6\u78BA\u8A8D\u7684\u552E\u5F8C\u670D\u52D9\u6D41\u7A0B",
        stages: [
          { id: "stage_1", name: "\u554F\u984C\u8A18\u9304", order: 1, trigger: { type: "message" }, messages: [] },
          { id: "stage_2", name: "\u6280\u8853\u6392\u67E5", order: 2, trigger: { type: "time", delaySeconds: 60 }, messages: [] },
          { id: "stage_3", name: "\u6EFF\u610F\u78BA\u8A8D", order: 3, trigger: { type: "time", delaySeconds: 300 }, messages: [] }
        ]
      },
      "community": {
        name: "\u793E\u7FA4\u6D3B\u8E8D\u5F15\u5C0E",
        description: "\u8A71\u984C\u767C\u8D77 + \u4E92\u52D5\u97FF\u61C9 + \u50F9\u503C\u7E3D\u7D50\u7684\u793E\u7FA4\u904B\u71DF\u6D41\u7A0B",
        stages: [
          { id: "stage_1", name: "\u8A71\u984C\u767C\u8D77", order: 1, trigger: { type: "time" }, messages: [] },
          { id: "stage_2", name: "\u4E92\u52D5\u97FF\u61C9", order: 2, trigger: { type: "time", delaySeconds: 60 }, messages: [] },
          { id: "stage_3", name: "\u50F9\u503C\u7E3D\u7D50", order: 3, trigger: { type: "time", delaySeconds: 300 }, messages: [] }
        ]
      }
    };
    const template = templates[templateType];
    if (template) {
      const scriptId = this.multiRoleService.addScript({
        name: template.name,
        description: template.description,
        stages: template.stages
      });
      this.showNewScriptDialog.set(false);
      if (scriptId) {
        const script = this.multiRoleService.scripts().find((s) => s.id === scriptId);
        if (script) {
          this.editScript(script);
        }
      }
    }
  }
  // ========== AI Á≠ñÂäÉÂäüËÉΩ ==========
  openAIPlanner() {
    const hasStoredDraft = this.restoreDraft();
    if (!hasStoredDraft) {
      this.aiPlannerGoal = "";
      this.plannerAccountCount.set(3);
      this.plannerSelectedAccounts.set([]);
      this.plannerAccountRoles.set(/* @__PURE__ */ new Map());
      this.plannerAutoAssign.set(true);
    } else {
      this.toast.info("\u{1F4CB} \u5DF2\u6062\u5FA9\u4E0A\u6B21\u672A\u5B8C\u6210\u7684\u7B56\u5283");
    }
    this.aiPlannerStatus.set("idle");
    this.aiPlanResult.set(null);
    this.showAIPlannerDialog.set(true);
    setTimeout(() => {
      this.goalInput?.nativeElement?.focus();
    }, 100);
  }
  closeAIPlanner() {
    if (this.aiPlannerGoal.trim() || this.selectedTargetUsers().length > 0) {
      this.saveDraft();
      this.toast.info("\u{1F4BE} \u8349\u7A3F\u5DF2\u81EA\u52D5\u4FDD\u5B58");
    }
    this.showAIPlannerDialog.set(false);
  }
  quickAIPlan(goal) {
    this.aiPlannerGoal = goal;
    this.openAIPlanner();
    setTimeout(() => this.startAIPlanning(), 100);
  }
  async startAIPlanning() {
    if (!this.aiPlannerGoal.trim())
      return;
    this.aiPlannerStatus.set("planning");
    this.aiPlanningSource.set(null);
    let result = await this.callAIForPlanning(this.aiPlannerGoal);
    if (!result) {
      console.log("[MultiRole] AI \u8ABF\u7528\u5931\u6557\uFF0C\u4F7F\u7528\u6A21\u677F\u56DE\u9000");
      result = this.getFallbackPlanByKeywords(this.aiPlannerGoal);
      this.aiPlanningSource.set("template");
      this.toast.warning("\u26A0\uFE0F AI \u670D\u52D9\u66AB\u4E0D\u53EF\u7528\uFF0C\u5DF2\u4F7F\u7528\u667A\u80FD\u6A21\u677F\u7B56\u7565");
    } else {
      this.aiPlanningSource.set("ai");
      this.toast.success("\u{1F916} AI \u7B56\u5283\u5B8C\u6210\uFF01");
    }
    this.aiPlanResult.set(result);
    await this.performAccountMatching();
  }
  resetAIPlanner() {
    this.aiPlannerStatus.set("idle");
    this.aiPlanResult.set(null);
    this.accountMatchResults.set([]);
    this.aiPlanningSource.set(null);
    this.plannerSelectedAccounts.set([]);
    this.plannerAccountRoles.set(/* @__PURE__ */ new Map());
    this.showAdvancedAccountSettings.set(false);
  }
  // üÜï P0: Â∏≥ËôüÊï∏ÈáèËÆäÊõ¥
  onAccountCountChange(event) {
    const value = parseInt(event.target.value, 10);
    this.plannerAccountCount.set(value);
    this.saveDraft();
  }
  // üÜï P0: ÂàáÊèõÂ∏≥ËôüÈÅ∏Êìá
  toggleAccountSelection(accountId) {
    const current = this.plannerSelectedAccounts();
    const maxCount = this.plannerAccountCount();
    if (current.includes(accountId)) {
      this.plannerSelectedAccounts.set(current.filter((id) => id !== accountId));
      const roles = new Map(this.plannerAccountRoles());
      roles.delete(accountId);
      this.plannerAccountRoles.set(roles);
    } else {
      if (current.length >= maxCount) {
        this.toast.warning(`\u6700\u591A\u9078\u64C7 ${maxCount} \u500B\u5E33\u865F`);
        return;
      }
      this.plannerSelectedAccounts.set([...current, accountId]);
    }
    this.saveDraft();
  }
  // üÜï P0: ÈÅ∏ÊìáÊâÄÊúâÂú®Á∑öÂ∏≥Ëôü
  selectAllOnlineAccounts() {
    const onlineAccounts = this.accountService.accounts().filter((a) => a.status === "Online").slice(0, this.plannerAccountCount()).map((a) => a.id);
    this.plannerSelectedAccounts.set(onlineAccounts);
    this.saveDraft();
  }
  // üÜï P0: ËÆäÊõ¥Â∏≥ËôüËßíËâ≤
  onAccountRoleChange(accountId, event) {
    const roleId = event.target.value;
    const roles = new Map(this.plannerAccountRoles());
    if (roleId) {
      roles.set(accountId, roleId);
    } else {
      roles.delete(accountId);
    }
    this.plannerAccountRoles.set(roles);
    this.saveDraft();
  }
  // üÜï P0: Áç≤ÂèñÂ∏≥ËôüÈõªË©±
  getAccountPhone(accountId) {
    const account = this.accountService.accounts().find((a) => a.id === accountId);
    return account?.phone || "\u672A\u77E5";
  }
  // üÜï P0: Áç≤ÂèñÂàÜÈÖçÁöÑËßíËâ≤ÂêçÁ®±
  getAssignedRoleName(accountId) {
    const roleId = this.plannerAccountRoles().get(accountId);
    if (!roleId)
      return "\u{1F916} AI \u5206\u914D";
    const role = this.availableRoleTypes.find((r) => r.id === roleId);
    return role ? `${role.icon} ${role.name}` : "\u{1F916} AI \u5206\u914D";
  }
  // üÜï P0: Áç≤ÂèñÊé®Ëñ¶Â∏≥ËôüÊï∏Èáè
  getRecommendedAccountCount() {
    const targetUsers = this.selectedTargetUsers();
    if (targetUsers.length === 0)
      return 3;
    const avgScore = targetUsers.reduce((sum, u) => sum + u.intentScore, 0) / targetUsers.length;
    if (avgScore >= 80)
      return Math.min(5, this.availableAccountCount());
    if (avgScore >= 60)
      return Math.min(4, this.availableAccountCount());
    if (avgScore >= 40)
      return Math.min(3, this.availableAccountCount());
    return Math.min(2, this.availableAccountCount());
  }
  // üÜï P1: Áç≤ÂèñÈ°ØÁ§∫ÁöÑËßíËâ≤Êï∏Èáè
  getDisplayedRolesCount() {
    return this.aiPlanResult()?.recommendedRoles?.length || 0;
  }
  // üÜï P2: ÂàáÊèõÂ∏≥ËôüÊï∏ÈáèË™™ÊòéÈ°ØÁ§∫
  toggleAccountExplanation() {
    this.showAccountExplanation.set(!this.showAccountExplanation());
  }
  // üÜï P0: ÂàáÊèõËßíËâ≤Êõ¥Êèõ‰∏ãÊãâÈÅ∏ÂñÆ
  toggleRoleDropdown(index, event) {
    event.stopPropagation();
    if (this.roleChangeModalIndex() === index) {
      this.roleChangeModalIndex.set(-1);
    } else {
      this.roleChangeModalIndex.set(index);
      this.backupDropdownId.set(-1);
    }
  }
  // üÜï P0: Êõ¥ÊèõÊåáÂÆöÁ¥¢ÂºïÁöÑËßíËâ≤
  changeRoleForIndex(index, newRoleType) {
    const currentMatches = this.accountMatchResults();
    if (index >= currentMatches.length) {
      this.toast.error("\u7121\u6CD5\u66F4\u63DB\uFF1A\u5E33\u865F\u672A\u5339\u914D");
      this.roleChangeModalIndex.set(-1);
      return;
    }
    if (currentMatches[index].roleName === newRoleType.name) {
      this.roleChangeModalIndex.set(-1);
      return;
    }
    const conflictIndex = currentMatches.findIndex((m, i) => i !== index && m.roleName === newRoleType.name);
    if (conflictIndex >= 0) {
      const updatedMatches = [...currentMatches];
      const oldRoleName = updatedMatches[index].roleName;
      const oldRoleIcon = updatedMatches[index].roleIcon;
      updatedMatches[index] = __spreadProps(__spreadValues({}, updatedMatches[index]), {
        roleName: newRoleType.name,
        roleIcon: newRoleType.icon,
        roleId: newRoleType.id
      });
      updatedMatches[conflictIndex] = __spreadProps(__spreadValues({}, updatedMatches[conflictIndex]), {
        roleName: oldRoleName,
        roleIcon: oldRoleIcon,
        roleId: currentMatches[index].roleId
      });
      this.accountMatchResults.set(updatedMatches);
      this.toast.success(`\u{1F504} \u5DF2\u4EA4\u63DB\u89D2\u8272\uFF1A${newRoleType.name} \u2194 ${oldRoleName}`);
    } else {
      const updatedMatches = [...currentMatches];
      updatedMatches[index] = __spreadProps(__spreadValues({}, updatedMatches[index]), {
        roleName: newRoleType.name,
        roleIcon: newRoleType.icon,
        roleId: newRoleType.id
      });
      this.accountMatchResults.set(updatedMatches);
      this.toast.success(`\u2713 \u5DF2\u66F4\u63DB\u70BA ${newRoleType.icon} ${newRoleType.name}`);
    }
    this.updateAiPlanRoles();
    this.roleChangeModalIndex.set(-1);
    this.saveDraft();
  }
  // üÜï P0: ÁßªÈô§ËßíËâ≤ÂàÜÈÖçÔºàÁßªÁÇ∫ÂÇôÁî®Ôºâ
  removeRoleAssignment(index) {
    const currentMatches = this.accountMatchResults();
    if (index >= currentMatches.length)
      return;
    const removedAccount = currentMatches[index];
    const updatedMatches = currentMatches.filter((_, i) => i !== index);
    this.accountMatchResults.set(updatedMatches);
    this.toast.info(`\u26AA ${removedAccount.accountPhone} \u5DF2\u79FB\u70BA\u5099\u7528\u5E33\u865F`);
    this.roleChangeModalIndex.set(-1);
    this.saveDraft();
  }
  // üÜï P1: ÂàáÊèõÂÇôÁî®Â∏≥Ëôü‰∏ãÊãâÈÅ∏ÂñÆ
  toggleBackupDropdown(accountId, event) {
    event.stopPropagation();
    if (this.backupDropdownId() === accountId) {
      this.backupDropdownId.set(-1);
    } else {
      this.backupDropdownId.set(accountId);
      this.roleChangeModalIndex.set(-1);
    }
  }
  // üÜï P1: ÈóúÈñâÂÇôÁî®Â∏≥Ëôü‰∏ãÊãâÈÅ∏ÂñÆ
  closeBackupDropdown() {
    this.backupDropdownId.set(-1);
  }
  // üÜï P1: ÂàÜÈÖçÂÇôÁî®Â∏≥ËôüÂà∞ËßíËâ≤
  assignBackupToRole(accountId, roleType) {
    const accounts = this.accountService.accounts();
    const account = accounts.find((a) => a.id === accountId);
    if (!account) {
      this.toast.error("\u627E\u4E0D\u5230\u5E33\u865F");
      this.backupDropdownId.set(-1);
      return;
    }
    const currentMatches = this.accountMatchResults();
    const existingIndex = currentMatches.findIndex((m) => m.roleName === roleType.name);
    if (existingIndex >= 0) {
      const existing = currentMatches[existingIndex];
      if (confirm(`${roleType.name} \u5DF2\u88AB ${existing.accountPhone} \u4F7F\u7528\u3002
\u662F\u5426\u66FF\u63DB\uFF1F`)) {
        const updatedMatches = [...currentMatches];
        updatedMatches[existingIndex] = {
          roleId: roleType.id,
          roleName: roleType.name,
          roleIcon: roleType.icon,
          accountId,
          accountPhone: account.phone,
          accountName: account.name || account.phone,
          matchScore: 80,
          matchReasons: ["\u624B\u52D5\u5206\u914D"]
        };
        this.accountMatchResults.set(updatedMatches);
        this.toast.success(`\u2713 ${account.phone} \u5DF2\u66FF\u63DB\u70BA ${roleType.icon} ${roleType.name}`);
      }
    } else {
      const newMatch = {
        roleId: roleType.id,
        roleName: roleType.name,
        roleIcon: roleType.icon,
        accountId,
        accountPhone: account.phone,
        accountName: account.name || account.phone,
        matchScore: 80,
        matchReasons: ["\u624B\u52D5\u5206\u914D"]
      };
      this.accountMatchResults.set([...currentMatches, newMatch]);
      this.toast.success(`\u2713 ${account.phone} \u5DF2\u5206\u914D\u70BA ${roleType.icon} ${roleType.name}`);
    }
    this.backupDropdownId.set(-1);
    this.saveDraft();
  }
  // üÜï P0: Êõ¥Êñ∞ AI Ë®àÂäÉÁµêÊûú‰∏≠ÁöÑËßíËâ≤ÔºàÂêåÊ≠•Ôºâ
  updateAiPlanRoles() {
    const result = this.aiPlanResult();
    if (!result)
      return;
    const matches = this.accountMatchResults();
    const updatedRoles = matches.map((m) => ({
      type: m.roleId,
      name: m.roleName,
      icon: m.roleIcon,
      purpose: result.recommendedRoles?.find((r) => r.name === m.roleName)?.purpose || "\u5354\u52A9\u71DF\u92B7",
      openingLine: result.recommendedRoles?.find((r) => r.name === m.roleName)?.openingLine
    }));
    this.aiPlanResult.set(__spreadProps(__spreadValues({}, result), {
      recommendedRoles: updatedRoles
    }));
  }
  // üÜï P4: Áç≤ÂèñÂÇôÁî®Â∏≥ËôüÂàóË°®
  getBackupAccounts() {
    const result = this.aiPlanResult();
    if (!result)
      return [];
    const roleCount = result.recommendedRoles?.length || 0;
    const accountCount = this.plannerAccountCount();
    if (accountCount <= roleCount)
      return [];
    const assignedAccountIds = new Set(this.accountMatchResults().map((m) => m.accountId));
    const allAccounts = this.accountService.accounts();
    const backupAccounts = allAccounts.filter((a) => a.status === "Online" && !assignedAccountIds.has(a.id)).slice(0, accountCount - roleCount).map((a) => ({
      id: a.id,
      phone: a.phone,
      name: a.name || a.phone
    }));
    return backupAccounts;
  }
  // üÜï P0: ‰øùÂ≠òËçâÁ®ø
  saveDraft() {
    const draft = {
      goal: this.aiPlannerGoal,
      accountCount: this.plannerAccountCount(),
      selectedAccounts: this.plannerSelectedAccounts(),
      accountRoles: Array.from(this.plannerAccountRoles().entries()),
      autoAssign: this.plannerAutoAssign(),
      targetUsers: this.selectedTargetUsers(),
      chatScenario: this.selectedChatScenario(),
      executionMode: this.selectedExecutionMode(),
      savedAt: Date.now()
    };
    localStorage.setItem(this.DRAFT_STORAGE_KEY, JSON.stringify(draft));
    this.hasDraft.set(true);
  }
  // üÜï P0: ÊÅ¢Âæ©ËçâÁ®ø
  restoreDraft() {
    try {
      const stored = localStorage.getItem(this.DRAFT_STORAGE_KEY);
      if (!stored)
        return false;
      const draft = JSON.parse(stored);
      if (Date.now() - draft.savedAt > 24 * 60 * 60 * 1e3) {
        localStorage.removeItem(this.DRAFT_STORAGE_KEY);
        return false;
      }
      this.aiPlannerGoal = draft.goal || "";
      this.plannerAccountCount.set(draft.accountCount || 3);
      this.plannerSelectedAccounts.set(draft.selectedAccounts || []);
      this.plannerAccountRoles.set(new Map(draft.accountRoles || []));
      this.plannerAutoAssign.set(draft.autoAssign !== false);
      if (draft.targetUsers?.length > 0) {
        this.selectedTargetUsers.set(draft.targetUsers);
      }
      if (draft.chatScenario) {
        this.selectedChatScenario.set(draft.chatScenario);
      }
      if (draft.executionMode) {
        this.selectedExecutionMode.set(draft.executionMode);
      }
      return true;
    } catch (e) {
      console.error("[MultiRole] \u6062\u5FA9\u8349\u7A3F\u5931\u6557:", e);
      return false;
    }
  }
  // üÜï P0: Ê∏ÖÈô§ËçâÁ®ø
  clearDraft() {
    localStorage.removeItem(this.DRAFT_STORAGE_KEY);
    this.hasDraft.set(false);
  }
  /**
   * üÜï Ë™øÁî®ÁúüÊ≠£ÁöÑ AI ÈÄ≤Ë°åÁ≠ñÂäÉ
   */
  async callAIForPlanning(goal) {
    return new Promise((resolve) => {
      const prompt = `\u4F60\u662F\u4E00\u4F4D\u8CC7\u6DF1\u7684 Telegram \u71DF\u92B7\u5C08\u5BB6\u3002\u8ACB\u6839\u64DA\u4EE5\u4E0B\u71DF\u92B7\u76EE\u6A19\uFF0C\u8A2D\u8A08\u4E00\u500B\u9AD8\u5EA6\u91DD\u5C0D\u6027\u7684\u591A\u89D2\u8272\u5354\u4F5C\u7B56\u7565\u3002

\u3010\u71DF\u92B7\u76EE\u6A19\u3011
${goal}

\u3010\u5206\u6790\u8981\u6C42\u3011
1. \u9996\u5148\u5206\u6790\u76EE\u6A19\uFF0C\u8B58\u5225\uFF1A
   - \u7522\u54C1/\u670D\u52D9\u985E\u578B
   - \u76EE\u6A19\u5BA2\u6236\u7FA4\u9AD4
   - \u5BA2\u6236\u53EF\u80FD\u7684\u75DB\u9EDE\u548C\u9867\u616E
   
2. \u7136\u5F8C\u8A2D\u8A08\u91DD\u5C0D\u6027\u89D2\u8272\uFF08\u6BCF\u500B\u89D2\u8272\u5FC5\u9808\u8207\u76EE\u6A19\u7522\u54C1\u76F4\u63A5\u76F8\u95DC\uFF09\uFF1A
   - \u89D2\u8272\u540D\u7A31\u5FC5\u9808\u5305\u542B\u7522\u54C1\u95DC\u9375\u8A5E\uFF08\u5982"\u652F\u4ED8\u9867\u554F"\u800C\u975E"\u92B7\u552E\u5C08\u54E1"\uFF09
   - \u6BCF\u500B\u89D2\u8272\u6709\u660E\u78BA\u7684\u5206\u5DE5\u548C\u8A71\u8853\u5B9A\u4F4D
   
3. \u8A2D\u8A08\u958B\u5834\u8A71\u8853\u9810\u89BD\uFF08\u8B93\u7528\u6236\u9810\u5224\u57F7\u884C\u6548\u679C\uFF09

\u3010JSON \u8FD4\u56DE\u683C\u5F0F\u3011
{
  "goalAnalysis": {
    "productType": "\u8B58\u5225\u7684\u7522\u54C1\u985E\u578B",
    "targetAudience": "\u76EE\u6A19\u5BA2\u6236\u63CF\u8FF0",
    "painPoints": ["\u5BA2\u6236\u75DB\u9EDE1", "\u5BA2\u6236\u75DB\u9EDE2"],
    "keySellingPoints": ["\u7522\u54C1\u512A\u52E21", "\u7522\u54C1\u512A\u52E22"]
  },
  "strategy": "1-2\u53E5\u8A71\u7684\u6574\u9AD4\u7B56\u7565",
  "recommendedRoles": [
    {
      "type": "\u89D2\u8272\u985E\u578B\u5982consultant/user/analyst",
      "name": "\u8207\u7522\u54C1\u76F8\u95DC\u7684\u89D2\u8272\u540D\u7A31",
      "icon": "emoji",
      "purpose": "\u9019\u500B\u89D2\u8272\u7684\u5177\u9AD4\u4F5C\u7528",
      "openingLine": "\u9019\u500B\u89D2\u8272\u7684\u958B\u5834\u767D\u793A\u4F8B"
    }
  ],
  "suggestedFlow": [
    {"step": 1, "action": "\u5177\u9AD4\u884C\u52D5", "role": "\u89D2\u8272\u540D", "scriptPreview": "\u8A71\u8853\u9810\u89BD"}
  ],
  "estimatedSuccessRate": \u6578\u5B57,
  "successRateReason": "\u6210\u529F\u7387\u9810\u4F30\u4F9D\u64DA"
}

\u3010\u91CD\u8981\u3011
- \u89D2\u8272\u5FC5\u9808\u8207\u300C${goal}\u300D\u76F4\u63A5\u76F8\u95DC\uFF0C\u4E0D\u8981\u7528\u901A\u7528\u89D2\u8272\u5982"\u5167\u5BB9\u71DF\u92B7\u5C08\u5BB6"
- \u8A71\u8853\u9810\u89BD\u8981\u5305\u542B\u7522\u54C1\u95DC\u9375\u8A5E
- \u5982\u679C\u662F\u652F\u4ED8\u985E\u7522\u54C1\uFF0C\u89D2\u8272\u61C9\u8A72\u662F"\u652F\u4ED8\u9867\u554F"\u3001"\u8CBB\u7387\u5206\u6790\u5E2B"\u7B49
- \u5982\u679C\u662F\u6559\u80B2\u985E\u7522\u54C1\uFF0C\u89D2\u8272\u61C9\u8A72\u662F"\u8AB2\u7A0B\u5C0E\u5E2B"\u3001"\u5B78\u54E1\u4EE3\u8868"\u7B49`;
      this.ipc.send("ai:generate-text", {
        prompt,
        maxTokens: 1500,
        // üîß P0: Â¢ûÂä† token Êï∏‰ª•ÊîØÊåÅÊõ¥Ë©≥Á¥∞ÁöÑÈüøÊáâ
        responseFormat: "json",
        callback: "multi-role:ai-plan-result"
      });
      const AI_TIMEOUT_MS = 45e3;
      let progressInterval = null;
      let elapsedSeconds = 0;
      this.aiPlanningElapsed.set(0);
      this.aiPlanningProgress.set("\u{1F50D} AI \u6B63\u5728\u5206\u6790\u60A8\u7684\u76EE\u6A19...");
      const progressMessages = [
        "\u{1F50D} AI \u6B63\u5728\u5206\u6790\u60A8\u7684\u76EE\u6A19...",
        "\u{1F914} \u6B63\u5728\u8B58\u5225\u6700\u4F73\u7B56\u7565...",
        "\u{1F465} \u6B63\u5728\u9078\u64C7\u5408\u9069\u7684\u89D2\u8272\u7D44\u5408...",
        "\u{1F4CB} \u6B63\u5728\u8A2D\u8A08\u57F7\u884C\u6D41\u7A0B...",
        "\u26A1 \u5373\u5C07\u5B8C\u6210\uFF0C\u8ACB\u7A0D\u5019...",
        "\u{1F3AF} \u6700\u5F8C\u512A\u5316\u4E2D..."
      ];
      progressInterval = setInterval(() => {
        elapsedSeconds += 1;
        this.aiPlanningElapsed.set(elapsedSeconds);
        const msgIndex = Math.min(Math.floor(elapsedSeconds / 7), progressMessages.length - 1);
        this.aiPlanningProgress.set(progressMessages[msgIndex]);
        if (elapsedSeconds % 5 === 0) {
          console.log(`[MultiRole] AI \u8655\u7406\u4E2D... ${elapsedSeconds}\u79D2`);
        }
      }, 1e3);
      const timeout = setTimeout(() => {
        console.log(`[MultiRole] AI \u8ABF\u7528\u8D85\u6642 (${AI_TIMEOUT_MS / 1e3}\u79D2)`);
        if (progressInterval)
          clearInterval(progressInterval);
        this.aiPlanningProgress.set("\u26A0\uFE0F AI \u97FF\u61C9\u8D85\u6642\uFF0C\u4F7F\u7528\u667A\u80FD\u6A21\u677F...");
        cleanup();
        resolve(null);
      }, AI_TIMEOUT_MS);
      const cleanup = this.ipc.on("multi-role:ai-plan-result", (data) => {
        clearTimeout(timeout);
        if (progressInterval)
          clearInterval(progressInterval);
        this.aiPlanningProgress.set("\u2705 AI \u8655\u7406\u5B8C\u6210\uFF01");
        cleanup();
        console.log("[MultiRole] \u6536\u5230 AI \u97FF\u61C9:", data);
        if (!data.success) {
          console.log("[MultiRole] AI \u8ABF\u7528\u5931\u6557:", data.error);
          resolve(null);
          return;
        }
        try {
          if (data.text) {
            const jsonMatch = data.text.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
              const parsed = JSON.parse(jsonMatch[0]);
              if (parsed.recommendedRoles && Array.isArray(parsed.recommendedRoles)) {
                parsed.recommendedRoles = sanitizeRoleIcons(parsed.recommendedRoles);
              }
              console.log("[MultiRole] AI \u7D50\u679C\u89E3\u6790\u6210\u529F:", parsed);
              resolve(parsed);
              return;
            }
          }
          console.log("[MultiRole] AI \u8FD4\u56DE\u5167\u5BB9\u7121\u6CD5\u89E3\u6790\u70BA JSON");
          resolve(null);
        } catch (e) {
          console.error("[MultiRole] AI \u7D50\u679C\u89E3\u6790\u5931\u6557:", e);
          resolve(null);
        }
      });
    });
  }
  /**
   * üÜï Ê†πÊìöÈóúÈçµË©ûÁç≤ÂèñÂõûÈÄÄÊñπÊ°àÔºàÊ®°ÊùøÔºâ
   */
  getFallbackPlanByKeywords(goal) {
    const lowerGoal = goal.toLowerCase();
    if (lowerGoal.includes("\u6210\u4EA4") || lowerGoal.includes("\u4ED8\u8CBB") || lowerGoal.includes("\u8CFC\u8CB7") || lowerGoal.includes("\u9996\u55AE")) {
      return {
        strategy: "\u63A1\u7528\u300C\u4FE1\u4EFB\u5EFA\u7ACB + \u50F9\u503C\u5C55\u793A + \u9650\u6642\u4FC3\u55AE\u300D\u4E09\u6BB5\u5F0F\u7B56\u7565\uFF0C\u901A\u904E\u8001\u5BA2\u6236\u80CC\u66F8\u5EFA\u7ACB\u4FE1\u4EFB\uFF0C\u5C08\u5BB6\u5C55\u793A\u50F9\u503C\uFF0C\u6700\u5F8C\u7531\u4FC3\u92B7\u5C08\u54E1\u63D0\u4F9B\u9650\u6642\u512A\u60E0\u4FC3\u6210\u6210\u4EA4\u3002",
        recommendedRoles: [
          { type: "loyal_customer", name: "\u8001\u7528\u6236", icon: "\u2764\uFE0F", purpose: "\u5206\u4EAB\u771F\u5BE6\u9AD4\u9A57" },
          { type: "expert", name: "\u7522\u54C1\u5C08\u5BB6", icon: "\u{1F393}", purpose: "\u5C08\u696D\u50F9\u503C\u5C55\u793A" },
          { type: "sales", name: "\u4FC3\u92B7\u5C08\u54E1", icon: "\u{1F4B0}", purpose: "\u9650\u6642\u512A\u60E0\u4FC3\u55AE" }
        ],
        suggestedFlow: [
          { step: 1, action: "\u8001\u7528\u6236\u81EA\u7136\u5206\u4EAB\u4F7F\u7528\u9AD4\u9A57\uFF0C\u5EFA\u7ACB\u4FE1\u4EFB", role: "\u8001\u7528\u6236" },
          { step: 2, action: "\u7522\u54C1\u5C08\u5BB6\u8A73\u7D30\u4ECB\u7D39\u529F\u80FD\u548C\u50F9\u503C", role: "\u7522\u54C1\u5C08\u5BB6" },
          { step: 3, action: "\u6839\u64DA\u5BA2\u6236\u53CD\u994B\u89E3\u7B54\u7591\u616E", role: "\u7522\u54C1\u5C08\u5BB6" },
          { step: 4, action: "\u63D0\u4F9B\u9650\u6642\u512A\u60E0\uFF0C\u71DF\u9020\u7DCA\u8FEB\u611F", role: "\u4FC3\u92B7\u5C08\u54E1" }
        ],
        estimatedSuccessRate: 65
      };
    } else if (lowerGoal.includes("\u6D41\u5931") || lowerGoal.includes("\u633D\u56DE")) {
      return {
        strategy: "\u63A1\u7528\u300C\u95DC\u61F7\u56DE\u8A2A + \u554F\u984C\u89E3\u6C7A + \u7279\u5225\u512A\u60E0\u300D\u7B56\u7565\uFF0C\u5148\u8868\u9054\u95DC\u5FC3\u4E86\u89E3\u96E2\u958B\u539F\u56E0\uFF0C\u91DD\u5C0D\u6027\u89E3\u6C7A\u554F\u984C\uFF0C\u6700\u5F8C\u63D0\u4F9B\u8AA0\u610F\u512A\u60E0\u4FC3\u9032\u56DE\u6B78\u3002",
        recommendedRoles: [
          { type: "callback", name: "\u56DE\u8A2A\u5C08\u54E1", icon: "\u{1F4DE}", purpose: "\u771F\u8AA0\u95DC\u61F7\u56DE\u8A2A" },
          { type: "support", name: "\u5BA2\u670D\u7D93\u7406", icon: "\u{1F3A7}", purpose: "\u89E3\u6C7A\u554F\u984C" },
          { type: "director", name: "\u5340\u57DF\u7E3D\u76E3", icon: "\u{1F451}", purpose: "\u7279\u5225\u633D\u7559" }
        ],
        suggestedFlow: [
          { step: 1, action: "\u771F\u8AA0\u95DC\u61F7\uFF0C\u4E86\u89E3\u96E2\u958B\u539F\u56E0", role: "\u56DE\u8A2A\u5C08\u54E1" },
          { step: 2, action: "\u91DD\u5C0D\u554F\u984C\u63D0\u4F9B\u89E3\u6C7A\u65B9\u6848", role: "\u5BA2\u670D\u7D93\u7406" },
          { step: 3, action: "\u9AD8\u5C64\u51FA\u9762\u8868\u9054\u8AA0\u610F", role: "\u5340\u57DF\u7E3D\u76E3" },
          { step: 4, action: "\u63D0\u4F9B\u5C08\u5C6C\u56DE\u6B78\u512A\u60E0", role: "\u5340\u57DF\u7E3D\u76E3" }
        ],
        estimatedSuccessRate: 45
      };
    }
    return {
      strategy: "\u63A1\u7528\u300C\u9700\u6C42\u4E86\u89E3 + \u65B9\u6848\u5C55\u793A + \u8DDF\u9032\u670D\u52D9\u300D\u901A\u7528\u7B56\u7565\uFF0C\u5148\u4E86\u89E3\u5BA2\u6236\u9700\u6C42\uFF0C\u63D0\u4F9B\u5B9A\u5236\u5316\u65B9\u6848\uFF0C\u6301\u7E8C\u8DDF\u9032\u76F4\u5230\u76EE\u6A19\u9054\u6210\u3002",
      recommendedRoles: [
        { type: "account_manager", name: "\u5BA2\u6236\u7D93\u7406", icon: "\u{1F4BC}", purpose: "\u4E86\u89E3\u9700\u6C42" },
        { type: "solution_expert", name: "\u65B9\u6848\u5C08\u5BB6", icon: "\u{1F4CB}", purpose: "\u63D0\u4F9B\u65B9\u6848" }
      ],
      suggestedFlow: [
        { step: 1, action: "\u4E86\u89E3\u5BA2\u6236\u5177\u9AD4\u9700\u6C42\u548C\u75DB\u9EDE", role: "\u5BA2\u6236\u7D93\u7406" },
        { step: 2, action: "\u6839\u64DA\u9700\u6C42\u63D0\u4F9B\u5B9A\u5236\u65B9\u6848", role: "\u65B9\u6848\u5C08\u5BB6" },
        { step: 3, action: "\u89E3\u7B54\u7591\u554F\u4E26\u6301\u7E8C\u8DDF\u9032", role: "\u5BA2\u6236\u7D93\u7406" }
      ],
      estimatedSuccessRate: 50
    };
  }
  /**
   * üÜï Âü∑Ë°åÂ∏≥ËôüÊô∫ËÉΩÂåπÈÖçÔºàÂÑ™ÂåñÁâàÔºâ
   * P0: Ëá™ÂãïËß∏Áôº + Êô∫ËÉΩÈôçÁ¥ö + Â§±ÊïóÂºïÂ∞é
   * P1: ÂåπÈÖçÂâçÂÖàÂêåÊ≠•Â∏≥ËôüÁãÄÊÖã
   */
  async performAccountMatching() {
    const result = this.aiPlanResult();
    if (!result)
      return;
    this.aiPlannerStatus.set("matching");
    this.matchFailureReason.set(null);
    this.matchMode.set("normal");
    try {
      await this.syncAccountStatusBeforeMatch();
      if (!this.plannerAutoAssign() && this.plannerSelectedAccounts().length > 0) {
        const manualMatches = this.buildManualAccountMatches(result.recommendedRoles);
        this.accountMatchResults.set(manualMatches);
        if (manualMatches.length < result.recommendedRoles.length) {
          this.matchMode.set("multi-role");
          this.toast.info(`\u{1F4CB} \u5DF2\u4F7F\u7528\u624B\u52D5\u9078\u64C7\u7684 ${manualMatches.length} \u500B\u5E33\u865F`);
        } else {
          this.toast.success("\u2713 \u5DF2\u61C9\u7528\u624B\u52D5\u5E33\u865F\u914D\u7F6E");
        }
        this.aiPlannerStatus.set("ready");
        return;
      }
      const intent = {
        type: "sales_conversion",
        confidence: 80,
        goal: this.aiPlannerGoal,
        targetAudience: "\u6F5B\u5728\u5BA2\u6236",
        urgency: "medium",
        suggestedDuration: "3-5\u5929"
      };
      const accountCount = this.plannerAccountCount();
      const rolesToMatch = result.recommendedRoles.slice(0, accountCount);
      const recommendedRoles = rolesToMatch.map((r, i) => ({
        id: `role_${i}`,
        name: r.name,
        icon: r.icon,
        type: r.type,
        purpose: r.purpose,
        personality: "\u5C08\u696D\u53CB\u597D",
        speakingStyle: "\u81EA\u7136\u5C0D\u8A71",
        entryTiming: "\u9069\u6642\u5207\u5165",
        sampleMessages: ["\u4F60\u597D\uFF01", "\u6709\u4EC0\u9EBC\u53EF\u4EE5\u5E6B\u60A8\u7684\uFF1F"]
      }));
      const matches = await this.dynamicEngine.smartMatchAccountsToRolesEnhanced(recommendedRoles, intent, { allowMultiRole: true, allowOffline: true });
      if (matches.length === 0) {
        this.matchFailureReason.set("no_accounts");
        this.accountMatchResults.set([]);
      } else if (matches.length < recommendedRoles.length) {
        this.matchMode.set("multi-role");
        this.accountMatchResults.set(matches.map((m) => ({
          roleId: m.roleId,
          roleName: m.roleName,
          roleIcon: m.roleIcon,
          accountId: m.accountId,
          accountPhone: m.accountPhone,
          accountName: m.accountName,
          matchScore: m.matchScore,
          matchReasons: m.matchReasons
        })));
        this.toast.info(`\u{1F504} \u5E33\u865F\u4E0D\u8DB3\uFF0C\u5DF2\u555F\u7528\u4E00\u865F\u591A\u89D2\u6A21\u5F0F\uFF08${matches.length} \u5E33\u865F\u8F2A\u63DB ${recommendedRoles.length} \u89D2\u8272\uFF09`);
      } else {
        this.accountMatchResults.set(matches.map((m) => ({
          roleId: m.roleId,
          roleName: m.roleName,
          roleIcon: m.roleIcon,
          accountId: m.accountId,
          accountPhone: m.accountPhone,
          accountName: m.accountName,
          matchScore: m.matchScore,
          matchReasons: m.matchReasons
        })));
      }
    } catch (error) {
      console.error("[MultiRole] \u5E33\u865F\u5339\u914D\u5931\u6557:", error);
      this.matchFailureReason.set("error");
    }
    this.aiPlannerStatus.set("ready");
  }
  // üÜï P0: ÊßãÂª∫ÊâãÂãïÂ∏≥ËôüÂåπÈÖçÁµêÊûú
  buildManualAccountMatches(roles) {
    const selectedAccounts = this.plannerSelectedAccounts();
    const accountRoles = this.plannerAccountRoles();
    const accounts = this.accountService.accounts();
    const matches = [];
    const usedAccounts = /* @__PURE__ */ new Set();
    const usedRoles = /* @__PURE__ */ new Set();
    selectedAccounts.forEach((accId) => {
      const assignedRoleId = accountRoles.get(accId);
      if (assignedRoleId) {
        const roleIndex = roles.findIndex((r) => r.type === assignedRoleId || this.availableRoleTypes.find((rt) => rt.id === assignedRoleId)?.name === r.name);
        const roleInfo = this.availableRoleTypes.find((r) => r.id === assignedRoleId);
        const account = accounts.find((a) => a.id === accId);
        if (account && roleInfo && !usedRoles.has(roleIndex)) {
          matches.push({
            roleId: `role_${matches.length}`,
            roleName: roleInfo.name,
            roleIcon: roleInfo.icon,
            accountId: accId,
            accountPhone: account.phone,
            accountName: account.phone,
            matchScore: 100,
            matchReasons: ["\u624B\u52D5\u6307\u5B9A"]
          });
          usedAccounts.add(accId);
          if (roleIndex >= 0)
            usedRoles.add(roleIndex);
        }
      }
    });
    let roleIdx = 0;
    selectedAccounts.forEach((accId) => {
      if (usedAccounts.has(accId))
        return;
      while (roleIdx < roles.length && usedRoles.has(roleIdx)) {
        roleIdx++;
      }
      if (roleIdx < roles.length) {
        const role = roles[roleIdx];
        const account = accounts.find((a) => a.id === accId);
        if (account) {
          matches.push({
            roleId: `role_${roleIdx}`,
            roleName: role.name,
            roleIcon: role.icon,
            accountId: accId,
            accountPhone: account.phone,
            accountName: account.phone,
            matchScore: 85,
            matchReasons: ["AI \u81EA\u52D5\u5206\u914D"]
          });
          usedRoles.add(roleIdx);
        }
        roleIdx++;
      }
    });
    return matches;
  }
  // üÜï Â∞éËà™Âà∞Â∏≥ËôüÁÆ°ÁêÜ
  goToAccountManagement() {
    this.closeAIPlanner();
    this.ipc.send("navigate-to-accounts", {});
  }
  /**
   * üîß Áæ§ËÅäÂçî‰ΩúÔºöÁôºÈÄÅÂëΩ‰ª§‰∏¶Á≠âÂæÖÁµêÊûú
   * @param command ÁôºÈÄÅÁöÑÂëΩ‰ª§
   * @param resultEvent Á≠âÂæÖÁöÑÁµêÊûú‰∫ã‰ª∂
   * @param payload Êï∏Êìö
   * @param timeoutMs Ë∂ÖÊôÇÊôÇÈñì
   */
  sendAndWaitForResult(command, resultEvent, payload, timeoutMs = 3e4) {
    return new Promise((resolve) => {
      const timeout = setTimeout(() => {
        console.warn(`[MultiRole] ${command} \u8D85\u6642 (${timeoutMs}ms)`);
        cleanup();
        resolve({ success: false, error: "\u64CD\u4F5C\u8D85\u6642" });
      }, timeoutMs);
      const cleanup = this.ipc.on(resultEvent, (data) => {
        clearTimeout(timeout);
        cleanup();
        console.log(`[MultiRole] ${command} \u7D50\u679C:`, data);
        resolve(data);
      });
      console.log(`[MultiRole] \u767C\u9001 ${command}:`, payload);
      this.ipc.send(command, payload);
    });
  }
  // üÜï P1: ÂåπÈÖçÂâçÂêåÊ≠•Â∏≥ËôüÁãÄÊÖã
  async syncAccountStatusBeforeMatch() {
    return new Promise((resolve) => {
      this.ipc.send("sync-account-status", {});
      this.accountService.loadAccounts();
      setTimeout(() => {
        console.log("[MultiRole] \u5E33\u865F\u72C0\u614B\u5DF2\u540C\u6B65");
        resolve();
      }, 800);
    });
  }
  applyAIPlan() {
    const result = this.aiPlanResult();
    if (!result)
      return;
    const mode = this.selectedExecutionMode();
    const rolesToUse = this.isPrivateChatMode() ? result.recommendedRoles.slice(0, 1) : result.recommendedRoles;
    for (let i = 0; i < rolesToUse.length; i++) {
      const roleConfig = rolesToUse[i];
      const match = this.accountMatchResults()[i];
      const existingRole = this.multiRoleService.roles().find((r) => r.name === roleConfig.name);
      if (!existingRole) {
        this.multiRoleService.addRole({
          name: roleConfig.name,
          type: "custom",
          boundAccountId: match?.accountId,
          boundAccountPhone: match?.accountPhone,
          personality: {
            description: roleConfig.purpose,
            speakingStyle: "friendly",
            traits: []
          },
          aiConfig: {
            useGlobalAI: true,
            customPrompt: `\u4F60\u662F${roleConfig.name}\uFF0C\u8CA0\u8CAC${roleConfig.purpose}\u3002\u8ACB\u7528\u5C08\u696D\u4F46\u53CB\u597D\u7684\u65B9\u5F0F\u8207\u5BA2\u6236\u4EA4\u6D41\u3002`,
            responseLength: "medium",
            emojiFrequency: "low",
            typingSpeed: "medium"
          },
          responsibilities: [roleConfig.purpose]
        });
      }
    }
    if (mode !== "scriptless") {
      const stages = result.suggestedFlow.map((step, index) => ({
        id: `stage_${index + 1}`,
        name: step.action.substring(0, 20) + "...",
        order: step.step,
        trigger: { type: index === 0 ? "manual" : "time", delaySeconds: 120 },
        messages: []
      }));
      this.multiRoleService.addScript({
        name: `AI \u7B56\u5283 - ${this.aiPlannerGoal.substring(0, 15)}...`,
        description: result.strategy,
        stages
      });
    }
    const targetUsers = this.selectedTargetUsers();
    this.dynamicEngine.startFromOnePhrase(this.aiPlannerGoal, mode, targetUsers.length > 0 ? targetUsers : void 0).then(async (execution) => {
      if (execution) {
        const targetInfo = targetUsers.length > 0 ? `\uFF0C\u76EE\u6A19 ${targetUsers.length} \u4EBA` : "";
        this.toast.success(`\u{1F680} \u79C1\u804A\u6A21\u5F0F\u5DF2\u5C31\u7DD2\uFF01${targetInfo}`);
        if (targetUsers.length > 0) {
          const accounts = this.accountMatchResults();
          const mainAccount = accounts[0];
          for (const target of targetUsers) {
            const orchestratorRoles = [{
              roleId: mainAccount?.roleId || "consultant",
              roleName: mainAccount?.roleName || "\u9867\u554F",
              roleIcon: mainAccount?.roleIcon || "\u{1F4BC}",
              accountId: mainAccount?.accountId || 0,
              accountPhone: mainAccount?.accountPhone || "",
              entryOrder: 1,
              entryDelaySeconds: 0,
              entryType: "opener",
              openingMessage: result.recommendedRoles[0]?.openingLine
            }];
            const session = this.orchestrator.createSession({
              targetUserId: target.telegramId || target.id,
              targetUserName: target.firstName || target.username || "Customer",
              roles: orchestratorRoles,
              rhythm: {
                minIntervalSeconds: 15,
                maxIntervalSeconds: 45,
                waitForUserReply: true,
                userSilenceTimeoutSeconds: 120
              }
            });
            await this.orchestrator.startCollaboration(session.id);
            console.log("[MultiRole] \u{1F3AF} \u79C1\u804A\u5354\u4F5C\u6703\u8A71\u5DF2\u5275\u5EFA:", session.id, target.firstName || target.username);
          }
        }
      }
    });
    this.closeAIPlanner();
    this.activeTab.set("dashboard");
    this.selectedTargetUsers.set([]);
  }
  /**
   * üîß Áæ§ËÅäÂçî‰ΩúÔºöÈñãÂßãÁæ§ÁµÑÂçî‰ΩúÊµÅÁ®ã
   */
  async startGroupCollaboration() {
    const result = this.aiPlanResult();
    if (!result)
      return;
    const targetUsers = this.selectedTargetUsers();
    if (targetUsers.length === 0) {
      this.toast.error("\u8ACB\u5148\u9078\u64C7\u76EE\u6A19\u7528\u6236");
      return;
    }
    if (!this.hasEnoughAccounts()) {
      this.toast.error(`\u5E33\u865F\u4E0D\u8DB3\uFF01\u9700\u8981 ${this.requiredAccountsForGroup()} \u500B\u5E33\u865F`);
      return;
    }
    const mode = this.selectedExecutionMode();
    const accounts = this.accountMatchResults();
    const mainAccount = accounts[0];
    if (!mainAccount) {
      this.toast.error("\u6C92\u6709\u53EF\u7528\u7684\u4E3B\u5E33\u865F");
      return;
    }
    console.log("[MultiRole] \u958B\u59CB\u7FA4\u804A\u5354\u4F5C\u6D41\u7A0B");
    console.log("[MultiRole] \u4E3B\u5E33\u865F:", mainAccount.accountPhone);
    console.log("[MultiRole] \u76EE\u6A19\u7528\u6236:", targetUsers.length);
    console.log("[MultiRole] \u89D2\u8272\u5E33\u865F:", accounts.length);
    try {
      this.groupCreationStatus.set("creating");
      this.groupCreationProgress.set("\u6B63\u5728\u5275\u5EFA\u7FA4\u7D44...");
      const firstTarget = targetUsers[0];
      const groupName = `VIP\u670D\u52D9\u7FA4 - ${firstTarget.firstName || firstTarget.username || "Customer"}`;
      const createResult = await this.sendAndWaitForResult("create-group", "create-group-result", {
        name: groupName,
        description: result.strategy,
        type: "group",
        // ‰ΩøÁî®ÊôÆÈÄöÁæ§ÁµÑ
        accountPhone: mainAccount.accountPhone
      });
      if (!createResult.success) {
        throw new Error(createResult.error || "\u5275\u5EFA\u7FA4\u7D44\u5931\u6557");
      }
      const groupId = createResult.groupId || createResult.chatId;
      this.createdGroupId.set(groupId);
      console.log("[MultiRole] \u7FA4\u7D44\u5275\u5EFA\u6210\u529F:", groupId);
      this.groupCreationStatus.set("inviting_target");
      this.groupCreationProgress.set("\u6B63\u5728\u9080\u8ACB\u5BA2\u6236\u52A0\u5165...");
      const groupUrl = createResult.groupUrl || "";
      let successInvites = 0;
      let failedInvites = 0;
      for (const target of targetUsers) {
        try {
          const inviteResult = await this.sendAndWaitForResult("group:invite-user", "group:invite-user-result", {
            groupId,
            groupName,
            // üÜï P0: ÂÇ≥ÈÅûÁæ§ÂêçÁî®ÊñºË®òÈåÑÊìç‰Ωú‰∏ä‰∏ãÊñá
            inviterPhone: mainAccount.accountPhone,
            targetUserId: target.telegramId || target.id,
            targetUsername: target.username
          }, 15e3);
          if (inviteResult.success) {
            successInvites++;
            console.log("[MultiRole] \u6210\u529F\u9080\u8ACB\u7528\u6236:", target.firstName || target.username);
            try {
              this.ipc.send("send-message", {
                accountPhone: mainAccount.accountPhone,
                userId: target.telegramId || target.id,
                content: `\u55E8 ${target.firstName || target.username || ""}\uFF01\u6211\u5011\u525B\u525B\u70BA\u60A8\u5275\u5EFA\u4E86\u5C08\u5C6C VIP \u670D\u52D9\u7FA4\u300C${groupName}\u300D\u{1F389}

\u7FA4\u88E1\u6709\u6211\u5011\u7684\u5C08\u696D\u5718\u968A\uFF0C\u53EF\u4EE5\u66F4\u5FEB\u901F\u5730\u70BA\u60A8\u89E3\u7B54\u554F\u984C\u3002\u6B61\u8FCE\u5230\u7FA4\u88E1\u804A\uFF01`
              });
              console.log("[MultiRole] \u5DF2\u767C\u9001\u5165\u7FA4\u901A\u77E5\u7D66:", target.firstName || target.username);
            } catch (notifyError) {
              console.warn("[MultiRole] \u767C\u9001\u5165\u7FA4\u901A\u77E5\u5931\u6557:", notifyError);
            }
          } else {
            failedInvites++;
            const errorMsg = inviteResult.error || "\u672A\u77E5\u932F\u8AA4";
            console.warn("[MultiRole] \u9080\u8ACB\u5931\u6557:", errorMsg);
            const userName = target.firstName || target.username || target.id;
            if (errorMsg.includes("PRIVACY") || errorMsg.includes("\u96B1\u79C1")) {
              this.toast.warning(`\u26A0\uFE0F ${userName} \u7684\u96B1\u79C1\u8A2D\u7F6E\u4E0D\u5141\u8A31\u9080\u8ACB\uFF0C\u6B63\u5728\u767C\u9001\u7FA4\u9080\u8ACB\u9023\u7D50...`);
            } else if (errorMsg.includes("MUTUAL") || errorMsg.includes("\u597D\u53CB")) {
              this.toast.warning(`\u26A0\uFE0F \u9700\u8981\u5148\u8207 ${userName} \u4E92\u76F8\u6DFB\u52A0\u597D\u53CB\uFF0C\u6B63\u5728\u767C\u9001\u7FA4\u9080\u8ACB\u9023\u7D50...`);
            } else if (errorMsg.includes("FLOOD") || errorMsg.includes("\u983B\u7E41")) {
              this.toast.error(`\u274C \u8ACB\u6C42\u904E\u65BC\u983B\u7E41\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66`);
            } else if (errorMsg.includes("\u672A\u9023\u63A5")) {
              this.toast.error(`\u274C \u9080\u8ACB\u5E33\u865F\u672A\u9023\u63A5\uFF0C\u8ACB\u6AA2\u67E5\u5E33\u865F\u72C0\u614B`);
            }
            if (groupUrl) {
              try {
                this.ipc.send("send-message", {
                  accountPhone: mainAccount.accountPhone,
                  userId: target.telegramId || target.id,
                  content: `\u60A8\u597D\uFF01\u8AA0\u9080\u60A8\u52A0\u5165\u6211\u5011\u7684 VIP \u5C08\u5C6C\u670D\u52D9\u7FA4\uFF1A
${groupUrl}

\u{1F446} \u9EDE\u64CA\u4E0A\u65B9\u9023\u7D50\u5373\u53EF\u52A0\u5165\uFF0C\u6211\u5011\u7684\u5C08\u696D\u5718\u968A\u5C07\u70BA\u60A8\u63D0\u4F9B\u4E00\u5C0D\u4E00\u670D\u52D9\uFF01`
                });
                console.log("[MultiRole] \u5DF2\u767C\u9001\u9080\u8ACB\u9023\u7D50\u7D66:", target.firstName || target.username);
                failedInvites--;
                successInvites++;
                this.ipc.send("record-action", {
                  userId: target.telegramId || target.id,
                  actionType: "group_invite_link",
                  actionDetails: {
                    group_id: groupId,
                    group_name: groupName,
                    group_url: groupUrl
                  },
                  performedBy: mainAccount.accountPhone
                });
              } catch (sendError) {
                console.warn("[MultiRole] \u767C\u9001\u9080\u8ACB\u9023\u7D50\u5931\u6557:", sendError);
              }
            } else {
              this.toast.warning(`\u26A0\uFE0F \u7121\u6CD5\u76F4\u63A5\u9080\u8ACB ${userName}\uFF0C\u4E14\u6C92\u6709\u7FA4\u9080\u8ACB\u9023\u7D50\u53EF\u767C\u9001`);
            }
          }
        } catch (inviteError) {
          failedInvites++;
          console.warn("[MultiRole] \u9080\u8ACB\u5BA2\u6236\u7570\u5E38:", target, inviteError);
        }
      }
      console.log(`[MultiRole] \u9080\u8ACB\u5B8C\u6210: \u6210\u529F/\u5DF2\u767C\u9080\u8ACB ${successInvites}, \u5931\u6557 ${failedInvites}`);
      this.groupCreationStatus.set("inviting_roles");
      this.groupCreationProgress.set("\u6B63\u5728\u9080\u8ACB\u5354\u4F5C\u5E33\u865F...");
      const MAX_RETRIES = 3;
      const RETRY_DELAY = 3e3;
      let addedCount = 0;
      for (let i = 1; i < accounts.length; i++) {
        const roleAccount = accounts[i];
        let success = false;
        for (let attempt = 1; attempt <= MAX_RETRIES && !success; attempt++) {
          try {
            console.log(`[MultiRole] \u5617\u8A66\u6DFB\u52A0\u89D2\u8272\u5E33\u865F (${attempt}/${MAX_RETRIES}):`, roleAccount.accountPhone);
            const addResult = await this.sendAndWaitForResult("group:add-member", "group:add-member-result", {
              groupId,
              adderPhone: mainAccount.accountPhone,
              memberPhone: roleAccount.accountPhone
            }, 15e3);
            if (addResult.success) {
              console.log("[MultiRole] \u2713 \u6210\u529F\u6DFB\u52A0\u89D2\u8272\u5E33\u865F:", roleAccount.accountPhone, roleAccount.roleName);
              success = true;
              addedCount++;
            } else {
              console.warn(`[MultiRole] \u26A0 \u6DFB\u52A0\u89D2\u8272\u5E33\u865F\u5931\u6557 (\u5617\u8A66 ${attempt}):`, roleAccount.accountPhone, addResult.error);
              if (attempt < MAX_RETRIES) {
                console.log(`[MultiRole] \u7B49\u5F85 ${RETRY_DELAY / 1e3} \u79D2\u5F8C\u91CD\u8A66...`);
                await new Promise((r) => setTimeout(r, RETRY_DELAY));
              }
            }
          } catch (addError) {
            console.warn(`[MultiRole] \u274C \u6DFB\u52A0\u89D2\u8272\u5E33\u865F\u7570\u5E38 (\u5617\u8A66 ${attempt}):`, roleAccount.accountPhone, addError);
            if (attempt < MAX_RETRIES) {
              await new Promise((r) => setTimeout(r, RETRY_DELAY));
            }
          }
        }
        if (!success) {
          this.toast.warning(`\u26A0\uFE0F \u7121\u6CD5\u6DFB\u52A0\u5E33\u865F ${roleAccount.accountPhone} \u5230\u7FA4\u7D44\uFF0C\u5C07\u4F7F\u7528\u73FE\u6709\u5E33\u865F\u7E7C\u7E8C`);
        }
      }
      console.log(`[MultiRole] \u{1F4CA} \u89D2\u8272\u5E33\u865F\u6DFB\u52A0\u7D50\u679C: ${addedCount}/${accounts.length - 1} \u6210\u529F`);
      this.groupCreationProgress.set("\u767C\u9001\u6B61\u8FCE\u6D88\u606F...");
      this.ipc.send("send-group-message", {
        resourceId: groupId,
        content: `\u6B61\u8FCE\u52A0\u5165 VIP \u5C08\u5C6C\u670D\u52D9\u7FA4\uFF01\u{1F389}

\u6211\u5011\u7684\u5C08\u696D\u5718\u968A\u5C07\u70BA\u60A8\u63D0\u4F9B\u4E00\u5C0D\u4E00\u7684\u5C08\u5C6C\u670D\u52D9\u3002\u6709\u4EFB\u4F55\u554F\u984C\u90FD\u53EF\u4EE5\u76F4\u63A5\u5728\u7FA4\u5167\u63D0\u51FA\uFF01`,
        accountPhone: mainAccount.accountPhone
      });
      this.groupCreationProgress.set("\u555F\u52D5\u5354\u4F5C\u76E3\u807D...");
      const roleConfigs = accounts.map((acc, idx) => ({
        phone: acc.accountPhone,
        roleId: acc.roleId || `role_${idx}`,
        roleName: acc.roleName || result.recommendedRoles[idx]?.name || "\u52A9\u624B",
        prompt: result.recommendedRoles[idx]?.purpose || "\u5354\u52A9\u670D\u52D9\u5BA2\u6236"
      }));
      this.ipc.send("group:monitor-messages", {
        groupId,
        roles: roleConfigs,
        mainAccountPhone: mainAccount.accountPhone
      });
      console.log("[MultiRole] \u5DF2\u555F\u52D5\u7FA4\u804A\u76E3\u807D\uFF0C\u89D2\u8272\u6578:", roleConfigs.length);
      for (const roleConfig of result.recommendedRoles) {
        const match = accounts.find((a) => a.roleName === roleConfig.name);
        const existingRole = this.multiRoleService.roles().find((r) => r.name === roleConfig.name);
        if (!existingRole) {
          this.multiRoleService.addRole({
            name: roleConfig.name,
            type: "custom",
            boundAccountId: match?.accountId,
            boundAccountPhone: match?.accountPhone,
            personality: {
              description: roleConfig.purpose,
              speakingStyle: "friendly",
              traits: []
            },
            aiConfig: {
              useGlobalAI: true,
              customPrompt: `\u4F60\u662F${roleConfig.name}\uFF0C\u5728\u7FA4\u804A\u4E2D\u8CA0\u8CAC${roleConfig.purpose}\u3002\u8ACB\u914D\u5408\u5176\u4ED6\u89D2\u8272\u5354\u4F5C\u670D\u52D9\u5BA2\u6236\u3002`,
              responseLength: "medium",
              emojiFrequency: "low",
              typingSpeed: "medium"
            },
            responsibilities: [roleConfig.purpose]
          });
        }
      }
      await this.dynamicEngine.startFromOnePhrase(this.aiPlannerGoal, mode, targetUsers, {
        chatScenario: "group",
        groupId,
        roleAccounts: accounts
      });
      const orchestratorRoles = accounts.map((acc, idx) => ({
        roleId: acc.roleId || `role_${idx}`,
        roleName: acc.roleName,
        roleIcon: acc.roleIcon || "\u{1F464}",
        accountId: acc.accountId,
        accountPhone: acc.accountPhone,
        entryOrder: idx + 1,
        entryDelaySeconds: idx === 0 ? 0 : 30 + idx * 15,
        // ‰∏ªËßíËâ≤Á´ãÂç≥ÂÖ•Â†¥ÔºåËºîÂä©ËßíËâ≤Âª∂ÈÅ≤ÂÖ•Â†¥
        entryType: idx === 0 ? "opener" : idx === 1 ? "supporter" : "atmosphere",
        openingMessage: result.recommendedRoles[idx]?.openingLine
      }));
      const session = this.orchestrator.createSession({
        targetUserId: firstTarget.telegramId || firstTarget.id,
        targetUserName: firstTarget.firstName || firstTarget.username || "Customer",
        groupId,
        roles: orchestratorRoles,
        rhythm: {
          minIntervalSeconds: 20,
          maxIntervalSeconds: 60,
          waitForUserReply: true,
          userSilenceTimeoutSeconds: 180
        }
      });
      await this.orchestrator.startCollaboration(session.id);
      console.log("[MultiRole] \u{1F3AF} \u5354\u4F5C\u7DE8\u6392\u670D\u52D9\u5DF2\u555F\u52D5\uFF0C\u6703\u8A71ID:", session.id);
      this.groupCreationStatus.set("ready");
      this.toast.success(`\u{1F389} \u7FA4\u804A\u5354\u4F5C\u5DF2\u555F\u52D5\uFF01\u7FA4\u7D44: ${groupName}`);
      this.closeAIPlanner();
      this.activeTab.set("dashboard");
      this.selectedTargetUsers.set([]);
    } catch (error) {
      console.error("[MultiRole] \u7FA4\u804A\u5354\u4F5C\u5931\u6557:", error);
      this.groupCreationStatus.set("error");
      this.toast.error(`\u7FA4\u804A\u5354\u4F5C\u5931\u6557: ${error.message || error}`);
    }
  }
  saveSettings() {
    this.multiRoleService.updateAutoGroupSettings({
      nameTemplate: this.autoGroupNameTemplate,
      inviteMessageTemplate: this.inviteMessage,
      maxConcurrentGroups: this.maxConcurrent,
      autoCloseAfterDays: this.autoCloseDays
    });
    this.multiRoleService.updateTriggerConditions({
      intentScoreThreshold: this.intentThreshold,
      minConversationRounds: this.minRounds,
      requirePriceInquiry: this.requirePriceInquiry
    });
    this.multiRoleService.updateAISettings({
      useAICenter: this.useAICenter,
      coordinationMode: this.coordinationMode
    });
  }
  // ============ üÜï ÁõÆÊ®ôÁî®Êà∂ÈÅ∏ÊìáÁõ∏ÈóúÊñπÊ≥ï ============
  /**
   * Ë®àÁÆóËÅØÁπ´‰∫∫ÁöÑÊÑèÂêëË©ïÂàÜ
   */
  calculateContactIntent(contact) {
    let score = 30;
    if (contact.status === "replied")
      score += 30;
    else if (contact.status === "contacted")
      score += 15;
    else if (contact.status === "new")
      score += 10;
    if (contact.source_type === "lead")
      score += 20;
    else if (contact.source_type === "member")
      score += 10;
    if (contact.tags?.includes("\u9AD8\u610F\u5411"))
      score += 25;
    else if (contact.tags?.includes("\u6709\u8208\u8DA3"))
      score += 15;
    if (contact.last_message_at)
      score += 10;
    return Math.min(100, score);
  }
  /**
   * ÊâìÈñãÁõÆÊ®ôÁî®Êà∂ÈÅ∏ÊìáÂô®
   */
  openTargetUserSelector() {
    this.syncTargetUsersFromSendConsole();
    this.showTargetUserSelector.set(true);
  }
  /**
   * üÜï P1: ÂæûÁôºÈÄÅÊéßÂà∂Âè∞ÂêåÊ≠•ÁõÆÊ®ôÁî®Êà∂Êï∏Êìö
   */
  syncTargetUsersFromSendConsole() {
    if (this.isSyncingTargetUsers())
      return;
    this.isSyncingTargetUsers.set(true);
    this.ipc.send("get-leads-paginated", {
      page: 1,
      pageSize: 500,
      status: null,
      search: null
    });
    const cleanup = this.ipc.on("leads-paginated", (data) => {
      cleanup();
      this.isSyncingTargetUsers.set(false);
      if (data.leads && data.leads.length > 0) {
        console.log("[MultiRole] \u5F9E\u767C\u9001\u63A7\u5236\u53F0\u540C\u6B65\u6578\u64DA:", data.leads.length);
        this.contactsService.importLeadsDirectly(data.leads);
        this.toast.success(`\u2705 \u5DF2\u540C\u6B65 ${data.leads.length} \u500B\u76EE\u6A19\u7528\u6236`);
      } else {
        this.toast.warning("\u26A0\uFE0F \u767C\u9001\u63A7\u5236\u53F0\u66AB\u7121\u6578\u64DA\uFF0C\u8ACB\u5148\u6DFB\u52A0\u76EE\u6A19\u5BA2\u6236");
      }
    });
    setTimeout(() => {
      if (this.isSyncingTargetUsers()) {
        this.isSyncingTargetUsers.set(false);
        this.toast.error("\u540C\u6B65\u8D85\u6642\uFF0C\u8ACB\u91CD\u8A66");
      }
    }, 1e4);
  }
  /**
   * ÈóúÈñâÁõÆÊ®ôÁî®Êà∂ÈÅ∏ÊìáÂô®
   */
  closeTargetUserSelector() {
    this.showTargetUserSelector.set(false);
    this.targetUserSearchQuery = "";
  }
  /**
   * ÂàáÊèõÈÅ∏‰∏≠ÁãÄÊÖã
   */
  toggleTargetUser(user) {
    const current = this.selectedTargetUsers();
    const exists = current.find((u) => u.telegramId === user.telegramId);
    if (exists) {
      this.selectedTargetUsers.set(current.filter((u) => u.telegramId !== user.telegramId));
    } else {
      this.selectedTargetUsers.set([...current, user]);
    }
  }
  /**
   * Á¢∫Ë™çÈÅ∏ÊìáÁõÆÊ®ôÁî®Êà∂
   */
  confirmTargetUsers() {
    const selected = this.selectedTargetUsers();
    if (selected.length === 0) {
      this.toast.warning("\u8ACB\u81F3\u5C11\u9078\u64C7\u4E00\u500B\u76EE\u6A19\u7528\u6236");
      return;
    }
    this.toast.success(`\u5DF2\u9078\u64C7 ${selected.length} \u500B\u76EE\u6A19\u7528\u6236`);
    this.closeTargetUserSelector();
  }
  /**
   * Ê™¢Êü•Áî®Êà∂ÊòØÂê¶Ë¢´ÈÅ∏‰∏≠
   */
  isUserSelected(user) {
    return this.selectedTargetUsers().some((u) => u.telegramId === user.telegramId);
  }
  /**
   * ÂÖ®ÈÅ∏/ÂèñÊ∂àÂÖ®ÈÅ∏
   */
  toggleSelectAll() {
    const filtered = this.filteredTargetUsers();
    const allSelected = filtered.every((u) => this.isUserSelected(u));
    if (allSelected) {
      const filteredIds = new Set(filtered.map((u) => u.telegramId));
      this.selectedTargetUsers.set(this.selectedTargetUsers().filter((u) => !filteredIds.has(u.telegramId)));
    } else {
      const currentIds = new Set(this.selectedTargetUsers().map((u) => u.telegramId));
      const newUsers = filtered.filter((u) => !currentIds.has(u.telegramId));
      this.selectedTargetUsers.set([...this.selectedTargetUsers(), ...newUsers]);
    }
  }
  /**
   * Ê∏ÖÁ©∫ÈÅ∏Êìá
   */
  clearSelectedUsers() {
    this.selectedTargetUsers.set([]);
  }
  /**
   * Âø´ÈÄüÈÅ∏ÊìáÈ´òÊÑèÂêëÁî®Êà∂
   */
  selectHighIntentUsers() {
    const highIntent = this.availableTargetUsers().filter((u) => u.intentScore >= 60);
    this.selectedTargetUsers.set(highIntent.slice(0, 20));
    this.toast.info(`\u5DF2\u9078\u64C7 ${this.selectedTargetUsers().length} \u500B\u9AD8\u610F\u5411\u7528\u6236`);
  }
  /**
   * üÜï ÊêúÁ¥¢ÁõÆÊ®ôÁî®Êà∂
   */
  searchTargetUsers() {
    if (this.targetUserSearchQuery.trim()) {
      this.toast.info(`\u627E\u5230 ${this.filteredTargetUsers().length} \u500B\u5339\u914D\u7528\u6236`);
    }
  }
  /**
   * üÜï Ê∏ÖÈô§ÊêúÁ¥¢ÂÖßÂÆπ
   */
  clearSearchQuery() {
    this.targetUserSearchQuery = "";
  }
  /**
   * üÜï Âà§Êñ∑ÊòØÂê¶ÂÖ®ÈÅ∏
   */
  isAllSelected() {
    const filtered = this.filteredTargetUsers();
    const selected = this.selectedTargetUsers();
    return filtered.length > 0 && filtered.every((u) => selected.some((s) => s.id === u.id));
  }
  // üÜï ÊâπÈáèÂ∞éÂÖ•ÂäüËÉΩ
  triggerImportFile() {
    this.importFileInput?.nativeElement?.click();
  }
  handleImportFile(event) {
    const input2 = event.target;
    const file = input2.files?.[0];
    if (!file)
      return;
    const reader = new FileReader();
    reader.onload = (e) => {
      const content = e.target?.result;
      this.parseImportFile(content, file.name);
    };
    reader.onerror = () => {
      this.toast.error("\u8B80\u53D6\u6587\u4EF6\u5931\u6557");
    };
    reader.readAsText(file);
    input2.value = "";
  }
  parseImportFile(content, fileName) {
    const lines = content.split("\n").filter((line) => line.trim());
    const importedUsers = [];
    let startIndex = 0;
    const firstLine = lines[0]?.toLowerCase() || "";
    if (firstLine.includes("telegram") || firstLine.includes("username") || firstLine.includes("id") || firstLine.includes("\u7528\u6236")) {
      startIndex = 1;
    }
    for (let i = startIndex; i < lines.length; i++) {
      const line = lines[i].trim();
      if (!line)
        continue;
      const parts = line.split(",").map((p) => p.trim().replace(/"/g, ""));
      if (parts.length >= 1) {
        const telegramId = parts[0];
        const username = parts[1] || "";
        const firstName = parts[2] || parts[1] || telegramId;
        const intentScore = parseInt(parts[3]) || 50;
        if (telegramId && (telegramId.match(/^\d+$/) || telegramId.startsWith("@"))) {
          importedUsers.push({
            id: telegramId,
            telegramId: telegramId.startsWith("@") ? "" : telegramId,
            username: telegramId.startsWith("@") ? telegramId.slice(1) : username,
            firstName,
            lastName: "",
            intentScore,
            source: "import"
          });
        }
      }
    }
    if (importedUsers.length === 0) {
      this.toast.error("\u672A\u80FD\u5F9E\u6587\u4EF6\u4E2D\u89E3\u6790\u51FA\u6709\u6548\u7528\u6236");
      return;
    }
    const current = this.selectedTargetUsers();
    const existingIds = new Set(current.map((u) => u.telegramId || u.id));
    const newUsers = importedUsers.filter((u) => !existingIds.has(u.telegramId || u.id));
    this.selectedTargetUsers.set([...current, ...newUsers]);
    this.toast.success(`\u{1F4E5} \u5DF2\u5C0E\u5165 ${newUsers.length} \u500B\u7528\u6236\uFF08\u5171 ${this.selectedTargetUsers().length} \u500B\uFF09`);
  }
  static {
    this.\u0275fac = function MultiRoleCenterComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _MultiRoleCenterComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _MultiRoleCenterComponent, selectors: [["app-multi-role-center"]], viewQuery: function MultiRoleCenterComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c03, 5)(_c12, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.importFileInput = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.goalInput = _t.first);
      }
    }, hostBindings: function MultiRoleCenterComponent_HostBindings(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275listener("click", function MultiRoleCenterComponent_click_HostBindingHandler($event) {
          return ctx.onDocumentClick($event);
        }, \u0275\u0275resolveDocument);
      }
    }, decls: 49, vars: 11, consts: [["goalInput", ""], ["importFileInput", ""], [1, "multi-role-center", "h-full", "flex", "flex-col", "bg-slate-900"], [1, "p-4", "border-b", "border-slate-700/50", "bg-slate-900/80", "backdrop-blur-sm"], [1, "flex", "items-center", "justify-between"], [1, "flex", "items-center", "gap-4"], [1, "text-2xl", "font-bold", "text-white", "flex", "items-center", "gap-3"], [1, "text-2xl"], [1, "flex", "items-center", "gap-2"], [1, "flex", "items-center", "gap-2", "px-3", "py-1", "bg-purple-500/20", "text-purple-400", "rounded-full", "text-sm"], [1, "px-3", "py-1", "bg-slate-700", "text-slate-400", "rounded-full", "text-sm"], [1, "flex", "items-center", "gap-4", "px-4", "py-2", "bg-slate-800/80", "rounded-xl", "border", "border-slate-700/50"], [1, "text-center"], [1, "text-lg", "font-bold", "text-purple-400"], [1, "text-xs", "text-slate-500"], [1, "w-px", "h-8", "bg-slate-700"], [1, "text-lg", "font-bold", "text-cyan-400"], [1, "text-lg", "font-bold", "text-emerald-400"], [1, "flex", "gap-1", "mt-4", "bg-slate-800/50", "p-1", "rounded-xl", "w-fit"], [1, "px-5", "py-2.5", "rounded-lg", "transition-all", "flex", "items-center", "gap-2", "text-sm", "font-medium", 3, "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "shadow-lg", "text-slate-400", "hover:text-white", "hover:bg-slate-700/50"], [1, "flex-1", "overflow-y-auto", "p-4"], [1, "space-y-6"], [1, "max-w-4xl", "mx-auto", "space-y-6"], [1, "max-w-3xl", "mx-auto", "space-y-6"], [1, "fixed", "inset-0", "bg-black/60", "backdrop-blur-sm", "flex", "items-center", "justify-center", "z-50"], [3, "role", "availableAccounts"], [3, "script"], [1, "fixed", "inset-0", "bg-black/70", "backdrop-blur-sm", "flex", "items-center", "justify-center", "z-50", "p-4"], [1, "w-2", "h-2", "bg-purple-500", "rounded-full", "animate-pulse"], [1, "px-5", "py-2.5", "rounded-lg", "transition-all", "flex", "items-center", "gap-2", "text-sm", "font-medium", 3, "click"], [1, "text-lg"], [1, "bg-gradient-to-r", "from-purple-500/20", "via-pink-500/20", "to-cyan-500/20", "rounded-2xl", "border", "border-purple-500/30", "p-6"], [1, "text-xl", "font-bold", "text-white", "flex", "items-center", "gap-3"], [1, "px-2", "py-0.5", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "text-xs", "rounded-full"], [1, "text-slate-400", "mt-1"], [1, "px-6", "py-3", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity", "flex", "items-center", "gap-2", 3, "click"], [1, "mt-4", "flex", "flex-wrap", "gap-2"], [1, "text-sm", "text-slate-500"], [1, "px-3", "py-1.5", "bg-slate-700/50", "text-slate-300", "text-sm", "rounded-lg", "hover:bg-slate-700", "transition-colors", 3, "click"], [3, "roleAdded", "roleEdit"], [1, "text-xl", "font-bold", "text-white", "flex", "items-center", "gap-2"], [1, "text-sm", "text-slate-400", "mt-1"], [3, "scenarioApplied"], [1, "bg-slate-800/50", "rounded-xl", "border", "border-slate-700/50", "p-6"], [1, "flex", "items-center", "justify-between", "mb-6"], [1, "font-semibold", "text-white", "flex", "items-center", "gap-2"], [1, "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", "hover:bg-purple-500/30", "transition-colors", 3, "click"], [1, "space-y-4"], [1, "flex", "items-center", "justify-between", "p-4", "bg-slate-700/50", "rounded-xl", "hover:bg-slate-700", "transition-colors"], [1, "text-center", "py-12", "text-slate-400"], [1, "text-sm", "font-medium", "text-white", "mb-4"], [1, "grid", "grid-cols-3", "gap-3"], [1, "p-4", "bg-slate-700/50", "rounded-xl", "text-center", "hover:bg-slate-700", "transition-colors"], [1, "w-14", "h-14", "rounded-xl", "flex", "items-center", "justify-center", "text-3xl"], [1, "font-medium", "text-white"], [1, "text-sm", "text-slate-400"], [1, "flex", "items-center", "gap-2", "mt-1"], [1, "px-2", "py-0.5", "bg-emerald-500/20", "text-emerald-400", "text-xs", "rounded-full"], [1, "px-2", "py-0.5", "bg-yellow-500/20", "text-yellow-400", "text-xs", "rounded-full"], [1, "px-2", "py-0.5", "bg-slate-600", "text-slate-300", "text-xs", "rounded"], [1, "flex", "items-center", "gap-3"], [1, "px-3", "py-1.5", "bg-slate-600", "text-slate-300", "rounded-lg", "text-sm", "hover:bg-slate-500", 3, "click"], [1, "text-slate-500", "hover:text-red-400", 3, "click"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-5", "h-5"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"], [1, "text-5xl", "mb-4"], [1, "text-lg", "mb-2"], [1, "text-sm", "mb-4"], [1, "px-6", "py-3", "bg-purple-500", "text-white", "rounded-lg", "hover:bg-purple-400", "transition-colors", 3, "click"], [1, "p-4", "bg-slate-700/50", "rounded-xl", "text-center", "hover:bg-slate-700", "transition-colors", 3, "click"], [1, "text-3xl", "mb-2"], [1, "text-sm", "text-white", "font-medium"], [1, "text-xs", "text-slate-400", "mt-1"], [1, "p-4", "bg-slate-700/50", "rounded-xl"], [1, "text-center", "py-8", "text-slate-400"], [1, "grid", "grid-cols-2", "gap-4"], [1, "p-4", "bg-slate-700/50", "rounded-xl", "text-left", "hover:bg-slate-700", "transition-colors", 3, "click"], [1, "flex", "items-center", "gap-3", "mb-2"], [1, "flex", "items-center", "justify-between", "mb-3"], [1, "px-2", "py-1", "bg-slate-600", "text-slate-300", "text-xs", "rounded"], [1, "text-purple-400", "hover:text-purple-300", "text-sm", 3, "click"], [1, "text-red-400", "hover:text-red-300", "text-sm", 3, "click"], [1, "flex", "items-center", "gap-2", "mt-3"], [1, "flex", "items-center", "gap-4", "mt-3", "pt-3", "border-t", "border-slate-600/50", "text-xs", "text-slate-400"], [1, "px-3", "py-1.5", "bg-slate-600/50", "rounded-lg", "text-xs", "text-slate-300"], ["fill", "none", "stroke", "currentColor", "viewBox", "0 0 24 24", 1, "w-4", "h-4", "text-slate-500"], ["stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "2", "d", "M9 5l7 7-7 7"], [1, "text-4xl", "mb-2"], [1, "mt-3", "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", 3, "click"], [1, "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", "hover:bg-purple-500/30", "transition-colors"], [1, "font-semibold", "text-white", "mb-6", "flex", "items-center", "gap-2"], [1, "text-sm", "text-slate-400", "block", "mb-2"], ["type", "text", "placeholder", "VIP\u5C08\u5C6C\u670D\u52D9\u7FA4 - {\u5BA2\u6236\u540D}", 1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", 3, "ngModelChange", "ngModel"], [1, "text-xs", "text-slate-500", "mt-1"], ["rows", "3", "placeholder", "\u70BA\u4E86\u66F4\u597D\u5730\u670D\u52D9\u60A8...", 1, "w-full", "px-4", "py-3", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", "resize-none", 3, "ngModelChange", "ngModel"], ["type", "number", "min", "1", "max", "20", 1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", 3, "ngModelChange", "ngModel"], ["type", "number", "min", "1", "max", "30", 1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", 3, "ngModelChange", "ngModel"], ["type", "range", "min", "50", "max", "100", "step", "5", 1, "flex-1", 3, "ngModelChange", "ngModel"], [1, "text-white", "w-12", "text-right"], [1, "flex", "items-center", "justify-between", "p-3", "bg-slate-700/50", "rounded-lg", "cursor-pointer"], [1, "text-white"], [1, "text-xs", "text-slate-400"], ["type", "checkbox", 1, "w-5", "h-5", "rounded", "text-purple-500", "bg-slate-700", "border-slate-600", 3, "ngModelChange", "ngModel"], [1, "flex", "items-center", "justify-between", "p-3", "bg-slate-700/50", "rounded-lg", "cursor-pointer", "mb-4"], [1, "flex", "gap-2"], [1, "flex-1", "py-2", "px-4", "rounded-lg", "text-sm", "transition-colors", 3, "click"], [1, "w-full", "py-3", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "rounded-lg", "hover:opacity-90", "transition-opacity", "font-medium", 3, "click"], [1, "bg-slate-800", "rounded-2xl", "w-full", "max-w-lg", "p-6", "shadow-xl", "border", "border-slate-700", "max-h-[90vh]", "overflow-y-auto"], [1, "text-xl", "font-bold", "text-white", "mb-6"], [1, "grid", "grid-cols-3", "gap-2"], [1, "p-3", "rounded-lg", "text-center", "transition-all", "border-2", 3, "border-purple-500", "bg-purple-500/10", "border-transparent", "bg-slate-700"], ["type", "text", "placeholder", "\u5982\uFF1A\u7522\u54C1\u5C08\u5BB6 Mira", 1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", 3, "ngModelChange", "ngModel"], ["rows", "3", "placeholder", "\u63CF\u8FF0\u9019\u500B\u89D2\u8272\u7684\u80CC\u666F\u548C\u6027\u683C...", 1, "w-full", "px-4", "py-3", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", "resize-none", 3, "ngModelChange", "ngModel"], ["rows", "4", "placeholder", "\u4F60\u662F\u4E00\u4F4D...", 1, "w-full", "px-4", "py-3", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", "resize-none", 3, "ngModelChange", "ngModel"], [1, "flex", "gap-3", "mt-6"], [1, "flex-1", "py-2.5", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", "transition-colors", 3, "click"], [1, "flex-1", "py-2.5", "bg-purple-500", "text-white", "rounded-lg", "hover:bg-purple-400", "transition-colors", 3, "click"], [1, "p-3", "rounded-lg", "text-center", "transition-all", "border-2", 3, "click"], [1, "text-2xl", "mb-1"], [1, "text-xs"], [3, "saved", "cancelled", "role", "availableAccounts"], [3, "saved", "cancelled", "script"], [1, "bg-slate-900", "rounded-2xl", "w-full", "max-w-2xl", "shadow-2xl", "border", "border-purple-500/30", "overflow-hidden"], [1, "p-6", "bg-gradient-to-r", "from-purple-500/20", "to-pink-500/20", "border-b", "border-slate-700/50"], [1, "text-slate-400", "hover:text-white", "p-2", "hover:bg-slate-800", "rounded-lg", 3, "click"], [1, "p-6", "space-y-6"], [1, "text-center", "py-8"], [1, "space-y-4", "max-h-[60vh]", "overflow-y-auto"], [1, "p-6", "border-t", "border-slate-700/50", "flex", "gap-3"], ["rows", "3", "placeholder", "\u4F8B\u5982\uFF1A\u628A\u5C0D\u7522\u54C1\u6709\u8208\u8DA3\u4F46\u9084\u5728\u7336\u8C6B\u7684\u5BA2\u6236\u8F49\u5316\u6210\u4ED8\u8CBB\u7528\u6236...", 1, "w-full", "px-4", "py-3", "bg-slate-800", "border", "border-slate-700", "rounded-xl", "text-white", "placeholder-slate-500", "resize-none", "focus:ring-2", "focus:ring-purple-500", "focus:border-transparent", 3, "ngModelChange", "click", "ngModel"], [1, "grid", "grid-cols-2", "gap-3"], [1, "p-3", "bg-slate-800", "rounded-xl", "text-left", "hover:bg-slate-700", "transition-colors", "border", "border-slate-700", 3, "click"], [1, "text-lg", "mb-1"], [1, "inline-block", "animate-spin", "text-4xl", "mb-4"], [1, "text-white", "font-medium"], [1, "text-slate-400", "text-sm", "mt-2"], [1, "mt-4", "flex", "items-center", "justify-center", "gap-2"], [1, "text-slate-500", "text-xs", "mt-3"], [1, "w-32", "h-2", "bg-slate-700", "rounded-full", "overflow-hidden"], [1, "h-full", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "animate-pulse"], [1, "p-4", "bg-indigo-500/10", "border", "border-indigo-500/30", "rounded-xl"], [1, "p-4", "bg-green-500/10", "border", "border-green-500/30", "rounded-xl"], [1, "flex", "items-center", "justify-between", "mb-2"], [1, "flex", "items-center", "gap-2", "text-green-400"], [1, "font-medium"], [1, "px-2", "py-1", "bg-purple-500/20", "text-purple-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "px-2", "py-1", "bg-slate-600/50", "text-slate-400", "text-xs", "rounded-full", "flex", "items-center", "gap-1"], [1, "text-slate-300"], [1, "text-sm", "text-slate-400", "mb-3"], [1, "p-4", "rounded-xl", "border-2", "transition-all", "text-left", 3, "click"], [1, "flex", "items-center", "gap-2", "mb-2"], [1, "text-xs", "text-slate-400", "space-y-1", "mt-3"], [1, "mt-3", "text-xs", "text-blue-400"], [1, "text-xs", "text-green-400"], [1, "mt-3", "text-xs"], [1, "text-red-400"], [1, "mt-3", "p-3", "bg-amber-500/10", "border", "border-amber-500/30", "rounded-lg"], [1, "mt-3", "p-3", "bg-green-500/10", "border", "border-green-500/30", "rounded-lg"], [1, "p-3", "rounded-lg", "border", "transition-all", "text-left", 3, "click"], [1, "flex", "items-center", "gap-2", "mb-1"], [1, "px-1.5", "py-0.5", "bg-cyan-500", "text-white", "text-xs", "rounded"], [1, "p-3", "bg-slate-800", "rounded-lg"], [1, "text-center", "py-4"], [1, "border", "border-slate-700/50", "rounded-xl", "overflow-hidden"], [1, "w-full", "p-3", "bg-slate-800/50", "flex", "items-center", "justify-between", "hover:bg-slate-800", "transition-colors", 3, "click"], [1, "px-2", "py-0.5", "bg-purple-500/20", "text-purple-400", "text-xs", "rounded"], [1, "px-2", "py-0.5", "bg-cyan-500/20", "text-cyan-400", "text-xs", "rounded"], [1, "text-slate-400", "text-sm"], [1, "p-4", "space-y-4", "bg-slate-800/30"], [1, "text-xs", "text-purple-400", "hover:text-purple-300", "flex", "items-center", "gap-1"], [1, "mb-3", "p-3", "bg-purple-500/10", "border", "border-purple-500/30", "rounded-lg", "text-sm"], [1, "bg-slate-800", "rounded-lg", "border", "border-slate-700", "overflow-hidden"], [1, "w-full", "text-sm"], [1, "bg-slate-900/50"], [1, "text-slate-400", "text-xs"], [1, "px-3", "py-2", "text-left"], [1, "px-3", "py-2", "text-center"], [1, "px-3", "py-2", "text-right"], [1, "divide-y", "divide-slate-700/50"], [1, "hover:bg-slate-700/30"], [1, "hover:bg-slate-700/30", "opacity-60"], [1, "mt-3", "p-3", "bg-slate-800", "rounded-lg", "border", "border-slate-700"], [1, "mt-3", "text-center", "py-2", "text-slate-400", "text-sm"], [1, "mt-3", "p-4", "bg-amber-500/10", "border", "border-amber-500/30", "rounded-lg"], [1, "mt-3", "p-3", "bg-cyan-500/10", "border", "border-cyan-500/30", "rounded-lg", "text-sm"], [1, "p-4", "bg-pink-500/10", "border", "border-pink-500/30", "rounded-xl"], [1, "text-slate-400"], [1, "text-lg", "font-bold"], [1, "mt-2", "text-xs", "text-slate-500", "border-t", "border-slate-700", "pt-2"], [1, "text-sm", "text-indigo-400", "font-medium", "mb-3", "flex", "items-center", "gap-2"], [1, "grid", "grid-cols-2", "gap-3", "text-sm"], [1, "text-slate-500", "text-xs", "mb-1"], [1, "mt-3"], [1, "flex", "flex-wrap", "gap-2"], [1, "px-2", "py-1", "bg-red-500/20", "text-red-400", "text-xs", "rounded"], [1, "px-2", "py-1", "bg-green-500/20", "text-green-400", "text-xs", "rounded"], [1, "flex", "items-center", "gap-2", "text-amber-400", "text-sm"], [1, "mt-2", "px-4", "py-2", "bg-amber-500/20", "text-amber-400", "rounded-lg", "hover:bg-amber-500/30", "text-sm", 3, "click"], [1, "text-xs", "text-green-400", "font-medium", "mb-2"], [1, "flex", "items-center", "gap-2", "text-xs", "text-slate-400"], [1, "px-2", "py-1", "bg-slate-700", "rounded"], [1, "text-slate-500", "mb-3"], [1, "flex", "gap-2", "justify-center", "flex-wrap"], [1, "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", "hover:bg-purple-500/30", "text-sm", 3, "click"], [1, "px-4", "py-2", "bg-amber-500/20", "text-amber-400", "rounded-lg", "hover:bg-amber-500/30", "text-sm", 3, "click"], [1, "px-4", "py-2", "bg-cyan-500/20", "text-cyan-400", "rounded-lg", "hover:bg-cyan-500/30", "text-sm", 3, "click"], ["type", "file", "accept", ".csv,.txt", 1, "hidden", 3, "change"], [1, "text-emerald-400", "text-sm"], [1, "text-xs", "text-slate-400", "hover:text-white", 3, "click"], [1, "text-xs", "text-red-400", "hover:text-red-300", 3, "click"], [1, "px-2", "py-1", "bg-slate-700", "rounded", "text-xs", "text-slate-300"], [1, "px-2", "py-1", "bg-slate-600", "rounded", "text-xs", "text-slate-400"], [1, "text-amber-400", "ml-1"], ["type", "range", 1, "flex-1", "h-2", "bg-slate-700", "rounded-lg", "appearance-none", "cursor-pointer", "accent-purple-500", 3, "input", "min", "max", "value"], [1, "flex", "gap-1"], [1, "w-8", "h-8", "rounded-lg", "text-sm", "font-medium", "disabled:opacity-30", "disabled:cursor-not-allowed", 3, "bg-purple-500", "text-white", "bg-slate-700", "text-slate-400", "disabled"], [1, "mt-2", "text-xs", "text-slate-500"], [1, "flex", "items-center", "justify-between", "p-3", "bg-slate-900/50", "rounded-lg"], [1, "text-sm", "text-white"], [1, "w-12", "h-6", "rounded-full", "transition-colors", "relative", 3, "click"], [1, "absolute", "top-1", "w-4", "h-4", "bg-white", "rounded-full", "transition-all"], [1, "w-8", "h-8", "rounded-lg", "text-sm", "font-medium", "disabled:opacity-30", "disabled:cursor-not-allowed", 3, "click", "disabled"], [1, "text-xs", "text-purple-400", "hover:text-purple-300", 3, "click"], [1, "text-xs", "text-slate-400", "hover:text-slate-300", 3, "click"], [1, "grid", "grid-cols-2", "gap-2"], [1, "mt-3", "p-2", "bg-slate-900/50", "rounded-lg"], [1, "p-3", "rounded-lg", "border-2", "transition-all", "text-left", 3, "border-purple-500", "bg-purple-500/10", "border-slate-700", "bg-slate-800"], [1, "p-3", "rounded-lg", "border-2", "transition-all", "text-left", 3, "click"], [1, "w-2", "h-2", "bg-green-500", "rounded-full"], [1, "text-sm", "text-white", "truncate"], [1, "mt-2"], [1, "w-full", "px-2", "py-1", "bg-slate-900", "border", "border-slate-600", "rounded", "text-xs", "text-white", 3, "click", "change", "value"], ["value", ""], [3, "value"], [1, "text-xs", "text-slate-400", "mb-1"], [1, "px-2", "py-1", "bg-slate-700", "rounded", "text-xs", "text-white", "flex", "items-center", "gap-1"], [1, "text-purple-400"], [1, "text-xs", "text-purple-400", "hover:text-purple-300", "flex", "items-center", "gap-1", 3, "click"], [1, "flex", "items-start", "gap-2"], [1, "mb-1"], [1, "text-xs", "text-slate-400", "space-y-1", "ml-4", "list-disc"], [1, "px-3", "py-2"], [1, "text-slate-500", "italic"], [1, "px-2", "py-0.5", "bg-emerald-500/20", "text-emerald-400", "text-xs", "rounded"], [1, "px-2", "py-0.5", "bg-amber-500/20", "text-amber-400", "text-xs", "rounded"], [1, "px-3", "py-2", "text-right", "relative"], [1, "relative", "inline-block"], [1, "text-xs", "text-purple-400", "hover:text-purple-300", "px-2", "py-1", "hover:bg-purple-500/10", "rounded", "flex", "items-center", "gap-1", 3, "click"], [1, "absolute", "right-0", "top-full", "mt-1", "w-48", "bg-slate-800", "border", "border-slate-600", "rounded-lg", "shadow-xl", "z-50", "overflow-hidden"], [1, "w-2", "h-2", "rounded-full", "bg-emerald-500"], [1, "absolute", "right-0", "top-full", "mt-1", "w-48", "bg-slate-800", "border", "border-slate-600", "rounded-lg", "shadow-xl", "z-50", "overflow-hidden", 3, "click"], [1, "px-3", "py-2", "bg-slate-900/50", "border-b", "border-slate-700"], [1, "max-h-48", "overflow-y-auto"], [1, "w-full", "px-3", "py-2", "text-left", "hover:bg-slate-700/50", "flex", "items-center", "gap-2", "text-sm", 3, "bg-purple-500/20"], [1, "border-t", "border-slate-700"], [1, "w-full", "px-3", "py-2", "text-left", "hover:bg-red-500/10", "text-red-400", "text-sm", "flex", "items-center", "gap-2", 3, "click"], [1, "w-full", "px-3", "py-2", "text-left", "hover:bg-slate-700/50", "flex", "items-center", "gap-2", "text-sm", 3, "click"], [1, "flex-1"], [1, "text-xs", "text-purple-400"], [1, "w-2", "h-2", "rounded-full", "bg-slate-500"], [1, "px-2", "py-0.5", "bg-slate-500/20", "text-slate-400", "text-xs", "rounded"], [1, "text-xs", "text-slate-400", "hover:text-white", "px-2", "py-1", "hover:bg-slate-500/10", "rounded", "flex", "items-center", "gap-1", 3, "click"], [1, "w-full", "px-3", "py-2", "text-left", "hover:bg-slate-700/50", "flex", "items-center", "gap-2", "text-sm"], [1, "w-full", "px-3", "py-2", "text-left", "hover:bg-slate-700/50", "text-slate-400", "text-sm", "flex", "items-center", "gap-2", 3, "click"], [1, "text-xs", "text-slate-500", "mb-2"], [1, "text-sm", "text-slate-300", "italic"], [1, "animate-pulse"], [1, "flex", "items-start", "gap-3"], [1, "text-amber-400", "text-sm"], [1, "text-amber-400", "font-medium", "mb-1"], [1, "text-sm", "text-slate-300", "mb-3"], [1, "px-4", "py-2", "bg-purple-500", "text-white", "rounded-lg", "text-sm", "hover:bg-purple-600", 3, "click"], [1, "px-4", "py-2", "bg-slate-700", "text-slate-300", "rounded-lg", "text-sm", "hover:bg-slate-600", 3, "click"], [1, "ml-2", "text-purple-400", "hover:text-purple-300", 3, "click"], [1, "flex", "items-center", "gap-2", "text-cyan-400"], [1, "text-slate-400", "mt-1", "text-xs"], [1, "space-y-3"], [1, "p-3", "bg-slate-800", "rounded-lg", "border", "border-slate-700"], [1, "w-7", "h-7", "rounded-full", "bg-purple-500/30", "text-purple-400", "text-sm", "flex", "items-center", "justify-center", "font-medium"], [1, "text-xs", "text-slate-500", "mt-0.5"], [1, "mt-2", "p-2", "bg-slate-900/50", "rounded", "border-l-2", "border-cyan-500", "ml-10"], [1, "text-xs", "text-slate-500", "mb-1"], [1, "text-sm", "text-pink-400", "font-medium", "mb-2"], [1, "text-xs", "text-slate-300", "space-y-1"], [1, "flex-1", "py-3", "bg-slate-700", "text-slate-300", "rounded-xl", "hover:bg-slate-600", "transition-colors", 3, "click"], [1, "flex-1", "py-3", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "click", "disabled"], [1, "flex-1", "py-3", "bg-gradient-to-r", "from-blue-500", "to-cyan-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity"], [1, "flex-1", "py-3", "bg-gradient-to-r", "from-green-500", "to-emerald-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "disabled"], [1, "flex-1", "py-3", "bg-gradient-to-r", "from-blue-500", "to-cyan-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity", 3, "click"], [1, "flex-1", "py-3", "bg-gradient-to-r", "from-green-500", "to-emerald-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "click", "disabled"], [1, "inline-block", "animate-spin", "mr-2"], [1, "inline-block", "animate-pulse", "mr-2"], [1, "bg-slate-800", "rounded-2xl", "w-full", "max-w-2xl", "shadow-xl", "border", "border-slate-700", "flex", "flex-col", "max-h-[80vh]"], [1, "p-6", "border-b", "border-slate-700/50"], [1, "flex", "items-start", "justify-between"], [1, "text-slate-400", "text-sm", "mt-1"], [1, "px-3", "py-1.5", "bg-cyan-500/20", "text-cyan-400", "rounded-lg", "text-sm", "hover:bg-cyan-500/30", "disabled:opacity-50", "flex", "items-center", "gap-1", 3, "click", "disabled"], [1, "p-4", "border-b", "border-slate-700/50"], [1, "flex", "gap-3"], [1, "flex-1", "relative"], ["type", "text", "placeholder", "\u641C\u7D22\u7528\u6236\u540D\u3001\u59D3\u540D\u6216 Telegram ID...", 1, "w-full", "px-4", "py-2.5", "pr-10", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", 3, "ngModelChange", "keyup.enter", "ngModel"], [1, "absolute", "right-3", "top-1/2", "-translate-y-1/2", "text-slate-400", "hover:text-white"], [1, "px-4", "py-2", "bg-purple-500/20", "text-purple-400", "rounded-lg", "hover:bg-purple-500/30", "text-sm", "flex", "items-center", "gap-1", 3, "click"], [1, "px-4", "py-2", "bg-slate-700", "text-slate-300", "rounded-lg", "hover:bg-slate-600", "text-sm", 3, "click"], [1, "flex", "gap-2", "mt-3"], [1, "px-3", "py-1.5", "bg-amber-500/20", "text-amber-400", "rounded-lg", "text-sm", "hover:bg-amber-500/30", 3, "click"], [1, "text-slate-500", "text-sm", "flex", "items-center"], [1, "text-center", "py-8", "text-slate-500"], [1, "space-y-2"], [1, "flex-1", "py-3", "bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "font-medium", "rounded-xl", "hover:opacity-90", "transition-opacity", "disabled:opacity-50", 3, "click", "disabled"], [1, "animate-spin"], [1, "absolute", "right-3", "top-1/2", "-translate-y-1/2", "text-slate-400", "hover:text-white", 3, "click"], [1, "text-4xl", "mb-3"], [1, "text-sm", "mt-1"], [1, "flex", "items-center", "gap-3", "p-3", "rounded-lg", "cursor-pointer", "transition-all", 3, "bg-purple-500/20", "border-purple-500", "bg-slate-700/50", "hover:bg-slate-700", "border", "border-transparent"], [1, "flex", "items-center", "gap-3", "p-3", "rounded-lg", "cursor-pointer", "transition-all", 3, "click"], [1, "w-5", "h-5", "rounded", "border-2", "flex", "items-center", "justify-center"], ["fill", "currentColor", "viewBox", "0 0 20 20", 1, "w-3", "h-3", "text-white"], [1, "w-10", "h-10", "rounded-full", "bg-gradient-to-br", "from-purple-500", "to-pink-500", "flex", "items-center", "justify-center", "text-white", "font-medium"], [1, "text-right"], [1, "text-sm", "font-bold"], ["fill-rule", "evenodd", "d", "M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z", "clip-rule", "evenodd"], [1, "bg-slate-800", "rounded-2xl", "w-full", "max-w-md", "p-6", "shadow-xl", "border", "border-slate-700"], [1, "text-xl", "font-bold", "text-white", "mb-6", "flex", "items-center", "gap-2"], ["type", "text", "placeholder", "\u5982\uFF1A\u65B0\u5BA2\u6236\u8F49\u5316\u5287\u672C", 1, "w-full", "px-4", "py-2.5", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", 3, "ngModelChange", "ngModel"], ["rows", "3", "placeholder", "\u63CF\u8FF0\u9019\u500B\u5287\u672C\u7684\u4F7F\u7528\u5834\u666F\u548C\u76EE\u6A19...", 1, "w-full", "px-4", "py-3", "bg-slate-700", "border", "border-slate-600", "rounded-lg", "text-white", "placeholder-slate-500", "resize-none", 3, "ngModelChange", "ngModel"], [1, "p-3", "bg-slate-700/50", "rounded-lg", "text-left", "hover:bg-slate-700", "transition-colors", 3, "click"], [1, "flex-1", "py-2.5", "bg-purple-500", "text-white", "rounded-lg", "hover:bg-purple-400", "transition-colors", "disabled:opacity-50", "disabled:cursor-not-allowed", 3, "click", "disabled"]], template: function MultiRoleCenterComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 2)(1, "div", 3)(2, "div", 4)(3, "div", 5)(4, "h1", 6)(5, "span", 7);
        \u0275\u0275text(6, "\u{1F3AD}");
        \u0275\u0275elementEnd();
        \u0275\u0275text(7, " \u89D2\u8272\u8CC7\u6E90\u5EAB ");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "div", 8);
        \u0275\u0275conditionalCreate(9, MultiRoleCenterComponent_Conditional_9_Template, 3, 1, "span", 9)(10, MultiRoleCenterComponent_Conditional_10_Template, 2, 0, "span", 10);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(11, "div", 11)(12, "div", 12)(13, "div", 13);
        \u0275\u0275text(14);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(15, "div", 14);
        \u0275\u0275text(16, "\u89D2\u8272");
        \u0275\u0275elementEnd()();
        \u0275\u0275element(17, "div", 15);
        \u0275\u0275elementStart(18, "div", 12)(19, "div", 16);
        \u0275\u0275text(20);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(21, "div", 14);
        \u0275\u0275text(22, "\u5287\u672C");
        \u0275\u0275elementEnd()();
        \u0275\u0275element(23, "div", 15);
        \u0275\u0275elementStart(24, "div", 12)(25, "div", 17);
        \u0275\u0275text(26);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(27, "div", 14);
        \u0275\u0275text(28, "\u5DF2\u5C31\u7DD2");
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(29, "div", 18);
        \u0275\u0275repeaterCreate(30, MultiRoleCenterComponent_For_31_Template, 5, 18, "button", 19, _forTrack09);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(32, "div", 20);
        \u0275\u0275conditionalCreate(33, MultiRoleCenterComponent_Case_33_Template, 28, 0, "div", 21)(34, MultiRoleCenterComponent_Case_34_Template, 1, 0, "app-role-library")(35, MultiRoleCenterComponent_Case_35_Template, 10, 0, "div", 21)(36, MultiRoleCenterComponent_Case_36_Template, 19, 1, "div", 22)(37, MultiRoleCenterComponent_Case_37_Template, 33, 1, "div", 22)(38, MultiRoleCenterComponent_Case_38_Template, 11, 1, "div", 22)(39, MultiRoleCenterComponent_Case_39_Template, 1, 0, "app-workflow-config")(40, MultiRoleCenterComponent_Case_40_Template, 1, 0, "app-workflow-monitor")(41, MultiRoleCenterComponent_Case_41_Template, 1, 0, "app-workflow-analytics")(42, MultiRoleCenterComponent_Case_42_Template, 74, 27, "div", 23);
        \u0275\u0275elementEnd();
        \u0275\u0275conditionalCreate(43, MultiRoleCenterComponent_Conditional_43_Template, 30, 3, "div", 24);
        \u0275\u0275conditionalCreate(44, MultiRoleCenterComponent_Conditional_44_Template, 1, 2, "app-role-editor", 25);
        \u0275\u0275conditionalCreate(45, MultiRoleCenterComponent_Conditional_45_Template, 1, 1, "app-script-editor", 26);
        \u0275\u0275conditionalCreate(46, MultiRoleCenterComponent_Conditional_46_Template, 17, 5, "div", 27);
        \u0275\u0275conditionalCreate(47, MultiRoleCenterComponent_Conditional_47_Template, 36, 9, "div", 24);
        \u0275\u0275conditionalCreate(48, MultiRoleCenterComponent_Conditional_48_Template, 45, 3, "div", 24);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        let tmp_5_0;
        \u0275\u0275advance(9);
        \u0275\u0275conditional(ctx.multiRoleService.activeGroupCount() > 0 ? 9 : 10);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.multiRoleService.roles().length);
        \u0275\u0275advance(6);
        \u0275\u0275textInterpolate(ctx.multiRoleService.scripts().length);
        \u0275\u0275advance(6);
        \u0275\u0275textInterpolate(ctx.multiRoleService.availableRoles().length);
        \u0275\u0275advance(4);
        \u0275\u0275repeater(ctx.tabs);
        \u0275\u0275advance(3);
        \u0275\u0275conditional((tmp_5_0 = ctx.activeTab()) === "dashboard" ? 33 : tmp_5_0 === "library" ? 34 : tmp_5_0 === "scenarios" ? 35 : tmp_5_0 === "roles" ? 36 : tmp_5_0 === "scripts" ? 37 : tmp_5_0 === "groups" ? 38 : tmp_5_0 === "workflow" ? 39 : tmp_5_0 === "monitor" ? 40 : tmp_5_0 === "analytics" ? 41 : tmp_5_0 === "settings" ? 42 : -1);
        \u0275\u0275advance(10);
        \u0275\u0275conditional(ctx.showAddRole() ? 43 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showRoleEditor() ? 44 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showScriptEditor() ? 45 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showAIPlannerDialog() ? 46 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showTargetUserSelector() ? 47 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showNewScriptDialog() ? 48 : -1);
      }
    }, dependencies: [CommonModule, FormsModule, NgSelectOption, \u0275NgSelectMultipleOption, DefaultValueAccessor, NumberValueAccessor, RangeValueAccessor, CheckboxControlValueAccessor, NgControlStatus, MinValidator, MaxValidator, NgModel, RoleEditorComponent, ScriptEditorComponent, CollaborationDashboardComponent, RoleLibraryComponent, ScenarioSelectorComponent, WorkflowConfigComponent, WorkflowMonitorComponent, WorkflowAnalyticsComponent], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(MultiRoleCenterComponent, [{
    type: Component,
    args: [{
      selector: "app-multi-role-center",
      standalone: true,
      imports: [CommonModule, FormsModule, RoleEditorComponent, ScriptEditorComponent, CollaborationDashboardComponent, RoleLibraryComponent, ScenarioSelectorComponent, WorkflowConfigComponent, WorkflowMonitorComponent, WorkflowAnalyticsComponent],
      template: `
    <div class="multi-role-center h-full flex flex-col bg-slate-900">
      <!-- \u9802\u90E8\u6A19\u984C\u6B04 -->
      <div class="p-4 border-b border-slate-700/50 bg-slate-900/80 backdrop-blur-sm">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <h1 class="text-2xl font-bold text-white flex items-center gap-3">
              <span class="text-2xl">\u{1F3AD}</span>
              \u89D2\u8272\u8CC7\u6E90\u5EAB
            </h1>
            
            <!-- \u6D3B\u8E8D\u7FA4\u7D44\u6578 -->
            <div class="flex items-center gap-2">
              @if (multiRoleService.activeGroupCount() > 0) {
                <span class="flex items-center gap-2 px-3 py-1 bg-purple-500/20 text-purple-400 rounded-full text-sm">
                  <span class="w-2 h-2 bg-purple-500 rounded-full animate-pulse"></span>
                  {{ multiRoleService.activeGroupCount() }} \u500B\u5354\u4F5C\u9032\u884C\u4E2D
                </span>
              } @else {
                <span class="px-3 py-1 bg-slate-700 text-slate-400 rounded-full text-sm">
                  \u7121\u6D3B\u8E8D\u5354\u4F5C
                </span>
              }
            </div>
          </div>
          
          <!-- \u5FEB\u901F\u7D71\u8A08 -->
          <div class="flex items-center gap-4 px-4 py-2 bg-slate-800/80 rounded-xl border border-slate-700/50">
            <div class="text-center">
              <div class="text-lg font-bold text-purple-400">{{ multiRoleService.roles().length }}</div>
              <div class="text-xs text-slate-500">\u89D2\u8272</div>
            </div>
            <div class="w-px h-8 bg-slate-700"></div>
            <div class="text-center">
              <div class="text-lg font-bold text-cyan-400">{{ multiRoleService.scripts().length }}</div>
              <div class="text-xs text-slate-500">\u5287\u672C</div>
            </div>
            <div class="w-px h-8 bg-slate-700"></div>
            <div class="text-center">
              <div class="text-lg font-bold text-emerald-400">{{ multiRoleService.availableRoles().length }}</div>
              <div class="text-xs text-slate-500">\u5DF2\u5C31\u7DD2</div>
            </div>
          </div>
        </div>
        
        <!-- Tab \u5C0E\u822A -->
        <div class="flex gap-1 mt-4 bg-slate-800/50 p-1 rounded-xl w-fit">
          @for (tab of tabs; track tab.id) {
            <button (click)="activeTab.set(tab.id)"
                    class="px-5 py-2.5 rounded-lg transition-all flex items-center gap-2 text-sm font-medium"
                    [class.bg-gradient-to-r]="activeTab() === tab.id"
                    [class.from-purple-500]="activeTab() === tab.id"
                    [class.to-pink-500]="activeTab() === tab.id"
                    [class.text-white]="activeTab() === tab.id"
                    [class.shadow-lg]="activeTab() === tab.id"
                    [class.text-slate-400]="activeTab() !== tab.id"
                    [class.hover:text-white]="activeTab() !== tab.id"
                    [class.hover:bg-slate-700/50]="activeTab() !== tab.id">
              <span class="text-lg">{{ tab.icon }}</span>
              <span>{{ tab.label }}</span>
            </button>
          }
        </div>
      </div>
      
      <!-- Tab \u5167\u5BB9\u5340 -->
      <div class="flex-1 overflow-y-auto p-4">
        @switch (activeTab()) {
          @case ('dashboard') {
            <!-- \u76E3\u63A7\u5100\u8868\u677F + AI \u7B56\u5283\u5165\u53E3 -->
            <div class="space-y-6">
              <!-- AI \u4E00\u9375\u7B56\u5283\u5361\u7247 -->
              <div class="bg-gradient-to-r from-purple-500/20 via-pink-500/20 to-cyan-500/20 rounded-2xl border border-purple-500/30 p-6">
                <div class="flex items-center justify-between">
                  <div>
                    <h2 class="text-xl font-bold text-white flex items-center gap-3">
                      <span class="text-2xl">\u{1F916}</span>
                      AI \u667A\u80FD\u7B56\u5283
                      <span class="px-2 py-0.5 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs rounded-full">NEW</span>
                    </h2>
                    <p class="text-slate-400 mt-1">\u544A\u8A34 AI \u4F60\u7684\u76EE\u6A19\uFF0C\u81EA\u52D5\u751F\u6210\u6700\u4F73\u89D2\u8272\u7D44\u5408\u548C\u57F7\u884C\u7B56\u7565</p>
                  </div>
                  <button (click)="openAIPlanner()"
                          class="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:opacity-90 transition-opacity flex items-center gap-2">
                    <span>\u{1F680}</span>
                    \u958B\u59CB\u7B56\u5283
                  </button>
                </div>
                
                <!-- \u5FEB\u901F\u76EE\u6A19\u9078\u64C7 -->
                <div class="mt-4 flex flex-wrap gap-2">
                  <span class="text-sm text-slate-500">\u5FEB\u901F\u9078\u64C7\uFF1A</span>
                  <button (click)="quickAIPlan('\u4FC3\u9032\u9996\u55AE\u6210\u4EA4')" 
                          class="px-3 py-1.5 bg-slate-700/50 text-slate-300 text-sm rounded-lg hover:bg-slate-700 transition-colors">
                    \u{1F4B0} \u4FC3\u9032\u9996\u55AE
                  </button>
                  <button (click)="quickAIPlan('\u633D\u56DE\u6D41\u5931\u5BA2\u6236')"
                          class="px-3 py-1.5 bg-slate-700/50 text-slate-300 text-sm rounded-lg hover:bg-slate-700 transition-colors">
                    \u{1F49D} \u633D\u56DE\u6D41\u5931
                  </button>
                  <button (click)="quickAIPlan('\u63D0\u5347\u793E\u7FA4\u6D3B\u8E8D\u5EA6')"
                          class="px-3 py-1.5 bg-slate-700/50 text-slate-300 text-sm rounded-lg hover:bg-slate-700 transition-colors">
                    \u{1F389} \u793E\u7FA4\u6D3B\u8E8D
                  </button>
                  <button (click)="quickAIPlan('\u8655\u7406\u552E\u5F8C\u554F\u984C')"
                          class="px-3 py-1.5 bg-slate-700/50 text-slate-300 text-sm rounded-lg hover:bg-slate-700 transition-colors">
                    \u{1F527} \u552E\u5F8C\u670D\u52D9
                  </button>
                </div>
              </div>
              
              <!-- \u539F\u6709\u7684\u76E3\u63A7\u5100\u8868\u677F -->
              <app-collaboration-dashboard></app-collaboration-dashboard>
            </div>
          }
          
          @case ('library') {
            <!-- \u89D2\u8272\u5EAB (50\u500B\u9810\u8A2D\u89D2\u8272) -->
            <app-role-library 
              (roleAdded)="onPresetRoleAdded($event)"
              (roleEdit)="onPresetRoleEdit($event)">
            </app-role-library>
          }
          
          @case ('scenarios') {
            <!-- \u5834\u666F\u6A21\u677F (10\u500B\u9810\u8A2D\u5834\u666F) -->
            <div class="space-y-6">
              <div class="flex items-center justify-between">
                <div>
                  <h2 class="text-xl font-bold text-white flex items-center gap-2">
                    <span>\u{1F3AC}</span> \u5834\u666F\u6A21\u677F\u5EAB
                  </h2>
                  <p class="text-sm text-slate-400 mt-1">10\u500B\u9810\u8A2D\u5834\u666F\uFF0C\u5FEB\u901F\u555F\u52D5\u591A\u89D2\u8272\u5354\u4F5C</p>
                </div>
              </div>
              <app-scenario-selector 
                (scenarioApplied)="onScenarioApplied($event)">
              </app-scenario-selector>
            </div>
          }
          
          @case ('roles') {
            <!-- \u89D2\u8272\u7BA1\u7406 -->
            <div class="max-w-4xl mx-auto space-y-6">
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <div class="flex items-center justify-between mb-6">
                  <h3 class="font-semibold text-white flex items-center gap-2">
                    <span>\u{1F3AD}</span> \u89D2\u8272\u5B9A\u7FA9
                  </h3>
                  <button (click)="showAddRole.set(true)"
                          class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition-colors">
                    + \u6DFB\u52A0\u89D2\u8272
                  </button>
                </div>
                
                <div class="space-y-4">
                  @for (role of multiRoleService.roles(); track role.id) {
                    <div class="flex items-center justify-between p-4 bg-slate-700/50 rounded-xl hover:bg-slate-700 transition-colors">
                      <div class="flex items-center gap-4">
                        <div class="w-14 h-14 rounded-xl flex items-center justify-center text-3xl"
                             [class.bg-purple-500/20]="role.type === 'expert'"
                             [class.bg-emerald-500/20]="role.type === 'satisfied_customer'"
                             [class.bg-cyan-500/20]="role.type === 'support'"
                             [class.bg-orange-500/20]="role.type === 'manager'"
                             [class.bg-slate-600]="role.type === 'custom'">
                          {{ getRoleIcon(role.type) }}
                        </div>
                        <div>
                          <div class="font-medium text-white">{{ role.name }}</div>
                          <div class="text-sm text-slate-400">{{ role.personality.description }}</div>
                          <div class="flex items-center gap-2 mt-1">
                            @if (role.boundAccountPhone) {
                              <span class="px-2 py-0.5 bg-emerald-500/20 text-emerald-400 text-xs rounded-full">
                                \u7D81\u5B9A: {{ role.boundAccountPhone }}
                              </span>
                            } @else {
                              <span class="px-2 py-0.5 bg-yellow-500/20 text-yellow-400 text-xs rounded-full">
                                \u672A\u7D81\u5B9A\u5E33\u865F
                              </span>
                            }
                            <span class="px-2 py-0.5 bg-slate-600 text-slate-300 text-xs rounded">
                              {{ getRoleStyleLabel(role.personality.speakingStyle) }}
                            </span>
                          </div>
                        </div>
                      </div>
                      
                      <div class="flex items-center gap-3">
                        <button (click)="editRole(role)"
                                class="px-3 py-1.5 bg-slate-600 text-slate-300 rounded-lg text-sm hover:bg-slate-500">
                          \u7DE8\u8F2F
                        </button>
                        <button (click)="deleteRole(role)"
                                class="text-slate-500 hover:text-red-400">
                          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                          </svg>
                        </button>
                      </div>
                    </div>
                  } @empty {
                    <div class="text-center py-12 text-slate-400">
                      <div class="text-5xl mb-4">\u{1F3AD}</div>
                      <p class="text-lg mb-2">\u5C1A\u672A\u5B9A\u7FA9\u89D2\u8272</p>
                      <p class="text-sm mb-4">\u5275\u5EFA\u89D2\u8272\u4F86\u7D44\u5EFA\u591A\u89D2\u8272\u5354\u4F5C\u5718\u968A</p>
                      <button (click)="showAddRole.set(true)"
                              class="px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-400 transition-colors">
                        + \u5275\u5EFA\u7B2C\u4E00\u500B\u89D2\u8272
                      </button>
                    </div>
                  }
                </div>
              </div>
              
              <!-- \u5FEB\u901F\u6DFB\u52A0\u89D2\u8272 -->
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <h4 class="text-sm font-medium text-white mb-4">\u5FEB\u901F\u6DFB\u52A0\u9810\u8A2D\u89D2\u8272</h4>
                <div class="grid grid-cols-3 gap-3">
                  @for (type of roleTypes; track type.id) {
                    <button (click)="quickAddRole(type.id)"
                            class="p-4 bg-slate-700/50 rounded-xl text-center hover:bg-slate-700 transition-colors">
                      <div class="text-3xl mb-2">{{ type.icon }}</div>
                      <div class="text-sm text-white font-medium">{{ type.label }}</div>
                      <div class="text-xs text-slate-400 mt-1">{{ type.description }}</div>
                    </button>
                  }
                </div>
              </div>
            </div>
          }
          
          @case ('scripts') {
            <!-- \u5287\u672C\u7DE8\u6392 -->
            <div class="max-w-4xl mx-auto space-y-6">
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <div class="flex items-center justify-between mb-6">
                  <h3 class="font-semibold text-white flex items-center gap-2">
                    <span>\u{1F4DC}</span> \u5354\u4F5C\u5287\u672C
                  </h3>
                  <button (click)="addScript()"
                          class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition-colors">
                    + \u65B0\u5EFA\u5287\u672C
                  </button>
                </div>
                
                <div class="space-y-4">
                  @for (script of multiRoleService.scripts(); track script.id) {
                    <div class="p-4 bg-slate-700/50 rounded-xl">
                      <div class="flex items-center justify-between mb-3">
                        <div>
                          <div class="font-medium text-white">{{ script.name }}</div>
                          <div class="text-sm text-slate-400">{{ script.description }}</div>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="px-2 py-1 bg-slate-600 text-slate-300 text-xs rounded">
                            {{ script.stages.length }} \u500B\u968E\u6BB5
                          </span>
                          <button (click)="editScript(script)"
                                  class="text-purple-400 hover:text-purple-300 text-sm">
                            \u7DE8\u8F2F
                          </button>
                          <button (click)="deleteScript(script)"
                                  class="text-red-400 hover:text-red-300 text-sm">
                            \u522A\u9664
                          </button>
                        </div>
                      </div>
                      
                      <!-- \u5287\u672C\u968E\u6BB5\u9810\u89BD -->
                      @if (script.stages.length > 0) {
                        <div class="flex items-center gap-2 mt-3">
                          @for (stage of script.stages; track stage.id; let i = $index) {
                            <div class="flex items-center gap-2">
                              <div class="px-3 py-1.5 bg-slate-600/50 rounded-lg text-xs text-slate-300">
                                {{ stage.name }}
                              </div>
                              @if (i < script.stages.length - 1) {
                                <svg class="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                </svg>
                              }
                            </div>
                          }
                        </div>
                      }
                      
                      <!-- \u7D71\u8A08 -->
                      <div class="flex items-center gap-4 mt-3 pt-3 border-t border-slate-600/50 text-xs text-slate-400">
                        <span>\u4F7F\u7528 {{ script.stats.useCount }} \u6B21</span>
                        <span>\u6210\u529F\u7387 {{ (script.stats.conversionRate * 100).toFixed(0) }}%</span>
                        <span>\u5E73\u5747 {{ script.stats.avgDuration }} \u5206\u9418</span>
                      </div>
                    </div>
                  } @empty {
                    <div class="text-center py-8 text-slate-400">
                      <div class="text-4xl mb-2">\u{1F4DC}</div>
                      <p>\u5C1A\u672A\u5275\u5EFA\u5287\u672C</p>
                      <button (click)="addScript()"
                              class="mt-3 px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg">
                        + \u5275\u5EFA\u5287\u672C
                      </button>
                    </div>
                  }
                </div>
              </div>
              
              <!-- \u9810\u8A2D\u5287\u672C\u6A21\u677F -->
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <h4 class="text-sm font-medium text-white mb-4">\u4F7F\u7528\u9810\u8A2D\u6A21\u677F</h4>
                <div class="grid grid-cols-2 gap-4">
                  <button (click)="useTemplate('high_intent')"
                          class="p-4 bg-slate-700/50 rounded-xl text-left hover:bg-slate-700 transition-colors">
                    <div class="flex items-center gap-3 mb-2">
                      <span class="text-2xl">\u{1F3AF}</span>
                      <span class="font-medium text-white">\u9AD8\u610F\u5411\u5BA2\u6236\u8F49\u5316</span>
                    </div>
                    <p class="text-sm text-slate-400">\u5C08\u5BB6\u4ECB\u7D39 + \u8001\u5BA2\u6236\u80CC\u66F8 + \u5BA2\u670D\u4FC3\u55AE</p>
                  </button>
                  <button (click)="useTemplate('product_demo')"
                          class="p-4 bg-slate-700/50 rounded-xl text-left hover:bg-slate-700 transition-colors">
                    <div class="flex items-center gap-3 mb-2">
                      <span class="text-2xl">\u{1F4E6}</span>
                      <span class="font-medium text-white">\u7522\u54C1\u6F14\u793A\u63A8\u85A6</span>
                    </div>
                    <p class="text-sm text-slate-400">\u529F\u80FD\u5C55\u793A + \u4F7F\u7528\u5834\u666F + \u6548\u679C\u5206\u4EAB</p>
                  </button>
                </div>
              </div>
            </div>
          }
          
          @case ('groups') {
            <!-- \u5354\u4F5C\u7FA4\u7D44 -->
            <div class="max-w-4xl mx-auto space-y-6">
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <div class="flex items-center justify-between mb-6">
                  <h3 class="font-semibold text-white flex items-center gap-2">
                    <span>\u{1F3E0}</span> \u5354\u4F5C\u7FA4\u7D44
                  </h3>
                  <button class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition-colors">
                    + \u624B\u52D5\u5275\u5EFA
                  </button>
                </div>
                
                @if (multiRoleService.roles().length === 0) {
                  <div class="text-center py-12 text-slate-400">
                    <div class="text-5xl mb-4">\u{1F3E0}</div>
                    <p class="text-lg mb-2">\u66AB\u7121\u5354\u4F5C\u7FA4\u7D44</p>
                    <p class="text-sm mb-4">\u7576\u89F8\u767C\u591A\u89D2\u8272\u5354\u4F5C\u6642\uFF0C\u7CFB\u7D71\u6703\u81EA\u52D5\u5EFA\u7ACB\u5354\u4F5C\u7FA4\u7D44</p>
                    <p class="text-xs text-slate-500">\u{1F4A1} \u63D0\u793A\uFF1A\u5148\u5728\u300C\u6211\u7684\u89D2\u8272\u300D\u4E2D\u6DFB\u52A0\u89D2\u8272\u4E26\u7D81\u5B9A\u5E33\u865F</p>
                  </div>
                } @else {
                  <div class="text-center py-12 text-slate-400">
                    <div class="text-5xl mb-4">\u{1F3E0}</div>
                    <p class="text-lg mb-2">\u66AB\u7121\u5354\u4F5C\u7FA4\u7D44</p>
                    <p class="text-sm mb-4">\u60A8\u5DF2\u6709 {{ multiRoleService.roles().length }} \u500B\u89D2\u8272\u5C31\u7DD2</p>
                    <button (click)="showCreateGroupDialog.set(true)"
                            class="px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-400 transition-colors">
                      + \u5275\u5EFA\u5354\u4F5C\u7FA4\u7D44
                    </button>
                  </div>
                }
              </div>
            </div>
          }
          
          @case ('workflow') {
            <!-- \u{1F195} Phase2: \u5DE5\u4F5C\u6D41\u914D\u7F6E -->
            <app-workflow-config></app-workflow-config>
          }
          
          @case ('monitor') {
            <!-- \u{1F195} Phase2: \u57F7\u884C\u76E3\u63A7 -->
            <app-workflow-monitor></app-workflow-monitor>
          }
          
          @case ('analytics') {
            <!-- \u{1F195} Phase4: \u6578\u64DA\u5206\u6790 -->
            <app-workflow-analytics></app-workflow-analytics>
          }
          
          @case ('settings') {
            <!-- \u8A2D\u7F6E -->
            <div class="max-w-3xl mx-auto space-y-6">
              <!-- \u81EA\u52D5\u5EFA\u7FA4\u8A2D\u7F6E -->
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <h3 class="font-semibold text-white mb-6 flex items-center gap-2">
                  <span>\u2699\uFE0F</span> \u81EA\u52D5\u5EFA\u7FA4\u8A2D\u7F6E
                </h3>
                
                <div class="space-y-4">
                  <div>
                    <label class="text-sm text-slate-400 block mb-2">\u7FA4\u540D\u6A21\u677F</label>
                    <input type="text" 
                           [(ngModel)]="autoGroupNameTemplate"
                           placeholder="VIP\u5C08\u5C6C\u670D\u52D9\u7FA4 - &#123;\u5BA2\u6236\u540D&#125;"
                           class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500">
                    <p class="text-xs text-slate-500 mt-1">\u53EF\u7528\u8B8A\u91CF: {{ '{' }}\u5BA2\u6236\u540D{{ '}' }}</p>
                  </div>
                  
                  <div>
                    <label class="text-sm text-slate-400 block mb-2">\u9080\u8ACB\u8A71\u8853</label>
                    <textarea rows="3"
                              [(ngModel)]="inviteMessage"
                              placeholder="\u70BA\u4E86\u66F4\u597D\u5730\u670D\u52D9\u60A8..."
                              class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 resize-none">
                    </textarea>
                  </div>
                  
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <label class="text-sm text-slate-400 block mb-2">\u6700\u5927\u540C\u6642\u5354\u4F5C\u6578</label>
                      <input type="number" 
                             [(ngModel)]="maxConcurrent"
                             min="1" max="20"
                             class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white">
                    </div>
                    <div>
                      <label class="text-sm text-slate-400 block mb-2">\u81EA\u52D5\u95DC\u9589\u5929\u6578</label>
                      <input type="number"
                             [(ngModel)]="autoCloseDays"
                             min="1" max="30"
                             class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white">
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- \u89F8\u767C\u689D\u4EF6 -->
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <h3 class="font-semibold text-white mb-6 flex items-center gap-2">
                  <span>\u{1F3AF}</span> \u9ED8\u8A8D\u89F8\u767C\u689D\u4EF6
                </h3>
                
                <div class="space-y-4">
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <label class="text-sm text-slate-400 block mb-2">\u610F\u5411\u8A55\u5206\u95BE\u503C</label>
                      <div class="flex items-center gap-2">
                        <input type="range" 
                               [(ngModel)]="intentThreshold"
                               min="50" max="100" step="5"
                               class="flex-1">
                        <span class="text-white w-12 text-right">{{ intentThreshold }}%</span>
                      </div>
                    </div>
                    <div>
                      <label class="text-sm text-slate-400 block mb-2">\u6700\u5C11\u5C0D\u8A71\u8F2A\u6578</label>
                      <input type="number"
                             [(ngModel)]="minRounds"
                             min="1" max="20"
                             class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white">
                    </div>
                  </div>
                  
                  <label class="flex items-center justify-between p-3 bg-slate-700/50 rounded-lg cursor-pointer">
                    <div>
                      <div class="text-white">\u9700\u8981\u8A62\u554F\u904E\u50F9\u683C</div>
                      <div class="text-xs text-slate-400">\u53EA\u6709\u8A62\u554F\u904E\u50F9\u683C\u7684\u5BA2\u6236\u624D\u89F8\u767C</div>
                    </div>
                    <input type="checkbox"
                           [(ngModel)]="requirePriceInquiry"
                           class="w-5 h-5 rounded text-purple-500 bg-slate-700 border-slate-600">
                  </label>
                </div>
              </div>
              
              <!-- AI \u8A2D\u7F6E -->
              <div class="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <h3 class="font-semibold text-white mb-6 flex items-center gap-2">
                  <span>\u{1F916}</span> AI \u8A2D\u7F6E
                </h3>
                
                <label class="flex items-center justify-between p-3 bg-slate-700/50 rounded-lg cursor-pointer mb-4">
                  <div>
                    <div class="text-white">\u4F7F\u7528 AI \u4E2D\u5FC3\u914D\u7F6E</div>
                    <div class="text-xs text-slate-400">\u5F9E AI \u4E2D\u5FC3\u7372\u53D6\u6A21\u578B\u548C\u77E5\u8B58\u5EAB\u914D\u7F6E</div>
                  </div>
                  <input type="checkbox"
                         [(ngModel)]="useAICenter"
                         class="w-5 h-5 rounded text-purple-500 bg-slate-700 border-slate-600">
                </label>
                
                <div>
                  <label class="text-sm text-slate-400 block mb-2">\u5354\u4F5C\u6A21\u5F0F</label>
                  <div class="flex gap-2">
                    <button (click)="coordinationMode = 'sequential'"
                            class="flex-1 py-2 px-4 rounded-lg text-sm transition-colors"
                            [class.bg-purple-500]="coordinationMode === 'sequential'"
                            [class.text-white]="coordinationMode === 'sequential'"
                            [class.bg-slate-700]="coordinationMode !== 'sequential'"
                            [class.text-slate-300]="coordinationMode !== 'sequential'">
                      \u9806\u5E8F\u57F7\u884C
                    </button>
                    <button (click)="coordinationMode = 'responsive'"
                            class="flex-1 py-2 px-4 rounded-lg text-sm transition-colors"
                            [class.bg-purple-500]="coordinationMode === 'responsive'"
                            [class.text-white]="coordinationMode === 'responsive'"
                            [class.bg-slate-700]="coordinationMode !== 'responsive'"
                            [class.text-slate-300]="coordinationMode !== 'responsive'">
                      \u97FF\u61C9\u5F0F
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- \u4FDD\u5B58\u6309\u9215 -->
              <button (click)="saveSettings()"
                      class="w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:opacity-90 transition-opacity font-medium">
                \u4FDD\u5B58\u8A2D\u7F6E
              </button>
            </div>
          }
        }
      </div>
      
      <!-- \u6DFB\u52A0\u89D2\u8272\u5C0D\u8A71\u6846 -->
      @if (showAddRole()) {
        <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
          <div class="bg-slate-800 rounded-2xl w-full max-w-lg p-6 shadow-xl border border-slate-700 max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold text-white mb-6">\u6DFB\u52A0\u89D2\u8272</h3>
            
            <div class="space-y-4">
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u89D2\u8272\u985E\u578B</label>
                <div class="grid grid-cols-3 gap-2">
                  @for (type of roleTypes; track type.id) {
                    <button (click)="newRoleType.set(type.id)"
                            class="p-3 rounded-lg text-center transition-all border-2"
                            [class.border-purple-500]="newRoleType() === type.id"
                            [class.bg-purple-500/10]="newRoleType() === type.id"
                            [class.border-transparent]="newRoleType() !== type.id"
                            [class.bg-slate-700]="newRoleType() !== type.id">
                      <div class="text-2xl mb-1">{{ type.icon }}</div>
                      <div class="text-xs"
                           [class.text-purple-400]="newRoleType() === type.id"
                           [class.text-slate-300]="newRoleType() !== type.id">
                        {{ type.label }}
                      </div>
                    </button>
                  }
                </div>
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u89D2\u8272\u540D\u7A31</label>
                <input type="text"
                       [(ngModel)]="newRoleName"
                       placeholder="\u5982\uFF1A\u7522\u54C1\u5C08\u5BB6 Mira"
                       class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500">
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u4EBA\u8A2D\u63CF\u8FF0</label>
                <textarea rows="3"
                          [(ngModel)]="newRoleDescription"
                          placeholder="\u63CF\u8FF0\u9019\u500B\u89D2\u8272\u7684\u80CC\u666F\u548C\u6027\u683C..."
                          class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 resize-none">
                </textarea>
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">AI \u4EBA\u8A2D Prompt</label>
                <textarea rows="4"
                          [(ngModel)]="newRolePrompt"
                          placeholder="\u4F60\u662F\u4E00\u4F4D..."
                          class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 resize-none">
                </textarea>
              </div>
            </div>
            
            <div class="flex gap-3 mt-6">
              <button (click)="showAddRole.set(false)"
                      class="flex-1 py-2.5 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-colors">
                \u53D6\u6D88
              </button>
              <button (click)="saveNewRole()"
                      class="flex-1 py-2.5 bg-purple-500 text-white rounded-lg hover:bg-purple-400 transition-colors">
                \u6DFB\u52A0
              </button>
            </div>
          </div>
        </div>
      }
      
      <!-- \u89D2\u8272\u7DE8\u8F2F\u5668 -->
      @if (showRoleEditor()) {
        <app-role-editor
          [role]="editingRole()"
          [availableAccounts]="availableAccounts()"
          (saved)="onRoleSaved($event)"
          (cancelled)="onRoleEditorCancelled()">
        </app-role-editor>
      }
      
      <!-- \u5287\u672C\u7DE8\u8F2F\u5668 -->
      @if (showScriptEditor()) {
        <app-script-editor
          [script]="editingScript()"
          (saved)="onScriptSaved($event)"
          (cancelled)="onScriptEditorCancelled()">
        </app-script-editor>
      }
      
      <!-- AI \u7B56\u5283\u5C0D\u8A71\u6846 -->
      @if (showAIPlannerDialog()) {
        <div class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4">
          <div class="bg-slate-900 rounded-2xl w-full max-w-2xl shadow-2xl border border-purple-500/30 overflow-hidden">
            <!-- \u982D\u90E8 -->
            <div class="p-6 bg-gradient-to-r from-purple-500/20 to-pink-500/20 border-b border-slate-700/50">
              <div class="flex items-center justify-between">
                <h2 class="text-xl font-bold text-white flex items-center gap-3">
                  <span class="text-2xl">\u{1F916}</span>
                  AI \u667A\u80FD\u7B56\u5283
                </h2>
                <button (click)="closeAIPlanner()"
                        class="text-slate-400 hover:text-white p-2 hover:bg-slate-800 rounded-lg">
                  \u2715
                </button>
              </div>
            </div>
            
            <!-- \u5167\u5BB9 -->
            <div class="p-6 space-y-6">
              @if (aiPlannerStatus() === 'idle') {
                <!-- \u8F38\u5165\u76EE\u6A19 -->
                <div>
                  <label class="text-sm text-slate-400 block mb-2">\u{1F3AF} \u544A\u8A34 AI \u4F60\u60F3\u9054\u6210\u4EC0\u9EBC\u76EE\u6A19</label>
                  <textarea #goalInput
                            rows="3"
                            [(ngModel)]="aiPlannerGoal"
                            placeholder="\u4F8B\u5982\uFF1A\u628A\u5C0D\u7522\u54C1\u6709\u8208\u8DA3\u4F46\u9084\u5728\u7336\u8C6B\u7684\u5BA2\u6236\u8F49\u5316\u6210\u4ED8\u8CBB\u7528\u6236..."
                            class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white placeholder-slate-500 resize-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            (click)="$event.stopPropagation()">
                  </textarea>
                </div>
                
                <!-- \u9810\u8A2D\u76EE\u6A19\u5FEB\u6377\u9078\u64C7 -->
                <div>
                  <label class="text-sm text-slate-400 block mb-2">\u6216\u9078\u64C7\u5E38\u898B\u76EE\u6A19</label>
                  <div class="grid grid-cols-2 gap-3">
                    <button (click)="aiPlannerGoal = '\u628A\u7336\u8C6B\u4E0D\u6C7A\u7684\u6F5B\u5728\u5BA2\u6236\u8F49\u5316\u70BA\u4ED8\u8CBB\u7528\u6236'"
                            class="p-3 bg-slate-800 rounded-xl text-left hover:bg-slate-700 transition-colors border border-slate-700">
                      <div class="text-lg mb-1">\u{1F4B0}</div>
                      <div class="text-sm text-white font-medium">\u4FC3\u9032\u9996\u55AE\u6210\u4EA4</div>
                      <div class="text-xs text-slate-400">\u591A\u89D2\u8272\u914D\u5408\u4FC3\u9032\u7336\u8C6B\u5BA2\u6236\u4E0B\u55AE</div>
                    </button>
                    <button (click)="aiPlannerGoal = '\u633D\u56DE\u5DF2\u6D41\u5931\u7684\u8001\u5BA2\u6236\uFF0C\u8B93\u4ED6\u5011\u91CD\u65B0\u8CFC\u8CB7'"
                            class="p-3 bg-slate-800 rounded-xl text-left hover:bg-slate-700 transition-colors border border-slate-700">
                      <div class="text-lg mb-1">\u{1F49D}</div>
                      <div class="text-sm text-white font-medium">\u633D\u56DE\u6D41\u5931\u5BA2\u6236</div>
                      <div class="text-xs text-slate-400">\u95DC\u61F7\u56DE\u8A2A + \u7279\u5225\u512A\u60E0</div>
                    </button>
                    <button (click)="aiPlannerGoal = '\u8B93\u793E\u7FA4\u66F4\u6D3B\u8E8D\uFF0C\u589E\u52A0\u7528\u6236\u4E92\u52D5\u548C\u7C98\u6027'"
                            class="p-3 bg-slate-800 rounded-xl text-left hover:bg-slate-700 transition-colors border border-slate-700">
                      <div class="text-lg mb-1">\u{1F389}</div>
                      <div class="text-sm text-white font-medium">\u63D0\u5347\u793E\u7FA4\u6D3B\u8E8D</div>
                      <div class="text-xs text-slate-400">\u8A71\u984C\u5F15\u5C0E + \u4E92\u52D5\u6FC0\u52F5</div>
                    </button>
                    <button (click)="aiPlannerGoal = '\u9AD8\u6548\u8655\u7406\u5BA2\u6236\u552E\u5F8C\u554F\u984C\uFF0C\u63D0\u5347\u6EFF\u610F\u5EA6'"
                            class="p-3 bg-slate-800 rounded-xl text-left hover:bg-slate-700 transition-colors border border-slate-700">
                      <div class="text-lg mb-1">\u{1F527}</div>
                      <div class="text-sm text-white font-medium">\u552E\u5F8C\u554F\u984C\u8655\u7406</div>
                      <div class="text-xs text-slate-400">\u5FEB\u901F\u97FF\u61C9 + \u6EFF\u610F\u5EA6\u8DDF\u9032</div>
                    </button>
                  </div>
                </div>
              }
              
              @if (aiPlannerStatus() === 'planning') {
                <!-- \u7B56\u5283\u4E2D\u52D5\u756B -->
                <div class="text-center py-8">
                  <div class="inline-block animate-spin text-4xl mb-4">\u{1F916}</div>
                  <p class="text-white font-medium">{{ aiPlanningProgress() }}</p>
                  <p class="text-slate-400 text-sm mt-2">\u5206\u6790\u76EE\u6A19 \u2192 \u9078\u64C7\u89D2\u8272 \u2192 \u8A2D\u8A08\u6D41\u7A0B</p>
                  <!-- \u{1F527} P0: \u986F\u793A\u9032\u5EA6\u6642\u9593 -->
                  @if (aiPlanningElapsed() > 0) {
                    <div class="mt-4 flex items-center justify-center gap-2">
                      <div class="w-32 h-2 bg-slate-700 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-purple-500 to-pink-500 animate-pulse" 
                             [style.width.%]="Math.min(aiPlanningElapsed() / 45 * 100, 95)"></div>
                      </div>
                      <span class="text-xs text-slate-500">{{ aiPlanningElapsed() }}\u79D2</span>
                    </div>
                  }
                  <p class="text-slate-500 text-xs mt-3">AI \u8ABF\u7528\u53EF\u80FD\u9700\u8981 30-45 \u79D2\uFF0C\u8ACB\u8010\u5FC3\u7B49\u5F85</p>
                </div>
              }
              
              @if (aiPlannerStatus() === 'ready' && aiPlanResult()) {
                <!-- \u7B56\u5283\u7D50\u679C -->
                <div class="space-y-4 max-h-[60vh] overflow-y-auto">
                  <!-- \u{1F527} P0: \u76EE\u6A19\u5206\u6790\u5340\u584A\uFF08\u65B0\u589E\uFF09 -->
                  @if (aiPlanResult()?.goalAnalysis) {
                    <div class="p-4 bg-indigo-500/10 border border-indigo-500/30 rounded-xl">
                      <h4 class="text-sm text-indigo-400 font-medium mb-3 flex items-center gap-2">
                        <span>\u{1F3AF}</span> \u76EE\u6A19\u5206\u6790
                      </h4>
                      <div class="grid grid-cols-2 gap-3 text-sm">
                        <div>
                          <div class="text-slate-500 text-xs mb-1">\u7522\u54C1\u985E\u578B</div>
                          <div class="text-white">{{ aiPlanResult()?.goalAnalysis?.productType }}</div>
                        </div>
                        <div>
                          <div class="text-slate-500 text-xs mb-1">\u76EE\u6A19\u5BA2\u6236</div>
                          <div class="text-white">{{ aiPlanResult()?.goalAnalysis?.targetAudience }}</div>
                        </div>
                      </div>
                      @if (aiPlanResult()?.goalAnalysis?.painPoints?.length) {
                        <div class="mt-3">
                          <div class="text-slate-500 text-xs mb-1">\u5BA2\u6236\u75DB\u9EDE</div>
                          <div class="flex flex-wrap gap-2">
                            @for (pain of aiPlanResult()!.goalAnalysis!.painPoints!; track pain) {
                              <span class="px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded">{{ pain }}</span>
                            }
                          </div>
                        </div>
                      }
                      @if (aiPlanResult()?.goalAnalysis?.keySellingPoints?.length) {
                        <div class="mt-3">
                          <div class="text-slate-500 text-xs mb-1">\u7522\u54C1\u512A\u52E2</div>
                          <div class="flex flex-wrap gap-2">
                            @for (point of aiPlanResult()!.goalAnalysis!.keySellingPoints!; track point) {
                              <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded">{{ point }}</span>
                            }
                          </div>
                        </div>
                      }
                    </div>
                  }
                  
                  <!-- \u7B56\u7565\u6982\u8FF0 -->
                  <div class="p-4 bg-green-500/10 border border-green-500/30 rounded-xl">
                    <div class="flex items-center justify-between mb-2">
                      <div class="flex items-center gap-2 text-green-400">
                        <span>\u2713</span>
                        <span class="font-medium">\u7B56\u5283\u5B8C\u6210\uFF01</span>
                      </div>
                      <!-- \u{1F195} \u986F\u793A AI \u8ABF\u7528\u72C0\u614B -->
                      @if (aiPlanningSource() === 'ai') {
                        <span class="px-2 py-1 bg-purple-500/20 text-purple-400 text-xs rounded-full flex items-center gap-1">
                          \u{1F916} AI \u751F\u6210
                        </span>
                      } @else if (aiPlanningSource() === 'template') {
                        <span class="px-2 py-1 bg-slate-600/50 text-slate-400 text-xs rounded-full flex items-center gap-1">
                          \u{1F4CB} \u6A21\u677F\u7B56\u7565
                        </span>
                      }
                    </div>
                    <p class="text-slate-300">{{ aiPlanResult()?.strategy }}</p>
                  </div>
                  
                  <!-- \u{1F527} \u7FA4\u804A\u5354\u4F5C\uFF1A\u5834\u666F\u9078\u64C7\uFF08\u7528\u6236\u4E3B\u52D5\u9078\u64C7\uFF09 -->
                  <div>
                    <h4 class="text-sm text-slate-400 mb-3">\u{1F3AF} \u9078\u64C7\u5354\u4F5C\u5834\u666F</h4>
                    <div class="grid grid-cols-2 gap-3">
                      <!-- \u79C1\u804A\u6A21\u5F0F -->
                      <button (click)="selectedChatScenario.set('private')"
                              class="p-4 rounded-xl border-2 transition-all text-left"
                              [class.border-blue-500]="selectedChatScenario() === 'private'"
                              [class.bg-blue-500/10]="selectedChatScenario() === 'private'"
                              [class.border-slate-700]="selectedChatScenario() !== 'private'"
                              [class.bg-slate-800]="selectedChatScenario() !== 'private'">
                        <div class="flex items-center gap-2 mb-2">
                          <span class="text-2xl">\u{1F4AC}</span>
                          <div>
                            <div class="text-white font-medium">\u79C1\u804A\u6A21\u5F0F</div>
                            <div class="text-xs text-slate-400">1v1 \u5C0D\u8A71</div>
                          </div>
                        </div>
                        <ul class="text-xs text-slate-400 space-y-1 mt-3">
                          <li>\u2022 \u55AE\u4E00\u89D2\u8272\u8207\u5BA2\u6236\u5C0D\u8A71</li>
                          <li>\u2022 \u9069\u5408\u9996\u6B21\u63A5\u89F8\u3001\u5FEB\u901F\u7BE9\u9078</li>
                          <li>\u2022 \u4F4E\u6210\u672C\u6279\u91CF\u89F8\u9054</li>
                        </ul>
                        <div class="mt-3 text-xs text-blue-400">
                          \u9700\u8981\u5E33\u865F\uFF1A1 \u500B
                        </div>
                      </button>
                      
                      <!-- \u7FA4\u804A\u5354\u4F5C\u6A21\u5F0F -->
                      <button (click)="selectedChatScenario.set('group')"
                              class="p-4 rounded-xl border-2 transition-all text-left"
                              [class.border-green-500]="selectedChatScenario() === 'group'"
                              [class.bg-green-500/10]="selectedChatScenario() === 'group'"
                              [class.border-slate-700]="selectedChatScenario() !== 'group'"
                              [class.bg-slate-800]="selectedChatScenario() !== 'group'">
                        <div class="flex items-center gap-2 mb-2">
                          <span class="text-2xl">\u{1F465}</span>
                          <div>
                            <div class="text-white font-medium">\u7FA4\u804A\u5354\u4F5C</div>
                            <div class="text-xs text-green-400">\u591A\u89D2\u8272\u5354\u540C</div>
                          </div>
                        </div>
                        <ul class="text-xs text-slate-400 space-y-1 mt-3">
                          <li>\u2022 \u5EFA\u7FA4\u9080\u8ACB\u5BA2\u6236 + \u591A\u89D2\u8272</li>
                          <li>\u2022 \u89D2\u8272\u5206\u5DE5\u5354\u4F5C\u670D\u52D9</li>
                          <li>\u2022 \u9AD8\u8F49\u5316\u6DF1\u5EA6\u71DF\u92B7</li>
                        </ul>
                        <div class="mt-3 text-xs" 
                             [class.text-green-400]="hasEnoughAccounts()"
                             [class.text-amber-400]="!hasEnoughAccounts()">
                          \u9700\u8981\u5E33\u865F\uFF1A{{ requiredAccountsForGroup() }} \u500B
                          @if (!hasEnoughAccounts() && selectedChatScenario() === 'group') {
                            <span class="text-red-400">\uFF08\u4E0D\u8DB3\uFF01\uFF09</span>
                          }
                        </div>
                      </button>
                    </div>
                    
                    <!-- \u7FA4\u804A\u6A21\u5F0F\u4E0B\u7684\u5E33\u865F\u4E0D\u8DB3\u63D0\u793A -->
                    @if (isGroupChatMode() && !hasEnoughAccounts()) {
                      <div class="mt-3 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg">
                        <div class="flex items-center gap-2 text-amber-400 text-sm">
                          <span>\u26A0\uFE0F</span>
                          <span>\u5E33\u865F\u4E0D\u8DB3\uFF01\u9700\u8981 {{ requiredAccountsForGroup() }} \u500B\u5E33\u865F\uFF0C\u7576\u524D\u53EA\u6709 {{ availableAccountCount() }} \u500B\u5728\u7DDA\u3002</span>
                        </div>
                        <button (click)="goToAccountManagement()" 
                                class="mt-2 px-4 py-2 bg-amber-500/20 text-amber-400 rounded-lg hover:bg-amber-500/30 text-sm">
                          \u2795 \u6DFB\u52A0\u66F4\u591A\u5E33\u865F
                        </button>
                      </div>
                    }
                    
                    <!-- \u7FA4\u804A\u6A21\u5F0F\u6D41\u7A0B\u8AAA\u660E -->
                    @if (isGroupChatMode() && hasEnoughAccounts()) {
                      <div class="mt-3 p-3 bg-green-500/10 border border-green-500/30 rounded-lg">
                        <div class="text-xs text-green-400 font-medium mb-2">\u{1F3AC} \u7FA4\u804A\u5354\u4F5C\u6D41\u7A0B</div>
                        <div class="flex items-center gap-2 text-xs text-slate-400">
                          <span class="px-2 py-1 bg-slate-700 rounded">\u2460 \u5EFA\u7FA4</span>
                          <span>\u2192</span>
                          <span class="px-2 py-1 bg-slate-700 rounded">\u2461 \u9080\u8ACB\u5BA2\u6236</span>
                          <span>\u2192</span>
                          <span class="px-2 py-1 bg-slate-700 rounded">\u2462 \u9080\u8ACB\u89D2\u8272</span>
                          <span>\u2192</span>
                          <span class="px-2 py-1 bg-slate-700 rounded">\u2463 \u5354\u4F5C\u670D\u52D9</span>
                        </div>
                      </div>
                    }
                  </div>
                  
                  <!-- \u{1F527} \u7FA4\u804A\u5354\u4F5C\uFF1A\u57F7\u884C\u6A21\u5F0F\u9078\u64C7 -->
                  <div>
                    <h4 class="text-sm text-slate-400 mb-3">\u2699\uFE0F AI \u5C0D\u8A71\u6A21\u5F0F</h4>
                    <div class="grid grid-cols-2 gap-3">
                      <button (click)="selectedExecutionMode.set('hybrid')"
                              class="p-3 rounded-lg border transition-all text-left"
                              [class.border-cyan-500]="selectedExecutionMode() === 'hybrid'"
                              [class.bg-cyan-500/10]="selectedExecutionMode() === 'hybrid'"
                              [class.border-slate-700]="selectedExecutionMode() !== 'hybrid'"
                              [class.bg-slate-800]="selectedExecutionMode() !== 'hybrid'">
                        <div class="flex items-center gap-2 mb-1">
                          <span>\u{1F4CB}</span>
                          <span class="text-sm text-white font-medium">\u5F15\u5C0E\u5F0F</span>
                          <span class="px-1.5 py-0.5 bg-cyan-500 text-white text-xs rounded">\u63A8\u85A6</span>
                        </div>
                        <p class="text-xs text-slate-400">\u9810\u8A2D\u8A71\u8853 + AI \u9748\u6D3B\u88DC\u5145</p>
                      </button>
                      <button (click)="selectedExecutionMode.set('scriptless')"
                              class="p-3 rounded-lg border transition-all text-left"
                              [class.border-pink-500]="selectedExecutionMode() === 'scriptless'"
                              [class.bg-pink-500/10]="selectedExecutionMode() === 'scriptless'"
                              [class.border-slate-700]="selectedExecutionMode() !== 'scriptless'"
                              [class.bg-slate-800]="selectedExecutionMode() !== 'scriptless'">
                        <div class="flex items-center gap-2 mb-1">
                          <span>\u{1F916}</span>
                          <span class="text-sm text-white font-medium">\u7D14 AI</span>
                        </div>
                        <p class="text-xs text-slate-400">\u6BCF\u689D\u6D88\u606F\u5373\u6642\u751F\u6210</p>
                      </button>
                    </div>
                  </div>
                  
                  <!-- \u{1F195} \u76EE\u6A19\u7528\u6236\u9078\u64C7 -->
                  <div>
                    <h4 class="text-sm text-slate-400 mb-3">\u{1F464} \u9078\u64C7\u71DF\u92B7\u76EE\u6A19</h4>
                    <div class="p-3 bg-slate-800 rounded-lg">
                      @if (selectedTargetUsers().length === 0) {
                        <div class="text-center py-4">
                          <div class="text-slate-500 mb-3">\u8ACB\u9078\u64C7\u8981\u9032\u884C\u71DF\u92B7\u7684\u76EE\u6A19\u7528\u6236</div>
                          <div class="flex gap-2 justify-center flex-wrap">
                            <button (click)="openTargetUserSelector()"
                                    class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 text-sm">
                              \u{1F4D2} \u5F9E\u901A\u8A0A\u9304\u9078\u64C7
                            </button>
                            <button (click)="selectHighIntentUsers()"
                                    class="px-4 py-2 bg-amber-500/20 text-amber-400 rounded-lg hover:bg-amber-500/30 text-sm">
                              \u2B50 \u81EA\u52D5\u9078\u9AD8\u610F\u5411
                            </button>
                            <button (click)="triggerImportFile()"
                                    class="px-4 py-2 bg-cyan-500/20 text-cyan-400 rounded-lg hover:bg-cyan-500/30 text-sm">
                              \u{1F4E5} \u6279\u91CF\u5C0E\u5165
                            </button>
                          </div>
                          <input #importFileInput type="file" accept=".csv,.txt" (change)="handleImportFile($event)" class="hidden">
                        </div>
                      } @else {
                        <div class="flex items-center justify-between mb-2">
                          <span class="text-emerald-400 text-sm">
                            \u2713 \u5DF2\u9078\u64C7 {{ selectedTargetUsers().length }} \u500B\u76EE\u6A19
                          </span>
                          <div class="flex gap-2">
                            <button (click)="openTargetUserSelector()"
                                    class="text-xs text-slate-400 hover:text-white">
                              \u4FEE\u6539
                            </button>
                            <button (click)="clearSelectedUsers()"
                                    class="text-xs text-red-400 hover:text-red-300">
                              \u6E05\u7A7A
                            </button>
                          </div>
                        </div>
                        <div class="flex flex-wrap gap-2">
                          @for (user of selectedTargetUsers().slice(0, 5); track user.telegramId) {
                            <span class="px-2 py-1 bg-slate-700 rounded text-xs text-slate-300">
                              {{ user.firstName || user.username || user.telegramId }}
                              <span class="text-amber-400 ml-1">{{ user.intentScore }}\u5206</span>
                            </span>
                          }
                          @if (selectedTargetUsers().length > 5) {
                            <span class="px-2 py-1 bg-slate-600 rounded text-xs text-slate-400">
                              +{{ selectedTargetUsers().length - 5 }} \u66F4\u591A
                            </span>
                          }
                        </div>
                      }
                    </div>
                  </div>
                  
                  <!-- \u{1F195} P0: \u5E33\u865F\u77E9\u9663\u914D\u7F6E -->
                  <div class="border border-slate-700/50 rounded-xl overflow-hidden">
                    <button (click)="showAdvancedAccountSettings.set(!showAdvancedAccountSettings())"
                            class="w-full p-3 bg-slate-800/50 flex items-center justify-between hover:bg-slate-800 transition-colors">
                      <div class="flex items-center gap-2">
                        <span>\u{1F465}</span>
                        <span class="text-sm text-white font-medium">\u5E33\u865F\u914D\u7F6E</span>
                        @if (plannerAutoAssign()) {
                          <span class="px-2 py-0.5 bg-purple-500/20 text-purple-400 text-xs rounded">AI \u81EA\u52D5\u5206\u914D</span>
                        } @else {
                          <span class="px-2 py-0.5 bg-cyan-500/20 text-cyan-400 text-xs rounded">
                            \u5DF2\u9078 {{ plannerSelectedAccounts().length }} \u500B\u5E33\u865F
                          </span>
                        }
                      </div>
                      <span class="text-slate-400 text-sm">{{ showAdvancedAccountSettings() ? '\u25B2' : '\u25BC' }}</span>
                    </button>
                    
                    @if (showAdvancedAccountSettings()) {
                      <div class="p-4 space-y-4 bg-slate-800/30">
                        <!-- \u5E33\u865F\u6578\u91CF\u9078\u64C7 -->
                        <div>
                          <div class="flex items-center justify-between mb-2">
                            <label class="text-sm text-slate-400">\u53C3\u8207\u5E33\u865F\u6578\u91CF</label>
                            <div class="flex items-center gap-2">
                              <span class="text-white font-medium">{{ plannerAccountCount() }}</span>
                              <span class="text-xs text-slate-500">/ {{ availableAccountCount() }} \u53EF\u7528</span>
                            </div>
                          </div>
                          <div class="flex items-center gap-3">
                            <input type="range" 
                                   [min]="1" 
                                   [max]="Math.min(5, availableAccountCount())"
                                   [value]="plannerAccountCount()"
                                   (input)="onAccountCountChange($event)"
                                   class="flex-1 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-purple-500">
                            <div class="flex gap-1">
                              @for (n of [1,2,3,4,5]; track n) {
                                <button (click)="plannerAccountCount.set(Math.min(n, availableAccountCount()))"
                                        [class.bg-purple-500]="plannerAccountCount() === n"
                                        [class.text-white]="plannerAccountCount() === n"
                                        [class.bg-slate-700]="plannerAccountCount() !== n"
                                        [class.text-slate-400]="plannerAccountCount() !== n"
                                        [disabled]="n > availableAccountCount()"
                                        class="w-8 h-8 rounded-lg text-sm font-medium disabled:opacity-30 disabled:cursor-not-allowed">
                                  {{ n }}
                                </button>
                              }
                            </div>
                          </div>
                          <div class="mt-2 text-xs text-slate-500">
                            \u{1F916} AI \u63A8\u85A6\uFF1A{{ getRecommendedAccountCount() }} \u500B\u5E33\u865F\uFF08\u57FA\u65BC\u76EE\u6A19\u5206\u6790\uFF09
                          </div>
                        </div>
                        
                        <!-- \u81EA\u52D5/\u624B\u52D5\u5207\u63DB -->
                        <div class="flex items-center justify-between p-3 bg-slate-900/50 rounded-lg">
                          <div>
                            <div class="text-sm text-white">AI \u81EA\u52D5\u5206\u914D\u5E33\u865F\u548C\u89D2\u8272</div>
                            <div class="text-xs text-slate-500">\u95DC\u9589\u5F8C\u53EF\u624B\u52D5\u9078\u64C7\u5E33\u865F\u4E26\u6307\u5B9A\u89D2\u8272</div>
                          </div>
                          <button (click)="plannerAutoAssign.set(!plannerAutoAssign())"
                                  class="w-12 h-6 rounded-full transition-colors relative"
                                  [class.bg-purple-500]="plannerAutoAssign()"
                                  [class.bg-slate-600]="!plannerAutoAssign()">
                            <span class="absolute top-1 w-4 h-4 bg-white rounded-full transition-all"
                                  [class.left-1]="!plannerAutoAssign()"
                                  [class.left-7]="plannerAutoAssign()"></span>
                          </button>
                        </div>
                        
                        <!-- \u624B\u52D5\u9078\u64C7\u5E33\u865F -->
                        @if (!plannerAutoAssign()) {
                          <div>
                            <div class="flex items-center justify-between mb-2">
                              <label class="text-sm text-slate-400">\u9078\u64C7\u5E33\u865F\uFF08\u9EDE\u64CA\u9078\u64C7/\u53D6\u6D88\uFF09</label>
                              <div class="flex gap-2">
                                <button (click)="selectAllOnlineAccounts()" 
                                        class="text-xs text-purple-400 hover:text-purple-300">\u5168\u9078\u5728\u7DDA</button>
                                <button (click)="plannerSelectedAccounts.set([])" 
                                        class="text-xs text-slate-400 hover:text-slate-300">\u6E05\u7A7A</button>
                              </div>
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                              @for (account of accountService.accounts(); track account.id) {
                                @if (account.status === 'Online') {
                                  <button (click)="toggleAccountSelection(account.id)"
                                          class="p-3 rounded-lg border-2 transition-all text-left"
                                          [class.border-purple-500]="plannerSelectedAccounts().includes(account.id)"
                                          [class.bg-purple-500/10]="plannerSelectedAccounts().includes(account.id)"
                                          [class.border-slate-700]="!plannerSelectedAccounts().includes(account.id)"
                                          [class.bg-slate-800]="!plannerSelectedAccounts().includes(account.id)">
                                    <div class="flex items-center gap-2">
                                      <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                      <span class="text-sm text-white truncate">{{ account.phone }}</span>
                                    </div>
                                    @if (plannerSelectedAccounts().includes(account.id)) {
                                      <!-- \u89D2\u8272\u9078\u64C7\u4E0B\u62C9\u6846 -->
                                      <div class="mt-2">
                                        <select (click)="$event.stopPropagation()"
                                                (change)="onAccountRoleChange(account.id, $event)"
                                                [value]="plannerAccountRoles().get(account.id) || ''"
                                                class="w-full px-2 py-1 bg-slate-900 border border-slate-600 rounded text-xs text-white">
                                          <option value="">\u{1F916} AI \u5206\u914D\u89D2\u8272</option>
                                          @for (role of availableRoleTypes; track role.id) {
                                            <option [value]="role.id">{{ role.icon }} {{ role.name }}</option>
                                          }
                                        </select>
                                      </div>
                                    }
                                  </button>
                                }
                              }
                            </div>
                            @if (plannerSelectedAccounts().length > 0) {
                              <div class="mt-3 p-2 bg-slate-900/50 rounded-lg">
                                <div class="text-xs text-slate-400 mb-1">\u5DF2\u9078\u5E33\u865F\u89D2\u8272\u9810\u89BD\uFF1A</div>
                                <div class="flex flex-wrap gap-2">
                                  @for (accId of plannerSelectedAccounts(); track accId) {
                                    <span class="px-2 py-1 bg-slate-700 rounded text-xs text-white flex items-center gap-1">
                                      {{ getAccountPhone(accId) }}
                                      <span class="text-purple-400">\u2192</span>
                                      {{ getAssignedRoleName(accId) }}
                                    </span>
                                  }
                                </div>
                              </div>
                            }
                          </div>
                        }
                      </div>
                    }
                  </div>
                  
                  <!-- \u{1F527} P1 \u512A\u5316\uFF1A\u89D2\u8272\u5206\u914D\u8868\u683C -->
                  <div>
                    <div class="flex items-center justify-between mb-3">
                      <h4 class="text-sm text-slate-400">\u{1F465} \u89D2\u8272\u5206\u914D\u9810\u89BD ({{ getDisplayedRolesCount() }}/{{ plannerAccountCount() }} \u5E33\u865F)</h4>
                      <!-- \u{1F195} P2: \u8AAA\u660E\u70BA\u4F55\u63A8\u85A6\u6B64\u6578\u91CF -->
                      @if (aiPlanResult()?.recommendedRoles?.length !== plannerAccountCount()) {
                        <button (click)="toggleAccountExplanation()"
                                class="text-xs text-purple-400 hover:text-purple-300 flex items-center gap-1">
                          \u{1F4A1} \u70BA\u4EC0\u9EBC\uFF1F
                        </button>
                      }
                    </div>
                    
                    <!-- \u{1F195} P2: \u5E33\u865F\u6578\u91CF\u8AAA\u660E\uFF08\u53EF\u6298\u758A\uFF09 -->
                    @if (showAccountExplanation()) {
                      <div class="mb-3 p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg text-sm">
                        <div class="flex items-start gap-2">
                          <span class="text-purple-400">\u{1F4A1}</span>
                          <div class="text-slate-300">
                            <p class="mb-1">AI \u63A8\u85A6 <strong class="text-purple-400">{{ aiPlanResult()?.recommendedRoles?.length || 0 }}</strong> \u500B\u89D2\u8272\uFF1A</p>
                            <ul class="text-xs text-slate-400 space-y-1 ml-4 list-disc">
                              <li>\u904E\u591A\u5E33\u865F\u53EF\u80FD\u5C0E\u81F4\u904E\u5EA6\u66DD\u5149\uFF0C\u5F15\u8D77\u7528\u6236\u8B66\u89BA</li>
                              <li>\u89D2\u8272\u5206\u5DE5\u660E\u78BA\uFF0C\u6BCF\u500B\u89D2\u8272\u6709\u7368\u7279\u4F5C\u7528</li>
                              <li>\u5269\u9918\u5E33\u865F\u53EF\u4F5C\u70BA\u5099\u7528\uFF0C\u96A8\u6642\u66FF\u88DC</li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    }
                    
                    <!-- \u{1F527} P1: \u89D2\u8272\u5206\u914D\u8868\u683C -->
                    <div class="bg-slate-800 rounded-lg border border-slate-700 overflow-hidden">
                      <table class="w-full text-sm">
                        <thead class="bg-slate-900/50">
                          <tr class="text-slate-400 text-xs">
                            <th class="px-3 py-2 text-left">\u5E33\u865F</th>
                            <th class="px-3 py-2 text-left">\u89D2\u8272</th>
                            <th class="px-3 py-2 text-center">\u72C0\u614B</th>
                            <th class="px-3 py-2 text-right">\u64CD\u4F5C</th>
                          </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-700/50">
                          <!-- \u5DF2\u5206\u914D\u7684\u89D2\u8272 -->
                          @for (role of aiPlanResult()?.recommendedRoles; track $index; let i = $index) {
                            <tr class="hover:bg-slate-700/30">
                              <td class="px-3 py-2">
                                @if (accountMatchResults().length > i) {
                                  <div class="flex items-center gap-2">
                                    <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
                                    <span class="text-white">{{ accountMatchResults()[i].accountPhone }}</span>
                                  </div>
                                } @else {
                                  <span class="text-slate-500 italic">\u5F85\u5206\u914D...</span>
                                }
                              </td>
                              <td class="px-3 py-2">
                                <div class="flex items-center gap-2">
                                  <span class="text-lg">{{ role.icon }}</span>
                                  <div>
                                    <div class="text-white">{{ role.name }}</div>
                                    <div class="text-xs text-slate-500">{{ role.purpose }}</div>
                                  </div>
                                </div>
                              </td>
                              <td class="px-3 py-2 text-center">
                                @if (i === 0) {
                                  <span class="px-2 py-0.5 bg-emerald-500/20 text-emerald-400 text-xs rounded">\u4E3B\u5C0E</span>
                                } @else if (accountMatchResults().length > i) {
                                  <span class="px-2 py-0.5 bg-cyan-500/20 text-cyan-400 text-xs rounded">\u5F85\u547D</span>
                                } @else {
                                  <span class="px-2 py-0.5 bg-amber-500/20 text-amber-400 text-xs rounded">\u5339\u914D\u4E2D</span>
                                }
                              </td>
                              <td class="px-3 py-2 text-right relative">
                                <!-- \u{1F195} P0: \u66F4\u63DB\u89D2\u8272\u4E0B\u62C9\u9078\u55AE -->
                                <div class="relative inline-block">
                                  <button (click)="toggleRoleDropdown(i, $event)"
                                          class="text-xs text-purple-400 hover:text-purple-300 px-2 py-1 hover:bg-purple-500/10 rounded flex items-center gap-1">
                                    \u66F4\u63DB 
                                    <span [class.rotate-180]="roleChangeModalIndex() === i">\u25BC</span>
                                  </button>
                                  
                                  <!-- \u4E0B\u62C9\u9078\u55AE -->
                                  @if (roleChangeModalIndex() === i) {
                                    <div class="absolute right-0 top-full mt-1 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-xl z-50 overflow-hidden"
                                         (click)="$event.stopPropagation()">
                                      <div class="px-3 py-2 bg-slate-900/50 border-b border-slate-700">
                                        <span class="text-xs text-slate-400">\u{1F504} \u9078\u64C7\u65B0\u89D2\u8272</span>
                                      </div>
                                      <div class="max-h-48 overflow-y-auto">
                                        @for (roleType of availableRoleTypes; track roleType.id) {
                                          <button (click)="changeRoleForIndex(i, roleType)"
                                                  [class.bg-purple-500/20]="role.name === roleType.name"
                                                  class="w-full px-3 py-2 text-left hover:bg-slate-700/50 flex items-center gap-2 text-sm">
                                            <span class="text-lg">{{ roleType.icon }}</span>
                                            <div class="flex-1">
                                              <div class="text-white">{{ roleType.name }}</div>
                                              <div class="text-xs text-slate-500">{{ roleType.desc }}</div>
                                            </div>
                                            @if (role.name === roleType.name) {
                                              <span class="text-xs text-purple-400">\u7576\u524D</span>
                                            }
                                          </button>
                                        }
                                      </div>
                                      <div class="border-t border-slate-700">
                                        <button (click)="removeRoleAssignment(i)"
                                                class="w-full px-3 py-2 text-left hover:bg-red-500/10 text-red-400 text-sm flex items-center gap-2">
                                          <span>\u{1F5D1}\uFE0F</span>
                                          <span>\u79FB\u70BA\u5099\u7528</span>
                                        </button>
                                      </div>
                                    </div>
                                  }
                                </div>
                              </td>
                            </tr>
                          }
                          
                          <!-- \u{1F195} P4: \u5099\u7528\u5E33\u865F\uFF08\u672A\u5206\u914D\u89D2\u8272\u7684\u5E33\u865F\uFF09 -->
                          @for (acc of getBackupAccounts(); track acc.id) {
                            <tr class="hover:bg-slate-700/30 opacity-60">
                              <td class="px-3 py-2">
                                <div class="flex items-center gap-2">
                                  <span class="w-2 h-2 rounded-full bg-slate-500"></span>
                                  <span class="text-slate-400">{{ acc.phone }}</span>
                                </div>
                              </td>
                              <td class="px-3 py-2">
                                <span class="text-slate-500 italic">\u26AA \u5099\u7528\u5E33\u865F</span>
                              </td>
                              <td class="px-3 py-2 text-center">
                                <span class="px-2 py-0.5 bg-slate-500/20 text-slate-400 text-xs rounded">\u9592\u7F6E</span>
                              </td>
                              <td class="px-3 py-2 text-right relative">
                                <!-- \u{1F195} P1: \u5206\u914D\u5099\u7528\u5E33\u865F\u4E0B\u62C9\u9078\u55AE -->
                                <div class="relative inline-block">
                                  <button (click)="toggleBackupDropdown(acc.id, $event)"
                                          class="text-xs text-slate-400 hover:text-white px-2 py-1 hover:bg-slate-500/10 rounded flex items-center gap-1">
                                    \u5206\u914D 
                                    <span [class.rotate-180]="backupDropdownId() === acc.id">\u25BC</span>
                                  </button>
                                  
                                  <!-- \u4E0B\u62C9\u9078\u55AE -->
                                  @if (backupDropdownId() === acc.id) {
                                    <div class="absolute right-0 top-full mt-1 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-xl z-50 overflow-hidden"
                                         (click)="$event.stopPropagation()">
                                      <div class="px-3 py-2 bg-slate-900/50 border-b border-slate-700">
                                        <span class="text-xs text-slate-400">\u{1F4CB} \u5206\u914D\u89D2\u8272</span>
                                      </div>
                                      <div class="max-h-48 overflow-y-auto">
                                        @for (roleType of availableRoleTypes; track roleType.id) {
                                          <button (click)="assignBackupToRole(acc.id, roleType)"
                                                  class="w-full px-3 py-2 text-left hover:bg-slate-700/50 flex items-center gap-2 text-sm">
                                            <span class="text-lg">{{ roleType.icon }}</span>
                                            <div class="flex-1">
                                              <div class="text-white">{{ roleType.name }}</div>
                                              <div class="text-xs text-slate-500">{{ roleType.desc }}</div>
                                            </div>
                                          </button>
                                        }
                                      </div>
                                      <div class="border-t border-slate-700">
                                        <button (click)="closeBackupDropdown()"
                                                class="w-full px-3 py-2 text-left hover:bg-slate-700/50 text-slate-400 text-sm flex items-center gap-2">
                                          <span>\u26AA</span>
                                          <span>\u4FDD\u6301\u5099\u7528</span>
                                        </button>
                                      </div>
                                    </div>
                                  }
                                </div>
                              </td>
                            </tr>
                          }
                        </tbody>
                      </table>
                    </div>
                    
                    <!-- \u8A71\u8853\u9810\u89BD\uFF08\u53EA\u986F\u793A\u7B2C\u4E00\u500B\u89D2\u8272\u7684\u958B\u5834\u767D\uFF09 -->
                    @if (aiPlanResult()?.recommendedRoles?.[0]?.openingLine) {
                      <div class="mt-3 p-3 bg-slate-800 rounded-lg border border-slate-700">
                        <div class="text-xs text-slate-500 mb-2">\u{1F4AC} \u958B\u5834\u767D\u9810\u89BD</div>
                        <div class="text-sm text-slate-300 italic">"{{ aiPlanResult()?.recommendedRoles?.[0]?.openingLine }}"</div>
                      </div>
                    }
                    <!-- \u{1F195} \u5339\u914D\u72C0\u614B\u986F\u793A -->
                    @if (accountMatchResults().length === 0 && !matchFailureReason()) {
                      <div class="mt-3 text-center py-2 text-slate-400 text-sm">
                        <span class="animate-pulse">\u{1F504} \u6B63\u5728\u667A\u80FD\u5339\u914D\u5E33\u865F...</span>
                      </div>
                    }
                    
                    <!-- \u{1F195} \u5339\u914D\u5931\u6557\u5F15\u5C0E -->
                    @if (matchFailureReason()) {
                      <div class="mt-3 p-4 bg-amber-500/10 border border-amber-500/30 rounded-lg">
                        @if (matchFailureReason() === 'no_accounts') {
                          <div class="flex items-start gap-3">
                            <span class="text-2xl">\u26A0\uFE0F</span>
                            <div>
                              <div class="text-amber-400 font-medium mb-1">\u7121\u53EF\u7528\u5E33\u865F</div>
                              <div class="text-sm text-slate-300 mb-3">
                                \u8ACB\u5148\u6DFB\u52A0 Telegram \u5E33\u865F\u4E26\u8A2D\u7F6E\u70BA AI \u89D2\u8272\uFF0C\u624D\u80FD\u57F7\u884C\u591A\u89D2\u8272\u5354\u4F5C\u3002
                              </div>
                              <div class="flex gap-2">
                                <button (click)="goToAccountManagement()"
                                        class="px-4 py-2 bg-purple-500 text-white rounded-lg text-sm hover:bg-purple-600">
                                  \u2795 \u6DFB\u52A0\u5E33\u865F
                                </button>
                                <button (click)="performAccountMatching()"
                                        class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg text-sm hover:bg-slate-600">
                                  \u{1F504} \u91CD\u65B0\u5339\u914D
                                </button>
                              </div>
                            </div>
                          </div>
                        } @else {
                          <div class="text-amber-400 text-sm">
                            \u5339\u914D\u904E\u7A0B\u51FA\u932F\uFF0C\u8ACB\u91CD\u8A66
                            <button (click)="performAccountMatching()" class="ml-2 text-purple-400 hover:text-purple-300">
                              \u{1F504} \u91CD\u65B0\u5339\u914D
                            </button>
                          </div>
                        }
                      </div>
                    }
                    
                    <!-- \u{1F195} \u4E00\u865F\u591A\u89D2\u6A21\u5F0F\u63D0\u793A -->
                    @if (matchMode() === 'multi-role' && accountMatchResults().length > 0) {
                      <div class="mt-3 p-3 bg-cyan-500/10 border border-cyan-500/30 rounded-lg text-sm">
                        <div class="flex items-center gap-2 text-cyan-400">
                          <span>\u{1F504}</span>
                          <span>\u4E00\u865F\u591A\u89D2\u6A21\u5F0F\u5DF2\u555F\u7528</span>
                        </div>
                        <div class="text-slate-400 mt-1 text-xs">
                          \u5E33\u865F\u6578\u91CF\u4E0D\u8DB3\uFF0C\u540C\u4E00\u5E33\u865F\u5C07\u8F2A\u63DB\u626E\u6F14\u591A\u500B\u89D2\u8272
                        </div>
                      </div>
                    }
                  </div>
                  
                  <!-- \u{1F527} P1: \u5EFA\u8B70\u6D41\u7A0B + \u8A71\u8853\u9810\u89BD\uFF08\u50C5\u5287\u672C/\u6DF7\u5408\u6A21\u5F0F\u986F\u793A\uFF09 -->
                  @if (selectedExecutionMode() !== 'scriptless') {
                    <div>
                      <h4 class="text-sm text-slate-400 mb-3">\u{1F3AC} \u57F7\u884C\u6D41\u7A0B</h4>
                      <div class="space-y-3">
                        @for (step of aiPlanResult()?.suggestedFlow; track step.step) {
                          <div class="p-3 bg-slate-800 rounded-lg border border-slate-700">
                            <div class="flex items-center gap-3">
                              <div class="w-7 h-7 rounded-full bg-purple-500/30 text-purple-400 text-sm flex items-center justify-center font-medium">
                                {{ step.step }}
                              </div>
                              <div class="flex-1">
                                <div class="text-sm text-white">{{ step.action }}</div>
                                <div class="text-xs text-slate-500 mt-0.5">\u57F7\u884C\u8005: {{ step.role }}</div>
                              </div>
                            </div>
                            <!-- \u{1F527} P1: \u8A71\u8853\u9810\u89BD\uFF08\u65B0\u589E\uFF09 -->
                            @if (step.scriptPreview) {
                              <div class="mt-2 p-2 bg-slate-900/50 rounded border-l-2 border-cyan-500 ml-10">
                                <div class="text-xs text-slate-500 mb-1">\u{1F4AC} \u8A71\u8853\u9810\u89BD</div>
                                <div class="text-sm text-slate-300 italic">"{{ step.scriptPreview }}"</div>
                              </div>
                            }
                          </div>
                        }
                      </div>
                    </div>
                  }
                  
                  <!-- \u7121\u5287\u672C\u6A21\u5F0F\u8AAA\u660E -->
                  @if (selectedExecutionMode() === 'scriptless') {
                    <div class="p-4 bg-pink-500/10 border border-pink-500/30 rounded-xl">
                      <h4 class="text-sm text-pink-400 font-medium mb-2">\u{1F916} \u7121\u5287\u672C\u6A21\u5F0F\u7279\u6027</h4>
                      <ul class="text-xs text-slate-300 space-y-1">
                        <li>\u2022 AI \u6839\u64DA\u5C0D\u8A71\u4E0A\u4E0B\u6587\u5373\u6642\u751F\u6210\u56DE\u8986</li>
                        <li>\u2022 \u6BCF 10 \u689D\u6D88\u606F\u81EA\u52D5\u5206\u6790\u5BA2\u6236\u8208\u8DA3\u548C\u60C5\u7DD2</li>
                        <li>\u2022 \u667A\u80FD\u5207\u63DB\u89D2\u8272\u548C\u8ABF\u6574\u7B56\u7565</li>
                        <li>\u2022 \u6AA2\u6E2C\u5230\u8F49\u5316\u4FE1\u865F\u81EA\u52D5\u5207\u63DB\u92B7\u552E\u6A21\u5F0F</li>
                      </ul>
                    </div>
                  }
                  
                  <!-- \u{1F527} P1: \u9810\u4F30\u6210\u529F\u7387 + \u4F9D\u64DA\u8AAA\u660E -->
                  <div class="p-3 bg-slate-800 rounded-lg">
                    <div class="flex items-center justify-between">
                      <span class="text-slate-400">\u9810\u4F30\u6210\u529F\u7387</span>
                      <span class="text-lg font-bold" 
                            [class.text-green-400]="(aiPlanResult()?.estimatedSuccessRate || 0) >= 70"
                            [class.text-amber-400]="(aiPlanResult()?.estimatedSuccessRate || 0) >= 40 && (aiPlanResult()?.estimatedSuccessRate || 0) < 70"
                            [class.text-red-400]="(aiPlanResult()?.estimatedSuccessRate || 0) < 40">
                        {{ aiPlanResult()?.estimatedSuccessRate }}%
                      </span>
                    </div>
                    @if (aiPlanResult()?.successRateReason) {
                      <div class="mt-2 text-xs text-slate-500 border-t border-slate-700 pt-2">
                        \u{1F4CA} {{ aiPlanResult()?.successRateReason }}
                      </div>
                    }
                  </div>
                </div>
              }
            </div>
            
            <!-- \u5E95\u90E8\u6309\u9215 -->
            <div class="p-6 border-t border-slate-700/50 flex gap-3">
              @if (aiPlannerStatus() === 'idle') {
                <button (click)="closeAIPlanner()"
                        class="flex-1 py-3 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors">
                  \u53D6\u6D88
                </button>
                <button (click)="startAIPlanning()"
                        [disabled]="!aiPlannerGoal.trim()"
                        class="flex-1 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed">
                  \u{1F916} \u958B\u59CB\u7B56\u5283
                </button>
              }
              @if (aiPlannerStatus() === 'ready') {
                <button (click)="resetAIPlanner()"
                        class="flex-1 py-3 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors">
                  \u91CD\u65B0\u7B56\u5283
                </button>
                <!-- \u{1F527} \u7FA4\u804A\u5354\u4F5C\uFF1A\u6839\u64DA\u5834\u666F\u986F\u793A\u4E0D\u540C\u6309\u9215 -->
                @if (isPrivateChatMode()) {
                  <button (click)="applyAIPlan()"
                          class="flex-1 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white font-medium rounded-xl hover:opacity-90 transition-opacity">
                    \u{1F4AC} \u958B\u59CB\u79C1\u804A
                  </button>
                } @else {
                  <button (click)="startGroupCollaboration()"
                          [disabled]="!hasEnoughAccounts() || selectedTargetUsers().length === 0"
                          class="flex-1 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-medium rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed">
                    @if (groupCreationStatus() === 'creating') {
                      <span class="inline-block animate-spin mr-2">\u23F3</span> \u5275\u5EFA\u7FA4\u7D44\u4E2D...
                    } @else if (groupCreationStatus() === 'inviting_target') {
                      <span class="inline-block animate-pulse mr-2">\u{1F4E8}</span> \u9080\u8ACB\u5BA2\u6236\u4E2D...
                    } @else if (groupCreationStatus() === 'inviting_roles') {
                      <span class="inline-block animate-pulse mr-2">\u{1F465}</span> \u9080\u8ACB\u89D2\u8272\u4E2D...
                    } @else {
                      \u{1F465} \u958B\u59CB\u7FA4\u804A\u5354\u4F5C
                    }
                  </button>
                }
              }
            </div>
          </div>
        </div>
      }
      
      <!-- \u{1F195} \u76EE\u6A19\u7528\u6236\u9078\u64C7\u5668\u5C0D\u8A71\u6846 -->
      @if (showTargetUserSelector()) {
        <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
          <div class="bg-slate-800 rounded-2xl w-full max-w-2xl shadow-xl border border-slate-700 flex flex-col max-h-[80vh]">
            <div class="p-6 border-b border-slate-700/50">
              <div class="flex items-start justify-between">
                <div>
                  <h3 class="text-xl font-bold text-white flex items-center gap-2">
                    <span>\u{1F464}</span> \u9078\u64C7\u71DF\u92B7\u76EE\u6A19\u7528\u6236
                  </h3>
                  <p class="text-slate-400 text-sm mt-1">\u5F9E\u767C\u9001\u63A7\u5236\u53F0\u540C\u6B65\u6700\u65B0\u7684\u76EE\u6A19\u5BA2\u6236\u6578\u64DA</p>
                </div>
                <!-- \u{1F195} P1: \u6578\u64DA\u540C\u6B65\u6309\u9215 -->
                <button (click)="syncTargetUsersFromSendConsole()"
                        [disabled]="isSyncingTargetUsers()"
                        class="px-3 py-1.5 bg-cyan-500/20 text-cyan-400 rounded-lg text-sm hover:bg-cyan-500/30 disabled:opacity-50 flex items-center gap-1">
                  @if (isSyncingTargetUsers()) {
                    <span class="animate-spin">\u27F3</span> \u540C\u6B65\u4E2D...
                  } @else {
                    \u{1F504} \u540C\u6B65\u6578\u64DA
                  }
                </button>
              </div>
            </div>
            
            <div class="p-4 border-b border-slate-700/50">
              <!-- \u641C\u7D22\u6846 -->
              <div class="flex gap-3">
                <div class="flex-1 relative">
                  <input type="text"
                         [(ngModel)]="targetUserSearchQuery"
                         placeholder="\u641C\u7D22\u7528\u6236\u540D\u3001\u59D3\u540D\u6216 Telegram ID..."
                         class="w-full px-4 py-2.5 pr-10 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500"
                         (keyup.enter)="searchTargetUsers()">
                  @if (targetUserSearchQuery) {
                    <button (click)="clearSearchQuery()"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white">
                      \u2715
                    </button>
                  }
                </div>
                <button (click)="searchTargetUsers()"
                        class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 text-sm flex items-center gap-1">
                  \u{1F50D} \u641C\u7D22
                </button>
                <button (click)="toggleSelectAll()"
                        class="px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 text-sm">
                  {{ isAllSelected() ? '\u53D6\u6D88\u5168\u9078' : '\u5168\u9078' }}
                </button>
              </div>
              
              <!-- \u5FEB\u901F\u7BE9\u9078 -->
              <div class="flex gap-2 mt-3">
                <button (click)="selectHighIntentUsers()"
                        class="px-3 py-1.5 bg-amber-500/20 text-amber-400 rounded-lg text-sm hover:bg-amber-500/30">
                  \u2B50 \u9AD8\u610F\u5411
                </button>
                <span class="text-slate-500 text-sm flex items-center">
                  \u5DF2\u9078: {{ selectedTargetUsers().length }} \u500B
                </span>
              </div>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4">
              @if (filteredTargetUsers().length === 0) {
                <div class="text-center py-8 text-slate-500">
                  <div class="text-4xl mb-3">\u{1F4ED}</div>
                  <p>\u66AB\u7121\u53EF\u9078\u7528\u6236</p>
                  <p class="text-sm mt-1">\u8ACB\u5148\u5F9E\u7FA4\u7D44\u63D0\u53D6\u6210\u54E1\u6216\u5C0E\u5165\u806F\u7E6B\u4EBA</p>
                </div>
              } @else {
                <div class="space-y-2">
                  @for (user of filteredTargetUsers(); track user.telegramId) {
                    <div (click)="toggleTargetUser(user)"
                         class="flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all"
                         [class.bg-purple-500/20]="isUserSelected(user)"
                         [class.border-purple-500]="isUserSelected(user)"
                         [class.bg-slate-700/50]="!isUserSelected(user)"
                         [class.hover:bg-slate-700]="!isUserSelected(user)"
                         [class.border]="true"
                         [class.border-transparent]="!isUserSelected(user)">
                      <!-- \u9078\u4E2D\u72C0\u614B -->
                      <div class="w-5 h-5 rounded border-2 flex items-center justify-center"
                           [class.bg-purple-500]="isUserSelected(user)"
                           [class.border-purple-500]="isUserSelected(user)"
                           [class.border-slate-500]="!isUserSelected(user)">
                        @if (isUserSelected(user)) {
                          <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                          </svg>
                        }
                      </div>
                      
                      <!-- \u982D\u50CF -->
                      <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-medium">
                        {{ (user.firstName || user.username || '?')[0].toUpperCase() }}
                      </div>
                      
                      <!-- \u7528\u6236\u4FE1\u606F -->
                      <div class="flex-1">
                        <div class="text-white font-medium">
                          {{ user.firstName || user.username || 'Unknown' }}
                          @if (user.lastName) { {{ user.lastName }} }
                        </div>
                        <div class="text-xs text-slate-400">
                          @if (user.username) { @{{ user.username }} \xB7 }
                          ID: {{ user.telegramId }}
                        </div>
                      </div>
                      
                      <!-- \u610F\u5411\u5206\u6578 -->
                      <div class="text-right">
                        <div class="text-sm font-bold"
                             [class.text-emerald-400]="user.intentScore >= 60"
                             [class.text-amber-400]="user.intentScore >= 40 && user.intentScore < 60"
                             [class.text-slate-400]="user.intentScore < 40">
                          {{ user.intentScore }}\u5206
                        </div>
                        <div class="text-xs text-slate-500">{{ user.source }}</div>
                      </div>
                    </div>
                  }
                </div>
              }
            </div>
            
            <div class="p-6 border-t border-slate-700/50 flex gap-3">
              <button (click)="closeTargetUserSelector()"
                      class="flex-1 py-3 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors">
                \u53D6\u6D88
              </button>
              <button (click)="confirmTargetUsers()"
                      [disabled]="selectedTargetUsers().length === 0"
                      class="flex-1 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50">
                \u78BA\u8A8D\u9078\u64C7 ({{ selectedTargetUsers().length }})
              </button>
            </div>
          </div>
        </div>
      }
      
      <!-- \u65B0\u5EFA\u5287\u672C\u5C0D\u8A71\u6846 -->
      @if (showNewScriptDialog()) {
        <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
          <div class="bg-slate-800 rounded-2xl w-full max-w-md p-6 shadow-xl border border-slate-700">
            <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
              <span>\u{1F4DC}</span> \u65B0\u5EFA\u5287\u672C
            </h3>
            
            <div class="space-y-4">
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u5287\u672C\u540D\u7A31 *</label>
                <input type="text"
                       [(ngModel)]="newScriptName"
                       placeholder="\u5982\uFF1A\u65B0\u5BA2\u6236\u8F49\u5316\u5287\u672C"
                       class="w-full px-4 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500">
              </div>
              
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u5287\u672C\u63CF\u8FF0</label>
                <textarea rows="3"
                          [(ngModel)]="newScriptDescription"
                          placeholder="\u63CF\u8FF0\u9019\u500B\u5287\u672C\u7684\u4F7F\u7528\u5834\u666F\u548C\u76EE\u6A19..."
                          class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 resize-none">
                </textarea>
              </div>
              
              <!-- \u5FEB\u901F\u9078\u64C7\u6A21\u677F -->
              <div>
                <label class="text-sm text-slate-400 block mb-2">\u6216\u5F9E\u6A21\u677F\u5275\u5EFA</label>
                <div class="grid grid-cols-2 gap-2">
                  <button (click)="createFromTemplate('high_intent')"
                          class="p-3 bg-slate-700/50 rounded-lg text-left hover:bg-slate-700 transition-colors">
                    <div class="text-lg mb-1">\u{1F3AF}</div>
                    <div class="text-sm text-white">\u9AD8\u610F\u5411\u8F49\u5316</div>
                  </button>
                  <button (click)="createFromTemplate('product_demo')"
                          class="p-3 bg-slate-700/50 rounded-lg text-left hover:bg-slate-700 transition-colors">
                    <div class="text-lg mb-1">\u{1F4E6}</div>
                    <div class="text-sm text-white">\u7522\u54C1\u6F14\u793A</div>
                  </button>
                  <button (click)="createFromTemplate('customer_support')"
                          class="p-3 bg-slate-700/50 rounded-lg text-left hover:bg-slate-700 transition-colors">
                    <div class="text-lg mb-1">\u{1F527}</div>
                    <div class="text-sm text-white">\u552E\u5F8C\u670D\u52D9</div>
                  </button>
                  <button (click)="createFromTemplate('community')"
                          class="p-3 bg-slate-700/50 rounded-lg text-left hover:bg-slate-700 transition-colors">
                    <div class="text-lg mb-1">\u{1F389}</div>
                    <div class="text-sm text-white">\u793E\u7FA4\u6D3B\u8E8D</div>
                  </button>
                </div>
              </div>
            </div>
            
            <div class="flex gap-3 mt-6">
              <button (click)="cancelAddScript()"
                      class="flex-1 py-2.5 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-colors">
                \u53D6\u6D88
              </button>
              <button (click)="confirmAddScript()"
                      [disabled]="!newScriptName.trim()"
                      class="flex-1 py-2.5 bg-purple-500 text-white rounded-lg hover:bg-purple-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                \u5275\u5EFA\u5287\u672C
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  `
    }]
  }], null, { importFileInput: [{
    type: ViewChild,
    args: ["importFileInput"]
  }], goalInput: [{
    type: ViewChild,
    args: ["goalInput"]
  }], onDocumentClick: [{
    type: HostListener,
    args: ["document:click", ["$event"]]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(MultiRoleCenterComponent, { className: "MultiRoleCenterComponent", filePath: "src/multi-role/multi-role-center.component.ts", lineNumber: 1795 });
})();

// src/views/multi-role-view.component.ts
var MultiRoleViewComponent = class _MultiRoleViewComponent {
  constructor() {
    this.i18n = inject(I18nService);
    this.nav = inject(NavBridgeService);
    this.membershipService = inject(MembershipService);
    this.accountService = inject(AccountManagementService);
  }
  // Â∞éËà™
  navigateTo(view) {
    this.nav.navigateTo(view);
  }
  // ÁøªË≠ØÊñπÊ≥ï
  t(key, params) {
    return this.i18n.t(key, params);
  }
  static {
    this.\u0275fac = function MultiRoleViewComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _MultiRoleViewComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _MultiRoleViewComponent, selectors: [["app-multi-role-view"]], decls: 1, vars: 0, consts: [[3, "navigateTo"]], template: function MultiRoleViewComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "app-multi-role-center", 0);
        \u0275\u0275listener("navigateTo", function MultiRoleViewComponent_Template_app_multi_role_center_navigateTo_0_listener($event) {
          return ctx.navigateTo($event);
        });
        \u0275\u0275elementEnd();
      }
    }, dependencies: [
      CommonModule,
      FormsModule,
      MultiRoleCenterComponent
    ], encapsulation: 2, changeDetection: 0 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(MultiRoleViewComponent, [{
    type: Component,
    args: [{
      selector: "app-multi-role-view",
      standalone: true,
      changeDetection: ChangeDetectionStrategy.OnPush,
      imports: [
        CommonModule,
        FormsModule,
        MultiRoleCenterComponent
      ],
      template: `
    <app-multi-role-center
      (navigateTo)="navigateTo($event)">
    </app-multi-role-center>
  `
    }]
  }], null, null);
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(MultiRoleViewComponent, { className: "MultiRoleViewComponent", filePath: "src/views/multi-role-view.component.ts", lineNumber: 33 });
})();

export {
  AutoGroupService,
  MultiRoleViewComponent
};
//# sourceMappingURL=chunk-STMAXXHJ.js.map
