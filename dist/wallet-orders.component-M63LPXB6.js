import{a as j}from"./chunk-HNCHSWBM.js";import{t as B}from"./chunk-FZJM4IRN.js";import"./chunk-TMNXXRHZ.js";import{h as N}from"./chunk-K5SU4RX2.js";import{Aa as l,Bb as o,Cb as m,Db as C,Eb as z,Ia as O,Na as D,Sa as f,W as _,X as g,ga as b,ib as p,jb as n,kb as i,lb as W,pb as v,pc as A,qc as R,rb as u,tb as c,uc as F,yb as h,zb as V}from"./chunk-PDD6YQ47.js";function U(a,t){if(a&1&&(n(0,"span",12),o(1),i()),a&2){let e=c().$implicit;l(),m(e.count)}}function L(a,t){if(a&1){let e=v();n(0,"button",10),u("click",function(){let d=_(e).$implicit,x=c();return g(x.filterByStatus(d.value))}),o(1),f(2,U,2,1,"span",11),i()}if(a&2){let e=t.$implicit,r=c();V("active",r.currentStatus()===e.value),l(),C(" ",e.label," "),l(),p("ngIf",e.count>0)}}function q(a,t){if(a&1&&(n(0,"div",29),o(1),i()),a&2){let e=c().$implicit,r=c(2);l(),C(" +",r.formatAmount(e.bonus_amount)," ")}}function G(a,t){if(a&1){let e=v();n(0,"div",30),u("click",function(d){return _(e),g(d.stopPropagation())}),n(1,"button",31),u("click",function(){_(e);let d=c().$implicit,x=c(2);return g(x.cancelOrder(d))}),o(2,"\u53D6\u6D88"),i(),n(3,"button",32),u("click",function(){_(e);let d=c().$implicit,x=c(2);return g(x.continuePayment(d))}),o(4,"\u7E7C\u7E8C\u652F\u4ED8"),i()()}}function H(a,t){if(a&1){let e=v();n(0,"div",16),u("click",function(){let d=_(e).$implicit,x=c(2);return g(x.viewOrder(d))}),n(1,"div",17)(2,"div",18)(3,"div",19),o(4),i(),n(5,"div",20),o(6),i()(),n(7,"div",21)(8,"div",22),o(9),i(),f(10,q,2,1,"div",23),i()(),n(11,"div",24)(12,"div",25)(13,"span",26),o(14),i(),n(15,"span"),o(16),i()(),n(17,"div",27),o(18),i()(),f(19,G,5,0,"div",28),i()}if(a&2){let e=t.$implicit,r=c(2);l(4),m(e.order_no),l(2),m(r.formatDate(e.created_at)),l(3),m(r.formatAmount(e.amount)),l(),p("ngIf",e.bonus_amount>0),l(4),m(r.getMethodIcon(e.payment_method)),l(2),m(r.getMethodName(e.payment_method)),l(),h("color",r.getStatusColor(e.status)),l(),C(" ",r.getStatusName(e.status)," "),l(),p("ngIf",e.status==="pending")}}function J(a,t){if(a&1){let e=v();n(0,"div",33)(1,"div",34),o(2,"\u{1F4CB}"),i(),n(3,"div",35),o(4,"\u66AB\u7121\u8A02\u55AE\u8A18\u9304"),i(),n(5,"button",36),u("click",function(){_(e);let d=c(2);return g(d.goToRecharge())}),o(6,"\u7ACB\u5373\u5145\u503C"),i()()}}function K(a,t){if(a&1&&(n(0,"div",13),f(1,H,20,10,"div",14)(2,J,7,0,"div",15),i()),a&2){let e=c();l(),p("ngForOf",e.orders()),l(),p("ngIf",e.orders().length===0)}}function Q(a,t){a&1&&(n(0,"div",37),W(1,"div",38),n(2,"span"),o(3,"\u52A0\u8F09\u4E2D..."),i()())}function X(a,t){if(a&1){let e=v();n(0,"div",39)(1,"button",40),u("click",function(){_(e);let d=c();return g(d.goToPage(d.currentPage()-1))}),o(2,"\u4E0A\u4E00\u9801"),i(),n(3,"span",41),o(4),i(),n(5,"button",40),u("click",function(){_(e);let d=c();return g(d.goToPage(d.currentPage()+1))}),o(6,"\u4E0B\u4E00\u9801"),i()()}if(a&2){let e=c();l(),p("disabled",e.currentPage()<=1),l(3),z("",e.currentPage()," / ",e.totalPages()),l(),p("disabled",e.currentPage()>=e.totalPages())}}function Y(a,t){if(a&1&&(n(0,"div",47)(1,"span",48),o(2,"\u8D08\u9001\u91D1\u984D"),i(),n(3,"span",54),o(4),i()()),a&2){let e,r=c(2);l(4),C("+",r.formatAmount(((e=r.selectedOrder())==null?null:e.bonus_amount)||0))}}function Z(a,t){if(a&1&&(n(0,"div",47)(1,"span",48),o(2,"\u624B\u7E8C\u8CBB"),i(),n(3,"span",50),o(4),i()()),a&2){let e,r=c(2);l(4),m(r.formatAmount(((e=r.selectedOrder())==null?null:e.fee)||0))}}function ee(a,t){if(a&1&&(n(0,"div",47)(1,"span",48),o(2,"USDT \u91D1\u984D"),i(),n(3,"span",50),o(4),i()()),a&2){let e,r=c(2);l(4),C("",(e=r.selectedOrder())==null?null:e.usdt_amount," USDT")}}function te(a,t){if(a&1&&(n(0,"div",47)(1,"span",48),o(2,"\u4EA4\u6613\u54C8\u5E0C"),i(),n(3,"span",55),o(4),i()()),a&2){let e,r=c(2);l(4),m((e=r.selectedOrder())==null?null:e.usdt_tx_hash)}}function ne(a,t){if(a&1&&(n(0,"div",47)(1,"span",48),o(2,"\u5230\u8CEC\u6642\u9593"),i(),n(3,"span",50),o(4),i()()),a&2){let e,r=c(2);l(4),m(r.formatDate(((e=r.selectedOrder())==null?null:e.confirmed_at)||""))}}function ie(a,t){if(a&1){let e=v();n(0,"div",56)(1,"button",57),u("click",function(){_(e);let d=c(2);return g(d.cancelOrder(d.selectedOrder()))}),o(2,"\u53D6\u6D88\u8A02\u55AE"),i(),n(3,"button",58),u("click",function(){_(e);let d=c(2);return g(d.continuePayment(d.selectedOrder()))}),o(4,"\u7E7C\u7E8C\u652F\u4ED8"),i()()}}function re(a,t){if(a&1){let e=v();n(0,"div",42),u("click",function(){_(e);let d=c();return g(d.closeOrderDetail())}),n(1,"div",43),u("click",function(d){return _(e),g(d.stopPropagation())}),n(2,"div",44)(3,"h3"),o(4,"\u8A02\u55AE\u8A73\u60C5"),i(),n(5,"button",45),u("click",function(){_(e);let d=c();return g(d.closeOrderDetail())}),o(6,"\xD7"),i()(),n(7,"div",46)(8,"div",47)(9,"span",48),o(10,"\u8A02\u55AE\u865F"),i(),n(11,"span",49),o(12),i()(),n(13,"div",47)(14,"span",48),o(15,"\u72C0\u614B"),i(),n(16,"span",50),o(17),i()(),n(18,"div",47)(19,"span",48),o(20,"\u5145\u503C\u91D1\u984D"),i(),n(21,"span",50),o(22),i()(),f(23,Y,5,1,"div",51)(24,Z,5,1,"div",51),n(25,"div",52)(26,"span",48),o(27,"\u5BE6\u969B\u5230\u8CEC"),i(),n(28,"span",50),o(29),i()(),n(30,"div",47)(31,"span",48),o(32,"\u652F\u4ED8\u65B9\u5F0F"),i(),n(33,"span",50),o(34),i()(),f(35,ee,5,1,"div",51)(36,te,5,1,"div",51),n(37,"div",47)(38,"span",48),o(39,"\u5275\u5EFA\u6642\u9593"),i(),n(40,"span",50),o(41),i()(),f(42,ne,5,1,"div",51),i(),f(43,ie,5,0,"div",53),i()()}if(a&2){let e,r,d,x,P,y,w,M,E,S,k,I,T,s=c();l(12),m((e=s.selectedOrder())==null?null:e.order_no),l(4),h("color",s.getStatusColor(((r=s.selectedOrder())==null?null:r.status)||"")),l(),C(" ",s.getStatusName(((d=s.selectedOrder())==null?null:d.status)||"")," "),l(5),m(s.formatAmount(((x=s.selectedOrder())==null?null:x.amount)||0)),l(),p("ngIf",(P=s.selectedOrder())==null?null:P.bonus_amount),l(),p("ngIf",(y=s.selectedOrder())==null?null:y.fee),l(5),m(s.formatAmount(((w=s.selectedOrder())==null?null:w.actual_amount)||0)),l(5),m(s.getMethodName(((M=s.selectedOrder())==null?null:M.payment_method)||"")),l(),p("ngIf",(E=s.selectedOrder())==null?null:E.usdt_amount),l(),p("ngIf",(S=s.selectedOrder())==null?null:S.usdt_tx_hash),l(5),m(s.formatDate(((k=s.selectedOrder())==null?null:k.created_at)||"")),l(),p("ngIf",(I=s.selectedOrder())==null?null:I.confirmed_at),l(),p("ngIf",((T=s.selectedOrder())==null?null:T.status)==="pending")}}var $=class a{constructor(t,e){this.walletService=t;this.router=e;this.orders=b([]);this.loading=b(!0);this.currentPage=b(1);this.totalPages=b(1);this.currentStatus=b("");this.selectedOrder=b(null);this.statusTabs=[{label:"\u5168\u90E8",value:"",count:0},{label:"\u5F85\u652F\u4ED8",value:"pending",count:0},{label:"\u5DF2\u652F\u4ED8",value:"paid",count:0},{label:"\u5DF2\u5230\u8CEC",value:"confirmed",count:0},{label:"\u5DF2\u904E\u671F",value:"expired",count:0}]}ngOnInit(){this.loadOrders()}async loadOrders(){this.loading.set(!0);try{let t=await this.walletService.getRechargeOrders({page:this.currentPage(),pageSize:20,status:this.currentStatus()||void 0});if(t){this.orders.set(t.orders),this.totalPages.set(t.pagination.total_pages);let e=t.orders.filter(r=>r.status==="pending").length;this.statusTabs[1].count=e}}catch(t){console.error("Load orders error:",t)}finally{this.loading.set(!1)}}filterByStatus(t){this.currentStatus.set(t),this.currentPage.set(1),this.loadOrders()}goToPage(t){t<1||t>this.totalPages()||(this.currentPage.set(t),this.loadOrders())}viewOrder(t){this.selectedOrder.set(t)}closeOrderDetail(){this.selectedOrder.set(null)}async continuePayment(t){this.router.navigate(["/wallet/recharge"],{queryParams:{orderNo:t.order_no}})}async cancelOrder(t){if(!confirm("\u78BA\u5B9A\u8981\u53D6\u6D88\u6B64\u8A02\u55AE\u55CE\uFF1F"))return;let e=await this.walletService.cancelRechargeOrder(t.order_no);e.success?(await this.loadOrders(),this.closeOrderDetail()):alert(e.error||"\u53D6\u6D88\u5931\u6557")}formatAmount(t){return"$"+(t/100).toFixed(2)}formatDate(t){return t?new Date(t).toLocaleString("zh-TW",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}getMethodIcon(t){return{usdt_trc20:"\u{1F48E}",usdt_erc20:"\u{1F48E}",alipay:"\u{1F499}",wechat:"\u{1F49A}",bank:"\u{1F3E6}"}[t]||"\u{1F4B3}"}getMethodName(t){return{usdt_trc20:"USDT (TRC20)",usdt_erc20:"USDT (ERC20)",alipay:"\u652F\u4ED8\u5BF6",wechat:"\u5FAE\u4FE1\u652F\u4ED8",bank:"\u9280\u884C\u5361"}[t]||t}getStatusName(t){return{pending:"\u5F85\u652F\u4ED8",paid:"\u5DF2\u652F\u4ED8",confirmed:"\u5DF2\u5230\u8CEC",failed:"\u5931\u6557",expired:"\u5DF2\u904E\u671F",refunded:"\u5DF2\u9000\u6B3E"}[t]||t}getStatusColor(t){return{pending:"#f59e0b",paid:"#3b82f6",confirmed:"#22c55e",failed:"#ef4444",expired:"#9ca3af",refunded:"#8b5cf6"}[t]||"#666"}goBack(){this.router.navigate(["/wallet"])}goToRecharge(){this.router.navigate(["/wallet/recharge"])}static{this.\u0275fac=function(e){return new(e||a)(O(j),O(N))}}static{this.\u0275cmp=D({type:a,selectors:[["app-wallet-orders"]],decls:13,vars:5,consts:[[1,"orders-view"],[1,"view-header"],[1,"header-left"],[1,"back-btn",3,"click"],[1,"filters"],["class","filter-tab",3,"active","click",4,"ngFor","ngForOf"],["class","orders-list",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","pagination",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"filter-tab",3,"click"],["class","count",4,"ngIf"],[1,"count"],[1,"orders-list"],["class","order-item",3,"click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"order-item",3,"click"],[1,"order-main"],[1,"order-info"],[1,"order-no"],[1,"order-time"],[1,"order-amount"],[1,"amount"],["class","bonus",4,"ngIf"],[1,"order-footer"],[1,"payment-method"],[1,"method-icon"],[1,"order-status"],["class","order-actions",3,"click",4,"ngIf"],[1,"bonus"],[1,"order-actions",3,"click"],[1,"cancel-btn",3,"click"],[1,"pay-btn",3,"click"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-text"],[1,"recharge-btn",3,"click"],[1,"loading-state"],[1,"spinner"],[1,"pagination"],[1,"page-btn",3,"click","disabled"],[1,"page-info"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"detail-row"],[1,"label"],[1,"value","mono"],[1,"value"],["class","detail-row",4,"ngIf"],[1,"detail-row","highlight"],["class","modal-footer",4,"ngIf"],[1,"value","bonus"],[1,"value","mono","small"],[1,"modal-footer"],[1,"secondary-btn",3,"click"],[1,"primary-btn",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),u("click",function(){return r.goBack()}),o(4,"\u2190"),i(),n(5,"h1"),o(6,"\u5145\u503C\u8A02\u55AE"),i()()(),n(7,"div",4),f(8,L,3,4,"button",5),i(),f(9,K,3,2,"div",6)(10,Q,4,0,"div",7)(11,X,7,4,"div",8)(12,re,44,14,"div",9),i()),e&2&&(l(8),p("ngForOf",r.statusTabs),l(),p("ngIf",!r.loading()),l(),p("ngIf",r.loading()),l(),p("ngIf",r.totalPages()>1),l(),p("ngIf",r.selectedOrder()))},dependencies:[F,A,R,B],styles:[".orders-view[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);padding:20px;color:#fff}.view-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.back-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:12px;background:#ffffff1a;border:none;color:#fff;font-size:20px;cursor:pointer}h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin:0}.filters[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:20px;overflow-x:auto;padding-bottom:8px}.filter-tab[_ngcontent-%COMP%]{flex-shrink:0;padding:10px 16px;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:20px;color:#ffffffb3;font-size:14px;cursor:pointer;transition:all .2s}.filter-tab[_ngcontent-%COMP%]:hover{background:#ffffff1a}.filter-tab.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-color:transparent;color:#fff}.filter-tab[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{display:inline-block;min-width:18px;height:18px;line-height:18px;text-align:center;background:#fff3;border-radius:10px;font-size:11px;margin-left:6px}.orders-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.order-item[_ngcontent-%COMP%]{background:#ffffff0d;border-radius:16px;padding:16px;cursor:pointer;transition:all .2s}.order-item[_ngcontent-%COMP%]:hover{background:#ffffff14}.order-main[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px}.order-no[_ngcontent-%COMP%]{font-size:14px;font-weight:500;font-family:monospace}.order-time[_ngcontent-%COMP%]{font-size:12px;opacity:.6;margin-top:4px}.order-amount[_ngcontent-%COMP%]{text-align:right}.order-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#667eea}.order-amount[_ngcontent-%COMP%]   .bonus[_ngcontent-%COMP%]{font-size:12px;color:#f59e0b}.order-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid rgba(255,255,255,.1)}.payment-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:13px;opacity:.7}.method-icon[_ngcontent-%COMP%]{font-size:16px}.order-status[_ngcontent-%COMP%]{font-size:13px;font-weight:500}.order-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:12px;padding-top:12px;border-top:1px dashed rgba(255,255,255,.1)}.cancel-btn[_ngcontent-%COMP%]{flex:1;padding:10px;background:#ffffff1a;border:none;border-radius:8px;color:#fff;font-size:14px;cursor:pointer}.pay-btn[_ngcontent-%COMP%]{flex:2;padding:10px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:8px;color:#fff;font-size:14px;font-weight:500;cursor:pointer}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.empty-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px}.empty-text[_ngcontent-%COMP%]{font-size:16px;opacity:.6;margin-bottom:24px}.recharge-btn[_ngcontent-%COMP%]{padding:12px 32px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:10px;color:#fff;font-size:15px;cursor:pointer}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:60px 20px;gap:12px}.spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid rgba(255,255,255,.1);border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:16px;margin-top:24px;padding:16px}.page-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#ffffff1a;border:none;border-radius:8px;color:#fff;font-size:14px;cursor:pointer}.page-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.page-info[_ngcontent-%COMP%]{font-size:14px;opacity:.7}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:100;padding:20px}.modal[_ngcontent-%COMP%]{background:#1a1a2e;border-radius:20px;max-width:400px;width:100%;max-height:80vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid rgba(255,255,255,.1)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.close-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:#ffffff1a;border:none;color:#fff;font-size:20px;cursor:pointer}.modal-body[_ngcontent-%COMP%]{padding:20px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(255,255,255,.05)}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{opacity:.6;font-size:14px}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:14px;text-align:right}.detail-row[_ngcontent-%COMP%]   .value.mono[_ngcontent-%COMP%]{font-family:monospace}.detail-row[_ngcontent-%COMP%]   .value.small[_ngcontent-%COMP%]{font-size:11px;word-break:break-all;max-width:200px}.detail-row[_ngcontent-%COMP%]   .value.bonus[_ngcontent-%COMP%]{color:#f59e0b}.detail-row.highlight[_ngcontent-%COMP%]{background:#667eea1a;margin:0 -20px;padding:12px 20px;border-radius:8px}.detail-row.highlight[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#667eea}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:12px;padding:20px;border-top:1px solid rgba(255,255,255,.1)}.secondary-btn[_ngcontent-%COMP%]{flex:1;padding:14px;background:#ffffff1a;border:none;border-radius:10px;color:#fff;font-size:15px;cursor:pointer}.primary-btn[_ngcontent-%COMP%]{flex:2;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:10px;color:#fff;font-size:15px;font-weight:500;cursor:pointer}"]})}};export{$ as WalletOrdersComponent};
