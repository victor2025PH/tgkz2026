# TG-Matrix æ‰“åŒ…ç™¼å¸ƒæŒ‡å—

> **ç‰ˆæœ¬**: 1.0.0  
> **æ›´æ–°æ—¥æœŸ**: 2026å¹´1æœˆ11æ—¥

---

## ğŸ“‹ ç›®éŒ„

1. [æ‰“åŒ…æ¦‚è¿°](#æ‰“åŒ…æ¦‚è¿°)
2. [ç’°å¢ƒæº–å‚™](#ç’°å¢ƒæº–å‚™)
3. [æ‰“åŒ…å‘½ä»¤](#æ‰“åŒ…å‘½ä»¤)
4. [é…ç½®èªªæ˜](#é…ç½®èªªæ˜)
5. [ç™¼å¸ƒæµç¨‹](#ç™¼å¸ƒæµç¨‹)
6. [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

---

## æ‰“åŒ…æ¦‚è¿°

### æ‰“åŒ…æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TG-Matrix å®‰è£åŒ…                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Electron App                                               â”‚
â”‚  â”œâ”€â”€ dist/                 (Angular ç·¨è­¯çµæœ)               â”‚
â”‚  â”œâ”€â”€ backend/              (Python å¾Œç«¯)                    â”‚
â”‚  â”œâ”€â”€ default-config/       (é»˜èªé…ç½®)                       â”‚
â”‚  â”œâ”€â”€ electron.js           (ä¸»é€²ç¨‹)                         â”‚
â”‚  â””â”€â”€ auto-ai-setup.js      (AI è‡ªå‹•è¨­ç½®)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¼¸å‡ºæ ¼å¼                                                    â”‚
â”‚  â”œâ”€â”€ Windows: .exe (NSIS å®‰è£ç¨‹åº)                          â”‚
â”‚  â”œâ”€â”€ macOS: .dmg (ç£ç›¤æ˜ åƒ)                                  â”‚
â”‚  â””â”€â”€ Linux: .AppImage (å¯åŸ·è¡Œæ–‡ä»¶)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®‰è£åŒ…ç‰¹é»

- âœ… **é–‹ç®±å³ç”¨** - é¦–æ¬¡å•Ÿå‹•è‡ªå‹•é…ç½® AI
- âœ… **ä¸å¸¶ç”¨æˆ¶æ•¸æ“š** - ç©ºç™½å®‰è£ï¼Œæ•¸æ“šç¨ç«‹
- âœ… **æœ¬åœ° AI å„ªå…ˆ** - è‡ªå‹•æª¢æ¸¬ Ollama
- âœ… **è‡ªå‹•é™ç´š** - æœ¬åœ°ä¸å¯ç”¨æ™‚åˆ‡æ›é›²ç«¯

---

## ç’°å¢ƒæº–å‚™

### 1. å®‰è£ä¾è³´

```bash
# å®‰è£ Node.js ä¾è³´
npm install

# å®‰è£ Python ä¾è³´
pip install -r backend/requirements.txt

# å®‰è£ electron-builder
npm install -g electron-builder
```

### 2. æº–å‚™åœ–æ¨™

åœ¨ `build-resources/` ç›®éŒ„æ”¾ç½®ä»¥ä¸‹æ–‡ä»¶ï¼š

| æ–‡ä»¶ | èªªæ˜ | å°ºå¯¸ |
|------|------|------|
| `icon.ico` | Windows åœ–æ¨™ | 256x256 |
| `icon.icns` | macOS åœ–æ¨™ | 512x512 |
| `icons/` | Linux åœ–æ¨™ç›®éŒ„ | å¤šå°ºå¯¸ PNG |

**ç”Ÿæˆåœ–æ¨™å·¥å…·**ï¼š
- https://icoconvert.com/
- https://cloudconvert.com/

### 3. æº–å‚™é»˜èªé…ç½®

ç¢ºä¿ä»¥ä¸‹æ–‡ä»¶å­˜åœ¨ï¼š

```
default-config/
â”œâ”€â”€ ai-config.json      # AI é»˜èªé…ç½®
â””â”€â”€ settings.json       # ç³»çµ±é»˜èªè¨­ç½®
```

---

## æ‰“åŒ…å‘½ä»¤

### å¿«é€Ÿæ‰“åŒ…

```bash
# æº–å‚™æ‰“åŒ…ç’°å¢ƒ
npm run prebuild:dist

# æ‰“åŒ… Windows ç‰ˆæœ¬
npm run dist:win

# æ‰“åŒ… macOS ç‰ˆæœ¬
npm run dist:mac

# æ‰“åŒ… Linux ç‰ˆæœ¬
npm run dist:linux

# æ‰“åŒ…æ‰€æœ‰å¹³å°
npm run dist:all
```

### è©³ç´°å‘½ä»¤èªªæ˜

| å‘½ä»¤ | èªªæ˜ | è¼¸å‡º |
|------|------|------|
| `npm run build:prod` | ç”Ÿç”¢æ§‹å»º Angular | dist/ |
| `npm run dist:win` | æ‰“åŒ… Windows | release/*.exe |
| `npm run dist:mac` | æ‰“åŒ… macOS | release/*.dmg |
| `npm run dist:linux` | æ‰“åŒ… Linux | release/*.AppImage |
| `npm run pack` | æ‰“åŒ…ä½†ä¸ç”Ÿæˆå®‰è£ç¨‹åº | release/win-unpacked/ |
| `npm run clean:dist` | æ¸…ç†æ‰“åŒ…æ–‡ä»¶ | - |

### æ‰‹å‹•æ‰“åŒ…æ­¥é©Ÿ

```bash
# 1. æ¸…ç†èˆŠæ–‡ä»¶
npm run clean:dist

# 2. æ§‹å»º Angular
npm run build:prod

# 3. æº–å‚™ç’°å¢ƒ
npm run prebuild:dist

# 4. é‹è¡Œ electron-builder
npx electron-builder --config electron-builder.yml --win
```

---

## é…ç½®èªªæ˜

### electron-builder.yml

```yaml
# æ‡‰ç”¨ä¿¡æ¯
appId: com.tgmatrix.app
productName: TG-Matrix

# è¼¸å‡ºç›®éŒ„
directories:
  output: release

# åŒ…å«æ–‡ä»¶
files:
  - "dist/**/*"
  - "electron.js"
  - "backend/**/*"
  - "default-config/**/*"

# æ’é™¤æ–‡ä»¶
files:
  - "!backend/**/__pycache__"
  - "!backend/*.db"
  - "!backend/sessions/**"

# Windows NSIS é…ç½®
nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true
```

### é»˜èª AI é…ç½®

`default-config/ai-config.json`:

```json
{
  "primaryProvider": "local",
  "localAi": {
    "provider": "ollama",
    "endpoint": "http://localhost:11434",
    "model": "qwen2:7b",
    "autoDetect": true
  },
  "autoFallback": {
    "enabled": true,
    "fallbackProvider": "gemini"
  }
}
```

---

## ç™¼å¸ƒæµç¨‹

### 1. ç‰ˆæœ¬æ›´æ–°

```bash
# æ›´æ–° package.json ç‰ˆæœ¬è™Ÿ
npm version patch  # 1.0.0 -> 1.0.1
npm version minor  # 1.0.0 -> 1.1.0
npm version major  # 1.0.0 -> 2.0.0
```

### 2. æ§‹å»ºæ¸¬è©¦

```bash
# æœ¬åœ°æ¸¬è©¦æ§‹å»º
npm run pack

# æ¸¬è©¦é‹è¡Œ
./release/win-unpacked/TG-Matrix.exe
```

### 3. ç”Ÿæˆå®‰è£åŒ…

```bash
# Windows
npm run dist:win

# è¼¸å‡ºæ–‡ä»¶
# release/TG-Matrix-Setup-1.0.0.exe
```

### 4. ç™¼å¸ƒæª¢æŸ¥æ¸…å–®

- [ ] ç‰ˆæœ¬è™Ÿå·²æ›´æ–°
- [ ] æ§‹å»ºç„¡éŒ¯èª¤
- [ ] å®‰è£åŒ…å¯æ­£å¸¸å®‰è£
- [ ] é¦–æ¬¡å•Ÿå‹•å‘å°æ­£å¸¸é¡¯ç¤º
- [ ] AI è‡ªå‹•æª¢æ¸¬æ­£å¸¸å·¥ä½œ
- [ ] æ‰€æœ‰åŠŸèƒ½å¯ç”¨
- [ ] å¸è¼‰æ­£å¸¸

---

## æ–‡ä»¶çµæ§‹

### æ‰“åŒ…å‰

```
tgkz2026/
â”œâ”€â”€ src/                    # Angular æºç¢¼
â”œâ”€â”€ backend/                # Python å¾Œç«¯
â”œâ”€â”€ dist/                   # Angular ç·¨è­¯è¼¸å‡º
â”œâ”€â”€ default-config/         # é»˜èªé…ç½®
â”œâ”€â”€ build-resources/        # æ‰“åŒ…è³‡æº
â”œâ”€â”€ build-scripts/          # æ‰“åŒ…è…³æœ¬
â”œâ”€â”€ electron.js             # Electron ä¸»é€²ç¨‹
â”œâ”€â”€ auto-ai-setup.js        # AI è‡ªå‹•è¨­ç½®
â”œâ”€â”€ electron-builder.yml    # æ‰“åŒ…é…ç½®
â””â”€â”€ package.json
```

### æ‰“åŒ…å¾Œ

```
release/
â”œâ”€â”€ TG-Matrix-Setup-1.0.0.exe    # Windows å®‰è£ç¨‹åº
â”œâ”€â”€ TG-Matrix-1.0.0.dmg          # macOS ç£ç›¤æ˜ åƒ
â”œâ”€â”€ TG-Matrix-1.0.0.AppImage     # Linux å¯åŸ·è¡Œæ–‡ä»¶
â””â”€â”€ win-unpacked/                # Windows è§£å£“ç‰ˆ
    â”œâ”€â”€ TG-Matrix.exe
    â””â”€â”€ resources/
        â”œâ”€â”€ app/
        â”œâ”€â”€ backend/
        â””â”€â”€ default-config/
```

### å®‰è£å¾Œ

```
C:\Program Files\TG-Matrix\
â”œâ”€â”€ TG-Matrix.exe
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ dist/
â”‚   â”‚   â”œâ”€â”€ backend/
â”‚   â”‚   â””â”€â”€ default-config/
â”‚   â””â”€â”€ electron.asar
â””â”€â”€ data/                    # ç”¨æˆ¶æ•¸æ“šç›®éŒ„ï¼ˆç©ºï¼‰
    â”œâ”€â”€ sessions/
    â”œâ”€â”€ backups/
    â””â”€â”€ logs/
```

---

## å¸¸è¦‹å•é¡Œ

### Q1: æ‰“åŒ…å¤±æ•—æç¤ºæ‰¾ä¸åˆ°åœ–æ¨™ï¼Ÿ

**A**: ç¢ºä¿ `build-resources/icon.ico` å­˜åœ¨ã€‚å¦‚æœæ²’æœ‰åœ–æ¨™ï¼Œå¯ä»¥ï¼š

```bash
# å‰µå»ºä½”ä½åœ–æ¨™ç›®éŒ„
mkdir build-resources

# æš«æ™‚ç¦ç”¨åœ–æ¨™ï¼ˆåœ¨ electron-builder.yml ä¸­ï¼‰
win:
  icon: null  # æˆ–åˆªé™¤æ­¤è¡Œ
```

### Q2: å®‰è£åŒ…å¤ªå¤§æ€éº¼è¾¦ï¼Ÿ

**A**: å„ªåŒ–æ‰“åŒ…é…ç½®ï¼š

```yaml
# electron-builder.yml
asar: true
compression: maximum

# æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
files:
  - "!**/node_modules/*/{CHANGELOG.md,README.md}"
  - "!**/test/**"
```

### Q3: Python å¾Œç«¯æ²’æœ‰æ‰“åŒ…é€²å»ï¼Ÿ

**A**: ç¢ºä¿ `extraResources` é…ç½®æ­£ç¢ºï¼š

```yaml
extraResources:
  - from: "backend"
    to: "backend"
    filter:
      - "**/*"
      - "!**/__pycache__"
```

### Q4: é¦–æ¬¡å•Ÿå‹•å ±éŒ¯ï¼Ÿ

**A**: æª¢æŸ¥ `auto-ai-setup.js` æ˜¯å¦æ­£ç¢ºï¼š

```bash
# æ¸¬è©¦ AI è‡ªå‹•è¨­ç½®
node auto-ai-setup.js
```

### Q5: å¦‚ä½•åªæ‰“åŒ…ä¸ç”Ÿæˆå®‰è£ç¨‹åºï¼Ÿ

**A**: ä½¿ç”¨ `--dir` é¸é …ï¼š

```bash
npm run pack
# æˆ–
npx electron-builder --dir
```

---

## è‡ªå‹•åŒ– CI/CD

### GitHub Actions ç¤ºä¾‹

```yaml
# .github/workflows/release.yml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [windows-latest, macos-latest, ubuntu-latest]
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      
      - name: Install dependencies
        run: npm install
      
      - name: Build
        run: npm run build:prod
      
      - name: Package
        run: npm run dist
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

---

## ç¸½çµ

### æ‰“åŒ…æ­¥é©Ÿ

1. `npm install` - å®‰è£ä¾è³´
2. `npm run prebuild:dist` - æº–å‚™ç’°å¢ƒ
3. `npm run dist:win` - æ‰“åŒ… Windows

### è¼¸å‡ºä½ç½®

- å®‰è£åŒ…ï¼š`release/TG-Matrix-Setup-{version}.exe`
- è§£å£“ç‰ˆï¼š`release/win-unpacked/`

### é—œéµé…ç½®

- `electron-builder.yml` - æ‰“åŒ…é…ç½®
- `default-config/ai-config.json` - AI é»˜èªè¨­ç½®
- `auto-ai-setup.js` - é¦–æ¬¡å•Ÿå‹•æª¢æ¸¬

---

*Â© 2026 TG-Matrix. Build & Release Guide.*
