# 資源發現功能 UI 增強說明

> 版本：v1.0  
> 日期：2026-01-13  
> 狀態：✅ 已完成

---

## 一、新增功能展示

### 1.1 多渠道選擇面板

**位置：** 資源發現頁面 → 搜索選項區域上方

**功能：**
- ✅ **Telegram 官方搜索** - 使用 Telegram 官方 API
- ✅ **極搜 (Jisuo)** - 中文群組專用搜索
- ✅ **TGStat** - 數據分析和統計
- ✅ **本地索引** - 已緩存的搜索結果

**UI 特點：**
- 卡片式選擇界面
- 實時顯示選中狀態（邊框高亮）
- 顯示每個渠道的狀態和說明
- 支持全選/取消全選

---

### 1.2 進入群組功能

**位置：** 
1. 單個群組操作按鈕（👥 圖標）
2. 批量操作區域（"進入群組" 按鈕）

**功能：**
- ✅ 單個群組：點擊 👥 按鈕進入群組查看成員
- ✅ 批量操作：選擇多個群組後，點擊"進入群組"按鈕批量進入

**操作流程：**
```
選擇群組 → 點擊"進入群組" → 跳轉到成員列表 → 查看成員詳情 → 可提取成員數據
```

---

### 1.3 批量群發功能

**位置：**
1. 單個群組操作（已加入的群組顯示 📨 按鈕）
2. 批量操作區域（選擇多個群組後顯示"批量群發"按鈕）

**功能：**
- ✅ 批量發送消息到多個群組
- ✅ 支持消息模板和變量替換
- ✅ 智能防封機制
- ✅ 發送間隔和每日上限設置

**變量支持：**
- `{group_name}` - 群組名稱
- `{member_count}` - 成員數

**對話框功能：**
- 消息內容編輯（支持多行）
- 發送間隔設置（30秒 - 10分鐘）
- 每日發送上限
- 智能防封開關

---

### 1.4 批量拉群功能

**位置：**
1. 單個群組操作（已加入的群組顯示 ➕ 按鈕）
2. 批量操作區域（選擇多個群組後顯示"批量拉群"按鈕）

**功能：**
- ✅ 批量邀請成員加入多個群組
- ✅ 成員選擇界面
- ✅ 智能防封機制
- ✅ 每群邀請上限設置

**操作流程：**
```
選擇目標群組 → 點擊"批量拉群" → 選擇要邀請的成員 → 設置參數 → 開始邀請
```

**對話框功能：**
- 成員選擇列表（支持全選）
- 邀請間隔設置
- 每群邀請上限
- 智能防封開關

---

## 二、UI 增強對比

### 增強前

```
┌────────────────────────────────────────┐
│  搜索框                                │
│  [搜索按鈕]                            │
│                                        │
│  資源列表                              │
│  [🔗] [➕] [🚀] [📋] [🗑️]            │
└────────────────────────────────────────┘
```

### 增強後

```
┌────────────────────────────────────────┐
│  🔗 搜索渠道選擇                        │
│  [📱 Telegram] [🔍 極搜]              │
│  [📊 TGStat] [💾 本地索引]            │
│                                        │
│  搜索框                                │
│  [⚙️] [搜索]                          │
│                                        │
│  資源列表                              │
│  [已選 5 個]                           │
│  [👥 進入群組] [🚀 批量加入 ▼]       │
│  [📨 批量群發] [➕ 批量拉群]          │
│                                        │
│  [👥] [🔗] [➕] [🚀] [📨] [➕] [📋] │
│    ↑    ↑    ↑    ↑    ↑    ↑         │
│   新增  原有 原有 原有 新增 新增      │
└────────────────────────────────────────┘
```

---

## 三、功能權限控制

### 會員等級限制

| 功能 | 免費版 | VIP | SVIP | MVP |
|------|:------:|:---:|:----:|:---:|
| 多渠道搜索 | ✅ (1個) | ✅ (2個) | ✅ (3個) | ✅ (全部) |
| 進入群組 | ✅ | ✅ | ✅ | ✅ |
| 批量群發 | ❌ | ✅ | ✅ | ✅ |
| 批量拉群 | ❌ | ✅ | ✅ | ✅ |

**UI 顯示：**
- 未解鎖功能顯示 🔒 圖標
- 點擊時提示升級會員

---

## 四、使用示例

### 示例 1：使用多渠道搜索中文群組

```
1. 打開"資源發現"頁面
2. 在"搜索渠道選擇"區域：
   - ✅ 勾選 "極搜"（中文群組）
   - ✅ 勾選 "Telegram"（官方搜索）
3. 輸入關鍵詞："支付,收款,USDT"
4. 點擊"搜索"按鈕
5. 查看搜索結果（來自多個渠道）
```

### 示例 2：批量群發消息

```
1. 選擇 5 個已加入的群組（勾選複選框）
2. 點擊"批量群發"按鈕
3. 在彈出對話框中：
   - 輸入消息內容："大家好，我是 {group_name} 的新成員"
   - 設置發送間隔：1-2 分鐘
   - 啟用"智能防封"
4. 點擊"開始群發"
5. 系統自動向 5 個群組發送消息
```

### 示例 3：批量拉群

```
1. 選擇 3 個目標群組
2. 點擊"批量拉群"按鈕
3. 在彈出對話框中：
   - 選擇要邀請的成員（可全選）
   - 設置每群邀請上限：10 人
   - 設置邀請間隔：2-3 分鐘
4. 點擊"開始拉群"
5. 系統自動邀請成員加入群組
```

---

## 五、技術實現

### 5.1 狀態管理

```typescript
// 多渠道選擇
selectedSearchSources = signal<string[]>(['telegram', 'jiso']);

// 批量操作
showBatchMessageDialog = signal(false);
showBatchInviteDialog = signal(false);
batchMessageConfig = { delayMin: 60, ... };
```

### 5.2 API 調用

```typescript
// 搜索時傳遞選中的源
ipcService.send('search-resources', {
  query: query,
  sources: this.selectedSearchSources(), // 新增
  ...
});

// 批量群發
ipcService.send('batch-send-messages', {
  groupIds: selectedIds,
  message: batchMessageContent,
  config: batchMessageConfig
});

// 批量拉群
ipcService.send('batch-invite-members', {
  groupIds: selectedIds,
  memberIds: batchInviteConfig.selectedMemberIds,
  config: batchInviteConfig
});
```

---

## 六、後續優化建議

### 短期（1週內）
- [ ] 添加搜索源健康狀態檢查
- [ ] 顯示每個源的搜索結果數量
- [ ] 優化批量操作進度顯示

### 中期（1個月內）
- [ ] 添加搜索源權重配置
- [ ] 實現搜索結果去重和合併
- [ ] 添加批量操作歷史記錄

### 長期（季度）
- [ ] 支持自定義搜索源插件
- [ ] 添加搜索源性能分析
- [ ] 實現智能推薦搜索源

---

**文檔結束**
