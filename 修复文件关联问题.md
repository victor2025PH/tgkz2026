# 修复 electron.js 文件关联问题

## 🔍 问题说明

运行 `npm start` 后，自动用记事本打开了 `electron.js` 文件，这是因为之前误选了记事本作为 `.js` 文件的默认打开方式。

## ⚠️ 重要说明

**`electron.js` 文件不应该直接打开！** 它应该通过 `npm start` 命令运行，而不是用任何程序打开。

## ✅ 解决方案

### 方法 1：清除文件关联（推荐）

#### 步骤 1：清除单个文件的关联

1. **右键点击 `electron.js` 文件**
2. **选择"属性"**
3. **点击"更改"按钮**（在"打开方式"旁边）
4. **选择"始终使用此应用打开 .js 文件"**
5. **但不要选择任何程序，直接关闭对话框**
6. **或者选择"记事本"，但取消勾选"始终使用此应用打开"**

#### 步骤 2：使用 PowerShell 清除关联

在 PowerShell 中运行：

```powershell
# 清除 electron.js 的特定关联（如果存在）
Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.js\UserChoice" -Name "ProgId" -ErrorAction SilentlyContinue
```

### 方法 2：修改默认打开方式（不推荐，但可以临时解决）

如果你想保留用编辑器查看代码的能力，但不影响 `npm start`：

1. **右键点击 `electron.js`**
2. **选择"打开方式" → "选择其他应用"**
3. **选择"记事本"或你喜欢的代码编辑器**
4. **重要：取消勾选"始终使用此应用打开 .js 文件"**
5. **点击"确定"**

这样你可以用编辑器查看代码，但不会影响 `npm start` 的运行。

### 方法 3：使用注册表编辑器（高级用户）

如果上述方法不行，可以使用注册表编辑器：

1. 按 `Win + R`，输入 `regedit`，按 Enter
2. 导航到：`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.js\UserChoice`
3. 删除 `ProgId` 值
4. 重启资源管理器或重启电脑

## 🎯 正确的启动方式

**重要：** `npm start` 不应该打开文件，应该启动 Electron 应用！

### 正确的流程：

1. **打开 PowerShell**
2. **进入项目目录：**
   ```powershell
   cd C:\tgkz2026
   ```
3. **运行启动命令：**
   ```powershell
   npm start
   ```

### 应该看到：

```
> tg-matrix@1.0.0 start
> electron .

[Backend] Starting Python backend...
[Backend] Python script: C:\tgkz2026\backend\main.py
[Backend] Event: log-entry
```

**然后 Electron 应用窗口应该自动打开，而不是记事本！**

## 🔧 如果 npm start 仍然打开记事本

### 检查 package.json

让我检查一下 `package.json` 中的启动脚本是否正确：

```json
{
  "scripts": {
    "start": "electron ."
  }
}
```

如果脚本不正确，需要修复。

### 临时解决方案

如果文件关联问题暂时无法解决，可以：

1. **直接运行 Electron：**
   ```powershell
   npx electron .
   ```

2. **或者使用完整路径：**
   ```powershell
   node_modules\.bin\electron.cmd .
   ```

## 📝 最佳实践

### 对于开发：

1. **查看代码：** 使用 VS Code 或其他代码编辑器打开项目文件夹
2. **运行应用：** 使用命令行 `npm start`
3. **不要设置默认打开方式：** 让 `.js` 文件没有默认程序

### 文件关联建议：

- ✅ **项目文件夹：** 用 VS Code 打开
- ✅ **运行应用：** 用命令行 `npm start`
- ❌ **不要设置：** `.js` 文件的默认打开方式

## 🚀 现在试试

1. **清除文件关联**（使用上面的方法）
2. **重新运行：**
   ```powershell
   npm start
   ```
3. **应该看到：** Electron 应用窗口打开，而不是记事本

---

**记住：** `npm start` 应该启动应用，而不是打开文件！

