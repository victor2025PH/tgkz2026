# 启动时优先显示中文配置说明

## ✅ 配置完成

已成功配置应用在启动时优先显示中文。

---

## 🔧 实施的修改

### 1. 修改翻译服务默认语言 ✅

**文件：** `src/translation.service.ts`

**修改前：**
```typescript
language = signal<Language>('en');
```

**修改后：**
```typescript
language = signal<Language>('zh'); // 默认使用中文
```

**说明：** 将翻译服务的默认语言从英文改为中文。

---

### 2. 在应用初始化时设置中文 ✅

**文件：** `src/app.component.ts`

**修改前：**
```typescript
ngOnInit() {
  this.setupIpcListeners();
  // Request initial state from the backend once the app is ready
  this.ipcService.send('get-initial-state');
```

**修改后：**
```typescript
ngOnInit() {
  // 设置默认语言为中文
  this.translationService.setLanguage('zh');
  
  this.setupIpcListeners();
  // Request initial state from the backend once the app is ready
  this.ipcService.send('get-initial-state');
```

**说明：** 在应用初始化时显式设置语言为中文，确保界面立即显示中文。

---

### 3. 在 Electron 主进程中设置语言环境 ✅

**文件：** `electron.js`

**修改 1：在 `createWindow` 函数中设置语言**
```javascript
function createWindow() {
  // 设置应用语言环境为中文
  app.commandLine.appendSwitch('lang', 'zh-CN');
  
  mainWindow = new BrowserWindow({
    // ... 窗口配置 ...
  });
```

**修改 2：在 `app.on('ready')` 中设置环境变量**
```javascript
app.on('ready', () => {
  // 设置系统语言环境为中文（如果系统支持）
  if (process.platform === 'win32') {
    // Windows: 设置环境变量
    process.env.LANG = 'zh_CN.UTF-8';
    process.env.LC_ALL = 'zh_CN.UTF-8';
  } else if (process.platform === 'darwin') {
    // macOS: 设置环境变量
    process.env.LANG = 'zh_CN.UTF-8';
    process.env.LC_ALL = 'zh_CN.UTF-8';
  } else {
    // Linux: 设置环境变量
    process.env.LANG = 'zh_CN.UTF-8';
    process.env.LC_ALL = 'zh_CN.UTF-8';
  }
  
  createWindow();
});
```

**说明：** 
- 使用 `app.commandLine.appendSwitch('lang', 'zh-CN')` 设置 Chromium 的语言环境
- 设置系统环境变量 `LANG` 和 `LC_ALL` 为中文，确保系统级别的语言设置

---

## 📋 配置层级

配置按以下层级生效（从高到低）：

1. **应用初始化设置** (`app.component.ts` `ngOnInit`)
   - 最高优先级
   - 在应用启动时立即设置语言为中文

2. **翻译服务默认值** (`translation.service.ts`)
   - 如果应用初始化时没有设置，使用此默认值
   - 现在默认为中文

3. **Electron 语言环境** (`electron.js`)
   - 设置 Chromium 和系统环境变量
   - 影响浏览器引擎的语言设置

---

## 🎯 预期效果

配置完成后，应用启动时应该：

1. ✅ **界面立即显示中文**
   - 所有翻译的文本都显示为中文
   - 菜单、按钮、标签等都使用中文

2. ✅ **系统语言环境为中文**
   - Electron 的 Chromium 引擎使用中文环境
   - 系统环境变量设置为中文

3. ✅ **用户仍可切换语言**
   - 用户可以通过界面上的语言切换按钮切换到英文
   - 下次启动时仍会默认显示中文

---

## ✅ 配置完成

所有配置已完成：
- ✅ 翻译服务默认语言设置为中文
- ✅ 应用初始化时设置语言为中文
- ✅ Electron 主进程设置语言环境为中文
- ✅ 代码已通过语法检查

**请重启应用，界面应该立即显示中文！**

如果界面仍然显示英文，请检查：
1. 浏览器缓存是否已清除
2. 是否重新构建了应用（`npm run build`）
3. 是否完全重启了 Electron 应用

