# 应用启动后验证指南

## ✅ 当前状态

Electron 应用已成功启动！现在需要验证所有功能是否正常工作。

## 🔍 验证步骤

### 步骤 1：检查主进程控制台（终端）

查看运行 `npm start` 的 PowerShell 终端窗口，应该看到：

```
> tg-matrix@1.0.0 start
> node_modules\.bin\electron.cmd .

[Backend] Starting Python backend...
[Backend] Python script: C:\tgkz2026\backend\main.py
[Backend] Event: log-entry
[Backend] Event: initial-state
```

**如果没有看到这些日志：**
- Python 后端可能没有启动
- 检查是否有错误信息

### 步骤 2：检查渲染进程控制台（应用内）

在 Electron 应用窗口中：

1. **查看开发者工具（应该已经自动打开）**
   - 点击 "Console" 标签页
   - 应该看到：`Received initial state from backend: {...}`

2. **检查是否有错误：**
   - 查看是否有红色错误信息
   - 查看警告信息（黄色）

### 步骤 3：检查应用界面

**应该看到：**
- ✅ 左侧导航菜单（仪表盘、账户管理、自动化中心等）
- ✅ 主内容区域显示仪表盘
- ✅ 统计数据卡片（总账户数、在线账户等，应该都是 0，因为数据库是新的）

### 步骤 4：测试基本功能

#### 测试 1：添加账户

1. 点击左侧菜单 "账户管理"（Accounts）
2. 在 "手动添加新账户" 区域：
   - 输入电话号码（例如：`+1234567890`）
   - 点击 "添加账户"
3. **检查：**
   - 终端应该显示：`[Backend] Sending command: add-account`
   - 终端应该显示：`[Backend] Event: accounts-updated`
   - 账户应该出现在列表中

#### 测试 2：添加关键词集

1. 点击左侧菜单 "自动化中心"（Automation）
2. 在 "关键词集" 区域：
   - 输入名称（例如：`测试关键词集`）
   - 点击 "添加"
3. **检查：**
   - 终端应该显示相关日志
   - 关键词集应该出现在列表中

#### 测试 3：检查数据库

运行一次操作后，检查数据库是否创建：

```powershell
Test-Path backend\data\tgmatrix.db
```

应该返回 `True`。

## 📊 验证清单

### ✅ 基础功能验证

- [ ] Electron 应用窗口正常打开
- [ ] 开发者工具自动打开
- [ ] 主进程控制台显示后端启动日志
- [ ] 渲染进程控制台显示初始状态接收
- [ ] 应用界面正常显示
- [ ] 左侧导航菜单可用
- [ ] 可以切换不同视图

### ✅ 后端通信验证

- [ ] 主进程控制台显示 `[Backend] Starting Python backend...`
- [ ] 主进程控制台显示 `[Backend] Event: log-entry`
- [ ] 主进程控制台显示 `[Backend] Event: initial-state`
- [ ] 渲染进程控制台显示 `Received initial state from backend`

### ✅ 功能测试

- [ ] 可以添加账户
- [ ] 可以添加关键词集
- [ ] 可以添加监控群组
- [ ] 可以添加消息模板
- [ ] 数据库文件已创建

## 🐛 常见问题排查

### 问题 1：看不到后端日志

**症状：** 终端中没有 `[Backend]` 开头的日志

**可能原因：**
- Python 后端没有启动
- Python 路径不正确

**解决方法：**
1. 检查终端中是否有错误信息
2. 检查 Python 是否在 PATH 中：
   ```powershell
   python --version
   ```
3. 检查后端依赖是否安装：
   ```powershell
   pip list | Select-String "pyrogram|aiosqlite"
   ```

### 问题 2：前端没有收到数据

**症状：** 应用界面显示为空，控制台没有初始状态

**可能原因：**
- Python 后端没有响应
- IPC 通信问题

**解决方法：**
1. 检查主进程控制台的错误信息
2. 检查是否有 `[Backend] Error:` 开头的日志
3. 尝试手动测试后端（见下方）

### 问题 3：数据库错误

**症状：** 看到数据库相关的错误

**解决方法：**
1. 检查 `backend/data/` 目录是否存在
2. 检查是否有写权限
3. 删除 `backend/data/tgmatrix.db` 让系统重新创建

## 🧪 手动测试后端（如果集成有问题）

如果 Electron 集成有问题，可以手动测试后端：

1. **打开新的 PowerShell 窗口**
2. **运行后端：**
   ```powershell
   cd C:\tgkz2026
   python backend/main.py
   ```
3. **输入测试命令：**
   ```json
   {"command": "get-initial-state", "payload": {}}
   ```
   按 Enter
4. **应该看到输出：**
   ```json
   {"event": "initial-state", "payload": {...}}
   {"event": "log-entry", "payload": {...}}
   ```

## 🎯 下一步开发计划

验证完成后，可以开始：

### 阶段 1：完善基础功能（当前）

- ✅ 验证所有命令都能正常工作
- ✅ 测试数据库操作
- ✅ 确保前后端通信正常

### 阶段 2：Telegram API 集成（下一步）

- [ ] 实现 Pyrogram 集成
- [ ] 实现账户登录功能
- [ ] 实现消息监控功能
- [ ] 实现消息发送功能

### 阶段 3：Excel 文件处理

- [ ] 实现 Excel 导入
- [ ] 实现 Excel 导出

## 📝 现在请操作

1. **检查主进程控制台（终端）**
   - 查看是否有后端启动日志
   - 查看是否有错误

2. **检查渲染进程控制台（应用内 F12）**
   - 查看 Console 标签页
   - 查看是否有初始状态数据

3. **测试添加账户功能**
   - 尝试添加一个账户
   - 检查是否成功

4. **告诉我结果**
   - 哪些功能正常？
   - 遇到了什么问题？

---

**提示：** 如果一切正常，我们可以开始实现 Pyrogram 集成（Telegram API）了！

