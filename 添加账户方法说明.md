# 添加账户方法说明

## 📋 概述

TG-Matrix 提供了三种添加账户的方法，适用于不同的使用场景。

---

## 方法 1：手动添加单个账户

### 适用场景
- ✅ 添加少量账户（1-5个）
- ✅ 需要立即添加单个账户
- ✅ 测试新账户配置

### 操作步骤

1. **打开账户管理页面**
   - 点击左侧菜单 "账户管理"（Accounts）

2. **填写账户信息**
   - **电话号码**（必填）：例如 `+1234567890`
   - **API ID**（可选）：从 [my.telegram.org](https://my.telegram.org) 获取
   - **API Hash**（可选）：从 [my.telegram.org](https://my.telegram.org) 获取
   - **SOCKS5 代理**（可选）：代理服务器地址
   - **账户分组**（可选）：用于组织和管理账户
   - **2FA 密码**（可选）：如果账户启用了两步验证
   - **启用预热模式**（可选）：自动预热账户

3. **提交表单**
   - 点击 "添加账户" 按钮
   - 账户将立即出现在账户列表中

### 优点
- ⚡ 快速添加单个账户
- 🎯 精确控制每个字段
- 🔄 实时反馈

### 缺点
- ❌ 不适合批量添加
- ❌ 需要手动输入每个账户

---

## 方法 2：Excel 批量导入

### 适用场景
- ✅ 批量添加多个账户（5+个）
- ✅ 从其他系统迁移账户
- ✅ 定期批量更新账户列表

### 操作步骤

1. **下载 Excel 模板**
   - 在 "文件管理" 区域点击 "下载模板"
   - 模板文件将保存到你的下载文件夹

2. **填写账户信息**
   - 打开下载的 Excel 文件
   - 按照模板格式填写账户信息：
     - `phone`: 电话号码
     - `api_id`: API ID
     - `api_hash`: API Hash
     - `proxy`: SOCKS5 代理
     - `group`: 账户分组
     - `two_factor_password`: 2FA 密码
     - `role`: 账户角色（Listener/Sender/Unassigned）

3. **上传 Excel 文件**
   - 在 "文件管理" 区域点击 "上传 Excel"
   - 选择填写好的 Excel 文件
   - 系统将自动解析并导入所有账户

### Excel 模板格式

| phone | api_id | api_hash | proxy | group | two_factor_password | role |
|-------|--------|----------|-------|-------|---------------------|------|
| +1234567890 | 12345 | abcdef... | socks5://... | Group1 | | Listener |
| +0987654321 | 67890 | ghijkl... | socks5://... | Group2 | password123 | Sender |

### 优点
- ✅ 适合批量操作
- ✅ 可以离线准备数据
- ✅ 易于编辑和修改
- ✅ 支持从其他系统导出后导入

### 缺点
- ❌ 需要先下载模板
- ❌ 需要手动填写 Excel

---

## 方法 3：导入 Session 文件

### 适用场景
- ✅ 已有 Pyrogram session 文件
- ✅ 从其他 Telegram 客户端迁移
- ✅ 备份和恢复账户

### 操作步骤

1. **准备 Session 文件**
   - 确保你有 `.session` 文件
   - Session 文件通常位于：
     - Windows: `%APPDATA%\pyrogram\sessions\`
     - Linux/Mac: `~/.local/share/pyrogram/sessions/`

2. **导入 Session 文件**
   - 在 "文件管理" 区域点击 "导入 Session"
   - 选择 `.session` 文件
   - 系统将自动：
     - 复制 session 文件到 `backend/sessions/`
     - 从文件名提取电话号码
     - 如果账户不存在，自动创建账户记录

3. **验证导入**
   - 检查账户列表，确认新账户已添加
   - 账户状态将显示为 "Offline"
   - 可以点击 "登录" 按钮测试账户

### Session 文件命名规则

Session 文件应该命名为：`{phone_number}.session`

例如：
- `1234567890.session`
- `+1234567890.session`（系统会自动处理 `+` 号）

### 导出 Session 文件

你也可以导出已有账户的 session 文件：

1. **在账户列表中**
   - 找到要导出的账户
   - 点击操作列中的 "导出 Session" 按钮（紫色图标）

2. **选择保存位置**
   - 选择保存位置和文件名
   - Session 文件将保存到指定位置

### 优点
- ✅ 快速导入已有账户
- ✅ 保留登录状态
- ✅ 支持备份和恢复
- ✅ 可以从其他系统迁移

### 缺点
- ❌ 需要先有 session 文件
- ❌ 文件名必须包含电话号码

---

## 🔄 重新加载 Session 文件

如果你在 `backend/sessions/` 目录中手动添加了 session 文件，可以：

1. **点击 "重新加载 Sessions" 按钮**
   - 系统将扫描 `backend/sessions/` 目录
   - 自动创建对应的账户记录
   - 更新账户列表

---

## 📊 方法对比

| 特性 | 手动添加 | Excel 导入 | Session 导入 |
|------|---------|-----------|-------------|
| 适用数量 | 1-5个 | 5+个 | 任意数量 |
| 速度 | 快 | 中等 | 快 |
| 需要准备 | 无 | Excel 文件 | Session 文件 |
| 保留登录状态 | ❌ | ❌ | ✅ |
| 批量操作 | ❌ | ✅ | ✅ |
| 离线准备 | ❌ | ✅ | ✅ |

---

## 💡 最佳实践

1. **少量账户**：使用方法 1（手动添加）
2. **批量添加新账户**：使用方法 2（Excel 导入）
3. **迁移已有账户**：使用方法 3（Session 导入）
4. **混合场景**：可以组合使用多种方法

---

## ⚠️ 注意事项

1. **电话号码格式**
   - 建议使用国际格式：`+国家代码 号码`
   - 例如：`+86 13800138000`

2. **Session 文件安全**
   - Session 文件包含账户的登录凭证
   - 请妥善保管，不要泄露给他人
   - 建议定期备份 session 文件

3. **API 凭证**
   - API ID 和 API Hash 可以从 [my.telegram.org](https://my.telegram.org) 获取
   - 每个账户可以使用相同的 API 凭证

4. **账户分组**
   - 使用分组可以更好地组织和管理账户
   - 可以在账户列表中按分组筛选

---

## 🆘 常见问题

### Q: 导入 Session 后账户状态是 "Offline"？
**A:** 这是正常的。Session 文件只是登录凭证，需要点击 "登录" 按钮来激活账户。

### Q: Excel 导入失败？
**A:** 请检查：
- Excel 文件格式是否正确
- 电话号码列是否填写
- 文件是否损坏

### Q: Session 文件找不到电话号码？
**A:** 确保文件名包含电话号码，例如：`1234567890.session`

### Q: 可以同时使用多种方法吗？
**A:** 可以！你可以根据需要组合使用三种方法。

---

**现在你可以根据需求选择最适合的方法来添加账户！** 🎉

