# 登录问题诊断步骤

## 🔍 问题：点击登录按钮没有响应

### 诊断步骤

#### 1. 检查前端日志（开发者工具 Console）

打开开发者工具（F12），查看 Console 标签页，应该看到：

```
[Frontend] loginAccount called with accountId: <ID>
[Frontend] Found account: +639952947692, Status: Offline
[Frontend] Sending login-account command to IPC
```

**如果没有看到这些日志：**
- 按钮点击事件可能没有触发
- 检查浏览器控制台是否有 JavaScript 错误

#### 2. 检查 Electron 主进程日志（终端窗口）

运行 `npm start` 的终端窗口应该显示：

```
[IPC] Received 'login-account': <accountId>
[Backend] Sending command: login-account request_id: <UUID>
```

**如果没有看到这些日志：**
- IPC 通信可能失败
- 检查 Electron 主进程是否正常运行

#### 3. 检查后端日志（终端窗口）

后端应该显示：

```
[Backend] handle_login_account called with payload: <accountId>
[Backend] Found account: +639952947692, API ID: <ID>, API Hash: ***
[Backend] Status updated to 'Logging in...', calling telegram_manager.login_account
[Backend] Calling telegram_manager.login_account for +639952947692
[Backend] login_account result: success=<true/false>, requires_code=<true/false>, requires_2fa=<true/false>
```

**如果没有看到这些日志：**
- 后端可能没有收到命令
- 检查 Python 后端进程是否正常运行

#### 4. 检查账户状态更新

登录后，账户状态应该按以下顺序变化：

1. **Offline** → **Logging in...** （立即）
2. **Logging in...** → **Waiting Code** （如果需要验证码）
3. **Logging in...** → **Waiting 2FA** （如果需要 2FA）
4. **Logging in...** → **Online** （如果登录成功）
5. **Logging in...** → **Error** （如果登录失败）

**如果状态没有变化：**
- 检查 `accounts-updated` 事件是否被正确接收
- 查看前端 Console 是否有 `[Frontend] Received accounts-updated event` 日志

#### 5. 检查验证码/2FA 对话框

如果需要验证码或 2FA，应该看到：

- **验证码对话框：** 显示 "输入验证码" 和电话号码
- **2FA 对话框：** 显示 "输入 2FA 密码" 和电话号码

**如果没有看到对话框：**
- 检查 `login-requires-code` 或 `login-requires-2fa` 事件是否被接收
- 查看前端 Console 是否有相应的事件日志

## 🛠️ 常见问题及解决方案

### 问题 1: 点击按钮完全没有反应

**可能原因：**
- 按钮被禁用
- JavaScript 错误阻止了事件处理
- Angular 组件未正确初始化

**解决方法：**
1. 打开开发者工具（F12）
2. 查看 Console 是否有错误
3. 检查按钮是否可点击（没有被其他元素遮挡）
4. 刷新页面（Ctrl+R）

### 问题 2: 命令发送了但没有响应

**可能原因：**
- 后端进程未启动
- IPC 通信失败
- 后端处理超时

**解决方法：**
1. 检查终端窗口，确认后端进程正在运行
2. 查看是否有错误信息
3. 尝试重启应用（关闭并重新运行 `npm start`）

### 问题 3: 状态更新为 "Logging in..." 但一直不变化

**可能原因：**
- Pyrogram 登录过程卡住
- API ID/Hash 不正确
- 网络连接问题
- 代理配置错误

**解决方法：**
1. 检查后端日志，查看是否有错误信息
2. 验证 API ID 和 API Hash 是否正确
3. 检查网络连接
4. 如果使用代理，验证代理配置是否正确

### 问题 4: 需要验证码但没有显示对话框

**可能原因：**
- `login-requires-code` 事件未正确发送
- 前端事件监听器未正确设置
- 对话框被其他元素遮挡

**解决方法：**
1. 查看前端 Console，确认是否收到 `login-requires-code` 事件
2. 检查 `loginState().requiresCode` 是否为 `true`
3. 检查 HTML 模板中的对话框条件是否正确

### 问题 5: 登录失败但没有错误提示

**可能原因：**
- 错误信息未正确发送到前端
- Toast 通知未显示
- 日志级别设置过高

**解决方法：**
1. 查看后端日志，查找错误信息
2. 检查前端 Console，查看是否有错误事件
3. 查看应用内的"日志"页面

## 📝 调试清单

在报告问题前，请收集以下信息：

- [ ] 前端 Console 日志（开发者工具）
- [ ] Electron 主进程日志（终端窗口）
- [ ] Python 后端日志（终端窗口）
- [ ] 账户信息（隐藏敏感信息）
- [ ] 账户状态变化时间线
- [ ] 是否有验证码/2FA 对话框出现
- [ ] 网络连接状态
- [ ] 代理配置（如果使用）

## 🔧 快速修复尝试

1. **刷新页面：** Ctrl+R 或 F5
2. **重启应用：** 关闭并重新运行 `npm start`
3. **检查账户信息：** 确保 API ID 和 API Hash 正确
4. **检查网络：** 确保可以访问 Telegram API
5. **查看日志：** 检查应用内的"日志"页面

---

**最后更新：** 2026-01-02

