# 解决白屏问题

## 🔍 问题原因

应用显示白屏是因为：

1. **构建文件不存在：** `dist/index.html` 文件不存在
2. **开发服务器未运行：** Electron 尝试连接 `http://localhost:3000`，但开发服务器没有启动
3. **没有自动构建：** 启动脚本没有在启动前检查并构建应用

## ✅ 已修复

我已经做了以下修复：

1. **创建了自动构建检查脚本** (`scripts/check-build.js`)
   - 启动前自动检查构建文件是否存在
   - 如果不存在，自动运行 `npm run build`
   - 确保应用始终有可用的构建文件

2. **更新了启动脚本** (`package.json`)
   - `npm start` 现在会在启动前检查并构建（如果需要）

3. **改进了错误提示** (`electron.js`)
   - 如果构建文件不存在，显示清晰的错误对话框
   - 提供具体的解决步骤

## 🚀 现在请操作

### 方法 1：使用新的启动脚本（推荐）

```powershell
npm start
```

这会：
1. 自动检查构建文件
2. 如果不存在，自动构建
3. 然后启动 Electron

### 方法 2：手动构建后启动

```powershell
npm run build
npm start
```

### 方法 3：使用一键构建并启动

```powershell
npm run start:build
```

## 📋 预期结果

启动后应该看到：

**终端输出：**
```
🔍 检查构建文件...
✅ 构建文件已存在

[Electron] Loading built files from dist/index.html
[Backend] Starting Python backend...
[Backend] Python executable: python
[Backend] Python script: C:\tgkz2026\backend\main.py
```

**应用窗口：**
- ✅ **完整的界面显示**（不再是白屏！）
- ✅ 左侧导航菜单（深色背景）
- ✅ 仪表盘视图
- ✅ 所有功能按钮

## 🔧 如果仍然白屏

### 检查 1：查看终端输出

查看是否有构建错误：
```
❌ 构建失败！
```

如果有错误，请告诉我具体的错误信息。

### 检查 2：检查 dist 目录

```powershell
dir dist
```

应该看到：
- `index.html`
- `index.js` 或其他 JavaScript 文件
- CSS 文件等

### 检查 3：手动构建

```powershell
npm run build
```

查看是否有编译错误。

### 检查 4：开发者工具

1. 在 Electron 应用中按 `F12`
2. 查看 Console 标签页
3. 查看是否有错误信息
4. 查看 Network 标签页，检查资源是否加载成功

## 📝 常见问题

### Q: 为什么需要构建？

A: Angular 应用需要编译（TypeScript → JavaScript）才能运行。构建过程会：
- 编译 TypeScript 代码
- 打包所有文件
- 优化代码
- 生成可在浏览器/Electron 中运行的文件

### Q: 每次都要构建吗？

A: 不需要。只有在以下情况需要重新构建：
- 第一次启动
- 修改了代码
- 删除了 `dist` 目录

如果代码没有修改，直接运行 `npm start` 即可。

### Q: 构建很慢怎么办？

A: 构建确实需要一些时间（通常 10-30 秒）。这是正常的。如果觉得太慢，可以考虑：
- 使用开发服务器模式（需要修改配置）
- 优化构建配置

## 🎯 成功标志

如果一切正常，你应该看到：

1. **应用界面：**
   - 左侧导航菜单
   - 仪表盘视图
   - 统计数据卡片

2. **终端日志：**
   - `[Electron] Loading built files from dist/index.html`
   - `[Backend] Starting Python backend...`
   - `[Backend] Event: initial-state`

3. **功能正常：**
   - 可以点击菜单切换视图
   - 可以添加账户
   - 可以查看日志

---

**最后更新：** 2026-01-02

